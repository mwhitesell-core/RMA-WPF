Imports Core.Globalization
Imports Core.Framework
Imports Core.Framework.Core.Framework
Imports Core.Framework.Core.Framework.QDesign
Imports Core.ExceptionManagement
Imports System.ComponentModel
Imports System.Reflection.Emit
Imports System.Reflection
Imports System.Text
Imports Core.Windows
Imports System.IO
Imports System.Math
Imports System.Runtime.Serialization.Formatters.Binary
Imports System.Data.OracleClient
Imports System.Collections.Specialized
Imports System.Configuration.ConfigurationSettings
Imports System.Net
Imports System.Xml
Imports System.Windows.Controls
Imports System.Threading
Imports System.Windows.Threading
Imports System.Windows.Input
Imports System.Windows
Imports System.Linq
Imports System.Globalization

Namespace Core.Windows.UI

    ''' -----------------------------------------------------------------------------
    ''' Project	 : Core.Windows.UI
    ''' Class	 : Web.UI.Page
    ''' 
    ''' -----------------------------------------------------------------------------
    ''' <summary>
    ''' The base page object that is inherited by the derived screens.
    ''' </summary>
    ''' <remarks>
    ''' The Page object is one of the key components in the Renaissance Architect
    ''' Framework.  This component contains the properties, methods, events and members
    ''' that provide the functionality required by the screens.
    ''' </remarks>
    ''' <history>
    ''' 	[Chris]	05/04/2005	Created
    ''' </history>
    ''' -----------------------------------------------------------------------------
    <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
    Public Class Page
        Inherits UserControl


        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event DisplayControl()

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Event ChangeToolBarDisplay()

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Event ClearValues()

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Event CloseRunscreen()

        Public hsSubConverted As Hashtable = New Hashtable

        Public Property PageClick As PaginationClick
        Public Property IsNewRequest() As Boolean
        Public Property DateError() As Boolean

        Public UniqueControl As Object
        Private ControlHadFocus As Object
        Public ControlHasFocus As Object
        Public RunningDesigner As Core.Windows.UI.Designer

        Public InGridFieldID As String
        Public Property NextControl As Control

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property RequireTerminate() As Boolean
        Private Property SkipAll() As Boolean
        Private intSecurityMenu As Integer
        Public Property ScreenSequence() As String = ""

        Private skipTimeLoad = False

        Private firstcontrol = False
        Private HasSelectProcessing = False
        Private blnUseAcceptProcessing As Boolean
        Private blnAutoUpdate As Boolean
        Private objRunscreenReturnToStop As Object
        Private htSearchTypes As Hashtable
        Private intHeaderRecNo As Integer
        Private strCurrentMode As String
        Private strScreenSession As String
        Private mscreenType As ScreenTypes
        Private blnFindComplete As Boolean
        Private blnBackout As Boolean
        Public PreCommandExecuted As Boolean
        Private blnUpdateExecuted As Boolean
        Private blnControlsCleared As Boolean
        Private blnEnableNumberedDesigners As Boolean
        Private strDesignerName As String
        Private strNavigationRecordCount As String
        Private intCurrentRecordNumber As Integer
        Private intGridRecordNumber As Integer
        Private intTotalGridRecords As Integer
        Private intCurrentPageSetNumber As Integer
        Private intTotalPageSets As Integer
        Private intCurrentPageNumber As Integer
        Private intCurrentGridIndex As Integer
        Private blnAppendMode As Boolean
        Private blnIsDirty As Boolean
        Private intScreenLevel As Integer
        Private blnIsRequest As Boolean
        Private blnIsAppend As Boolean
        Private blnIsInAppendOrEntry As Boolean
        Private blnIsAppendFromEntry As Boolean
        Private blnIsInPostEntry As Boolean
        Private blnAppendFromGridNew As Boolean
        Private blnIsPathComplete As Boolean
        Private strStopScreens As String = ""
        Private blnReturnStopScreen As Boolean
        Private blnAccessOk As Boolean
        Private objPaginationType As PaginationTypes
        Private htHasChanged As Hashtable
        Private hsMultiAccept As Hashtable
        Private blnPUSHAPPEND As Boolean
        Private blnPassedMessagesError As Boolean
        Private oMessage As stcMessage

        Private intTotalRecordsProcessed As Integer
        Private blnPrepareGrid As Boolean
        Private blnUpdateProcessing As Boolean
        Private blnPostFind As Boolean
        Private strInitializeExecuted As String
        Private intRecordsForLoop As Integer
        Private strUserRoles As String
        Private intTotalRecordsFound As Integer
        Private intTotalSkippedRecords As Integer
        Private blnIsInFieldState As Boolean
        Private blnIsMainState As Boolean
        Private intRecordsProcessed As Integer


        Public Property RecordsProcessed() As Integer

            Get
                Return intRecordsProcessed
            End Get
            Set(ByVal Value As Integer)
                intRecordsProcessed = Value
            End Set
        End Property

        Public Property TotalRecordsFound() As Integer

            Get
                Return intTotalRecordsFound
            End Get
            Set(ByVal Value As Integer)
                intTotalRecordsFound = Value
            End Set
        End Property
        Public Property TotalSkippedRecords() As Integer

            Get
                Return intTotalSkippedRecords
            End Get
            Set(ByVal Value As Integer)
                intTotalSkippedRecords = Value
            End Set
        End Property

        ''' --- cApplicationScope --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of cApplicationScope.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Const cApplicationScope As String = "0003"

        ''' --- dicCoreDictionary --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of dicCoreDictionary.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Shared dicCoreDictionary() As CoreDictionary  ' Used to store the Core Dictionaries

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Shared helpScreens() As HelpScreens
        ''' --- colDictionaryKeys --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of colDictionaryKeys.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Shared colDictionaryKeys As HybridDictionary  ' Used to hold 5 Characters Language-Culture which is the key and corresponding Index that can be used in an Array

#Region " Web Form Designer Generated Code "

        ''' --- InitializeComponent ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of InitializeComponent.
        ''' </summary>
        ''' <remarks>This call is required by the Web Form Designer.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <System.Diagnostics.DebuggerStepThrough(),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub InitializeComponent()

        End Sub

        Public IsFunctionKey As Boolean = False
        Private hsFunction As Hashtable
        Private arrFunction As ArrayList




        'NOTE: The following placeholder declaration is required by the Web Form Designer.
        'Do not delete or move it.
        ''' --- designerPlaceholderDeclaration -------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of designerPlaceholderDeclaration.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private designerPlaceholderDeclaration As System.Object

        ''' --- m_intToolbarAction -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intToolbarAction.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intToolbarAction As ToolbarIcons = ToolbarIcons.Unknown   'To hold Toolbar action, if any

        ''' --- m_blnInvalidPattern -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnInvalidPattern.
        ''' </summary>
        ''' <remarks>Indicates that an InvalidPattern message is to be displayed.  Used by Accept verb.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnInvalidPattern As Boolean = False

        ''' --- m_blnExecutingDeclarations -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnExecutingDeclarations.
        ''' </summary>
        ''' <remarks>For GetSystemVal if Initial declaration for Temporary.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnExecutingDeclarations As Boolean = True

        ''' --- m_blnOccursWithDetail -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnOccursWithDetail.
        ''' </summary>
        ''' <remarks>Used to determine whether to exit the ENTRY when a Skip All is 
        ''' performed on the first grid field.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnOccursWithDetail As Boolean = False

        ''' --- m_blnInPostFindOrDetailPostFind -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnInPostFindOrDetailPostFind.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnInPostFindOrDetailPostFind As Boolean = False

        ''' --- m_blnRunscreenInInitialize -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnRunscreenInInitialize.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public m_blnRunscreenInInitialize As Boolean = False
        ''' --- m_blnInInitialize -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnInInitialize.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public m_blnInInitialize As Boolean = False
        'Instead of looping through all request collection we are initializing these Fields OnInit event
        ''' --- EventTarget --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Will hold the value from Request("__EventTarget")
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public EventTarget As String = ""

        ''' --- EventArgument ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of EventArgument.
        ''' </summary>
        ''' <remarks>Will hold the value from Request("__EventArgument")
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public EventArgument As String = ""

        ''' --- m_strRequestedTarget -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strRequestedTarget.
        ''' </summary>
        ''' <remarks>Will hold the value from Request("RequestedTarget")
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend m_strRequestedTarget As String

        ''' --- m_strRequestedArgument ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strRequestedArgument.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strRequestedArgument As String 'Will hold the value from Request("RequestedArgument")

        ''' --- m_strPendingBuffer -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strPendingBuffer.
        ''' </summary>
        ''' <remarks>Will hold the value from Request("hidPendingBuffer")
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_strPendingBuffer As String = ""

        ''' --- m_ClusterFile -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' Stores a reference to the File object that occurs with a cluster.
        ''' </summary>
        ''' <remarks>Holds a reference to the file that occurs with a cluster.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_ClusterFile As IFileObject

        'Holds name of Push procedure set in GeneratePushVerbScript
        Private m_strPushProcedure As String




#End Region

#Region "Screen Variable Definitions"

        Public m_strJobScriptPath As String = String.Empty
        Public m_blnJobScriptCreate As Boolean = False
        Public DisplayFileForDelete As String = String.Empty
        Public m_strReplaceContent As String = String.Empty
        Public m_strHidRunscreen As String = String.Empty
        Public m_strDisplayReset As String = String.Empty
        Public blnOverRideRunscreenClear As Boolean = False
        Public blnOverRideRunscreenClearRun As Boolean = False
        Friend m_clearRequestInitValues As Boolean = False
        Private m_blnCurrentDesigner As Boolean = False
        Public blHideMenu As Boolean = False
        Private blnFieldDiff As Boolean = False

        ''' --- m_blnReturnedFromRunScreen ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnReturnedFromRunScreen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        Private m_blnReturnedFromRunScreen As Boolean = False

        Private blnAutoReturn As Boolean = False

        Public m_blnShowGridFromUpdate As Boolean = False

        ''' --- m_blnUpdateCmdCalled ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnUpdateCmdCalled.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_blnUpdateCmdCalled As Boolean = False

        ''' --- m_strMountPointDrive ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strMountPointDrive.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strMountPointDrive As String = String.Empty

        ''' --- m_blnExecutingLookupNotOn ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnExecutingLookupNotOn.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnExecutingLookupNotOn As Boolean = False

        ''' --- m_strLookupNotOnFileName ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strLookupNotOnFileName.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strLookupNotOnFileName As String = String.Empty

        ''' --- m_blnLookupOnSameFile ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnLookupOnSameFile.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnLookupOnSameFile As Boolean = False

        ''' --- m_blntbsTabs ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blntbsTabs.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        Private m_inttbsTabs As Integer = 0

        ''' --- m_strLookupNotOnFile ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strLookupNotOnFile.  Used to determine the name of the file
        '''     for the ErrorMessage function.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        Private m_strLookupNotOnFile As String = String.Empty

        ''' --- m_blnHasReceivingList ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnHasReceivingList.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnHasReceivingList As Boolean = False

        ''' --- m_strAcceptField ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to store the value of the last accept.  The run screen will be 
        '''     appended to it if a run screen is called.  Once a second run screen
        '''     is called, this field will be updated on the screen (flicker free)
        '''     using PageModeLogic.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend m_strAcceptField As String = String.Empty

        ''' --- m_blnExecutingExit ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates that we are executing the Exit procedure.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnExecutingExit As Boolean

        ''' --- m_blnExecutingUpdate ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates that we are executing the Update procedure (not CallUpdate).
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend m_blnExecutingUpdate As Boolean

        ''' --- m_blnInErrorHandler ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates that we are in the error handler (for RaiseSavePageState).
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend m_blnInErrorHandler As Boolean

        ''' --- m_IsIMMessage ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	m_IsNotIMMessage indicates if the current message is a non 'IM' type message.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[glenn]	25sep2007	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_IsNotIMMessage As BooleanTypes = BooleanTypes.NotSet

        ''' --- stcSearchTypes ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to determine whether a Sequential search was performed or a specific search.
        '''     This is used to determine whether the error producted in a LookupNotOn should be displayed.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Serializable(), EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Structure stcSearchTypes
            Dim Type As FileTypes
            Dim Occurs As Integer
            Dim SearchType As SearchTypes
        End Structure

        ''' --- m_htSearchTypes ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to determine whether a Sequential search was performed or a specific search.
        '''     This is used to determine whether the error producted in a LookupNotOn should be displayed.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_htSearchTypes As Hashtable

        ''' --- m_strResponseMessage ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	The message to display in a message box (alert).
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strResponseMessage As String = String.Empty

        ''' --- QTPParm ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to pass values to the QTPs.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected QTPParm(15) As String

        ''' --- m_htSearchTypes ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to determine whether a Sequential search was performed or a specific search.
        '''     This is used to determine whether the error producted in a LookupNotOn should be displayed.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Sub SetSearchType(ByVal Name As String, ByVal FileType As FileTypes, ByVal Occurs As Integer, ByVal Type As SearchTypes)

            ' Set the search type information.
            Dim SearchInfo As stcSearchTypes
            SearchInfo.Type = FileType
            SearchInfo.Occurs = Occurs
            SearchInfo.SearchType = Type

            ' Store the search information for this file.
            If Not m_htSearchTypes.Contains(Name) Then
                m_htSearchTypes.Add(Name, SearchInfo)
            Else
                m_htSearchTypes.Item(Name) = SearchInfo
            End If

        End Sub

        ''' --- m_htSearchTypes ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to determine whether a Sequential search was performed or a specific search.
        '''     This is used to determine whether the error producted in a LookupNotOn should be displayed.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Property SearchType() As Hashtable
            Get
                If Not htSearchTypes Is Nothing Then
                    Return htSearchTypes
                Else
                    Return New Hashtable
                End If
            End Get
            Set(ByVal Value As Hashtable)
                If Value Is Nothing OrElse Value.Count = 0 Then
                    htSearchTypes = Nothing
                Else
                    htSearchTypes = m_htSearchTypes
                End If
            End Set
        End Property

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property tbsTabsSelectedIndex() As Integer
            Get
                Return m_inttbsTabs
            End Get
            Set(ByVal Value As Integer)
                m_inttbsTabs = Value
                'RegisterHiddenFields("hidtbsTabs", Value)
            End Set
        End Property



        ''' --- SearchWasFiltered ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to determine whether a Sequential search was performed or a specific search.
        '''     This is used to determine whether the error producted in a LookupNotOn should be displayed.
        '''     This function will return false when an error should be raised.  The only time
        '''     an error should not be raised is when the search was filtered.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function SearchWasFiltered(ByVal FieldName As String) As Boolean

            Dim strName As String

            If FieldName.IndexOf(".") > 0 Then
                strName = FieldName.Substring(0, FieldName.IndexOf("."))
                If m_htSearchTypes.Contains(strName) Then
                    Dim CurrentSearchType As stcSearchTypes
                    CurrentSearchType = CType(m_htSearchTypes.Item(strName), stcSearchTypes)
                    If CurrentSearchType.Occurs > 0 Then
                        If Me.TotalGridRecords = 1 Then
                            Return CurrentSearchType.SearchType = SearchTypes.Filtered
                        Else
                            Return False
                        End If
                    Else
                        If Me.NavigationRecordCount = 1 Then
                            Return CurrentSearchType.SearchType = SearchTypes.Filtered
                        Else
                            Return False
                        End If
                    End If
                Else
                    Return False
                End If
            Else
                Return False
            End If

        End Function


        ' Default PowerHouse variables.
        ''' --- m_blnPromptOK ------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Indicates that a value was entered in a field when prompted using the 
        '''     Accept or RequestPrompt methods.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected m_blnPromptOK As Boolean
        ''' --- m_blnFindMode ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates that the user is in FIND mode.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnFindMode As Boolean
        ''' --- m_blnEntryMode -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates that the user is in ENTRY mode.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public m_blnEntryMode As Boolean
        ''' --- m_blnChangeMode ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates that the user is in CHANGE mode.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnChangeMode As Boolean
        ''' --- m_blnCorrectMode ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates that the user is in CORRECT mode.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public m_blnCorrectMode As Boolean
        ''' --- m_blnSelectMode ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates that the user is in SELECT mode.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnSelectMode As Boolean
        ''' --- m_intScreenLevel ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates the current level of the screen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_intScreenLevel As Integer
        ''' --- m_strScreenKey -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates the current level of the screen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_strScreenKey As String

        ''' --- m_blnValidateError --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates that we have an error that originated in the Validate
        '''     procedure (ie. datatype error, out of range error, etc).  
        '''     The focus should stay on the field.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnValidateError As Boolean

        ''' --- m_blnIsMenuScreen --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates whether this is a menu screen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnIsMenuScreen As Boolean
        ''' --- m_triDisplayProcessingPage -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_triDisplayProcessingPage.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Shared m_triDisplayProcessingPage As Microsoft.VisualBasic.TriState = TriState.UseDefault

        ''' --- m_strPushMessage -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strPushMessage.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        Private m_strPushMessage As String = ""

        ''' --- m_blnDisplayToolbar --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates whether Toolbar should be visible on this screen or not.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnDisplayToolbar As Boolean = True

        Private Shared m_strDefaultDateFormat As String
        Private Shared m_strDefaultDateSeparator As String
        Private Shared m_strNullSeparator As String

        Private Shared m_strInitialDialogProperties As String
        Protected Friend Shared m_htScreenProperties As Hashtable 'Used to store Screen Properties (Coordinates for RunScreens).

        Private m_strParmPrompts As String
        Protected Friend m_htParmPrompts As Hashtable

        Private Shared m_triUseEnterKeyToSelectRow As Microsoft.VisualBasic.TriState = TriState.UseDefault

        Private m_strRequestedControlFocus As String  ' Used to set focus to the form rather than a control if an error occurs and there is no Accept field.
        Friend m_strActionDropdowns As String = String.Empty ' Used for AccessKeys (shortcut keys).


        '-----------------------------------------------------------------------------------------------------------
        ' In order to handle OldValue, and the fact that PowerHouse changes any reference to the 
        ' item on which the EDIT procedure is executing to either FIELDTEXT or FIELDVALUE, we are
        ' storing OLDVALUE in this array prior to calling the edit procedure.  We then assign FIELDTEXT/FIELDVALUE
        ' to the record buffer so that we don't have to worry about changing the item to FIELDTEXT/FIELDVALUE.
        ' OldValue will be stored using the following structure: ITEM in position 0 
        '                                                        FIELDTEXT in Position 1
        '                                                        FIELDVALUE in Position 2
        ''' --- sOldValue ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of sOldValue.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Structure sOldValue
            ''' --- Field --------------------------------------------------------------
            ''' <exclude/>
            ''' 
            ''' <summary>
            ''' 	Summary of Field.
            ''' </summary>
            ''' <remarks>
            ''' </remarks>
            ''' <history>
            ''' 	[Campbell]	7/4/2005	Created
            ''' </history>
            ''' --- End of Comments ----------------------------------------------------
            Dim Field As String
            ''' --- FieldText ----------------------------------------------------------
            ''' <exclude/>
            ''' 
            ''' <summary>
            ''' 	 Contains the most recent value in the field.
            ''' </summary>
            ''' <remarks>
            ''' </remarks>
            ''' <history>
            ''' 	[Campbell]	7/4/2005	Created
            ''' </history>
            ''' --- End of Comments ----------------------------------------------------
            Dim FieldText As String
            Dim FieldDate As String
            ''' --- FieldValue ---------------------------------------------------------
            ''' <exclude/>
            ''' 
            ''' <summary>
            ''' 	 Contains the most recent numeric or date value in the field.
            ''' </summary>
            ''' <remarks>
            ''' </remarks>
            ''' <history>
            ''' 	[Campbell]	7/4/2005	Created
            ''' </history>
            ''' --- End of Comments ----------------------------------------------------
            Dim FieldValue As Decimal
        End Structure

        ''' --- m_OldValue ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_OldValue.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_OldValue As sOldValue                             ' Array used to store OldValue.  

        ''' --- ObjectStateMedium --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to store state for WEB applications.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected ObjectStateMedium As StateMedium = StateMedium.SessionOnServer
        ''' --- ViewStateMedium ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ViewStateMedium.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected ViewStateMedium As StateMedium = StateMedium.PageOnClient

        '-----------------------------------------------------------------------------------------------------------
        ' For use of Occurrence Property and m_intOccurrence Variable 
        ' please see Notes on Occurrence Property
        ''' --- m_intOccurrence ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to store the current Occurrence of a CLUSTER variable.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_intOccurrence As Integer = 0

        ''' --- m_intLastBoundRow --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intLastBoundRow.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intLastBoundRow As Integer = -1                   ' Used as a flag to identify whether the row is bound or not

        ''' --- m_blnCommandOK -----------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Indicates the status of the last RunCommand method.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected m_blnCommandOK As Boolean                         ' 
        ''' --- m_strAmxwReturnValue -----------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Holds the return value from a RunCommandAmxw.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected AmxwReturnValue As String = String.Empty
        ''' --- m_intPath ----------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Integer value that is set by the Path method based on the criteria selected.  
        '''     This value is used by the Find method to determine the retrieval of data.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected m_intPath As Integer                              ' 
        ''' --- m_intSubPath -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	The PowerHouse SUBPATH variable.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_intSubPath As Integer                           ' 
        ''' --- FieldText ----------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	 Contains the most recent character value in the field.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend FieldText As String = String.Empty

        '<EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        'Protected Friend FieldDate As String = ""
        ''' --- FieldValue ---------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	 Contains the most recent numeric or date value in the field.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend FieldValue As Decimal                              ' 

        ''' --- m_blnDisableAppend -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnDisableAppend.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnDisableAppend As Boolean                       ' If the Append is disabled.

        ''' --- m_blnDisableFind -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnDisableFind.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnDisableFind As Boolean                       ' Allows disabling Find when Change is true (allowing entered records that are saved to be updated.

        ''' --- m_intLastMode ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used when calling SUBSCREENS using MODE SAME.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_intLastMode As PageModeTypes                    ' 

        ''' --- m_strLookupValue ---------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	The value selected in the INPUT procedure using the LOOKUP screen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected m_strLookupValue As String                        ' 

        ''' --- m_blnFrench --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnFrench.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnFrench As Boolean
        ''' --- m_blnStartJobScript --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnStartJobScript.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnStartJobScript As Boolean

        ''' --- m_strJobParams --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strJobParams.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strJobParams As String = String.Empty

        ''' --- m_blnStartJobScript --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnStartJobScript.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnAppendJobScript As Boolean
        ''' --- m_lngRecNo ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_lngRecNo.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_lngRecNo As Integer
        ''' --- m_intCurrentRecordNumber -------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intCurrentRecordNumber.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_intCurrentRecordNumber As Integer
        ''' --- m_strRunScreen -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strRunScreen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_strRunScreen As String = String.Empty
        ''' --- m_intPosition ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intPosition.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_intPosition As Int16

        ''' --- m_blnDisableAppendFromEntry ------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnDisableAppendFromEntry.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnDisableAppendFromEntry As Boolean                ' Don't automatically call the Append procedure during Entry.

        ' Web based code.
        ''' --- m_blnHasPathRequestFields ------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnHasPathRequestFields.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnHasPathRequestFields As Boolean                ' Used to indicate whether the current screen has REQUEST fields in the PATH procedure.

        Private m_blnAllowAcceptInDetailPostFind As Boolean
        ''' --- m_blnEnableNavigation ----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnEnableNavigation.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnEnableNavigation As Boolean = True             ' Determine whether the First, Next, Previous and Last buttons should be enabled.
        ''' --- m_strNavigationControl ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strNavigationControl.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strNavigationControl As String
        ''' --- m_blnInFieldValidation ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnInFieldValidation.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnInFieldValidation As Boolean                   ' Indicates whether the form is performing InFieldValidation.
        ''' --- m_intPageActionType ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intPageActionType.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intPageActionType As PageActionType = PageActionType.NotSet
        ''' --- m_intGridActionType ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intGridActionType.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intGridActionType As DataListActionTypes = DataListActionTypes.NotSet
        ''' --- m_blnRunCustomScreen -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnRunCustomScreen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnRunCustomScreen As Boolean                     ' Indicates that the run screen exception is to call a custom (non-Core) page.
        ''' --- m_objPageActionObject ----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_objPageActionObject.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_objPageActionObject As Object
        ''' --- m_objPageFunctionObject ----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_objPageFunctionObject.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_objPageFunctionObject As Object

        ''' --- m_blnHasError ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnHasError.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnHasError As Boolean = False
        ''' --- m_blnExecutingBackout ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnExecutingBackout.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnExecutingBackout As Boolean = False
        ''' --- m_blnHasErrorInFind ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnHasErrorInFind.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnHasErrorInFind As Boolean = False
        ''' --- m_blnDisableToolbar ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnDisableToolbar.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnDisableToolbar As Boolean = False              ' Set this to disable the toolbar (except Exit, etc.).  
        ''' --- m_blnSaveInFieldState ----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnSaveInFieldState.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnSaveInFieldState As Boolean = False            ' Determines whether we should save InFieldState after running Initialize.
        ''' --- m_blnInitializeExecuted --------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnInitializeExecuted.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnInitializeExecuted As Boolean = False            ' Determines whether we should save InFieldState after running Initialize.
        ''' --- m_CurrentField -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_CurrentField.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_CurrentField As String

        ' TODO: Consolidate (toolbaractiontype)  -- Web
        ''' --- m_NavigationType ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_NavigationType.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_NavigationType As NavigationTypes

        ' Variables used for SQL.
        ''' --- m_strWhere ---------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Stringbuilder object used to maintain the WHERE CLAUSE or filter criteria
        '''     for the retrieval of data.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <example>m_strWHERE = New StringBuilder(" WHERE ") <br/>
        '''         m_strWHERE.Append(" ").Append(fleEMPLOYEE.EMPLOYEE_ID = ").Append(T_EMP_ID.Value)
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected m_strWhere As StringBuilder
        ''' --- m_strOrderBy -------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Stringbuilder object used to maintain the ORDER BY CLAUSE or sort criteria
        '''     for the retrieval of data.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <example>m_strOrderBy = New StringBuilder(" ORDER BY EMPLOYEE.EMPLOYEE_ID")
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected m_strOrderBy As StringBuilder
        ''' --- m_strSQL -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strSQL.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_strSQL As StringBuilder
        ''' --- m_blnSlave ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnSlave.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnSlave As Boolean

        ' Variables used for Activities.
        ''' --- m_blnChange --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnChange.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnChange As Boolean
        ''' --- m_blnCancel --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnCancel.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnCancel As Boolean
        ''' --- m_blnExit --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnExit.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnExit As Boolean
        ''' --- m_blnDelete --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnDelete.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnDelete As Boolean
        ''' --- m_blnEntry ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnEntry.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnEntry As Boolean
        ''' --- m_blnFind ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnFind.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnFind As Boolean
        ''' --- m_blnNoAction ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnNoAction.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnNoAction As Boolean = False

        ''' --- m_blnDisableUpdate ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnDisableUpdate.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnDisableUpdate As Boolean

        ''' --- m_blnDisableDelete ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnDisableDelete.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnDisableDelete As Boolean

        ''' --- m_blnDisableEntry ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnDisableEntry.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnDisableEntry As Boolean

        ''' --- m_blnAutoReturn ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnAutoReturn.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnAutoReturn As Boolean
        ''' --- m_colMessages ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_colMessages.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend m_colMessages As New ArrayList

        ''' --- m_htLockTimes ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_htLockTimes.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_htLockTimes As New Hashtable

        ''' --- m_strPageTitle -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strPageTitle.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strPageTitle As String
        ''' --- m_strPassArraysToScreens -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strPassArraysToScreens.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strPassArraysToScreens As String = String.Empty

        ' Designer and Grid variables.
        ''' --- m_blnRaiseDataChangedEvent -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Whether to raise an data changed event or not?
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnRaiseDataChangedEvent As Boolean = True      ' 

        ''' --- m_blnRenderBlankGrid -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnRenderBlankGrid.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnRenderBlankGrid As Boolean = False

        ''' --- m_blnDisableOtherDesigners -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used during multiple postback, used in a Grid/Composite screen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_blnDisableOtherDesigners As Boolean      ' 
        ''' --- m_blnDefaultFirstRowInGrid -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used in a Grid/Composite screen having Designers.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_blnDefaultFirstRowInGrid As Boolean      ' 
        ''' --- HasGrid ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	This field gets set to True, from a DataList Control.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend HasGrid As Boolean                         ' 
        ''' --- m_blnCallFind ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used in Grid to conditionally enable Append Icon on Top of Grid.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_blnCallFind As Boolean = False           ' 
        ''' --- m_blnInFind --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used in FileObject to check if GetData is from Find or not.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_blnInFind As Boolean = False             ' 
        ''' --- m_blnInFindOrDetailFind --------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used in FileObject to check if GetData is from Find/DetailFind or not.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_blnInFindOrDetailFind As Boolean = False ' 
        ''' --- m_blnInDetailFind --------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used in FileObject to check if GetData is from Find/DetailFind or not.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_blnInDetailFind As Boolean = False ' 
        ''' --- m_blnIsGetDataIssuedFromFindOrDetailFind ---------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to determine whether GetData has been issued from Find Or DetailFind.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_blnIsGetDataIssuedFromFindOrDetailFind As Boolean = False    ' 
        ''' --- m_intRecordsToFillInFindOrDetailFind -------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to determine whether GetData has been issued from Find Or DetailFind.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_intRecordsToFillInFindOrDetailFind As Integer = -1   ' 

        ''' --- m_blnErrorInLastRecord ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to determine whether there is an error while processing current record in Find/DetailFind or not.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public m_blnErrorInLastRecord As Boolean = False            ' 
        ''' --- m_blnSkipRecordsWithError ------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to determine whether is there need to check error in Find/DetailFind or not.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public m_blnSkipRecordsWithError As Boolean = False         ' 

        ''' --- cSkipError ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to pass as a redable parameter in ForMissing or For loop in Find and 
        ''' represents that there is need to skip records with an error in Find or DetailFind.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Const cSkipError As Boolean = True                ' 

        ''' --- m_blnBindGridFields ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used in "SetOccurence" to determine there is need to call BindGridFields or not.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public m_blnBindGridFields As Boolean = True               ' 

        ''' --- m_blnExecutingPath -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Determines whether executing Path or PostPath or not.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_blnExecutingPath As Boolean = False      ' 
        ''' --- m_blnExecutingPostPath -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Determines whether executing PostPath or not.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_blnExecutingPostPath As Boolean = False      ' 

        ''' --- m_blnRequireValidateRequest ----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnRequireValidateRequest.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnRequireValidateRequest As Boolean = True       ' Used to bypass Validate Request if called from First, Prevous, Next, Last and Pagination

        ''' --- m_blnDisableGridRows -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnDisableGridRows.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend m_blnDisableGridRows As Boolean = False              ' Used to disable Grid Rows, in case there is no pending Accept

        ''' --- m_triContinueAppend ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_triContinueAppend.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend m_triContinueAppend As Microsoft.VisualBasic.TriState = TriState.UseDefault ' Used to cancel append for the Grid

        ' Used in a call to FileObject.FOR method
        ''' --- m_hstNestedForInfo -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_hstNestedForInfo.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_hstNestedForInfo As Hashtable        ' m_hstNestedForInfo is a list of NestedFor, for the current FileObject

        ' Used for the duplicate method in the field statemantes.
        ''' --- m_hstFieldDuplicate -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_hstFieldDuplicate.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_hstFieldDuplicate As Hashtable

        ''' --- m_strLastForID -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strLastForID.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strLastForID As String               ' m_strLastForID denotes the most ID Number for inner most For

        ''' --- m_intLastForIDNumber -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intLastForIDNumber.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_intLastForIDNumber As Integer = -1   ' m_intLastForIDNumber denotes the most ID Number for inner most For
        ''' --- m_sorNestedForIDs --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_sorNestedForIDs.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend m_sorNestedForIDs As System.Collections.SortedList
        ' Web specific.
        ''' --- CurrentDesigner ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CurrentDesigner.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend CurrentDesigner As Windows.UI.Designer    ' Used during multiple postback, used in a Grid/Composite screen

        ''' --- m_clmControlList ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_clmControlList.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_clmControlList As New ControlListManager
        ''' --- m_blnCallPerformOperation ------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnCallPerformOperation.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnCallPerformOperation As Boolean = False
        ''' --- m_blnSubmit --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnSubmit.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnSubmit As Boolean = False

        ''' --- m_blnCloseWindow ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnCloseWindow.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_blnCloseWindow As Boolean = False

        ''' --- m_hstInternalStateInfo ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_hstInternalStateInfo.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_hstInternalStateInfo As Hashtable                 ' To store the state of Temporary and File Objects
        ''' --- m_blnStateRetrievedInPageLoad --------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnStateRetrievedInPageLoad.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnStateRetrievedInPageLoad As Boolean = False
        ''' --- m_blnNeedLoadState -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnNeedLoadState.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnNeedLoadState As Boolean = True

        ''' --- m_strPageId --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strPageId.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strPageId As String

        ''' --- m_intRunScreenSequence ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intRunScreenSequence.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intRunScreenSequence As Integer = 0               ' Indicates the sequence of run screen calls.  

        ''' --- m_intUpdateSequence ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intUpdateSequence.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intUpdateSequence As Integer = 0               ' Indicates the sequence of run screen calls.  
        ''' --- m_intProcedureRunScreenSequence ------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intProcedureRunScreenSequence.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intProcedureRunScreenSequence As Integer = 0      ' Sequence for RunScreens that occur in a procedure as opposed to a Validate.
        ''' --- m_intProcedureRunScreenSequence ------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intProcedureRunScreenSequence.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intFunctionKeySequence As Integer = 0
        ''' --- m_intProcedureUpdateSequence ------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intProcedureUpdateSequence.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intProcedureUpdateSequence As Integer = 0
        ''' --- m_htRunFlag --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_htRunFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_htRunFlag As Hashtable                            ' RunScreen hashtable that stores Field.ID or Procedure run screen values.

        ''' --- m_htPutFlag --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_htPutFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_htPutFlag As Hashtable
        ''' --- m_htGetFlag --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_htGetFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_htGetFlag As Hashtable

        ''' --- m_htUpdateFlag --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_htUpdateFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_htUpdateFlag As Hashtable
        ''' --- cPROCEDURE ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of cPROCEDURE.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Const cPROCEDURE As String = "Procedure"            ' RunScreen constant for RunScreens that occur outside of Validation.
        ''' --- cREPORT_PAGES ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Constant value for the directory name of the Application Report .aspx pages.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Const cREPORT_PAGES As String = "ReportPages"            ' RunReportScreen constant for RunReportScreens main directory.
        ''' --- m_strControlName ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strControlName.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strControlName As String = String.Empty                      ' This will contain the Field.ID value for RunScreens in Validates.
        ''' --- m_strRunFlag -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strRunFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strRunFlag As String = String.Empty                         ' The RUN_FLAG value from SESSION.
        ''' --- m_strUpdateFlag -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strUpdateFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strUpdateFlag As String = String.Empty
        ''' --- m_intRunScreenMode -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intRunScreenMode.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_intRunScreenMode As PageModeTypes

        ''' --- m_strRunScreenFolder -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strRunScreenFolder.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strRunScreenFolder As String                      ' The sub-directory from which to call the run screen.
        ''' --- m_intRunScreenFolderLength -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intRunScreenFolderLength.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intRunScreenFolderLength As Short = -1            ' RunScreenFolderLength is used in a call to Run Screen to identify folder based on Run Screen Name
        ''' --- m_intUseLookUpIcon -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intUseLookUpIcon.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intUseLookUpIcon As Short = -1            ' RunScreenFolderLength is used in a call to Run Screen to identify folder based on Run Screen Name
        ''' --- m_strRunScreenFolderLength -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strRunScreenFolderLength.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Shared m_strRunScreenFolderLength As String         ' strRunScreenFolderLength is used to get initial value from config file

        ' Flags for true infield validation (ACCEPT, REQUEST, etc.)
        ''' --- m_intAcceptSequence ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intAcceptSequence.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intAcceptSequence As Integer = 0
        ''' --- m_strAcceptFlag ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strAcceptFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strAcceptFlag As String = String.Empty
        ''' --- m_strFinishAcceptFlag ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strFinishAcceptFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strFinishAcceptFlag As String = String.Empty

        ''' --- m_strEditFlag ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strAcceptFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strEditFlag As String = String.Empty

        ' Flags for true infield validation (ACCEPT, REQUEST, etc.)
        ''' --- m_intLookUpSequence ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intLookUpSequence.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intLookUpSequence As Integer = 0
        ''' --- m_strLookUpFlag ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strLookUpFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strLookUpFlag As String = String.Empty
        ''' --- m_intRequestSequence -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intRequestSequence.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intRequestSequence As Integer = 0
        ''' --- m_strRequestFlag ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strRequestFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strRequestFlag As String = String.Empty
        ''' --- m_intPutSequence ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intPutSequence.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intPutSequence As Integer = 0
        ''' --- m_intGetSequence ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intGetSequence.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intGetSequence As Integer = 0

        ''' --- m_strPutFlag -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strPutFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strPutFlag As String = String.Empty
        ''' --- m_strGetFlag -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strGetFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strGetFlag As String = String.Empty
        ''' --- m_intDoExternalSequence --------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intDoExternalSequence.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intDoExternalSequence As Integer = 0
        ''' --- m_strDoExternalFlag ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strDoExternalFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strDoExternalFlag As String = String.Empty
        ''' --- m_intRunCommandSequence --------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intRunCommandSequence.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intRunCommandSequence As Integer = 0
        ''' --- m_strRunCommandFlag ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strRunCommandFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strRunCommandFlag As String = String.Empty
        ''' --- m_intInfoWarningSequence -------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intInfoWarningSequence.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intInfoWarningSequence As Integer = 0
        ''' --- m_strInfoWarningFlag -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strInfoWarningFlag.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strInfoWarningFlag As String = String.Empty
        ''' --- m_strUniqueControlId -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strUniqueControlId.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strUniqueControlId As String = String.Empty                 ' Control to receive the focus.
        ''' --- m_fldAcceptField ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_fldAcceptField.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend m_fldAcceptField As Object                   ' The field on which the ACCEPT is performed.
        ''' --- m_strPopupComboName ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strPopupComboName.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strPopupComboName As String                       ' used to popup combo values
        ''' --- m_htFileInfo -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_htFileInfo.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_htFileInfo As Hashtable                      ' Stores the RowId and CheckSum_Value for files that performed a PUT.

        ''' --- m_htFileInfo -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_DisableSubmit.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[glenna]	27/oct/2007	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_DisableSubmit As Boolean = False                 ' Indicates if Submit button should be enabled

        ''' --- m_DeleteNoSubmit -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates that Delete should be called but Submit should not be called
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[glenna]	13/nov/2007	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_DeleteNoSubmit As Boolean = False


        ''' --- stcFileInfo --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of stcFileInfo.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Serializable(), EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Structure stcFileInfo
            ''' --- RowId --------------------------------------------------------------
            ''' <exclude/>
            ''' 
            ''' <summary>
            ''' 	Summary of RowId.
            ''' </summary>
            ''' <remarks>
            ''' </remarks>
            ''' <history>
            ''' 	[Campbell]	7/4/2005	Created
            ''' </history>
            ''' --- End of Comments ----------------------------------------------------
            Dim RowId As String
            ''' --- CheckSum -----------------------------------------------------------
            ''' <exclude/>
            ''' 
            ''' <summary>
            ''' 	Summary of CheckSum.
            ''' </summary>
            ''' <remarks>
            ''' </remarks>
            ''' <history>
            ''' 	[Campbell]	7/4/2005	Created
            ''' </history>
            ''' --- End of Comments ----------------------------------------------------
            Dim CheckSum As Decimal
            ''' --- AlteredRecord -----------------------------------------------------------
            ''' <exclude/>
            ''' 
            ''' <summary>
            ''' 	Summary of AlteredRecord.
            ''' </summary>
            ''' <remarks>
            ''' </remarks>
            ''' <history>
            ''' 	[Campbell]	7/4/2005	Created
            ''' </history>
            ''' --- End of Comments ----------------------------------------------------
            Dim AlteredRecord As Boolean
            ''' --- NewRecord -----------------------------------------------------------
            ''' <exclude/>
            ''' 
            ''' <summary>
            ''' 	Summary of NewRecord.
            ''' </summary>
            ''' <remarks>
            ''' </remarks>
            ''' <history>
            ''' 	[Campbell]	7/4/2005	Created
            ''' </history>
            ''' --- End of Comments ----------------------------------------------------
            Dim NewRecord As Boolean
            ''' --- DeletedRecord -----------------------------------------------------------
            ''' <exclude/>
            ''' 
            ''' <summary>
            ''' 	Summary of DeletedRecord.
            ''' </summary>
            ''' <remarks>
            ''' </remarks>
            ''' <history>
            ''' 	[Campbell]	7/4/2005	Created
            ''' </history>
            ''' --- End of Comments ----------------------------------------------------
            Dim DeletedRecord As Boolean
        End Structure

        'Friend m_triEnableCurrentRow As TriState = TriState.UseDefault ' used to determine whether grid rows need to be disabled or not

        ' Used for AcceptProcessing.
        ''' --- m_strGridDesigner --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strGridDesigner.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strGridDesigner As String                         ' Indicates the designer to run for the grid (Designer_01).
        ''' --- m_strStopScreen --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strStopScreen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strStopScreen As Boolean
        ''' --- m_blnChangedSelectedTab --------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnChangedSelectedTab.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnChangedSelectedTab As Boolean = False                  ' Indicates that we have changed the tab through code.  

        ''' --- GlobalizationManager -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GlobalizationManager.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public GlobalizationManager As Globalization.Core.Globalization.GlobalizationManager

        ''' --- m_strPageName ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strPageName.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strPageName As String
        ''' --- m_blnLanguageChanged -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnLanguageChanged.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnLanguageChanged As Boolean = False
        ''' --- m_intPageModeType --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intPageModeType.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intPageModeType As PageModeTypes = PageModeTypes.Unknown

        ''' --- DefaultSize --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of DefaultSize.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Const DefaultSize As Integer = -1  'Used in initializing Temporary values with default size

        ''' --- m_intRequireSelectProcessing ---------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intRequireSelectProcessing.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intRequireSelectProcessing As SelectProcessing = Framework.Core.Framework.SelectProcessing.OnPrimary
        ''' --- m_blnHasSelectProcessing -------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnHasSelectProcessing.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnHasSelectProcessing As Boolean
        ''' --- m_strPrimaryFile ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strPrimaryFile.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strPrimaryFile As String = String.Empty
        ''' --- m_blnMovePrevious --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnMovePrevious.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnMovePrevious As Boolean = False
        ''' --- m_bfoFileForRecordStatus -------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_bfoFileForRecordStatus.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_bfoFileForRecordStatus As BaseFileObject  ' m_bfoFileForRecordStatus is used in DeletedRecord, AlteredRecord and NewRecord method

        ''' --- m_bfoPrimaryFile ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_bfoPrimaryFile.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend m_bfoPrimaryFile As BaseFileObject           ' m_bfoPrimaryFile is used to store Primary File Object

        'Variable to hold the collection of Combo fields
        ''' --- m_colMetaComboColumnNames ------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_colMetaComboColumnNames.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_colMetaComboColumnNames As ArrayList  'Contains name of columns for which combo values needs to be retrieved from The Database
        ''' --- m_colUserComboColumnNames ------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_colUserComboColumnNames.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_colUserComboColumnNames As ArrayList  'Contains name of columns for which user has provided combo items and there is no need to look into Meta Combo Table
        ''' --- m_colUserComboValues -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_colUserComboValues.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_colUserComboValues As ArrayList              'Contains combo values for each Combo Field control that has Combo Items populated in screen
        ''' --- m_tblColumnsTable --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_tblColumnsTable.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_tblColumnsTable As System.Data.DataTable     'Contains the combo items retrieved from the Database

        ''' --- m_blnIsUsingSqlServer -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnIsUsingSqlServer.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnIsUsingSqlServer As Microsoft.VisualBasic.TriState = TriState.UseDefault

        ' Push verb.
        ''' --- m_strPush ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strPush.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        '<EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)> _
        Private m_strPush As String = String.Empty
        ' Push verb.
        ''' --- m_strPushPostCommand ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strPushPostCommand.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strPushPostCommand As String = String.Empty
        ' For Exit procedure.
        ''' --- m_blnHasExitProcedure ----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnHasExitProcedure.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnHasExitProcedure As Boolean = False

        ' For Backout procedure.
        ''' --- m_blnHasBackoutProcedure ----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnHasBackoutProcedure.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnHasBackoutProcedure As Boolean = False

        ' TODO: Should be removed.  Investigate.
        ''' --- m_intCount ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intCount.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected m_intCount As Integer

        ' Push on grid controls (Append, etc).  Returns the name of the control.
        ''' --- GetControlId -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetControlId.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Event GetControlId(ByVal Push As String, ByRef ControlId As String)

        ''' --- m_strHidControl ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strHidControl.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strHidControl As String                   ' Used for AcceptProcessing to reset the value of an error field.

        ''' --- m_strPreviousFor ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strPreviousFor.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strPreviousFor As String = String.Empty

        ''' --- m_PreCancelMode ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' Used to store the mode prior to pressing Cancel in case the mode is 
        ''' checked in the Backout procedure.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_preCancelMode As PageModeTypes

        ' Window Position variables
        ''' --- m_intTop -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intTop.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intTop As Integer = -1
        ''' --- m_intLeft ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intLeft.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intLeft As Integer = -1
        ''' --- m_intHeight --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intHeight.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intHeight As Integer = 750
        ''' --- m_intWidth ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intWidth.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intWidth As Integer = 1000
        ''' --- m_blnChangeEventFired ----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnChangeEventFired.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnChangeEventFired As Boolean = False
        ''' --- m_blnByPassExit ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnByPassExit.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnByPassExit As Boolean = False

        ''' --- m_blnRenderDefaultTextBoxesForDesigner -----------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnRenderDefaultTextBoxesForDesigner.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend m_blnRenderDefaultTextBoxesForDesigner As Microsoft.VisualBasic.TriState 'A flag to use default settings of text box while rendering textbox

        ''' --- m_blnExecutingDesigner ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnExecutingDesigner.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnExecutingDesigner As Boolean = False                ' Indicates whether we are executing a designer or not.
        ''' --- m_intNextAppendInRow -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_intNextAppendInRow.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_intNextAppendInRow As Integer = -1                     'Used to append multiple rows from Entry and GridNew

        ''' --- m_blnSkipAllAndTerminateAppend -------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnSkipAllAndTerminateAppend.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend m_blnSkipAllAndTerminateAppend As Boolean                 'Flag used to SKIPALL and then Terminate Append
        ''' --- m_blnImmediateTerminateAppend --------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnImmediateTerminateAppend.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend m_blnImmediateTerminateAppend As Boolean                  'Flag used to Terminate Append

        ''' --- m_blnExecAppend --------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnExecAppend.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend m_blnExecAppend As Boolean                  'Flag used to Terminate Append

        ''' --- m_blnClearField --------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnClearField.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend m_blnClearField As Boolean                  'Flag used to Terminate Append indicating whether to clear the field

        ''' --- m_blnPagePostProcessCalled -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnPagePostProcessCalled.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnPagePostProcessCalled As Boolean                    'Used to determine whether PagePostProcess has been called or not

        ''' --- m_blnIsInDisplayPreDisplayFormatting -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnIsInDisplayPreDisplayFormatting.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnIsInDisplayPreDisplayFormatting As Boolean

        ''' --- m_blnIsRunningSelectProcessing -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnIsRunningSelectProcessing.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Mayur]	September 9, 2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnIsRunningSelectProcessing As Boolean

        ''' --- m_blnFieldMark -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnFieldMark.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Mayur]	September 9, 2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnFieldMark As Boolean

        ''' --- m_strInitScript -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strInitScript.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Mayur]	September 9, 2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public m_strInitScript As New StringBuilder(String.Empty)

        ''' --- m_IsDefaultDelete -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_IsDefaultDelete.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Mayur]	September 9, 2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public m_IsDefaultDelete As Boolean = False


        ''' --- m_strRequestedControlFocusOverRide -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strRequestedControlFocusOverRide.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Mayur]	September 9, 2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public m_strRequestedControlFocusOverRide As String = String.Empty

        ''' --- m_blnIsFlickerFree ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_blnIsFlickerFree.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Mayur]	19-Oct-2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_blnIsFlickerFree As Microsoft.VisualBasic.TriState = TriState.UseDefault

        ''' --- m_oldTextField ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' Stores the field that had the OldText value updated.  This is so we can
        ''' set the OldText back if we hit a RunScreen since when we hit a RunScreen
        ''' and we go back to the ASPX, we don't update the fields on the form.  For
        ''' this reason the OldText is updated and when compared to the posted value,
        ''' will cause the posted value to be updated.  This field will allow us to 
        ''' reset the OldText value if we hit a RunScreen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	01-Apr-2009	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_oldTextField As Object

        ''' --- m_oldTextValue ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' Stores the value in OldText prior to being updated.  This is so we can
        ''' set the OldText back if we hit a RunScreen since when we hit a RunScreen
        ''' and we go back to the ASPX, we don't update the fields on the form.  For
        ''' this reason the OldText is updated and when compared to the posted value,
        ''' will cause the posted value to be updated.  
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	01-Apr-2009	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_oldTextValue As String = String.Empty
#End Region

#Region " Abstract Function Definitions"

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' PreInit gets called from Base Page's Init event handler and can be used in 
        ''' derived page to execute code before Derived Page's Init event handler.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Mayur]	09/06/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Overridable Shadows Function PreInit()
            'Meant to be used in derived in page.

            'The derived page should set FormName in PreInit
            Return Nothing
        End Function

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Closes all file objects and transaction/connection objects on the page.
        ''' </summary>
        ''' <remarks>
        ''' The CloseTransactionObjects method closes the file objects through the
        ''' call to CloseFiles and closes the transaction/connection objects.  
        ''' <br/><br/>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect Precompiler.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Sub CloseTransactionObjects()

        End Sub

        '---------------------------------------------
        ' Default CloseFiles procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Closes all file objects on the page.
        ''' </summary>
        ''' <remarks>
        ''' The CloseFiles method closes disposes of the file objects.
        ''' <br/><br/>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect Precompiler.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Sub CloseFiles()

        End Sub

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' This method marks data records for deletion in Primary files and associated
        ''' Secondary and Detail files.
        ''' </summary>
        ''' <remarks>
        ''' The Delete method is invoked by pressing the Delete button on the 
        ''' toolbar.  This method is used to mark data records for deletion in Primary
        ''' files and associated Secondary and Detail files.
        ''' <br/><br/>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect Precompiler if it doesn't exists and the 
        ''' DeleteActivity property has been set to True on the page.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend Overridable Function Delete() As Boolean

            m_IsDefaultDelete = True
            Return True

        End Function


        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Overridable Sub DisplayAlert(message As String, autoclose As Boolean)

        End Sub

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Sub CallScreen(baseUserControl As Page, borderless As Boolean)

        End Sub

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Sub HideAlert()

        End Sub


        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' This method marks data records for deletion in Detail files.
        ''' </summary>
        ''' <remarks>
        ''' The DetailDelete method is invoked by pressing the Detail Delete button 
        ''' on the grid.  This method is used to mark data records for deletion in Detail 
        ''' files.
        ''' <br/><br/>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect Precompiler if it doesn't exists providing the 
        ''' DeleteActivity property  has been set to True on the page.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend Overridable Function DetailDelete() As Boolean

            m_IsDefaultDelete = True
            Return True

        End Function

        '---------------------------------------------
        ' Default Append Function
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' This method is used to append new records to the Primary or Detail files.
        ''' </summary>
        ''' <remarks>
        ''' The Append method is invoked by pressing the Append button on the grid
        ''' or when the Append method is encountered in the Entry method.
        ''' <br/><br/>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect Precompiler if it doesn't exists providing the 
        ''' NoAppend property is not set to True on the Primary file.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend Overridable Function Append() As Boolean

            Return True

        End Function

        ''' --- AppendFromEntry ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of AppendFromEntry.
        ''' </summary>
        ''' <remarks>AppendInEntry Function should be called from Entry Procedure only.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend Overridable Function AppendFromEntry() As Boolean
            'AppendInEntry will be called from DataList for each Appended 
            'record in Entry Mode
            '
            'By default, call Append, however in case if we need to perform 
            'logic for each grid record in Entry Procedure, developer may override 
            'this procedure
            If Not Me.IsInPostEntry Then

                Try
                    Append()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
            End If

            Return True
        End Function

        '---------------------------------------------
        ' AppendFromGridNew Function
        '---------------------------------------------
        ''' --- AppendFromGridNew --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of AppendFromGridNew.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function AppendFromGridNew() As Boolean
            Try
                Append()
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try
            Return True
        End Function

        '---------------------------------------------
        ' TerminateAppend Function
        '---------------------------------------------
        ''' --- TerminateAppend --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' This should only be called from Append() when the grid automatically 
        ''' finds records and the Append() procedure was created using code from
        ''' Entry() which has a For loop code.  This allows us to get out of the 
        ''' Append() loop that is called from DataList.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Sub TerminateAppend()
            m_blnImmediateTerminateAppend = True
        End Sub

        ''' --- DoAppend -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of DoAppend.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function DoAppend() As Boolean

            'Call Append if the screen has Grid (ScreenType is Composite or Grid)
            If Me.HasGrid Then
                m_blnExecAppend = True

                If Me.EventTarget.EndsWith("btnGridRowNew") AndAlso Occurrence = 1 Then
                    RecordsForLoop = 0
                End If
                ' If (((CorrectMode OrElse ChangeMode) AndAlso Me.DisableAppend) OrElse (Mode = PageModeTypes.Entry AndAlso Me.DisableAppendFromEntry)) OrElse IsSkipAllFromFirstField() Then
                If (((CorrectMode OrElse ChangeMode) AndAlso Me.DisableAppend) OrElse (Mode = PageModeTypes.Entry AndAlso Me.DisableAppendFromEntry)) Then
                    m_blnImmediateTerminateAppend = True
                Else
                    Dim blnCallAppend As Boolean
                    blnCallAppend = True  'By Default set this flag to Call Append
                    m_blnSkipAllAndTerminateAppend = False

                    'If its not a Terminate, move append to the next record
                    If Me.RequireTerminate Then
                        If m_blnImmediateTerminateAppend Then
                            'Skip running append if, Terminate is requested from the first field
                            blnCallAppend = False  'Don't call Append
                        Else
                            'If Terminate is requested from other than first field, SKIPALL and than Terminate
                            m_blnSkipAllAndTerminateAppend = True
                        End If
                    End If

                    IsInAppendOrEntry = True
                    If blnCallAppend Then
                        If MethodWasExecuted(m_strAcceptFlag, 1) AndAlso RecordsForLoop < Me.m_intOccurrence + 1 Then
                            RecordsForLoop = Me.m_intOccurrence + 1
                        End If

                        If Me.IsAppendFromEntry Then

                            Try
                                Me.AppendFromEntry()
                            Catch ex As CustomApplicationException
                                Throw ex
                            Catch ex As Exception
                                ExceptionManager.Publish(ex)
                                Throw ex
                            End Try
                        ElseIf Me.IsAppendFromGrid Then
                            Me.AppendFromGridNew()
                        Else
                            Try
                                Append()
                            Catch ex As CustomApplicationException
                                Throw ex
                            Catch ex As Exception
                                ExceptionManager.Publish(ex)
                                Throw ex
                            End Try
                        End If
                    ElseIf m_blnImmediateTerminateAppend Then
                        If Not m_ClusterFile Is Nothing AndAlso RecordsForLoop > m_ClusterFile.RecordCount Then
                            RecordsForLoop = m_ClusterFile.RecordCount
                        End If
                    End If
                    IsInAppendOrEntry = False
                End If

                If (m_blnImmediateTerminateAppend OrElse m_blnSkipAllAndTerminateAppend OrElse Me.IsInPostEntry) Then
                    Me.FinishAppend()
                Else
                    'Set the Next row to append-in only if, there no Terminate or SkipAllAndTerminate
                    m_intNextAppendInRow = Me.m_intOccurrence + 1
                    If RecordsForLoop < Me.m_intOccurrence + 1 Then
                        'Note: RecordsForLoop is used as One based
                        RecordsForLoop = m_intNextAppendInRow
                    End If
                End If

                m_blnExecAppend = False
            End If


        End Function

        ''' --- FinishAppend -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of FinishAppend.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Sub FinishAppend()
            'This method is used to resets multiple Append related variables, and sets the mode either to Correct or Change
            ' Clear the fields in the current row.  This is called here since the call
            ' at the end works on Occurrence 1.
            If m_blnImmediateTerminateAppend Then
                RaiseResetValueChanged(True)
            End If

            Me.NextAppendInRow = -1
            If Me.IsAppendFromEntry Then
                ' If the grid occurs with the detail file, and the user does a SKIP ALL 
                ' on the first grid field, then exit out of the rest of the ENTRY procedure
                ' and just call the display formatting function.
                If m_blnImmediateTerminateAppend AndAlso m_blnOccursWithDetail Then

                    Try
                        Me.DisplayFormatting()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                Else
                    'If Append called from Entry, before calling finish append, Calling Call PostEntry
                    Me.CallPostEntry()
                End If
                Me.IsAppendFromEntry = False
                Me.IsAppendFromGrid = False
                Mode = PageModeTypes.Correct
            Else
                Me.IsAppendFromGrid = False
                If Mode <> PageModeTypes.Correct Then Mode = PageModeTypes.Change
            End If
            Me.IsInAppendOrEntry = False
            Me.IsAppend = False
            RaiseResetValueChanged()
        End Sub



        ''' --- IsExecutingAppend --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsExecutingAppend.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Function IsExecutingAppend() As Boolean
            Return (Me.IsAppendFromEntry OrElse Me.IsAppendFromGrid)
        End Function


        ''' --- CallPostEntry ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CallPostEntry.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub CallPostEntry()
            Me.SetOccurrence(0, True)
            If Not Me.IsInPostEntry Then
                'Save state (only once) before calling Post Entry
                Me.RemoveFlags(True)
                Me.IsInPostEntry = True
            End If

            Try
                Me.PostEntry()
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try
            'If ExecutingPostEntryWithTerminateAppend Then
            '    m_blnImmediateTerminateAppend = False
            'End If
            Me.IsInPostEntry = False
        End Sub

        ''' --- ResetAppendVariables -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ResetAppendVariables.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub ResetAppendVariables()
            'At present this function is being called from several Toolbar Button Click
            'Note: ResetAppendVariables should only be used internally
            Me.IsAppendFromGrid = False
            Me.IsAppendFromEntry = False
            Me.m_blnImmediateTerminateAppend = False
            Me.m_blnSkipAllAndTerminateAppend = False
            Me.IsAppend = False



        End Sub



        ''' --- IsImmediateTerminate -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsImmediateTerminate.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Function IsImmediateTerminate() As Boolean
            'Skip running append if, Terminate is requested from the first field
            ' Added check for IsInPostEntry since the TERMINATE will continue to be set but the m_strAcceptFlag will be greater than 1 so we still need to return True.
            Return (RequireTerminate() AndAlso (Not Me.m_strAcceptFlag Is Nothing) AndAlso Me.m_strAcceptFlag.Length <= 1 AndAlso Me.m_strFinishAcceptFlag.Length < 1) OrElse (RequireTerminate() AndAlso Me.IsInPostEntry)
        End Function

        ''' --- SkipAllFromFirstField ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SkipAllFromFirstField.
        ''' </summary>
        ''' <param name="EventArgument"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function IsSkipAll(ByVal EventArgument As String) As Boolean
            'Skip running append if, SkipAll is requested from the first field
            Return EventArgument.Equals("SKIPALL")
            Return True
        End Function

        ''' --- IsSkipAll ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsSkipAll.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function IsSkipAll() As Boolean
            If m_strPendingBuffer.ToString.Equals(String.Empty) Then
                Return False
            Else
                Return IsSkipAll(m_strPendingBuffer)
            End If
        End Function

        ''' --- IsImmediateTerminate -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsImmediateTerminate.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Function IsSkipAllFromFirstField() As Boolean
            'Skip running append if, Terminate is requested from the first field
            Return IsSkipAll() AndAlso (Not Me.m_strAcceptFlag Is Nothing) AndAlso Me.m_strAcceptFlag.Length <= 1
        End Function

        '---------------------------------------------
        ' Default DisplayFormatting procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Formats the values in the record buffers associated to the fields 
        ''' on the screen in order to display them.
        ''' </summary>
        ''' <remarks>
        ''' The DisplayFormatting method is called after the Find sequence has
        ''' completed.  The Display method is called for each of the fields on the form and
        ''' adds the necessary formatting to the record buffer values prior to displaying them.
        ''' <br/><br/>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect PreCompiler.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Sub DisplayFormatting()

        End Sub

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Overridable Sub CallDisplayForDelete()

            Try
                DisplayFormatting()
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try
        End Sub



        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Sets a reference to the controls (fields) that are part of the grid.
        ''' </summary>
        ''' <remarks>
        ''' The GetGridFieldObject method sets a reference to the controls in the
        ''' grid, and binds them to their respective record buffers (File or Temporary objects).
        ''' <br/><br/>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect PreCompiler.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend Overridable Sub GetGridFieldObject(ByVal DataListField As Object, ByRef CoreField As Object, ByVal Name As String)

        End Sub

        '---------------------------------------------
        ' Default Backout procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Performs processing when the user backs out of the Entry sequence or fails
        ''' to update a change.
        ''' </summary>
        ''' <remarks>
        ''' Use the Backout method to perform processing when the user fails to 
        ''' complete the Entry sequence or fails to update a change.  A warning is given
        ''' to the user indicating that data changes will be lost.
        ''' <br/><br/>
        ''' NOTE: Override this method in the derived screen if you want to perform Backout
        ''' processing.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function Backout() As Boolean

            Return True

        End Function

        '---------------------------------------------
        ' Lock procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Locks a table or record in the database.
        ''' </summary>
        ''' <param name="FileObject">A reference to a file object.</param>
        ''' <param name="LockTypes">A lock type of either Record, File or Base</param>
        ''' <remarks>
        ''' Use the Lock method to lock a record or table in the database.  
        ''' </remarks>
        ''' <example>Lock(fleEMPLOYEE) <br/>
        '''         Lock(fleEMPLOYEE, LockTypes.File)
        ''' </example>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function Lock(ByVal FileObject As BaseFileObject, Optional ByVal LockTypes As LockTypes = LockTypes.Record) As Boolean

            Try
                Return FileObject.Lock(LockTypes)
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try

        End Function

        '---------------------------------------------
        ' Lock procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Unlocks a table or record in the database.
        ''' </summary>
        ''' <param name="FileObject">A reference to a file object.</param>
        ''' <param name="LockTypes">A lock type of either Record, File or Base</param>
        ''' <remarks>
        ''' Use the Unlock method to unlock a table or record that has previously
        ''' been locked.
        ''' </remarks>
        ''' <example>Unlock(fleEMPLOYEE) <br/>
        '''         Unlock(fleEMPLOYEE, LockTypes.File)
        ''' </example>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function Unlock(ByVal FileObject As BaseFileObject, Optional ByVal LockTypes As LockTypes = LockTypes.Record) As Boolean


            Try
                Return FileObject.Unlock(LockTypes)
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try

        End Function

        Protected Function MountPointDrive() As String

            If m_strMountPointDrive = String.Empty Then
                m_strMountPointDrive = System.Configuration.ConfigurationManager.AppSettings("SharedDrive") & ""
            End If

            Return m_strMountPointDrive

        End Function

        Protected Function CopyFile(ByVal Source As String, ByVal Destination As String) As Boolean

            Try
                Dim DestinationDir As String = Substring(Destination, 1, Destination.LastIndexOf("\"))
                If Not Directory.Exists(DestinationDir) Then
                    Directory.CreateDirectory(DestinationDir)
                End If
                If File.Exists(Destination) Then
                    File.Delete(Destination)
                End If
                File.Copy(Source, Destination)

                Return True

            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Return False
            End Try


        End Function



        '---------------------------------------------
        ' Default Find procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Retrieves data records based on the Path method.
        ''' </summary>
        ''' <remarks>
        ''' Use the Find method to retrieve data that is to be displayed on the 
        ''' screen.
        ''' <br/><br/>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect PreCompiler if no Find method was coded and
        ''' the FindActivity for the screen is set to True.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function Find() As Boolean

            Return True

        End Function

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Sub SetVariables()


        End Sub

        Public Sub CallSetVariables()

            Try
                'CallCloseTransactionObjects()
                SetVariables()
                InitializeTransactionObjects()
                InitializeFiles()
                SetRelations()
                RetrieveParamsReceived()
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try
        End Sub

        '---------------------------------------------
        ' Default PostFind procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Performs processing upon the successful completion of the Find method.
        ''' </summary>
        ''' <remarks>
        ''' Use the PostFind method to perform specific processing after successfully
        ''' completing the Find method.  This method is called prior to displaying the 
        ''' retrieved data on the screen.
        ''' <br/><br/>
        ''' NOTE: Override this method in the derived screen if you want to perform PostFind
        ''' processing.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function PostFind() As Boolean

            Return True

        End Function


        '---------------------------------------------
        ' Default SelectProcessing procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Allows the user to use additional search criteria (based on the Primary file)
        ''' when searching for data.
        ''' </summary>
        ''' <remarks>
        ''' The SelectProcessing method allows the user to add additional search 
        ''' criteria when searching for data.  This filter is applied only the the Primary
        ''' file.  This method executes upon completion of the Path method and is not
        ''' initiated for the first find if the screen is called in Find mode.
        ''' <br/><br/>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect PreCompiler.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function SelectProcessing(Optional ByVal AddWhere As Boolean = False) As String

            Return ""

        End Function

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Overridable Function CallInitialize() As Boolean

            Try
                m_blnInInitialize = True
                Try
                    Initialize()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

                m_blnInInitialize = False
            Catch ex As CustomApplicationException
                Select Case ex.Message
                    Case cRunScreenException.ToString
                        If Me.HasGrid Then
                            'If there is a grid, in case of an error 
                            'we need to display controls as labels in Grid
                            'Please note for non-grid screen it will call following method
                            'however, following method only raises an event
                            'If we ever need to write some logic other than raising
                            'an event, we need to change above if condition 
                            RaisePrepareGridControlsForDisplay(True)
                        End If
                        Throw ex
                    Case cAcceptRequestPromptException.ToString
                        Throw ex
                    Case cReturn.ToString
                        '--------------- 
                        'In case "ReturnAndClose" called from "Initialize", rethrow an error
                        'Mainly changed to fix a bug in QKCD5111 (Freightways)
                        '--------------- September 27, 2005 09:51
                        Throw ex
                    Case Else
                        'Error in Initialize closes the form
                        If m_fldAcceptField Is Nothing Then
                            Me.ReturnAndClose()
                        Else
                            Throw ex
                        End If
                End Select



            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function

        '---------------------------------------------
        ' Default INITIALIZE procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Performs processing when the screen is initialized.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' Use the Initialize method to perform processing while the screen is
        ''' being initialized.  The event occurs prior to the rendering of the screen, and
        ''' is called only once per screen.  It is not executed each time the page is posted.
        ''' <br/><br/>
        ''' NOTE: Override this method in the derived screen if you want to perform Initialize
        ''' processing.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function Initialize() As Boolean

            Return True

        End Function

        '---------------------------------------------
        ' Default InitializeScreen procedure.
        '---------------------------------------------
        ''' --- InitializeScreen ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of InitializeScreen.
        ''' </summary>
        ''' <param name="InitializeTemporaryVariables"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub InitializeScreen(ByVal InitializeTemporaryVariables As Boolean)

            Try
                ' Initialize the connections objects.
                CoreWebTrace("InitializeScreen", "Before InitializeTransactionObjects")
                InitializeTransactionObjects()
                CoreWebTrace("InitializeScreen", "After InitializeTransactionObjects")
                CoreWebTrace("InitializeScreen", "Before InitializeFiles")
                InitializeFiles()
                CoreWebTrace("InitializeScreen", "After InitializeFiles")

                If InitializeTemporaryVariables Then
                    'For details on setting InitialValue, see comments on RaiseGetInitialValue method in CoreBaseType
                    RaiseEvent InitializeInternalValues()
                End If
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try

        End Sub

        '---------------------------------------------
        ' Default InitializeFiles procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Assigns the transaction objects to the specified files.
        ''' </summary>
        ''' <remarks>
        ''' The InitializeFiles method is used to assign the transaction objects
        ''' (both the declared transactions and the default transactions) to the appropriate
        ''' File objects.
        ''' <br/><br/>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect PreCompiler.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Sub InitializeFiles()

        End Sub

        '---------------------------------------------
        ' Default OpHPBnections procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Opens the connections and creates the transactions.
        ''' </summary>
        ''' <remarks>
        ''' The InitializeTransactionObjects method opens the connections and transactions
        ''' that are required by the default transactions as well as the declared transactions.
        ''' <br/><br/>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect PreCompiler.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Sub InitializeTransactionObjects()

        End Sub

        '---------------------------------------------
        ' Default PreEntry procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Perform processing prior to the Entry sequence.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' Use the PreEntry method to perform any processing prior to the Entry
        ''' sequence.  This method can be used to perform tests or calculations.
        ''' <br/><br/>
        ''' NOTE: Override this method in the derived screen if you want to perform PreEntry
        ''' processing.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function PreEntry() As Boolean

        End Function

        '---------------------------------------------
        ' Default Entry procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Performs the standard Entry sequence.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' Use the Entry method to perform the entering of new data records.  
        ''' <para>
        ''' <note>This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect PreCompiler if this method does not already exist
        ''' and the EntryActivity on the screen is set to True.</note>
        ''' </para>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function Entry() As Boolean

        End Function

        '---------------------------------------------
        ' Post Entry procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Perform any processing after successful completion of the Entry sequence.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' Use the PostEntry method to perform any subsequent processing upon
        ''' successful completion of the Entry sequence.
        ''' <br/><br/>
        ''' NOTE: Override this method in the derived screen if you want to perform PostEntry
        ''' processing.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function PostEntry() As Boolean

        End Function

        '---------------------------------------------
        ' Default Path procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Establishes how record retrieval should be performed by the Find method.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' Use the Path method to determine how the record retrieval of Primary 
        ''' and Secondary files should be performed by the Find method.  This method is initiated 
        ''' when the Find sequence is initiated.  This method sets the m_intPath member variable
        ''' with the appropriate value based on the values entered on the screen by the user.
        ''' <para>
        ''' <note>This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect PreCompiler if this method does not already exist
        ''' and the FindActivity on the screen is set to True.</note>
        ''' </para>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function Path() As Boolean

        End Function

        '---------------------------------------------
        ' Default PostPath procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Performs processing upon successful completion of the Path method.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' Use the PostPath method to perform any additional processing after
        ''' successful completion of the Path method and prior to the Find method.  
        ''' <br/><br/>
        ''' NOTE: Override this method in the derived screen if you want to perform PostPath
        ''' processing.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function PostPath() As Boolean

        End Function

        '---------------------------------------------
        ' Default DetailFind procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Performs data record retrieval for the Detail file and any files that occur
        ''' with this file.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' Use the DetailFind method to perform data retrieval for Detail files 
        ''' and any files that occur with this file.  This method is executed after Find 
        ''' and PostFind methods.
        ''' <br/><br/>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect PreCompiler if this method does not already exist
        ''' and the FindActivity on the screen is set to True.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function DetailFind() As Boolean

        End Function

        '---------------------------------------------
        ' Default PostDetailFind procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Performs processing upon the successful completion of the DetailFind method.
        ''' </summary>
        ''' <remarks>
        ''' Use the DeatilPostFind method to perform specific processing after successfully
        ''' completing the DetailFind method.  This method is called prior to displaying the 
        ''' retrieved data on the screen.
        ''' <br/><br/>
        ''' NOTE: Override this method in the derived screen if you want to perform DetailPostFind
        ''' processing.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function DetailPostfind() As Boolean

        End Function

        '---------------------------------------------
        ' Default PreDisplayFormatting procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Formats the values in the record buffers associated to the fields 
        ''' on the screen that have the PreDisplay option set and displays them.
        ''' </summary>
        ''' <remarks>
        ''' The PreDisplayFormatting method adds the necessary formatting to the 
        ''' values in the record buffers that are associated to the fields on the screen 
        ''' prior to displaying them.
        ''' <br/><br/>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect PreCompiler.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Sub PreDisplayFormatting()

        End Sub

        '---------------------------------------------
        ' Default InitalizeItems procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <param name="Predisplay"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Overridable Overloads Sub InitalizeItems(ByVal Predisplay As Boolean)
            If (Not Me.m_bfoPrimaryFile Is Nothing) Then
                Me.m_bfoPrimaryFile.AddRecord(True)
            End If

            If Predisplay Then
                CallPreDisplayFormatting()
            End If
        End Sub

        '---------------------------------------------
        ' Default SetDefaultValues procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Assigns the default values and displays them when the user enters a new record
        ''' during the Entry phase.
        ''' </summary>
        ''' <example>
        ''' If fleEMPLOYEE.GetStringValue("GENDER") = cEmptyString AndAlso fleEMPLOYEE.NewRecord Then
        '''     fleEMPLOYEE.SetValue("GENDER") = T_GL_MALE.Value
        '''     Validate(fldEMPLOYEE_GENDER, ValidateTypes.Display)
        '''     fldEMPLOYEE_GENDER.ValueChanged = True
        ''' End If
        ''' </example>
        ''' <remarks>
        ''' Use the SetDefaultValues method to assign a default value to fields on 
        ''' the screen.  These values will be displayed when the user Adds a new record 
        ''' during the Entry sequence.  
        ''' <br/><br/>
        ''' NOTE: Override this member to set default values when entering new records.  This
        ''' method is only valid when the UseAcceptProcessing is not set on the screen.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Sub SetDefaultValues()

        End Sub

        '---------------------------------------------
        ' Default Exit procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Performs processing prior to closing the current screen.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' Use the Exit method to perform processing prior to closing the current
        ''' screen.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function [Exit]() As Boolean

        End Function

        '---------------------------------------------
        ' Default TRANS_UPDATE procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Perform a Commit or Rollback on the default update transaction.
        ''' </summary>
        ''' <param name="Method">TransactionMethods.Commit or TransactionMethods.Rollback</param>
        ''' <remarks>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect PreCompiler.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend Overridable Sub TRANS_UPDATE(ByVal Method As TransactionMethods)

        End Sub

        '---------------------------------------------
        ' ExecuteNamedTransactions procedure to call named transactions.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Perform a Commit or Rollback on named transaction during the Update phase if no Commit was explicitly
        ''' coded by the developer.
        ''' </summary>
        ''' <param name="Method">TransactionMethods.Commit or TransactionMethods.Rollback</param>
        ''' <remarks>
        ''' NOTE: This method will be overriden in the derived screen and is generated
        ''' by the Renaissance Architect PreCompiler.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend Overridable Sub ExecuteNamedTransactions(ByVal Method As TransactionMethods)

        End Sub

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend Function ExecuteMethod() As Boolean

            Dim intSequence As Integer = 0
            If Not Me.UseAcceptProcessing OrElse (Me.UseAcceptProcessing AndAlso m_strControlName.Length > 0) Then
                m_intRunScreenSequence += 1
                intSequence = m_intRunScreenSequence
            Else
                m_intProcedureRunScreenSequence += 1
                intSequence = m_intProcedureRunScreenSequence
            End If

            Dim blnMethodWasExecuted As Boolean
            blnMethodWasExecuted = MethodWasExecuted(m_htRunFlag, intSequence)

            If blnMethodWasExecuted Then
                Return False
            Else
                ' Save the sequence information and set a flag indicating screen was run.
                SetMethodExecutedFlag(m_htRunFlag, "RUN_FLAG", intSequence)



                Return True
            End If

        End Function



        '-------------------------------------------------------------------
        ' Name: HandleRunScreenException
        ' Function: Handles the RunScreen calls.
        ' Example: HandleRunScreenException()
        '-------------------------------------------------------------------
        ''' --- HandleRunScreenException -------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of HandleRunScreenException.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub HandleRunScreenException()

            ' Check if the screen was posted back by a control
            ' or if the screen was just loading.
            If EventTarget Is Nothing Then
                HandleRunScreenException("")
            Else
                HandleRunScreenException(EventTarget)
            End If

        End Sub

        ''' --- HandleRunScreenException -------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of HandleRunScreenException.
        ''' </summary>
        ''' <param name="strSource"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub HandleRunScreenException(ByVal strSource As String)



        End Sub

        ''' --- HandleRunScreenException -------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of HandleRunScreenException.
        ''' </summary>
        ''' <param name="sender"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub HandleRunScreenException(ByRef sender As Object)

            Dim intCount As Int16
            Dim strUniqueControlId As String = String.Empty

            '' Get the UniqueId for the TextBox control.
            'For intCount = 0 To sender.Controls.Count - 1
            '    If sender.Controls(intCount).GetType.ToString = "System.Web.UI.WebControls.TextBox" Then
            '        strUniqueControlId = sender.Controls(intCount).Name
            '        Exit For
            '    End If
            'Next

            HandleRunScreenException(strUniqueControlId)

        End Sub

        ''' --- CallExit -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CallExit.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function CallExit() As Boolean

            ' Set the MODE flags to FALSE.
            m_blnFindMode = False
            m_blnEntryMode = False
            m_blnChangeMode = False
            m_blnCorrectMode = False
            m_blnSelectMode = False

            ' Check if any of the files have an altered status.  
            ' This sets IsDirty to true if an altered file is found.
            RaiseCheckFileStatuses()

            ' Call the EXIT procedure.
            m_blnExecutingExit = True
            Try
                If IsDirty Then
                    m_blnExecutingBackout = True

                    Try
                        Backout()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                    m_blnExecutingBackout = False
                End If

                Try
                    [Exit]()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
            Catch ex As CustomApplicationException
                If m_fldAcceptField Is Nothing Then
                    SetByPassExit()
                End If
                Throw ex
            Catch ex As Exception
                Throw ex
            End Try
            m_blnExecutingExit = False

            If Not IsDirty OrElse EventArgument.Equals("CONTINUE") Then
                Try
                    SaveParamsReceived()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
            End If

            SetByPassExit()

            If IsPopup Then
                RaiseEvent CloseRunscreen()
            End If


            Return True

        End Function

        ''' --- SetByPassExit -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SetByPassExit.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub SetByPassExit()

            ' If the EventArgument is not equal to "ExitOnly", then set the m_blnByPassExit flag.
            ' The EventArgument will be equal to "ExitOnly" when calling the exit procedure from the MENU
            ' (by either calling another screen or the current screen again).  This means we don't want to close
            ' the browser.  In the case of Modal Dialogs (or clicking the EXIT button on the main screen), 
            ' the EventArgument will be a value other than "ExitOnly", which will cause the browser to close.
            If Not EventArgument.Equals("ExitOnly") Then
                m_blnByPassExit = True
            End If

        End Sub

        '-------------------------------------------------------------------
        ' Name: PerformOperationInitializationForAcceptProcessing
        ' Function: Initializes the screen objects (Files, Variables, 
        '           Transactions).
        ' Example: PerformOperationInitializationForAcceptProcessing()
        '-------------------------------------------------------------------
        ''' --- PerformOperationInitializationForAcceptProcessing ------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PerformOperationInitializationForAcceptProcessing.
        ''' </summary>
        ''' <param name="InFieldValidation"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub PerformOperationInitializationForAcceptProcessing(Optional ByVal InFieldValidation As Boolean = False)

            'If Me.IsPostBack AndAlso Not m_strPendingBuffer.Equals(cRemoveFlags) Then
            '    ' Determine the flag information.
            '    RetrieveFlags()
            'Else
            '    If m_strPendingBuffer.Equals(cRemoveFlags) Then m_strPendingBuffer = String.Empty
            '    RemoveFlags()
            'End If

            If Not m_blnNeedLoadState Then
                Exit Sub
            End If

            'If User has clicked on Add (Which is Entry for Grid Screen) 
            'then we don't need to retrieve Session Variables 
            'If Not Me.IsNewRequest Then
            CoreWebTrace("PerformOperationInitialization", "Before RetrieveState")

            ' Initialize the screen objects (Transactions, Files, etc.)
            'Calling InitializeScreen before RaiseLoadPageState as 
            'now LoadPageState in Temporary Variables calls RaiseGetInitialValue that
            'in turn gets the Initial value from the derived Page, which might need FileObjects, if
            'Initial value is from a Reference or Master file. 
            'For further details on setting initial value see comments 
            'on RaiseGetInitialValue method in CoreBaseType ---December 6, 2004
            If InitializeExecuted = Nothing Then
                InitializeScreen(True)
            End If

            ' Only retrieve state if not called from Page_Load.
            Select Case NavigationType
                Case NavigationTypes.Entry


                Case NavigationTypes.Cancel, NavigationTypes.Delete, NavigationTypes.Find, NavigationTypes.First, NavigationTypes.Last, NavigationTypes.Next, NavigationTypes.Previous


                    Me.IsInPostEntry = False
                Case NavigationTypes.Submit

                    Me.IsInPostEntry = False
                Case Else
                    ' Accept processing.

            End Select

            CoreWebTrace("PerformOperationInitialization", "After RetrieveState")
            CoreWebTrace("PerformOperationInitialization", "After InitializeScreen")
            'Else
            '' Initialize the screen objects (Transactions, Files, etc.)
            'InitializeScreen(True)

            'CoreWebTrace("PerformOperationInitialization", "After InitializeScreen")

            'RaiseLoadPageState(False, ObjectState.FileObjectsAndCoreBaseTypes)

            'CoreWebTrace("PerformOperationInitialization", "After Initialize")
            'End If

        End Sub

        '-------------------------------------------------------------------
        ' Name: PerformOperationInitialization
        ' Function: Initializes the screen objects (Files, Variables, 
        '           Transactions).
        ' Example: PerformOperationInitialization()
        '-------------------------------------------------------------------
        ''' --- PerformOperationInitialization -------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PerformOperationInitialization.
        ''' </summary>
        ''' <param name="InFieldValidation"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub PerformOperationInitialization(Optional ByVal InFieldValidation As Boolean = False)

            'If Me.IsPostBack Then
            '    ' Determine the flag information.
            '    RetrieveFlags()
            'End If

            If Not m_blnNeedLoadState Then
                Exit Sub
            End If

            'If User has clicked on Add (Which is Entry for Grid Screen) 
            'then we don't need to retrieve Session Variables 
            If (((Mode = PageModeTypes.Change) OrElse InFieldValidation) And Page.NavigationType <> NavigationTypes.Entry) AndAlso (PageActionType <> PageActionType.PaginationClick) Then
                CoreWebTrace("PerformOperationInitialization", "Before RetrieveState")

                ' If State is not already retrieved in Page_Load then Retrieve the state. 
                ' Ideally State should be retrieved in Page_Load
                ' Note following code to retrieve State can be removed if 


                CoreWebTrace("PerformOperationInitialization", "After RetrieveState")
                ' Initialize the screen objects (Transactions, Files, etc.)
                InitializeScreen(True)
                CoreWebTrace("PerformOperationInitialization", "After InitializeScreen")
            Else
                ' Initialize the screen objects (Transactions, Files, etc.)
                InitializeScreen(True)

                CoreWebTrace("PerformOperationInitialization", "After InitializeScreen")

                If m_intToolbarAction = ToolbarIcons.Add OrElse
                    m_intToolbarAction = ToolbarIcons.Find OrElse
                    m_intToolbarAction = ToolbarIcons.First OrElse
                    m_intToolbarAction = ToolbarIcons.Previous OrElse
                    m_intToolbarAction = ToolbarIcons.Next OrElse
                    m_intToolbarAction = ToolbarIcons.Last OrElse
                    m_intToolbarAction = ToolbarIcons.Cancel OrElse
                    PageActionType = PageActionType.PaginationClick Then
                    'Note: In case of Navigation e.g. First, Previous, Next, Last and pagination
                    'We need to retrieve Startup Variables

                    'Retrieve "InField" state for ResetAtStartup Temporary Variables however NOT for File Objects

                Else
                    ' Retrieve Main state for non-grid screens.

                End If

                ' Call the PowerHouse Initialize procedure.
                If InitializeExecuted = Nothing Then
                    CallInitialize()
                    m_blnSaveInFieldState = True
                    m_blnInitializeExecuted = True
                End If

                CoreWebTrace("PerformOperationInitialization", "After Initialize")

                If (Mode = PageModeTypes.Entry AndAlso NavigationType = NavigationTypes.None) Or NavigationType = NavigationTypes.Entry Then

                    Try
                        SetDefaultValues()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                End If
            End If

        End Sub

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Compares a string to a pattern.
        ''' </summary>
        ''' <param name="Value">A string of characters to compare against a pattern.</param>
        ''' <param name="Pattern">A string representing a specific pattern to match against the passed in value.</param>
        ''' <returns>A Boolean</returns>
        ''' <remarks>
        ''' Will return True, if the pattern matches the string and False, if not.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	4/5/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function MatchPattern(ByVal Value As String, ByVal Pattern As String) As Boolean

            Try
                'Added the following because !0 means nothing is PH and regular expressions can not duplicate this
                If (Pattern = "!0" OrElse Pattern.IndexOf("|!0") >= 0) AndAlso Value.Trim.Length = 0 Then
                    Return True
                End If
                Return EvalRegularExpressionAsPowerHousePattern(Value, GetRegularExpresssionPattern(Pattern))
            Catch ex As CustomApplicationException
                If ex.Message.Equals("Invalid pattern!") Then 'IM.InvalidPattern
                    If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                        Warning("Motif invalide!") 'IM.InvalidPattern
                    Else
                        Warning("Invalid pattern!") 'IM.InvalidPattern
                    End If

                    m_blnInvalidPattern = True
                    Return True
                Else
                    Throw ex
                End If
            End Try

        End Function

        '-------------------------------------------------------------------
        ' Name: PerformOperationMethodsForAcceptProcessing
        ' Function: Calls the specific methods based on the values passed
        '           to the PerformOperation procedure.
        ' Example: PerformOperationMethodsForAcceptProcessing()
        '-------------------------------------------------------------------
        ''' --- PerformOperationMethodsForAcceptProcessing -------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PerformOperationMethodsForAcceptProcessing.
        ''' </summary>
        ''' <param name="Submit"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub PerformOperationMethodsForAcceptProcessing(Optional ByVal Submit As Boolean = False)

            Dim intMode As PageModeTypes
            Dim blnMainSaveState As Boolean 'Used in DataList
            Dim blnInFieldSaveState As Boolean 'Used in DataList
            Dim blnKeepCurrentPage As Boolean = True
            Dim blnExitScreen As Boolean = False

            PagePreProcess(Nothing)

            RaiseGetDropdownItemsDB()

            'While responding to RaisePrepareGridToProcess, DataList may change blnMainSaveState/blnInFieldSaveState
            'However for non-grid screens we will continue to call SaveState
            blnMainSaveState = True 'By default call SaveState without InField
            blnInFieldSaveState = False 'By default DON'T call SaveState with InField

            'Update flag to append Terminate immediately
            m_blnImmediateTerminateAppend = Me.IsImmediateTerminate

            'Note: Pagination changes the mode to Find and NavigationType to Next
            RaisePrepareGridToProcess(blnMainSaveState, blnInFieldSaveState)


            'If Me.IsNewRequest Then
            ' Call the PowerHouse Initialize procedure.
            If InitializeExecuted = Nothing Then

                CallInitialize()

                'In case of UseAcceptProcessing is set to True, PreDisplayFormatting 
                'is being called only once.
                'We may need to make similar change for InFieldValidation
                If Me.UseAcceptProcessing AndAlso NavigationType <> NavigationTypes.Cancel Then
                    CallPreDisplayFormatting()
                End If


                m_blnSaveInFieldState = True
                m_blnInitializeExecuted = True

                If m_blnRunscreenInInitialize Then InitializeExecuted = True

                InitializeExecuted = True
                'Me.RaiseSavePageState(False)

            End If
            'End If


            intMode = Mode

            ' To handle the LstOcc set in AcceptDesigner.
            'RemoveScreenSession("LstOcc")


            If NavigationType = NavigationTypes.None AndAlso m_strPush.Length > 0 Then

                ' The first condition is true under the following conditions:
                '  1) The screen is called in FindMode.
                '  2) The user clicks the FIND button.  NOTE: If no SelectProcessing, then an automatic FIND is done after the PATH.
                '  3) The user clicks the SUBMIT button after entering search criteria (Find and SelectProcessing).
                '  4) The user clicks on the navigation buttons (First, Next, Previous, Last).
            ElseIf NavigationType = NavigationTypes.Find OrElse (NavigationType = NavigationTypes.None AndAlso intMode = PageModeTypes.Find) _
            OrElse ((NavigationType = NavigationTypes.First _
            Or NavigationType = NavigationTypes.Next Or NavigationType = NavigationTypes.Previous _
            Or NavigationType = NavigationTypes.Last) AndAlso Mode = PageModeTypes.Find) _
            OrElse (NavigationType = NavigationTypes.Submit AndAlso Mode = PageModeTypes.Select) Then

                If NavigationType = NavigationTypes.Submit AndAlso Mode = PageModeTypes.Select Then
                    Mode = PageModeTypes.Find
                    intMode = PageModeTypes.Find
                End If

                ' Don't allow numbered designer to execute.
                EnableNumberedDesigners = False

                ' Used in DataList to determine whether to clear
                ' the fields.
                IsRequest = True    ' Accept processing.

                ' Only run the find once.  If the PostFind has a RunScreen,
                ' then don't run this code again.  This ensures that we have
                ' the same record information as prior to the RunScreen call.
                If Not blnFindComplete Then
                    ' Call PreDisplayFormatting as cancel may have been pressed.
                    CallPreDisplayFormatting()

                    'RaiseResetInitialValues() ' For Reset variables only, not ResetAtStartup or ResetAtMode.
                    ' Call the Path procedure. (When navigating records, 
                    ' the m_intPath is set but the PATH is not run).
                    CallPath()


                End If

                ' In order to enable SELECT mode, we will only call the FIND 
                ' procedure if the form is called in FindMode.  If the user clicks
                ' the Find button, then run the path and wait for SELECT processing.
                If (Not m_intPageActionType = PageActionType.DesignerClick) AndAlso ((NavigationType = NavigationTypes.None AndAlso intMode = PageModeTypes.Find) _
                OrElse (NavigationType = NavigationTypes.Submit AndAlso intMode = PageModeTypes.Find) OrElse
                ((NavigationType = NavigationTypes.First _
                Or NavigationType = NavigationTypes.Next Or NavigationType = NavigationTypes.Previous _
                Or NavigationType = NavigationTypes.Last) AndAlso Mode = PageModeTypes.Find) _
                OrElse (NavigationType = NavigationTypes.Submit AndAlso Mode = PageModeTypes.Select) OrElse (Not HasSelectProcessing OrElse (EventArgument + "").Equals("PUSH"))) Then
                    IsPathComplete = True ' accept processing
                    ' Call the Find procedure.
                    CallFind()
                    blnKeepCurrentPage = False
                    ' Reset the RequestedControlFocus so that the first field becomes hightlighted.
                    m_strRequestedControlFocus = String.Empty

                End If

                CoreWebTrace("PerformOperationMethods", "After Find")

            ElseIf NavigationType = NavigationTypes.Cancel Then

                If IsDirty Then
                    Mode = m_preCancelMode ' In case Backout checks the mode prior to backout.  We set to nomode to clear the grid.
                    m_blnExecutingBackout = True

                    Try
                        Backout()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                    m_blnExecutingBackout = False
                    Mode = PageModeTypes.NoMode
                    blnBackout = True
                End If

            ElseIf NavigationType = NavigationTypes.Entry OrElse (intMode = PageModeTypes.Entry AndAlso Not EnableNumberedDesigners) Then

                Dim blnExecuteAppend As Boolean = True

                ' Don't allow numbered designer to execute.
                EnableNumberedDesigners = False

                ' Call the PreEntry and Entry procedures.
                If Not Me.IsAppendFromEntry Then

                    Try
                        If Not IsInAppendOrEntry Then
                            InitalizeItems(True)  'Add new record to primary, Initialize Items and Predisplay Fields
                        End If

                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                    Try
                        PreEntry()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                    IsInAppendOrEntry = True
                    Try
                        Entry()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                    IsInAppendOrEntry = False

                    ' Remove the flags and Save state
                    RemoveFlags(True)

                    If HasGrid Then
                        'Set flag to identify Append is called from Entry
                        IsAppendFromEntry = True
                        IsAppendFromGrid = True
                        IsAppend = True

                        ' Ensure that if we are going to the Append,
                        ' that we set InitializeExecuted so that we
                        ' don't reset the Initial values for Temporaries.
                        If m_blnInitializeExecuted Then
                            InitializeExecuted = True
                        End If

                        ' If the DisableAppendFromEntry is set to True, set a flag
                        ' to indicate that Append is not to be called.
                        If DisableAppendFromEntry OrElse m_strPush = "Find" Then
                            blnExecuteAppend = False
                        End If
                    End If
                End If

                'Call Append if the screen has Grid
                If blnExecuteAppend Then
                    DoAppend()
                Else
                    FinishAppend()
                End If

                ' Reset the RequestedControlFocus so that the first field becomes hightlighted.
                m_strRequestedControlFocus = String.Empty

            ElseIf NavigationType = NavigationTypes.None AndAlso EventTarget = "Toolbar1$ImageExit" Then

                blnExitScreen = CallExit()

            ElseIf NavigationType = NavigationTypes.None AndAlso IsAppend Then

                ' Don't allow numbered designer to execute.
                EnableNumberedDesigners = False
                IsAppend = True
                If IsInPostEntry Then
                    FinishAppend()
                Else
                    DoAppend()
                End If

            ElseIf NavigationType = NavigationTypes.Delete Then

                If Me.ScreenType = ScreenTypes.Grid Then
                    ' If we have a ScreenType of Grid (Primary occurs), then
                    ' the grid handles the delete of all records.
                    RaiseDeleteGridRecords()
                Else
                    ' Call the Delete procedure.

                    Try
                        Delete()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                End If

                'If DeleteNoSubmit set in Page_Init then skip Submit
                If (Not Me.DeleteNoSubmit) Then
                    CallUpdate()
                End If

            ElseIf NavigationType = NavigationTypes.Submit Then

                CallUpdate()

            ElseIf m_intPageActionType = PageActionType.DesignerClick Then
                If Not blnFindComplete Then
                    'Restore the Previous Path into the current Path Variable
                    m_intPath = GetPreviousPath()
                End If


                If Not m_objPageActionObject Is Nothing Then
                    RunningDesigner = CType(m_objPageActionObject, Core.Windows.UI.Designer)
                    With RunningDesigner
                        'Check whether Designer Click is already fired from a DataList Control
                        If .m_intDesignerClickStatus = DesignerStatus.NotClicked Then
                            Dim blnCancel As Boolean = False

                            'Designer Click for non-grid screen will be fired from here
                            .RaiseBeforeClick(blnCancel, New DesignerEventArgs)
                            If Not blnCancel Then
                                ' Don't allow numbered designer to execute.
                                EnableNumberedDesigners = False
                                .RaiseClick()
                            End If
                        End If
                    End With
                    RunningDesigner = Nothing
                End If

            ElseIf m_intPageActionType = PageActionType.SubScreenClick Then
                Dim objSubScreen As Core.Windows.UI.SubScreen
                objSubScreen = CType(m_objPageActionObject, Core.Windows.UI.SubScreen)
                With objSubScreen
                    'SubScreen Click
                    .RaiseClick()
                End With
                objSubScreen = Nothing
            End If




            If Not blnExitScreen Then
                If NavigationType = NavigationTypes.Delete Then
                    Me.Mode = PageModeTypes.NoMode
                    RaiseShowGrid(True)
                Else
                    If Mode = PageModeTypes.NoMode Then
                        IsAppend = False
                    ElseIf Mode = PageModeTypes.Find OrElse Mode = PageModeTypes.Change Then
                        ' If Find mode, then set to false.  Don't do this for Change mode in case a RunScreen was called.
                        If Mode = PageModeTypes.Find Then m_blnReturnedFromRunScreen = False
                        CallDisplayFormatting()
                        m_blnReturnedFromRunScreen = False ' Don't need a condition (If Not Mode = PageModeTypes.Find Then) as setting to False is fine.
                        If NavigationType = NavigationTypes.None AndAlso Mode = PageModeTypes.Change AndAlso m_intPageActionType <> PageActionType.DataListButtonClick AndAlso SkipAll = False AndAlso RequireTerminate = False Then
                            RaiseShowGrid(True, True)
                        End If
                    ElseIf m_blnReturnedFromRunScreen Then
                        CallDisplayFormatting()
                        m_blnReturnedFromRunScreen = False
                        If NavigationType = NavigationTypes.None AndAlso Mode = PageModeTypes.Change AndAlso m_intPageActionType <> PageActionType.DataListButtonClick Then
                            RaiseShowGrid(True, True)
                        End If
                    End If
                End If

                'Disable Grid Rows, in case there is no pending Accept
                RaiseSetOccursWithFileFlags()
                m_blnDisableGridRows = True

                If ((Mode = PageModeTypes.Change OrElse Mode = PageModeTypes.Correct) AndAlso NavigationType = NavigationTypes.Submit) OrElse IsAppend OrElse PageActionType = Framework.Core.Framework.PageActionType.DataListButtonClick OrElse RequireTerminate Then
                    RaisePrepareGridControlsForDisplay(blnKeepCurrentPage)
                End If

                PageActionType = PageActionType.NotSet
                PageActionObject = Nothing

                ' Accept processing.
                ' Allow numbered designer to execute.
                EnableNumberedDesigners = True
                IsRequest = False
                IsPathComplete = False
                IsAppend = False



                ' Check if any of the files have an altered status.  
                ' This sets IsDirty to true if an altered file is found.
                RaiseCheckFileStatuses()



            End If

            ' Clear the value of hidControl.  This is used to reset
            ' the field's value if an error occurs and the control 
            ' loses focus.
            m_strHidControl = ""
        End Sub

        Private Sub FunctionKey(Optional ByVal FieldID As String = "", Optional ByVal CurrentDesigner As Boolean = True)
            Dim objDesigner As Core.Windows.UI.Designer

            arrFunction = hsFunction(m_intAcceptSequence)
            If IsNothing(arrFunction) Then arrFunction = New ArrayList

            'If IsNothing(Session("intsequence")) Then
            '    Session("fcRunScreenSequence") = m_intRunScreenSequence
            '    Session("fcProcedureRunScreenSequence") = m_intProcedureRunScreenSequence
            'End If


            For i As Integer = 0 To arrFunction.Count - 1
                'objDesigner = Me.FindControl(arrFunction(i).ToString.Split("~")(0))
                With objDesigner
                    'Check whether Designer Click is already fired from a DataList Control
                    If .m_intDesignerClickStatus = DesignerStatus.NotClicked Then
                        Dim blnCancel As Boolean = False

                        'If Request("hidFunctionKey").ToString.Split("~")(0) = objDesigner.Name Then
                        '    If Not IsNothing(m_CurrentField) AndAlso m_CurrentField.Length > 0 Then
                        '        If Request("hidFunctionKey").ToString.Split("~")(1) = m_CurrentField Then
                        '            m_blnCurrentDesigner = True
                        '        End If
                        '    Else
                        '        m_blnCurrentDesigner = True
                        '    End If
                        'End If

                        'Designer Click for non-grid screen will be fired from here
                        .RaiseBeforeClick(blnCancel, New DesignerEventArgs)
                        If Not blnCancel Then
                            .RaiseClick()
                        End If
                        m_blnCurrentDesigner = False
                    End If
                End With

                objDesigner = Nothing
            Next

            If CurrentDesigner AndAlso Not m_objPageFunctionObject Is Nothing Then

                objDesigner = CType(m_objPageFunctionObject, Core.Windows.UI.Designer)

                If arrFunction.Count = 0 OrElse Not arrFunction.Contains(objDesigner.Name & "~" & m_intFunctionKeySequence) Then
                    arrFunction.Add(objDesigner.Name & "~" & m_intFunctionKeySequence)
                    m_intFunctionKeySequence += 1
                    hsFunction(m_intAcceptSequence) = arrFunction



                    With objDesigner
                        'Check whether Designer Click is already fired from a DataList Control
                        If .m_intDesignerClickStatus = DesignerStatus.NotClicked Then
                            Dim blnCancel As Boolean = False
                            'If Request("hidFunctionKey").ToString.Split("~")(0) = objDesigner.Name Then
                            '    If Not IsNothing(m_CurrentField) AndAlso m_CurrentField.Length > 0 Then
                            '        If Request("hidFunctionKey").ToString.Split("~")(1) = m_CurrentField Then
                            '            m_blnCurrentDesigner = True
                            '        End If
                            '    Else
                            '        m_blnCurrentDesigner = True
                            '    End If
                            'End If

                            'Designer Click for non-grid screen will be fired from here
                            .RaiseBeforeClick(blnCancel, New DesignerEventArgs)
                            If Not blnCancel Then
                                .RaiseClick()
                            End If
                            m_blnCurrentDesigner = False
                        End If
                    End With

                End If

                objDesigner = Nothing
            End If



            If Mode = PageModeTypes.Entry Then
                ' Run the code as if the Add button was pressed.
                EventTarget = "Toolbar1$ImageAdd"
                EventArgument = "SUBMIT"
            Else
                EventTarget = FieldID
                EventArgument = ""
            End If


            'm_intRunScreenSequence = Session("fcRunScreenSequence")
            'm_intProcedureRunScreenSequence = Session("fcProcedureRunScreenSequence")
            'Session.Remove(FormName + "_" + Level.ToString + "_Function")
            'Session.Remove("fcRunScreenSequence")
            'Session.Remove("fcProcedureRunScreenSequence")


        End Sub


        '-------------------------------------------------------------------
        ' Name: PerformOperationMethods
        ' Function: Calls the specific methods based on the values passed
        '           to the PerformOperation procedure.
        ' Example: PerformOperationMethods()
        '-------------------------------------------------------------------
        ''' --- PerformOperationMethods --------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PerformOperationMethods.
        ''' </summary>
        ''' <param name="Submit"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub PerformOperationMethods(Optional ByVal Submit As Boolean = False)

            Dim intMode As PageModeTypes
            Dim blnMainSaveState As Boolean 'Used in DataList
            Dim blnInFieldSaveState As Boolean 'Used in DataList
            Dim blnKeepCurrentPage As Boolean = True
            Dim blnExitScreen As Boolean = False

            'While responding to RaisePrepareGridToProcess, DataList may change blnMainSaveState/blnInFieldSaveState
            'However for non-grid screens we will continue to call SaveState
            blnMainSaveState = True 'By default call SaveState without InField
            blnInFieldSaveState = False 'By default DON'T call SaveState with InField

            'Note: Pagination changes the mode to Find and NavigationType to Next
            RaisePrepareGridToProcess(blnMainSaveState, blnInFieldSaveState)

            intMode = Mode
            If intMode = PageModeTypes.Find AndAlso ((Not (Me.HasPathRequestFields)) _
                                                    OrElse Submit OrElse NavigationType <> NavigationTypes.None) Then

                ' Call the Path procedure.
                CallPath()

                ' Call the Find procedure.
                CallFind()

                blnKeepCurrentPage = False

                CoreWebTrace("PerformOperationMethods", "After Find")

            ElseIf (intMode = PageModeTypes.Change OrElse intMode = PageModeTypes.Entry) AndAlso (Submit OrElse NavigationType = NavigationTypes.Delete OrElse ScreenType = ScreenTypes.Ghost) Then

                If intMode = PageModeTypes.Entry Then
                    ' Call the PreEntry and Entry procedures.

                    Try
                        PreEntry()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                    Try
                        Entry()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                ElseIf NavigationType = NavigationTypes.Delete Then
                    ' If we have a ScreenType of Grid (Primary occurs), then
                    ' the grid handles the delete of all records.
                    If Not ScreenType = ScreenTypes.Grid Then
                        ' Call the Delete procedure.
                        Try
                            Delete()
                        Catch ex As CustomApplicationException
                            Throw ex
                        Catch ex As Exception
                            ExceptionManager.Publish(ex)
                            Throw ex
                        End Try
                    End If
                ElseIf intMode = PageModeTypes.Change AndAlso NavigationType <> NavigationTypes.Delete Then
                    ' Call the UpdateValidation for Change mode.

                    Try
                        UpdateValidation()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                End If

                ' Calls GridUpdateValidation, Append or Delete functions for 
                ' grid records depending on record status in grid.
                RaiseProcessGridRecords()

                If intMode = PageModeTypes.Entry Then
                    ' Call any code from the entry procedure that 
                    ' happens after the append.

                    Try
                        PostEntry()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                End If

                ' Call the PreUpdate procedure.
                Try
                    PreUpdate()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

                ' Call the Update procedure.  
                Try
                    Update()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

                ' Commit the default transaction (TRANS_UPDATE).

                Try
                    TRANS_UPDATE(TransactionMethods.Commit)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

                ' Call the PostUpdate procedure.
                Try
                    PostUpdate()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

                'Save The Recieving list after the Update
                Try
                    SaveParamsReceived()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

            ElseIf NavigationType = NavigationTypes.None AndAlso EventTarget = "Toolbar1$ImageExit" Then

                blnExitScreen = CallExit()

            ElseIf m_intPageActionType = PageActionType.DesignerClick Then
                Dim objDesigner As Core.Windows.UI.Designer
                If Not m_objPageActionObject Is Nothing Then
                    objDesigner = CType(m_objPageActionObject, Core.Windows.UI.Designer)
                    With objDesigner
                        'Check whether Designer Click is already fired from a DataList Control
                        If .m_intDesignerClickStatus = DesignerStatus.NotClicked Then
                            Dim blnCancel As Boolean = False

                            'Designer Click for non-grid screen will be fired from here
                            .RaiseBeforeClick(blnCancel, New DesignerEventArgs)
                            If Not blnCancel Then
                                .RaiseClick()
                            End If
                        End If

                        'In case of designer click, update "InFieldState" leaving "Main" state unchanged
                        'TODO: Designers that:
                        '   - has Business Logic that can affect "Update",
                        '   - doesn't have "Accept"
                        ' needs to be called during "Submit"
                        ' At present the default generated code and existing Framework,
                        ' doen't handle (will not be executed) such designer logic during "Submit"
                        blnMainSaveState = False
                        m_blnSaveInFieldState = True
                    End With
                    objDesigner = Nothing
                End If
            End If

            If Not blnExitScreen Then
                If NavigationType = NavigationTypes.Delete Then
                    Me.Mode = PageModeTypes.NoMode
                    RaiseShowGrid(True)
                Else
                    ' Add the appropriate formatting depending on the mode.
                    If intMode = PageModeTypes.NoMode OrElse (intMode = PageModeTypes.Find _
                    AndAlso (Me.HasPathRequestFields) AndAlso (Not Submit) _
                    AndAlso (NavigationType <> NavigationTypes.First AndAlso NavigationType <> NavigationTypes.Last _
                    AndAlso NavigationType <> NavigationTypes.Next AndAlso NavigationType <> NavigationTypes.Previous)) Then
                        CallPreDisplayFormatting()
                        CoreWebTrace("PerformOperationMethods", "After PreDisplayFormatting")
                        'End If
                    Else
                        If Submit OrElse (NavigationType <> NavigationTypes.None) _
                        OrElse (intMode = PageModeTypes.Find AndAlso (Not (HasPathRequestFields))) Then
                            CallDisplayFormatting()
                            CoreWebTrace("PerformOperationMethods", "After DisplayFormatting")
                        End If
                    End If
                End If

                RaisePrepareGridControlsForDisplay(blnKeepCurrentPage)



                ' Determine whether to save InFieldState.  If SaveInFieldState is false, then don't
                ' change blnInFieldSaveState to false, as it may have been set to true elsewhere.
                If m_blnSaveInFieldState Then blnInFieldSaveState = True

                CoreWebTrace("PerformOperationMethods", "After SaveState")

            End If

        End Sub

        Public Function CurrentFormattedDate() As String
            'Returns formatted current date with separators
            Dim strDateFormat As String = GetDefaultDateFormat()


            Dim intToday As Int32 = Format(Today, "yyyyMMdd")
            Dim strDate = ConvertNumberToScreenDate(intToday, GlobalizationManager, strDateFormat)
            Return strDate

        End Function

        '-------------------------------------------------------------------
        ' Name: PerformOperationForAcceptProcessing
        ' Function: Determines what methods to call based on the Toolbar 
        '           button that was clicked.
        ' Example: PerformOperationForAcceptProcessing()
        '-------------------------------------------------------------------
        ''' --- PerformOperationForAcceptProcessing --------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PerformOperationForAcceptProcessing.
        ''' </summary>
        ''' <param name="Submit"></param>
        ''' <param name="LanguageChanged"></param>
        ''' <param name="IsCalledByGrid"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function PerformOperationForAcceptProcessing(Optional ByVal Submit As Boolean = False, Optional ByVal LanguageChanged As Boolean = False, Optional ByVal IsCalledByGrid As Boolean = False) As Boolean

            Try

                m_intRequestSequence = 0
                m_intAcceptSequence = 0
                m_intRequestSequence = 0

                If LanguageChanged Then

                    PerformOperationInitializationForAcceptProcessing()
                    If Mode = PageModeTypes.NoMode Or Mode = PageModeTypes.Find Or Mode = PageModeTypes.Entry _
                    Or Mode = PageModeTypes.Select Then  ' Accept processing.
                        Mode = PageModeTypes.NoMode ' Accept processing.
                        'Used to call PreDisplayFormatting, however now we call PreDisplayFormatting
                        'only once; when we open a screen
                    Else
                        CallDisplayFormatting()
                    End If
                    EnableNumberedDesigners = True ' Accept processing.


                Else

                    CoreWebTrace("PerformOperation", "Before InitializeScreen")

                    m_NavigationType = NavigationType

                    ' Set the current mode based on the button pressed.
                    Select Case NavigationType
                        Case NavigationTypes.First, NavigationTypes.Last, NavigationTypes.Next, NavigationTypes.Previous

                            ' Set the mode to FIND mode.
                            Mode = PageModeTypes.Find
                            m_strHidControl = String.Empty

                        Case NavigationTypes.Find, NavigationTypes.Entry

                            ' Only run this code if we haven't cleared the controls.
                            If ControlsCleared = False AndAlso Not IsFunctionKey Then
                                m_strHidControl = String.Empty
                                m_htSearchTypes = New Hashtable
                                RaiseClearControls()
                                ControlsCleared = True
                                blnOverRideRunscreenClear = True
                                m_clearRequestInitValues = True
                            End If

                            If NavigationType = NavigationTypes.Find Then
                                Mode = PageModeTypes.Find
                            Else
                                Mode = PageModeTypes.Entry
                            End If
                            ' Reset the record number.
                            CurrentRecordNumber = 0
                            intHeaderRecNo = 0

                        Case NavigationTypes.Cancel
                            ' Move the ResetAtStartup variable values into the main state.

                            CallCancel()
                        Case NavigationTypes.None
                            If Mode = PageModeTypes.Entry And InitializeExecuted = Nothing Then
                                'If screen opened in entry mode
                                ' Only run this code if we haven't cleared the controls.
                                If ControlsCleared = False AndAlso Not IsFunctionKey Then
                                    m_strHidControl = String.Empty
                                    RaiseClearControls()
                                    ControlsCleared = True
                                End If

                                ' Reset the record number.
                                CurrentRecordNumber = 0
                                intHeaderRecNo = 0
                            ElseIf Mode = PageModeTypes.Entry AndAlso IsAppendFromEntry Then
                                If ControlsCleared = False AndAlso Not IsFunctionKey Then
                                    m_strHidControl = String.Empty
                                    ControlsCleared = True
                                End If

                            End If
                    End Select


                    PerformOperationInitializationForAcceptProcessing()

                    PerformOperationMethodsForAcceptProcessing(Submit)

                    If Not System.Configuration.ConfigurationManager.AppSettings("SshHost") Is Nothing Then
                        ' Rerun the code if a Push Next.
                        Do While m_strPush = "NextRecord"
                            m_strPush = ""

                            If CurrentRecordNumber < NavigationRecordCount Then
                                PageActionType = Framework.Core.Framework.PageActionType.ToolbarClick
                                NavigationType = NavigationTypes.Next
                                m_intToolbarAction = ToolbarIcons.Next
                                If Mode = PageModeTypes.Change Then Mode = PageModeTypes.Find

                                PerformOperationMethodsForAcceptProcessing(Submit)
                            End If
                        Loop
                    End If

                    m_fldAcceptField = Nothing

                    'CallCloseTransactionObjects()


                    ' Set the MODE of the form depending on the button pressed.
                    Select Case NavigationType
                        Case NavigationTypes.Find, NavigationTypes.First, NavigationTypes.Last, NavigationTypes.Next, NavigationTypes.Previous, NavigationTypes.Submit

                            ' Set the mode to CHANGE mode.
                            If Not Mode = PageModeTypes.Select Then Mode = PageModeTypes.Change

                            RaiseResetValueChanged()
                            IsDirty = False

                        Case NavigationTypes.Entry
                            If Not Me.HasGrid Then  'Set Correct mode if there is no grid, otherwise call Append
                                Mode = PageModeTypes.Correct
                                RaiseResetValueChanged()
                            End If
                        Case NavigationTypes.None
                            ' Accept processing.
                            Select Case Mode
                                Case PageModeTypes.Find
                                    Mode = PageModeTypes.Change
                                    firstcontrol = True
                                    IsDirty = False
                                Case PageModeTypes.Entry
                                    If Not Me.HasGrid Then  'Set Correct mode if there is no grid, otherwise call Append
                                        Mode = PageModeTypes.Correct
                                        RaiseResetValueChanged()
                                    End If
                            End Select
                    End Select

                    If m_blnInitializeExecuted Then
                        InitializeExecuted = True
                    End If

                End If


                RemoveFlags()


                ' Reset the ControlsCleared indicating that 
                ' we need to run RaiseClearControls().
                ControlsCleared = False

                ' Reset the ValueChanged and SubmittedValues to unchanged.  This ensures
                ' that we don't re-run the run-screens for numbered designers if we go
                ' to the same numbered designer again.
                ' NOTE: IsDirty is still set, so when the user tries to move
                '       to another page, the "Data has changed" message still appears.
                RaiseResetValueChanged()

                ' Save the search types.
                SearchType = m_htSearchTypes

                ToolbarAction = ToolbarIcons.NotSet
                PageClick = PaginationClick.NotSet
                RequireTerminate = False

                If Not NextControl Is Nothing Then
                    Page_Load(NextControl)


                End If

                Return True

            Catch ex As CustomApplicationException

                If ToolbarAction = ToolbarIcons.Submit Then
                    ToolbarAction = ToolbarIcons.NotSet
                End If

                SkipAll = False
                RequireTerminate = False

                ' If an error was thrown after deleting a record using the delete button, (in the PostUpdate procedure),
                ' then clear the screen.
                If NavigationType = NavigationTypes.Delete AndAlso UpdateExecuted Then
                    Me.Mode = PageModeTypes.NoMode
                    RaiseShowGrid(True)
                End If

                If  Me.Mode = PageModeTypes.NoMode Then
                    RaiseShowGrid(True)
                End if

                ' Save the search types.
                SearchType = m_htSearchTypes



                RaiseSetOccursWithFileFlags()
                ' Save ResetAtStartup variables in their own space.  This value is to be used if
                ' cancelling out of this action to match the behaviour in PowerHouse.

                If ex.Message = cRunScreenException.ToString Then
                    ' RUN SCREEN exception.



                    ' If the user is in one numbered designer, and selects another designer using the 
                    ' lookup, set the EventArgument to "".  This will ensure that the focus
                    ' is put to the next field upon returning from the RunScreen (that is called).  
                    ' The(EventArgument) will only equal "MainFrame|M" when called from onLoadSetFocus.
                    If (Not m_strRequestedArgument Is Nothing) AndAlso m_strRequestedArgument.ToString.Equals("~~Lookup~~") _
                    AndAlso EventArgument.ToString.Equals("MainFrame|M") Then
                        EventArgument = String.Empty
                    End If

                    HandleRunScreenException()

                ElseIf ex.Message = cAcceptRequestPromptException.ToString Then
                    ' ACCEPT, REQUEST, PROMPT exception.

                    RaiseCheckFileStatuses()
                    HandleAcceptRequestPromptException()


                Else
                    ' Check if any of the files have an altered status.  
                    ' This sets IsDirty to true if an altered file is found.
                    If Not ex.Message = cReturn.ToString Then
                        RaiseCheckFileStatuses()
                    End If

                    ' Remove any pending PUSH actions.
                    m_strPush = ""

                    ' Clear the value since we didn't throw a runscreen/accept exception.
                    If Not m_fldAcceptField Is Nothing Then
                        'RemoveScreenSession("CL" & m_fldAcceptField.ID)
                    End If

                    ' Removed due to initialize not being called again when screen is called in Entry mode
                    ' and an error occurs.  Any values set in the Initialize are then lost.
                    'If m_blnInitializeExecuted Then
                    '    InitializeExecuted = True
                    'End If

                    ' If we called a PreCommand, set back to False.  
                    ' If not called, this will do nothing.
                    PreCommandExecuted = False

                    ' If an error occurs in Find mode, then reset toolbar.
                    If ex.Message <> cReturn.ToString Then

                        ' Save the RESET AT STARTUP variables.
                        If m_fldAcceptField Is Nothing Then
                            If m_colMessages.Count > 0 AndAlso m_colMessages(0).Text.ToString.Trim <> "" Then m_blnInErrorHandler = True

                            m_blnInErrorHandler = False

                            If m_blnInitializeExecuted Then
                                InitializeExecuted = True
                            End If

                            ' Ensure that the focus is not on any field if an error occured
                            ' and there is no previous Accept field.
                            m_strRequestedControlFocus = String.Empty
                        End If

                        ' Accept processing.
                        If m_fldAcceptField Is Nothing AndAlso ((Not IsPathComplete AndAlso Mode = PageModeTypes.Find) _
                        OrElse (Mode = PageModeTypes.Entry)) Then
                            Mode = PageModeTypes.NoMode
                        End If
                    End If

                    If Mode = PageModeTypes.NoMode AndAlso m_fldAcceptField Is Nothing Then
                        ' Reset the flags.
                        RemoveFlags()
                    End If

                    ' Accept processing.
                    If Me.HasGrid Then

                        If (ex.Message = cAddMessageError OrElse ex.Message.Equals("No Records Found.")) AndAlso m_fldAcceptField Is Nothing Then ' IM.NoRecords 'DependancyGrid001: This condition may need a change, if there is change in "DependancyGrid001/1" & "DependancyGrid001/2"
                            'Beside cAddMessageError, now also considering IM.NoRecords, especially to handle a designer procedure that 
                            'has "GetData" that can throw "IM.NoRecords"

                            RemoveFlags()


                            'If there is an Error and no more Accept disable the Grid's current row
                            'm_triEnableCurrentRow = TriState.False
                            m_blnDisableGridRows = True

                            ' An error may have occurred in the designer, and no accept field has executed.
                            ' This ensures that the DELETE buttons on the grid are enabled (if all other conditions are met).
                            m_blnExecutingDesigner = False

                            'Enable designers so that user can click Grid button in case,
                            'this error occurred in a "Edit_Click"
                            Me.EnableNumberedDesigners = True

                            'If an error occurred in Append, cancel the append
                            If IsAppend Then
                                m_triContinueAppend = Microsoft.VisualBasic.TriState.False
                                IsAppend = False
                            End If
                        End If

                        If IsAppend AndAlso (Not Me.m_strAcceptFlag Is Nothing) AndAlso Me.m_strAcceptFlag.Length <= 1 AndAlso RecordsForLoop = Me.Occurrence Then
                            'In case there is a grid, and there is an Error from First Field of the Last Row, ignore that particular row
                            RecordsForLoop = Me.Occurrence - 1
                        End If

                        If ex.Message <> cReturn.ToString Then
                            'Display grid controls as labels
                            RaisePrepareGridControlsForDisplay(True)
                        End If

                        If ex.Message <> cAddMessageError Then
                            IsRequest = False
                            IsPathComplete = False
                            IsAppend = False
                        End If
                    Else
                        If (ex.Message = cAddMessageError OrElse ex.Message.Equals("No Records Found.")) AndAlso m_fldAcceptField Is Nothing Then 'IM.NoRecords  'DependancyGrid001: This condition may need a change, if there is change in "DependancyGrid001/1" & "DependancyGrid001/2"
                            'Beside cAddMessageError, now also considering IM.NoRecords, especially to handle a designer procedure that 
                            'has "GetData" that can throw "IM.NoRecords"
                            If ex.Message.Equals("No Records Found.") OrElse ex.Message.Equals("Aucun enregistrement trouv.") Then 'IM.NoRecords
                                RaiseClearControls()
                            End If

                            RemoveFlags()

                            ' An error may have occurred in the designer, and no accept field has executed.
                            ' This ensures that the DELETE buttons on the grid are enabled (if all other conditions are met).
                            m_blnExecutingDesigner = False

                            'Enable designers.
                            Me.EnableNumberedDesigners = True
                        End If
                    End If


                    If ex.Message = cAddMessageError Then 'DependancyGrid001/1: If we ever need to change this condition, also change condition marked as "DependancyGrid001"

                        Try
                            ' Remove any calls to the run screen.  This ensures that we can re-run the screen.
                            If Not m_htRunFlag Is Nothing Then
                                m_htRunFlag.Remove(m_fldAcceptField.Name)

                                ' Remove run screens called in procedures after the last accept.
                                ' This ensures that if the value is changed, the run screen is called again.
                                If Not m_strRunFlag Is Nothing Then
                                    m_htRunFlag.Item(cPROCEDURE) = m_strRunFlag

                                End If
                            End If

                            ' Re-run the previously executed accept.
                            SetAcceptControl(m_fldAcceptField)



                        Catch ex1 As Exception
                            If ex1.Message = cAcceptRequestPromptException.ToString Then
                                HandleAcceptRequestPromptException()
                            End If
                        End Try

                    ElseIf (ex.Message = "No Records Found." OrElse ex.Message.Equals("Aucun enregistrement trouv.")) AndAlso Me.EntryMode AndAlso Not m_fldAcceptField Is Nothing Then 'IM.NoRecords

                        Try
                            ' Re-run the previously executed accept.
                            SetAcceptControl(m_fldAcceptField)
                        Catch ex1 As Exception
                            If ex1.Message = cAcceptRequestPromptException.ToString Then
                                HandleAcceptRequestPromptException()
                            End If
                        End Try
                        ' Update the message to display it on the screen.
                        Try
                            AddMessage(ex.Message, MessageTypes.Error)
                        Catch Exc As CustomApplicationException

                        End Try


                    ElseIf ex.Message <> cAddMessageError And ex.Message <> cReturn.ToString Then

                        ' Add the error to the error collection in the toolbar.

                        Try
                            If (ex.Message = "No Records Found." OrElse ex.Message.Equals("Aucun enregistrement trouv.")) AndAlso Mode = PageModeTypes.Find Then 'IM.NoRecords
                                Mode = PageModeTypes.NoMode

                                ' Accept processing.
                                RemoveFlags()
                            End If
                            AddMessage(ex.Message, MessageTypes.Error)
                        Catch Exc As CustomApplicationException

                        End Try

                    ElseIf ex.Message = cReturn.ToString Then
                        RaiseEvent CloseRunscreen()

                    End If

                End If

            Catch ex As Exception



                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function

        '-------------------------------------------------------------------
        ' Name: PerformOperation
        ' Function: Determines what methods to call based on the Toolbar 
        '           button that was clicked.
        ' Example: PerformOperation()
        '-------------------------------------------------------------------
        ''' --- PerformOperation ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PerformOperation.
        ''' </summary>
        ''' <param name="Submit"></param>
        ''' <param name="LanguageChanged"></param>
        ''' <param name="IsCalledByGrid"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function PerformOperation(Optional ByVal Submit As Boolean = False, Optional ByVal LanguageChanged As Boolean = False, Optional ByVal IsCalledByGrid As Boolean = False) As Boolean

            Try


                If LanguageChanged Then

                    PerformOperationInitialization()
                    If Mode = PageModeTypes.NoMode Or Mode = PageModeTypes.Find Or Mode = PageModeTypes.Entry Then
                        CallPreDisplayFormatting()
                    Else
                        CallDisplayFormatting()
                    End If
                    If Me.HasGrid Then
                        RaisePrepareGridControlsForDisplay(True)
                    End If


                Else

                    CoreWebTrace("PerformOperation", "Before InitializeScreen")

                    m_NavigationType = NavigationType

                    ' Set the current mode based on the button pressed.
                    Select Case NavigationType
                        Case NavigationTypes.First, NavigationTypes.Last, NavigationTypes.Next, NavigationTypes.Previous
                            ' Set the mode to FIND mode.
                            Mode = PageModeTypes.Find
                        Case NavigationTypes.Find, NavigationTypes.Entry, NavigationTypes.Cancel
                            Mode = PageModeTypes.NoMode
                            If NavigationType = NavigationTypes.Find AndAlso Not (Me.HasPathRequestFields) Then Mode = PageModeTypes.Find
                            RaiseClearControls()
                            If NavigationType = NavigationTypes.Entry Then
                                If m_intPageModeType <> PageModeTypes.Find Then
                                    RaiseClearRequestValues()
                                End If
                            End If

                            ' Set FINDMODE or ENTRYMODE.
                            Select Case NavigationType
                                Case NavigationTypes.Find
                                    m_blnFindMode = True
                                    strCurrentMode = "F"   ' Used during infieldvalidation for non-AcceptProcessing.
                                Case NavigationTypes.Entry
                                    m_blnEntryMode = True
                                    strCurrentMode = "E"   ' Used during infieldvalidation for non-AcceptProcessing.
                                Case NavigationTypes.Cancel
                                    m_blnFindMode = False
                                    m_blnEntryMode = False
                                    strCurrentMode = ""
                            End Select

                        Case NavigationTypes.Submit, NavigationTypes.None
                            ' NOTE: NavigationType will be None when the user clicks a DESIGNER, 
                            '       the GridEditButton or the form loads.
                            GetFindEntryMode()
                    End Select

                    ' Reset the record number.
                    If NavigationType = NavigationTypes.Find OrElse NavigationType = NavigationTypes.Delete Then
                        CurrentRecordNumber = 0
                        intHeaderRecNo = 0
                        NavigationRecordCount = 0
                    End If

                    PerformOperationInitialization()

                    PerformOperationMethods(Submit)



                    ' Set the MODE of the form depending on the button pressed.
                    Select Case NavigationType
                        Case NavigationTypes.Find
                            If (Me.HasPathRequestFields) Then
                                ' Set the mode in the form to FindMode (Allows user to enter search values).
                                Mode = PageModeTypes.Find
                            Else
                                ' Automatically search and display the records found.
                                Mode = PageModeTypes.Change
                            End If
                        Case NavigationTypes.First, NavigationTypes.Last, NavigationTypes.Next, NavigationTypes.Previous
                            ' Set the mode to CHANGE mode.
                            Mode = PageModeTypes.Change
                        Case NavigationTypes.Entry
                            Mode = PageModeTypes.Entry
                        Case NavigationTypes.None
                            ' If we have a form that has no REQUEST fields in the PATH procedure,
                            ' and a FIND is done, then set the mode to change mode, since there
                            ' the NavigationType will be None when the form first loads.
                            If Mode = PageModeTypes.Find AndAlso Not (Me.HasPathRequestFields) Then
                                Mode = PageModeTypes.Change
                            End If
                    End Select

                    If m_blnInitializeExecuted Then
                        InitializeExecuted = True
                    End If

                    If Submit Then
                        If Mode = PageModeTypes.Find OrElse Mode = PageModeTypes.Entry Then
                            Mode = PageModeTypes.Change
                        End If
                    End If

                    ' If the Submit was pressed, the the ValueChanged
                    ' for the fields to FALSE.
                    If Submit Then
                        RaiseResetValueChanged()
                        IsDirty = False
                    End If

                    Select Case NavigationType
                        Case NavigationTypes.First, NavigationTypes.Last, NavigationTypes.Next, NavigationTypes.Previous, NavigationTypes.Cancel
                            IsDirty = False
                    End Select
                End If

                'If Me.IsPostBack Then
                '    If Not (IsCalledByGrid AndAlso PageActionType = PageActionType.InFieldValidation) Then
                '        RemoveFlags()
                '    End If
                'End If

                ' Check if any of the files have an altered status.  
                ' This sets IsDirty to true if an altered file is found.
                RaiseCheckFileStatuses()

                Return True

            Catch ex As CustomApplicationException

                If ex.Message = cRunScreenException.ToString Then

                    HandleRunScreenException()

                Else
                    ' Check if any of the files have an altered status.  
                    ' This sets IsDirty to true if an altered file is found.
                    RaiseCheckFileStatuses()

                    If m_blnInitializeExecuted Then
                        InitializeExecuted = True
                    End If

                    ' If an error occurs in Find mode, then reset toolbar.
                    If ex.Message <> cReturn.ToString Then

                        If Mode = PageModeTypes.Find Then
                            Mode = PageModeTypes.NoMode
                        End If
                    End If

                    If Me.HasGrid Then
                        'If there is a grid, in case of an error 
                        'we need to display controls as labels in Grid
                        'Please note for non-grid screen it will call following method
                        'however, following method only raises an event
                        'If we ever need to write some logic other than raising
                        'an event, we need to change above if condition 
                        RaisePrepareGridControlsForDisplay(True)
                    End If



                    ' Add the error to the error collection in the toolbar.
                    If ex.Message <> cAddMessageError And ex.Message <> cReturn.ToString Then
                        Try
                            If (ex.Message = "No Records Found." OrElse ex.Message.Equals("Aucun enregistrement trouv.")) AndAlso Mode = PageModeTypes.Find Then 'IM.NoRecords
                                Mode = PageModeTypes.NoMode
                            End If
                            AddMessage(ex.Message, MessageTypes.Error)
                        Catch Exc As CustomApplicationException

                        End Try
                    End If
                End If

            Catch ex As Exception

                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function

        ''' --- PerformOperation ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PerformOperation.
        ''' </summary>
        ''' <param name="sender"></param>
        ''' <param name="Submit"></param>
        ''' <param name="ValidateType"></param>
        ''' <param name="NavigationType"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Function PerformOperation(ByRef sender As TextBox, Optional ByVal Submit As Boolean = False, Optional ByVal ValidateType As ValidateTypes = ValidateTypes.Accept, Optional ByVal NavigationType As NavigationTypes = NavigationTypes.None) As Boolean

            Try
                Dim intValidateType As ValidateTypes = ValidateTypes.Accept

                'If Not CoreBodyTag.Attributes("onLoad") = Nothing Then
                '    CoreBodyTag.Attributes("onLoad") = CoreBodyTag.Attributes("onLoad").Replace("RunScreenFunction();", "")
                'End If

                ' Set the ValidateType based on the mode.
                If Mode = PageModeTypes.Find OrElse Mode = PageModeTypes.Select Then
                    intValidateType = ValidateTypes.Request
                    m_blnFindMode = True
                ElseIf Mode = PageModeTypes.Change And AppendMode Then
                    m_blnFindMode = True
                End If

                If Not Me.UseAcceptProcessing Then
                    GetFindEntryMode()
                End If

                CoreWebTrace("PerformOperation", "Before InitializeScreen")

                If Me.UseAcceptProcessing Then
                    PerformOperationInitializationForAcceptProcessing(True)
                    RaiseGetDropdownItemsDB()
                Else
                    PerformOperationInitialization(True)
                End If

                RaisePrepareGridToProcess(False, False)

                ' Allow the developer to set up the screen prior to validating the field.
                ' This allows disabling fields, etc.
                PagePreProcess(Nothing)

                Dim blnValidate As Boolean

                'If TypeOf sender Is Core.Windows.UI.ComboBox Then
                '    blnValidate = Validate(CType(sender, ComboBox), intValidateType, True)
                'Else

                blnValidate = Validate(sender, intValidateType, True)
                'End If



                ' Call the REFRESH option for fields.
                If m_blnReturnedFromRunScreen Then
                    CallDisplayFormatting()
                    m_blnReturnedFromRunScreen = False
                End If

                '' Call the generic VALIDATE function.
                'If Not blnValidate Then
                '    ' If the Validate failed, set the focus to the original control.
                '    Me.SetFocusField(sender.Name)
                '    'RegisterHiddenField("RequestedControlFocusOverRide", sender.RenderedID)
                'End If

                Me.RaisePrepareGridControlsForDisplay(True)



                CoreWebTrace("PerformOperation", "After SaveState(True)")

                CoreWebTrace("PerformOperation", "After SaveState(True)")

                ' Check if any of the files have an altered status.  
                ' This sets IsDirty to true if an altered file is found.
                RaiseCheckFileStatuses()



                RemoveFlags()

                Return True

            Catch ex As CustomApplicationException

                If Me.HasGrid Then
                    'If there is a grid, in case of an error 
                    'we need to display controls as labels in Grid
                    'Please note for non-grid screen it will call following method
                    'however, following method only raises an event
                    'If we ever need to write some logic other than raising
                    'an event, we need to change above if condition 
                    RaisePrepareGridControlsForDisplay(True)
                End If



                If Not ex.Message = cRunScreenException.ToString Then
                    ' Check if any of the files have an altered status.  
                    ' This sets IsDirty to true if an altered file is found.
                    RaiseCheckFileStatuses()
                End If



                ' Add the error to the error collection in the toolbar.
                If ex.Message = cAddMessageError Or ex.Message = cReturn.ToString Then
                    'If Me.IsPostBack Then
                    '    RemoveFlags()
                    'End If
                ElseIf ex.Message = cRunScreenException.ToString Then

                    HandleRunScreenException(sender)

                ElseIf ex.Message = cAcceptRequestPromptException.ToString Then
                    ' Do nothing.  Ensures the message isn't written as an error icon with the number 3.
                    RaiseCheckFileStatuses()
                    HandleAcceptRequestPromptException()
                Else
                    Try
                        AddMessage(ex.Message, MessageTypes.Error)
                    Catch Exc As CustomApplicationException

                    End Try
                End If

            Catch ex As Exception

                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function

        ''' --- PerformOperation ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PerformOperation.
        ''' </summary>
        ''' <param name="sender"></param>
        ''' <param name="Submit"></param>
        ''' <param name="ValidateType"></param>
        ''' <param name="NavigationType"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Function PerformOperation(ByRef sender As UI.DateControl, Optional ByVal Submit As Boolean = False, Optional ByVal ValidateType As ValidateTypes = ValidateTypes.Accept, Optional ByVal NavigationType As NavigationTypes = NavigationTypes.None) As Boolean

            Try
                Dim intValidateType As ValidateTypes = ValidateTypes.Accept

                ' Set the ValidateType based on the mode.
                If Mode = PageModeTypes.Find OrElse Mode = PageModeTypes.Select Then
                    intValidateType = ValidateTypes.Request
                    m_blnFindMode = True
                ElseIf Mode = PageModeTypes.Change And AppendMode Then
                    m_blnFindMode = True
                End If

                CoreWebTrace("PerformOperation", "Before InitializeScreen")

                If Me.UseAcceptProcessing Then
                    PerformOperationInitializationForAcceptProcessing(True)
                Else
                    PerformOperationInitialization(True)
                End If

                If Not Me.UseAcceptProcessing Then
                    GetFindEntryMode()
                End If

                RaisePrepareGridToProcess(False, False)

                ' Call the generic VALIDATE function.
                If Not Validate(sender, intValidateType, True) Then
                    ' If the Validate failed, set the focus to the original control.
                    Me.SetFocusField(sender.Name)
                    'RegisterHiddenField("RequestedControlFocusOverRide", sender.RenderedID)
                End If

                ' Call the REFRESH option for fields.
                If m_blnReturnedFromRunScreen Then
                    CallDisplayFormatting()
                    m_blnReturnedFromRunScreen = False
                End If

                Me.RaisePrepareGridControlsForDisplay(True)



                CoreWebTrace("PerformOperation", "After SaveState(True)")

                CoreWebTrace("PerformOperation", "After SaveState(True)")

                ' Check if any of the files have an altered status.  
                ' This sets IsDirty to true if an altered file is found.
                RaiseCheckFileStatuses()



                RemoveFlags()

                Return True

            Catch ex As CustomApplicationException

                If Me.HasGrid Then
                    'If there is a grid, in case of an error 
                    'we need to display controls as labels in Grid
                    'Please note for non-grid screen it will call following method
                    'however, following method only raises an event
                    'If we ever need to write some logic other than raising
                    'an event, we need to change above if condition 
                    RaisePrepareGridControlsForDisplay(True)
                End If



                If Not ex.Message = cRunScreenException.ToString Then
                    ' Check if any of the files have an altered status.  
                    ' This sets IsDirty to true if an altered file is found.
                    RaiseCheckFileStatuses()
                End If



                ' Add the error to the error collection in the toolbar.
                If ex.Message = cAddMessageError Or ex.Message = cReturn.ToString Then
                    'If Me.IsPostBack Then
                    '    RemoveFlags()
                    'End If
                ElseIf ex.Message = cRunScreenException.ToString Then

                    HandleRunScreenException(sender)

                ElseIf ex.Message = cAcceptRequestPromptException.ToString Then
                    ' Do nothing.  Ensures the message isn't written as an error icon with the number 3.
                    RaiseCheckFileStatuses()
                    HandleAcceptRequestPromptException()
                Else
                    Try
                        AddMessage(ex.Message, MessageTypes.Error)
                    Catch Exc As CustomApplicationException

                    End Try
                End If

            Catch ex As Exception

                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function

        ''' --- PerformOperation ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PerformOperation.
        ''' </summary>
        ''' <param name="sender"></param>
        ''' <param name="Submit"></param>
        ''' <param name="ValidateType"></param>
        ''' <param name="NavigationType"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Function PerformOperation(ByRef sender As UI.ComboBox, Optional ByVal Submit As Boolean = False, Optional ByVal ValidateType As ValidateTypes = ValidateTypes.Accept, Optional ByVal NavigationType As NavigationTypes = NavigationTypes.None) As Boolean

            Try
                Dim intValidateType As ValidateTypes = ValidateTypes.Accept

                ' Set the ValidateType based on the mode.
                If Mode = PageModeTypes.Find OrElse Mode = PageModeTypes.Select Then
                    intValidateType = ValidateTypes.Request
                    m_blnFindMode = True
                ElseIf Mode = PageModeTypes.Change And AppendMode Then
                    m_blnFindMode = True
                End If

                CoreWebTrace("PerformOperation", "Before InitializeScreen")

                If Me.UseAcceptProcessing Then
                    PerformOperationInitializationForAcceptProcessing(True)
                Else
                    PerformOperationInitialization(True)
                End If

                If Not Me.UseAcceptProcessing Then
                    GetFindEntryMode()
                End If

                RaisePrepareGridToProcess(False, False)

                ' Call the generic VALIDATE function.
                If Not Validate(sender, intValidateType, True) Then
                    ' If the Validate failed, set the focus to the original control.
                    Me.SetFocusField(sender.Name)
                    'RegisterHiddenField("RequestedControlFocusOverRide", sender.RenderedID)
                End If

                ' Call the REFRESH option for fields.
                If m_blnReturnedFromRunScreen Then
                    CallDisplayFormatting()
                    m_blnReturnedFromRunScreen = False
                End If

                Me.RaisePrepareGridControlsForDisplay(True)



                CoreWebTrace("PerformOperation", "After SaveState(True)")

                CoreWebTrace("PerformOperation", "After SaveState(True)")

                ' Check if any of the files have an altered status.  
                ' This sets IsDirty to true if an altered file is found.
                RaiseCheckFileStatuses()



                RemoveFlags()

                Return True

            Catch ex As CustomApplicationException

                If Me.HasGrid Then
                    'If there is a grid, in case of an error 
                    'we need to display controls as labels in Grid
                    'Please note for non-grid screen it will call following method
                    'however, following method only raises an event
                    'If we ever need to write some logic other than raising
                    'an event, we need to change above if condition 
                    RaisePrepareGridControlsForDisplay(True)
                End If



                If Not ex.Message = cRunScreenException.ToString Then
                    ' Check if any of the files have an altered status.  
                    ' This sets IsDirty to true if an altered file is found.
                    RaiseCheckFileStatuses()
                End If



                ' Add the error to the error collection in the toolbar.
                If ex.Message = cAddMessageError Or ex.Message = cReturn.ToString Then
                    'If Me.IsPostBack Then
                    '    RemoveFlags()
                    'End If
                ElseIf ex.Message = cRunScreenException.ToString Then

                    HandleRunScreenException(sender)

                ElseIf ex.Message = cAcceptRequestPromptException.ToString Then
                    ' Do nothing.  Ensures the message isn't written as an error icon with the number 3.
                    RaiseCheckFileStatuses()
                    HandleAcceptRequestPromptException()
                Else
                    Try
                        AddMessage(ex.Message, MessageTypes.Error)
                    Catch Exc As CustomApplicationException

                    End Try
                End If

            Catch ex As Exception

                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        ''' <summary>
        '''     This method handles switching databases by adding the Link name to database
        ''' calls.
        ''' </summary>
        ''' <param name="Owner">The database for which we want to start using a link to switch to another database location</param>
        ''' <param name="Link">The link name for the new database location.  Set this to an empty string to point back to the original location.</param>
        ''' <example>
        ''' SwitchDB("SALES", "SALES_US")
        ''' SwitchDB("SALES", "")
        ''' </example>
        ''' <remarks>
        ''' This method allows the switching of nodes or databases by indicating the database link to use
        ''' to switch to another database.
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	4/4/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Sub SwitchDB(ByVal Owner As String, ByVal Link As String)

        End Sub
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        '''     This method handles reading the items received from a calling screen.
        ''' </summary>
        ''' <param name="ReceivedObjects">List of Objects received from the calling screen</param>
        ''' <example>
        ''' Receiving(fleEMPLOYEE, TEMP_NAME)
        ''' </example>
        ''' <remarks>
        ''' Receiving should only be used from overrided "RetrieveParamsReceived".
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	4/4/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Sub Receiving(ByVal ParamArray ReceivedObjects() As Object)
            m_blnHasReceivingList = True
            Dim intParamIndex As Integer
            For intParamIndex = 0 To ReceivedObjects.Length - 1
                SetParmValue(ReceivedObjects(intParamIndex), Me.CalledPageSession(Name, Level.ToString, "PARM" + (intParamIndex + 1).ToString, ScreenSequence))
            Next
        End Sub

        ''' --- ReceivingReport ---------------------------------------------------------
        ''' <summary>
        '''     This method handles reading the items received from a calling screen.
        ''' </summary>
        ''' <param name="ReceivedObjects">List of Objects received from the calling screen</param>
        ''' <example>
        ''' Receiving(fleEMPLOYEE, TEMP_NAME)
        ''' </example>
        ''' <remarks>
        ''' Receiving should only be used from overrided "RetrieveParamsReceived".
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	4/4/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Sub ReceivingReport(ByVal ParamArray ReceivedObjects() As Object)
            m_blnHasReceivingList = True
            Dim intParamIndex As Integer
            For intParamIndex = 0 To ReceivedObjects.Length - 1
                SetParmValue(ReceivedObjects(intParamIndex), Me.CalledPageSession(Name, Level.ToString, "PARM" + (intParamIndex + 1).ToString, ScreenSequence))
            Next
        End Sub

        ''' --- SetReportParmValue -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Sets the value of an object.
        ''' </summary>
        ''' <param name="Parm">An Object which to assign a value to.</param>
        ''' <param name="ReturnValue"></param>
        ''' <param name="CalledFromRetrieveParamsReceived"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Sub SetReportParmValue(ByRef Parm As Object, ByVal ReturnValue As Object, ByVal CalledFromRetrieveParamsReceived As Boolean, ByVal ParmSequence As Integer)

            Select Case Parm.GetType.ToString
                Case "Core.Windows.UI.Core.Windows.OracleFileObject", "Core.Windows.UI.Core.Windows.SqlFileObject", "Core.Windows.UI.Core.Windows.IfxFileObject"
                    With CType(Parm, IFileObject)
                        Dim cnnPreviousConnection As IDbConnection
                        Dim trnPreviousTransaction As IDbTransaction
                        cnnPreviousConnection = .Connection
                        trnPreviousTransaction = .Transaction
                        .SetInternalValues(ReturnValue, True, ParmSequence)
                        .Connection = cnnPreviousConnection
                        .Transaction = trnPreviousTransaction
                    End With
                Case "Core.Windows.UI.Core.Windows.CoreCharacter"
                    With CType(Parm, Core.Windows.CoreCharacter)
                        If CalledFromRetrieveParamsReceived Then
                            .HasReceivedValue = True
                            .InitialValue = CStr(ReturnValue)
                        End If
                        .Value = CStr(ReturnValue)
                    End With
                Case "Core.Windows.CoreVarChar"
                    With CType(Parm, Core.Windows.CoreVarChar)
                        If CalledFromRetrieveParamsReceived Then
                            .HasReceivedValue = True
                            .InitialValue = CStr(ReturnValue)
                        End If
                        .Value = CStr(ReturnValue)
                    End With
                Case "Core.Windows.UI.Core.Windows.CoreDecimal"
                    With CType(Parm, Core.Windows.CoreDecimal)
                        If CalledFromRetrieveParamsReceived Then
                            .HasReceivedValue = True
                            .InitialValue = CDec(ReturnValue)
                        End If
                        .Value = CDec(ReturnValue)
                    End With
                Case "Core.Windows.UI.Core.Windows.CoreInteger"
                    With CType(Parm, Core.Windows.CoreInteger)
                        If CalledFromRetrieveParamsReceived Then
                            .HasReceivedValue = True
                            .InitialValue = CDec(ReturnValue)
                        End If
                        .Value = CDec(ReturnValue)
                    End With
                Case "Core.Windows.UI.Core.Windows.CoreDate"
                    With CType(Parm, Core.Windows.CoreDate)
                        If CalledFromRetrieveParamsReceived Then
                            .HasReceivedValue = True
                            .InitialValue = CDec(ReturnValue)
                        End If
                        .Value = CDec(ReturnValue)
                    End With
                Case "System.String[]"
                    CType(ReturnValue, System.Array).CopyTo(Parm, 0)
            End Select

        End Sub

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        ''' <summary>
        '''     This method handles updating the values that are received by this screen.
        ''' </summary>
        ''' <example>
        ''' SaveReceivingParams(fleEMPLOYEE, TEMP_NAME)
        ''' </example>
        ''' <remarks>
        ''' SaveReceivingParams should only be used from overrided "SaveParamsReceived".
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	4/4/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub SaveReceivingParam(ByVal Param As Object, ByVal Index As Integer)

        End Sub

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        '''     This method handles updating the values that are received by this screen.
        ''' </summary>
        ''' <param name="ReceivedObjects">List of Objects received from the calling screen</param>
        ''' <example>
        ''' SaveReceivingParams(fleEMPLOYEE, TEMP_NAME)
        ''' </example>
        ''' <remarks>
        ''' SaveReceivingParams should only be used from overrided "SaveParamsReceived".
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	4/4/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Sub SaveReceivingParams(ByVal ParamArray ReceivedObjects() As Object)


            Dim intParamIndex As Integer
            Dim strKey As String = FormName + "_" + Level.ToString + "_" + ScreenSequence.ToString() + "_PARM"
            For intParamIndex = 0 To ReceivedObjects.Length - 1

                Dim strPageSessionKey As String = Name + "_" + Level.ToString + "_" + ScreenSequence + "_" + "PARM" + (intParamIndex + 1).ToString

                If ApplicationState.Current.PassingObjects.ContainsKey(strPageSessionKey) Then
                    ApplicationState.Current.PassingObjects.Item(strPageSessionKey) = GetParmValue(ReceivedObjects(intParamIndex))
                Else
                    ApplicationState.Current.PassingObjects.Add(strPageSessionKey, GetParmValue(ReceivedObjects(intParamIndex)))
                End If
            Next
        End Sub

        '---------------------------------------------
        ' Default RetrieveParamsReceived procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' This method is called to handle the values received by this screen.
        ''' objects.
        ''' </summary>
        ''' <remarks>
        ''' Use the RetrieveParamsReceived method to handle assigning the values passed in to
        ''' the screen to the appropriate File/Temporary objects.  
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Sub RetrieveParamsReceived()

        End Sub

        '---------------------------------------------
        ' Default SaveParamsReceived procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' This method is called to handle updating the values received by this screen.
        ''' objects.
        ''' </summary>
        ''' <remarks>
        ''' Use the SaveParamsReceived method to handle updating the values from the 
        ''' File/Temporary objects that were passed in to this screen.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Sub SaveParamsReceived()

        End Sub

        '---------------------------------------------
        ' Default GetPattern procedure (used for 
        ' Pattern expressions).
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Returns the Pattern expression for a field if this pattern is not static.
        ''' </summary>
        ''' <param name="Name">The name of the Field for which we want to retrieve the pattern</param>
        ''' <returns>A string value representing the Pattern to match.</returns>
        ''' <example>
        ''' Protected Overrides Function GetPattern(ByVal Name As String) As String
        '''     Select Case Name
        '''         Case "TEMP_PATTERN"
        '''             Return RTrim(flePATTERNS.GetStringValue("FIELD_PATTERN"))
        '''     End Select
        ''' End Function
        ''' </example>
        ''' <remarks>
        ''' Use the GetPattern method when assigning a pattern to a field that is
        ''' based on an expression or when the pattern is not a constant.  
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function GetPattern(ByVal Name As String) As String

            Return ""

        End Function

        '---------------------------------------------
        ' Default SetFieldDefaults procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Assigns the default value for a given field.
        ''' </summary>
        ''' <param name="Name">The name of the Field for which to return the default value.</param>
        ''' <returns>The default value for the named field.</returns>
        ''' <example>
        ''' Protected Overrides Function SetFieldDefaults(ByVal Name As String) As String
        '''     Try
        '''         Select Case Name
        '''             Case "EMPLOYEE_GENDER"
        '''                 Return "0001"
        '''             Case Else
        '''                 Return ""
        '''         End Select
        '''     Catch ex As CustomApplicationException
        '''         Throw ex
        '''     Catch ex As Exception
        '''         ExceptionManager.Publish(ex)
        '''         Throw ex
        '''     End Try
        ''' End Function
        ''' </example>
        ''' <remarks>
        ''' Use the SetFieldDefaults method to return the default value for a field
        ''' if no value is entered by the user during the Entry sequence.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function SetFieldDefaults(ByVal Name As String) As Object

            Return ""

        End Function

        '---------------------------------------------
        ' Default PreUpdate procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Performs processing prior to the Update method.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' Use the PreUpdate method to perform specific processing prior to executing
        ''' the Update method.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function PreUpdate() As Boolean

            Return True

        End Function

        '---------------------------------------------
        ' Default Update procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Performs processing upon successful completion of the Update method.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' Use the PostUpdate method to perform specific processing upon successful
        ''' completion of the Update method.  
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Overridable Function PostUpdate() As Boolean

            Return True

        End Function

        '---------------------------------------------
        ' Default Update procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Performs processing to update the database.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' The Update method is used to update the database with new, modified or deleted records.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend Overridable Function Update() As Boolean

            Return True

        End Function

        '---------------------------------------------
        ' Default UpdateValidation procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Calls the Accept/Edit verb for each of the fields on the screen in order to 
        ''' validate the data entered.
        ''' </summary>
        ''' <remarks>
        ''' The UpdateValidation method is generated by the Renaissance Architect 
        ''' PreCompiler for screens that have the UseAcceptProcessing property set
        ''' to False.  This method ensures that the values entered are validated and run
        ''' through the proper phases (Input, Edit, Process, Output).  Screens where  
        ''' UseAcceptProcessing is set to False have to re-run through the Accept/Edit
        ''' verbs as the user is not forced through the proper sequence since the user can
        ''' skip from one field to any other field.  Accept processing forces the user through
        ''' the sequence defined by the associated method (Entry, Designer 01, etc.).
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend Overridable Sub UpdateValidation()

        End Sub

        '---------------------------------------------
        ' Default UpdateValidation procedure.
        '---------------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Calls the Accept/Edit verb for each of the grid fields on the screen in order 
        ''' to validate the data entered.
        ''' </summary>
        ''' <remarks>
        ''' The GridUpdateValidation method is generated by the Renaissance Architect 
        ''' PreCompiler for screens that have the UseAcceptProcessing property set
        ''' to False.  This method ensures that the values entered are validated and run
        ''' through the proper phases (Input, Edit, Process, Output).  Screens where  
        ''' UseAcceptProcessing is set to False have to re-run through the Accept/Edit
        ''' verbs as the user is not forced through the proper sequence since the user can
        ''' skip from one field to any other field.  Accept processing forces the user through
        ''' the sequence defined by the associated method (Append, Designer 01, etc.).
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend Overridable Sub GridUpdateValidation()

        End Sub

#End Region

#Region "Properties"


        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property RunscreenReturnToStop() As Object
            Get
                Return objRunscreenReturnToStop
            End Get
            Set(ByVal Value As Object)
                objRunscreenReturnToStop = Value
            End Set
        End Property




        ''' --- NullResponse ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Determines whether the user entered a Null Response in the field.
        ''' </summary>
        ''' <param name="FieldId">The field being evaluated.</param>
        ''' <remarks>
        ''' Returns the value of hidNullResponse, a hidden field on every form, which what kind if character, if any, that the user has entered
        ''' K - user typed at least one displayable char
        ''' D - use pressed Delete or Backspace
        ''' E - user pressed Enter or Tab
        ''' '' (nothing) - nothing entered yet 
        ''' </remarks>
        ''' <example>If NullResponse(sender.Name) = 'K' Then <br/>
        '''         Returns 'K'/'D'/'E'/''
        ''' </example>
        ''' <history>
        ''' 	[glenna]	08-nov-2007	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private ReadOnly Property NullResponse(ByVal FieldID As String) As String
            Get
                'Return Request("hidNullResponse") AndAlso IsCurrentField(FieldID)
                Return False

            End Get

        End Property

        ''' --- IsCurrentField ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Indicates that the field is the current field.
        ''' </summary>
        ''' <param name="FieldId">The field being evaluated.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <example>ScreenSession("T_TEMP") = T_TEMP.Value <br/>
        '''         T_TEMP.Value = ScreenSession("T_TEMP")
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public ReadOnly Property IsCurrentField(ByVal Field As Control) As Boolean
            Get
                If ControlHadFocus Is Nothing Then Return False
                Return Field.Name = ControlHadFocus.Name

            End Get

        End Property



        ''' --- UseScaling ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of UseScaling.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend ReadOnly Property UseScaling() As Boolean
            Get
                Return True
            End Get
        End Property

        ''' --- IsPopup ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsPopup.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property IsPopup() As Boolean


        '-----------------------------------
        ' ProcessLocation.
        '-----------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Returns the ProcessLocation parameter defined in the Global.asax file.
        ''' </summary>
        ''' <returns>Returns a string representing the ProcessLocation value.</returns>
        ''' <remarks>
        ''' Use the ProcessLocation method to return the value for ProcessLocation
        ''' as specified in the web application's Global.asax file.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	04/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function ProcessLocation() As String

            Dim strProcessLocation As String
            'If Application(cProcessLocation) Is Nothing Then
            '    strProcessLocation = String.Empty
            'Else
            '    strProcessLocation = Application(cProcessLocation)
            'End If

            Return strProcessLocation

        End Function

        '-----------------------------------
        ' SysName.
        '-----------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' The dictionary title as specified in the Global.asax file.
        ''' </summary>
        ''' <returns>Returns a string representing the dictionary title.</returns>
        ''' <remarks>
        ''' Use the SysName method to return the dictionary title as specified in
        ''' the web application's Global.asax file. 
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	04/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function SysName() As String

            Return ""

        End Function

        '----------------------------
        ' DisableAppend property.
        '----------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Disables appending new records on grid screens.
        ''' </summary>
        ''' <value>A boolean value indicating whether Append is disabled.</value>
        ''' <remarks>
        ''' Use the DisableAppend property to disable appending new records on
        ''' grid screens.  By setting this value to True, the user will not have access
        ''' to the Append button on the grid in order to add new records.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	04/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property DisableAppend() As Boolean
            Get
                Return m_blnDisableAppend
            End Get
            Set(ByVal Value As Boolean)
                m_blnDisableAppend = Value
            End Set
        End Property

        '----------------------------
        ' DisableFind property.
        '----------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Disables the Find button on screens where the Change activity and Entry activies
        ''' are True.  
        ''' </summary>
        ''' <value>A boolean value indicating whether Find button is disabled.</value>
        ''' <remarks>
        ''' Use the DisableFind property to disable the Find button on screens where Entry and
        ''' Change activities are set to True (Change = True by default enables the Find button) 
        ''' to ensure the Find is disabled.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	04/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property DisableFind() As Boolean
            Get
                Return m_blnDisableFind
            End Get
            Set(ByVal Value As Boolean)
                m_blnDisableFind = Value
            End Set
        End Property

        '----------------------------
        ' UpdateExecuted property.
        '----------------------------
        ''' --- UpdateExecuted -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of UpdateExecuted.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property UpdateExecuted() As Boolean
            Get
                Return blnUpdateExecuted
            End Get
            Set(ByVal Value As Boolean)
                blnUpdateExecuted = Value
            End Set
        End Property

        Private _IsQuiz As Boolean
        <Browsable(False),
      EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property IsQuiz() As Boolean
            Get
                Return _IsQuiz
            End Get
            Set(ByVal Value As Boolean)
                _IsQuiz = Value
            End Set
        End Property




        '----------------------------
        ' ExecutingDesigner property.
        '----------------------------
        ''' --- ExecutingDesigner --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ExecutingDesigner.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property ExecutingDesigner() As Boolean
            Get
                Return m_blnExecutingDesigner
            End Get
            Set(ByVal Value As Boolean)
                m_blnExecutingDesigner = Value
            End Set
        End Property

        '----------------------------
        ' HasBackoutProcedure property.
        '----------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating that the current screen has a coded Backout method.
        ''' </summary>
        ''' <value>True if the screen has a coded Backout method.</value>
        ''' <remarks>
        ''' Use the HasBackoutProcedure property to indicate that the current screen has
        ''' a coded Backout method.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property HasBackoutProcedure() As Boolean
            Get
                Return m_blnHasBackoutProcedure
            End Get
            Set(ByVal Value As Boolean)
                m_blnHasBackoutProcedure = Value
            End Set
        End Property

        '----------------------------
        ' HasExitProcedure property.
        '----------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating that the current screen has a coded Exit method.
        ''' </summary>
        ''' <value>True if the screen has a coded Exit method.</value>
        ''' <remarks>
        ''' Use the HasExitProcedure property to indicate that the current screen has
        ''' a coded Exit method.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property HasExitProcedure() As Boolean
            Get
                Return m_blnHasExitProcedure
            End Get
            Set(ByVal Value As Boolean)
                m_blnHasExitProcedure = Value
            End Set
        End Property

        '--------------------------
        ' ControlsCleared property.
        '--------------------------
        ''' --- ControlsCleared ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ControlsCleared.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property ControlsCleared() As Boolean
            Get

                Return blnControlsCleared

            End Get
            Set(ByVal Value As Boolean)

                blnControlsCleared = Value

            End Set
        End Property

        '--------------------------
        ' ChangedSelectedTab property.
        '--------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating that a tab was changed through code.
        ''' </summary>
        ''' <value>A boolean indicating that the current tab was changed.</value>
        ''' <remarks>
        ''' Use the ChangedSelectedTab property to indicate that the selected tab
        ''' on a screen that uses the Tab control has changed.  
        ''' <br/><br/>
        ''' NOTE: This control is used for screens that call slave screens, where the slave
        ''' screens have been merged into the current screen.  A tab control is used to navigate 
        ''' to the different tabs (slave screens).
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Property ChangedSelectedTab() As Boolean
            Get
                Return m_blnChangedSelectedTab
            End Get
            Set(ByVal Value As Boolean)
                m_blnChangedSelectedTab = Value
            End Set
        End Property

        '--------------------------
        ' MultiLineText property.
        '--------------------------
        ''' --- MultiLineText ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of MultiLineText.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False), DefaultValue(""),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property MultiLineText() As String
            Get
                Return ""
            End Get
            Set(ByVal Value As String)

            End Set
        End Property

        '--------------------------
        ' MultiLinePrev property.
        '--------------------------
        ''' --- MultiLinePrev ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of MultiLinePrev.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False), DefaultValue(""),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property MultiLinePrev() As String
            Get
                Return ""
            End Get
            Set(ByVal Value As String)

            End Set
        End Property



        '--------------------------
        ' EnableNumberedDesigners property.
        '--------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property EnableNumberedDesigners() As Boolean
            Get
                Return blnEnableNumberedDesigners
            End Get
            Set(ByVal Value As Boolean)
                blnEnableNumberedDesigners = Value
            End Set
        End Property

        '----------------------------
        ' UseAcceptProcessing property.
        '----------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating to use Accept processing which forces the processing
        ''' of fields in a specific sequence.
        ''' </summary>
        ''' <value>True if Accept processing is turned on.</value>
        ''' <remarks>
        ''' Use the UseAcceptProcessing property to indicate that Accept processing is 
        ''' turned on to enforce processing of fields in a sequence based on the method being 
        ''' executed.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Bindable(False),
        Browsable(True),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property UseAcceptProcessing() As Boolean
            Get
                Return True
            End Get
            Set(ByVal Value As Boolean)
                blnUseAcceptProcessing = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating to use AutoUpdate.
        ''' </summary>
        ''' <value>True if AutoUpdate is turned on.</value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Bindable(False),
        Browsable(True),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property AutoUpdate() As Boolean
            Get
                Return blnAutoUpdate
            End Get
            Set(ByVal Value As Boolean)
                blnAutoUpdate = Value
            End Set
        End Property



        '----------------------------------------
        ' DisableToolbar property.
        '----------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating that the toolbar should be disabled.
        ''' </summary>
        ''' <value>True if the toolbar should be disabled.</value>
        ''' <remarks>
        ''' Use the DisableToolbar property to disable the toolbar buttons for the 
        ''' current screen.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property DisableToolbar() As Boolean
            Get
                Return m_blnDisableToolbar
            End Get
            Set(ByVal Value As Boolean)
                m_blnDisableToolbar = Value
            End Set
        End Property

        '----------------------------------------
        ' ScreenType property.
        '  NonGrid = 0
        '  Grid = 1
        '  Composite = 2
        '  Ghost = 4
        '----------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating the screen type.
        ''' </summary>
        ''' <value>The posible values are ScreenTypes.NonGrid, ScreenTypes.Grid, 
        ''' ScreenTypes.Composite and ScreenTypes.Ghost.</value>
        ''' <remarks>
        ''' Use the ScreenType property to indicate whether the current screen is 
        ''' a grid or non-grid screen, a composite screen (grid with primary which requires
        ''' the pagination and navigation toolbars), or a ghost screen.  
        ''' <note>Changing this value to a value other then what was generated may have undesired results.
        ''' </note>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Bindable(False),
        Browsable(True),
        DefaultValue(ScreenTypes.NonGrid),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property ScreenType() As ScreenTypes
            Get
                Return mscreenType
            End Get
            Set(ByVal Value As ScreenTypes)
                mscreenType = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        ''' <summary>
        ''' Gets or sets a value indicating that the grid occurs with a detail file.
        ''' </summary>
        ''' <value>A boolean indicating whether the grid occurs with a detail file.</value>
        ''' <remarks>
        ''' This property is used to determine whether to exit the ENTRY procedure when a 
        ''' Skip All (Ctrl + PgDwn) is used on the first grid field during ENTRY processing.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property OccursWithDetail() As Boolean
            Get
                Return m_blnOccursWithDetail
            End Get
            Set(ByVal Value As Boolean)
                m_blnOccursWithDetail = Value
            End Set
        End Property
        '----------------------------------------
        ' IsExecutingInFieldValidation property.
        '----------------------------------------
        ''' --- IsExecutingInFieldValidation ---------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsExecutingInFieldValidation.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property IsExecutingInFieldValidation() As Boolean
            Get
                Return m_blnInFieldValidation
            End Get
            Set(ByVal Value As Boolean)
                m_blnInFieldValidation = Value
            End Set
        End Property

        '---------------------------------
        ' PassArraysToScreens property.
        '---------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets the screens that receive the temps as arrays.
        ''' </summary>
        ''' <value>A comma delimited string representing the screens that receive arrays.</value>
        ''' <remarks>
        ''' Use the PassArraysToScreens property to set or retrieve names of the screens
        ''' that receive occurring temporaries.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property PassArraysToScreens() As String
            Get
                Return m_strPassArraysToScreens
            End Get
            Set(ByVal Value As String)
                m_strPassArraysToScreens = Value
            End Set
        End Property

        '---------------------------------
        ' PageTitle property.
        '---------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets the title value that is displayed in the title bar of the screen.
        ''' </summary>
        ''' <value>A string value representing the title to display.</value>
        ''' <remarks>
        ''' Use the PageTitle property to set or retrieve the title that will be displayed
        ''' in the title bar of the screen.  This value is set in the PagePostProcess method.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property PageTitle() As String
            Get
                Return m_strPageTitle
            End Get
            Set(ByVal Value As String)
                m_strPageTitle = Value
            End Set
        End Property

        '---------------------------------
        ' PageActionType property.
        ' This property can be used to determine which action caused Web Request.
        ' We need to set this property ideally in that object's Init Event
        ' so that we can access it in Page's Load/PerformOperation etc. 
        '
        ' Note: At present Only Desinger Control sets this property.
        '       At some point in time we need to set and use this property 
        '       from Navigation, DataList, InFieldValidation, Pagination and every 
        '       other control which causes post back,
        '       so that we can consistantly refer same property, instead of 
        '       referring several properties to know which event caused post back
        '---------------------------------
        ''' --- PageActionType -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PageActionType.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property PageActionType() As PageActionType
            Get
                Return m_intPageActionType
            End Get
            Set(ByVal Value As PageActionType)
                m_intPageActionType = Value
            End Set
        End Property

        '---------------------------------
        ' GridActionType property.
        ' This property can be used to determine which action in Grid caused Web Request.
        ' This property gets set from DataList control
        ' for non-grid screen it will always be "NotSet"
        '---------------------------------
        ''' --- GridActionType -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GridActionType.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property GridActionType() As DataListActionTypes
            Get
                Return m_intGridActionType
            End Get
            Set(ByVal Value As DataListActionTypes)
                m_intGridActionType = Value
            End Set
        End Property

        '---------------------------------
        ' PageActionObject property.
        ' This property can be used to determine an originator object which caused a Web Request.
        ' We need to set this property ideally in that object's Init Event
        ' so that we can access it in Page's Load/PerformOperation etc. 
        '
        ' Note: At present Only Desinger Control sets this property.
        '       At some point in time we need to set and use this property 
        '       from Navigation, DataList, InFieldValidation, Pagination and every 
        '       other control which causes post back,
        '       so that we can consistantly refer same property, instead of 
        '       referring several properties to know which event caused post back
        '---------------------------------
        ''' --- PageActionObject ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PageActionObject.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property PageActionObject() As Object
            Get
                If m_objPageActionObject Is Nothing Then
                    'TODO: We need to be consistantly return an Object which caused the post back
                    '      except in a new Web Request
                    '
                    'Till then Return Nothing
                End If
                Return m_objPageActionObject
            End Get
            Set(ByVal Value As Object)
                m_objPageActionObject = Value
            End Set
        End Property


        ''' --- PageFunctionObject ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PageFunctionObject.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property PageFunctionObject() As Object
            Get
                If m_objPageFunctionObject Is Nothing Then
                    'TODO: We need to be consistantly return an Object which caused the post back
                    '      except in a new Web Request
                    '
                    'Till then Return Nothing
                End If
                Return m_objPageFunctionObject
            End Get
            Set(ByVal Value As Object)
                m_objPageFunctionObject = Value
            End Set
        End Property



        '---------------------------------
        ' HasError property.
        ' This property is used in Page's Prerender to determine whether 
        ' Page has added any error
        ' Please note that error generated through AddMessage will only be 
        ' presented through this property and as AddMessage throws an Exception
        ' this property is not useful during page execution of page except in 
        ' PreRender Events
        '---------------------------------
        ''' --- HasError -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of HasError.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property HasError() As Boolean
            Get
                Return m_blnHasError
            End Get
            Set(ByVal Value As Boolean)
                If Not Value Then

                    Try
                        HideAlert()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                End If
                m_blnHasError = Value
            End Set
        End Property

        '---------------------------------
        ' HasErrorInFind property.
        ' This property is used in Page's Prerender to determine whether 
        ' Page has added any error
        ' Please note that error generated through AddMessage will only be 
        ' presented through this property and as AddMessage throws an Exception
        ' this property is not useful during page execution of page except in 
        ' PreRender Events
        '---------------------------------
        ''' --- HasError -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of HasError.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property HasErrorInFind() As Boolean
            Get
                Return m_blnHasErrorInFind
            End Get
            Set(ByVal Value As Boolean)
                m_blnHasErrorInFind = Value
            End Set
        End Property

        '---------------------------------
        ' Occurrence property.
        ' 1. Occurrence property returns One Based Occurrence 
        '    and should be used whenever you see PH Variable Occurrence
        '
        ' 2. Variable m_intOccurrence used to store the property value 
        '    is Zero based, as such this should not be used in place of PH Occurrence variable
        '
        ' 3. m_intOccurrence is Zero based in order to access:
        '       - Temporary Variable occurs with cluster or a File object with which Cluster occurs
        '       - Rows in a File Object which are stored as Zero based
        ' 
        ' 4. This property is not being persisted and will only be available after GridLoad
        ' 
        ' 5. If there is any need to use Occurrence before GridLoad check
        '    the possibility whether you can use DataList's EditItemIndex, 
        '    which is Zero Based and being persisted during Round trip to server
        '---------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets the Occurrence value.
        ''' </summary>
        ''' <value>An integer value representing the current occurrence.</value>
        ''' <remarks>
        ''' The Occurrence property indicates the number of times a loop has executed or
        ''' the current record occurrence within a grid.  For example, if working with the 
        ''' third record in a grid, the value of occurrence is 3.  If a FOR loop is executing
        ''' while working on the third record, the occurrence will be the number of times the
        ''' loop has executed.  When breaking out of the loop, the occurrence will have a 
        ''' value of 3 once again.
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public ReadOnly Property Occurrence() As Integer
            Get
                Return m_intOccurrence + 1
            End Get
        End Property



        ''' --- RenderDefaultTextBoxesForDesigner ----------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RenderDefaultTextBoxesForDesigner.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property RenderDefaultTextBoxesForDesigner() As Microsoft.VisualBasic.TriState
            'This property is used as a flag to render TextBox controls using
            'default settings while running designers
            Get
                Return m_blnRenderDefaultTextBoxesForDesigner
            End Get
            Set(ByVal Value As Microsoft.VisualBasic.TriState)
                m_blnRenderDefaultTextBoxesForDesigner = Value
            End Set
        End Property

        '---------------------------------
        ' DesignerName property.
        ' This property is used to retrieve Designer Link object in InFieldValidation
        '---------------------------------
        ''' --- DesignerName -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of DesignerName.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property DesignerName() As String
            Get
                Return strDesignerName
            End Get
            Set(ByVal Value As String)
                'Need to persist as we need this during InFieldValidation
                strDesignerName = Value
            End Set
        End Property

        '---------------------------------
        ' NavigationRecordCount property.
        '---------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property NavigationRecordCount() As Integer
            Get
                Dim strViewStateValue As String = strNavigationRecordCount

                If strViewStateValue Is Nothing Then
                    Return 0
                Else
                    Return Int(strViewStateValue)
                End If
            End Get
            Set(ByVal Value As Integer)
                strNavigationRecordCount = Value
            End Set
        End Property

        '---------------------------------
        ' CurrentRecordNumber property; used in a Grid Screen
        ' This property is in a context to TotalRecords and it can be more than "Occurs"
        ' Note: Per Screen, one grid with Data
        '---------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property CurrentRecordNumber() As Integer
            Get
                Return intCurrentRecordNumber
            End Get
            Set(ByVal Value As Integer)
                intCurrentRecordNumber = Value
            End Set
        End Property

        '---------------------------------
        ' GridRecordNumber property; used in a Grid Screen
        ' This property is in a context to TotalRecords and it can be more than "Occurs"
        ' Note: Per Screen, one grid with Data
        '---------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property GridRecordNumber() As Integer
            Get
                Return intGridRecordNumber
            End Get
            Set(ByVal Value As Integer)
                intGridRecordNumber = Value
            End Set
        End Property

        '----------------------------------------
        ' TotalGridRecords property is used to retrieve Total Records in a Table attached with Grid
        ' Note: Per Screen, one grid with Data
        '----------------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property TotalGridRecords() As Integer
            Get
                Return intTotalGridRecords
            End Get
            Set(ByVal Value As Integer)
                intTotalGridRecords = Value
            End Set
        End Property

        Private intTotalPages As Integer
        <Bindable(False),
       Browsable(False),
       EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property TotalPages() As Integer
            Get
                Return intTotalPages
            End Get
            Set(ByVal Value As Integer)
                intTotalPages = Value
            End Set
        End Property

        '---------------------------------
        ' CurrentPageSetNumber property; used in a Grid Screen
        ' Note: Per Screen, one grid with Data
        '---------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property CurrentPageSetNumber() As Integer
            Get
                Return intCurrentPageSetNumber
            End Get
            Set(ByVal Value As Integer)
                intCurrentPageSetNumber = Value
            End Set
        End Property

        <Bindable(False),
       Browsable(False),
       EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property TotalPageSets() As Integer
            Get
                Return intTotalPageSets
            End Get
            Set(ByVal Value As Integer)
                intTotalPageSets = Value
            End Set
        End Property

        '---------------------------------
        ' CurrentPageNumber property; used in a Grid Screen
        ' Note: Per Screen, one grid with Data
        '---------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property CurrentPageNumber() As Integer
            Get
                Return intCurrentPageNumber
            End Get
            Set(ByVal Value As Integer)
                intCurrentPageNumber = Value
            End Set
        End Property

        '---------------------------------
        ' CurrentIndex property; used in a Grid Screen
        ' CurrentIndex property is in a context to "Occurs"
        ' and it should never exceed "Occurs"
        ' Note: Per Screen, one grid with Data
        '---------------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property CurrentGridIndex() As Integer
            Get
                Return intCurrentGridIndex
            End Get
            Set(ByVal Value As Integer)
                intCurrentGridIndex = Value
            End Set
        End Property

        '----------------------------
        ' CalledPageSession property uses Session Collection, however to make it 
        ' readable and maitainable it adds 
        ' prefix "PageName_Level_" to SessionKey passed, which mimics
        ' a Page-Specific Session
        '----------------------------
        ''' --- CalledPageSession --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CalledPageSession.
        ''' </summary>
        ''' <param name="CalledScreenName"></param>
        ''' <param name="CalledScreenLevel"></param>
        ''' <param name="PageSessionKey"></param>
        ''' <param name="strSequence"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property CalledPageSession(ByVal CalledScreenName As String, ByVal CalledScreenLevel As Integer, ByVal PageSessionKey As String, ByVal strSequence As String) As Object
            Get
                Dim strPageSessionKey As String = CalledScreenName + "_" + CalledScreenLevel.ToString + "_" + strSequence + "_" + PageSessionKey
                Return ApplicationState.Current.PassingObjects.Item(strPageSessionKey)
            End Get
            Set(ByVal Value As Object)
                Dim strPageSessionKey As String = CalledScreenName + "_" + CalledScreenLevel.ToString + "_" + strSequence + "_" + PageSessionKey
                If ApplicationState.Current.PassingObjects.ContainsKey(strPageSessionKey) Then
                    ApplicationState.Current.PassingObjects.Item(strPageSessionKey) = Value
                Else
                    ApplicationState.Current.PassingObjects.Add(strPageSessionKey, Value)
                End If

            End Set
        End Property

        ''' --- Session ------------------------------------------------------------
        ''' <exclude />
        ''' <summary>
        '''     Summary of Session.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        '''     [Campbell]	7/5/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(EditorBrowsableState.Advanced)>
        Public Property Session As Hashtable
            Get
                If ApplicationState.Current.Session Is Nothing Then
                    ApplicationState.Current.Session = New Hashtable
                End If
                Return ApplicationState.Current.Session
            End Get
            Set(value As Hashtable)
                ApplicationState.Current.Session = value
            End Set
        End Property

        ''' --- InternalPageState --------------------------------------------------
        ''' <exclude />
        ''' <summary>
        '''     Summary of InternalPageState.
        ''' </summary>
        ''' <param name="ObjectStateKey"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        '''     [Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        '<EditorBrowsable(EditorBrowsableState.Advanced)>
        'Friend Property InternalPageState(ObjectStateKey As String) As Object
        '    Get
        '        Dim objValueFromState As Object

        '        ObjectStateKey = m_strPageId + ObjectStateKey
        '        Select Case ObjectStateMedium
        '            Case StateMedium.SessionOnServer
        '                objValueFromState = Session(ObjectStateKey)
        '                If _
        '                    (Not objValueFromState Is Nothing) AndAlso
        '                    objValueFromState.GetType.ToString = "System.String[]" Then
        '                    objValueFromState = CType(objValueFromState, Array).Clone
        '                End If
        '                Return objValueFromState
        '            Case StateMedium.PageOnClient
        '                'objValueFromState = ViewState(ObjectStateKey)
        '                If _
        '                    (Not objValueFromState Is Nothing) AndAlso
        '                    objValueFromState.GetType.ToString = "System.String[]" Then
        '                    objValueFromState = CType(objValueFromState, Array).Clone
        '                End If
        '                Return objValueFromState
        '            Case StateMedium.DatabaseOnServer
        '                'TODO: m_hstInternalStateInfo Needs to be saved in Database
        '                Return m_hstInternalStateInfo(ObjectStateKey)
        '            Case StateMedium.DiskOnServer
        '                'Needs an implementation
        '        End Select
        '        Return Nothing
        '    End Get
        '    Set(Value As Object)
        '        ObjectStateKey = m_strPageId + ObjectStateKey
        '        Select Case ObjectStateMedium
        '            Case StateMedium.SessionOnServer
        '                Session(ObjectStateKey) = Value
        '            Case StateMedium.PageOnClient
        '                'ViewState(ObjectStateKey) = Value
        '            Case StateMedium.DatabaseOnServer
        '                'TODO: m_hstInternalStateInfo Needs to be saved in Database
        '                m_hstInternalStateInfo(ObjectStateKey) = Value
        '            Case StateMedium.DiskOnServer
        '                'Needs an implementation
        '        End Select
        '    End Set
        'End Property

        ''' --- PageId -------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PageId.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private ReadOnly Property PageId() As String
            Get
                Return m_strPageId
            End Get
        End Property

        '----------------------------
        ' EnableNavigation property.
        '----------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property EnableNavigation() As Boolean
            Get
                Return m_blnEnableNavigation
            End Get
            Set(ByVal Value As Boolean)
                m_blnEnableNavigation = Value
            End Set
        End Property

        '----------------------------
        ' AppendMode property.
        '----------------------------
        ''' --- AppendMode ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of AppendMode.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Bindable(False),
        Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property AppendMode() As Boolean
            Get
                Return blnAppendMode
            End Get
            Set(ByVal Value As Boolean)
                blnAppendMode = Value
            End Set
        End Property

        '--------------------------
        ' IsDirty property.
        '--------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property IsDirty() As Boolean
            Get
                Return blnIsDirty
            End Get
            Set(ByVal Value As Boolean)
                blnIsDirty = Value
            End Set
        End Property

        '--------------------------
        ' NavigationType property.
        '--------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property NavigationType() As NavigationTypes
            Get
                Return m_NavigationType
            End Get
            Set(ByVal Value As NavigationTypes)
                m_NavigationType = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property CallPerformOperation() As Boolean
            Get
                Return m_blnCallPerformOperation
            End Get
            Set(ByVal Value As Boolean)
                m_blnCallPerformOperation = Value
            End Set
        End Property

        '--------------------------
        ' Slave property.
        '--------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets that the current screen is a slave screen.
        ''' </summary>
        ''' <value>True if the screen is a slave screen.</value>
        ''' <remarks>
        ''' Use the Slave property to indicate that the current screen is a slave screen
        ''' (a screen with no primary file).
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property Slave() As Boolean
            Get
                Return m_blnSlave
            End Get
            Set(ByVal Value As Boolean)
                m_blnSlave = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Overides the Findactivity if the security is set in the database
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[patrick]	12/9/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public DisableSecurityFind As Boolean
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Overides the Changeactivity if the security is set in the database
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[patrick]	12/9/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public DisableSecurityChange As Boolean
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Overides the Deleteactivity if the security is set in the database
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[patrick]	12/9/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public DisableSecurityDelete As Boolean
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Overides the Entryactivity if the security is set in the database
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[patrick]	12/9/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public DisableSecurityEntry As Boolean
        '--------------------------
        ' Change Activity property.
        '--------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating that the current screen is updatable.
        ''' </summary>
        ''' <value>True if the screen is updatable.</value>
        ''' <remarks>
        ''' Use the ChangeActivity property to indicate that the user can update records
        ''' on the current screen.
        ''' <br/><br/>
        ''' NOTE: If ChangeActivity or DeleteActivity is true, then FindActivity returns True.
        ''' If ChangeActivity, DeleteActivity, FindActivity and EntryActivity are all False,
        ''' then all these activities are considered True indicating that the user can find,
        ''' delete, change and add new records on the current screen unless the code prohibits
        ''' this explicitly (ie. by removing the code from within the Entry procedure).
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property ChangeActivity() As Boolean
            Get
                'If the database security table overides the activity
                If DisableSecurityChange Then
                    Return False
                End If
                ' If all the activities are FALSE (which means the default - none of the activities were set),
                ' then PowerHouse sets the activities to TRUE.
                If m_blnChange = False AndAlso m_blnDelete = False AndAlso m_blnEntry = False AndAlso m_blnFind = False AndAlso Not NoAction Then
                    Return True
                Else
                    Return m_blnChange
                End If
            End Get
            Set(ByVal Value As Boolean)
                m_blnChange = Value
            End Set
        End Property

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property DisableCancel() As Boolean
            Get
                Return m_blnCancel
            End Get
            Set(ByVal Value As Boolean)
                m_blnCancel = Value
            End Set
        End Property


        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property DisableExit() As Boolean
            Get
                Return m_blnExit
            End Get
            Set(ByVal Value As Boolean)
                m_blnExit = Value
            End Set
        End Property

        '----------------------------
        ' DisableSubmit property.
        '----------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating that the current should have it's Submit button disabled.
        ''' </summary>
        ''' <value>True if the Submit button should be disabled on a screen.</value>
        ''' <remarks>
        ''' Use the DisableSubmit property to indicate that the current screen should not allow Submit
        ''' </remarks>
        ''' <history>
        ''' 	[GlennA]	27/oct/2007	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property DisableSubmit() As Boolean
            Get
                Return m_DisableSubmit
            End Get
            Set(ByVal Value As Boolean)
                m_DisableSubmit = Value
            End Set
        End Property

        '----------------------------
        ' DeleteNoSubmit property.
        '----------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating that the current should have it's Submit button disabled.
        ''' </summary>
        ''' <value>True if the Submit button should be disabled on a screen.</value>
        ''' <remarks>
        ''' Use the DisableSubmit property to indicate that the current screen should not allow Submit
        ''' </remarks>
        ''' <history>
        ''' 	[GlennA]	13/nov/2007	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property DeleteNoSubmit() As Boolean
            Get
                Return m_DeleteNoSubmit
            End Get
            Set(ByVal Value As Boolean)
                m_DeleteNoSubmit = Value
            End Set
        End Property
        '--------------------------
        ' Delete Activity property.
        '--------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating that the current screen allows deleting records.
        ''' </summary>
        ''' <value>True if the screen allows the deletion of records.</value>
        ''' <remarks>
        ''' Use the DeleteActivity property to indicate that the user can delete records
        ''' on the current screen.
        ''' <br/><br/>
        ''' NOTE: If ChangeActivity or DeleteActivity is true, then FindActivity returns True.
        ''' If ChangeActivity, DeleteActivity, FindActivity and EntryActivity are all False,
        ''' then all these activities are considered True indicating that the user can find,
        ''' delete, change and add new records on the current screen unless the code prohibits
        ''' this explicitly (ie. by removing the code from within the Entry procedure).
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property DeleteActivity() As Boolean
            Get
                'If the database security table overides the activity
                If DisableSecurityDelete Then
                    Return False
                End If
                ' If all the activities are FALSE (which means the default - none of the activities were set),
                ' then PowerHouse sets the activities to TRUE.
                If m_blnChange = False AndAlso m_blnDelete = False AndAlso m_blnEntry = False AndAlso m_blnFind = False AndAlso Not NoAction Then
                    Return True
                Else
                    Return m_blnDelete
                End If
            End Get
            Set(ByVal Value As Boolean)
                m_blnDelete = Value
            End Set
        End Property

        '--------------------------
        ' Entry Activity property.
        '--------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating that the current screen allows adding new records.
        ''' </summary>
        ''' <value>True if the screen allows adding new records.</value>
        ''' <remarks>
        ''' Use the EntryActivity property to indicate that the user can add new records
        ''' on the current screen.
        ''' <br/><br/>
        ''' NOTE: If ChangeActivity, DeleteActivity, FindActivity and EntryActivity are all False,
        ''' then all these activities are considered True indicating that the user can find,
        ''' delete, change and add new records on the current screen unless the code prohibits
        ''' this explicitly (ie. by removing the code from within the Entry procedure).
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property EntryActivity() As Boolean
            Get
                'If the database security table overides the activity
                If DisableSecurityEntry Then
                    Return False
                End If
                ' If all the activities are FALSE (which means the default - none of the activities were set),
                ' then PowerHouse sets the activities to TRUE.
                If m_blnChange = False AndAlso m_blnDelete = False AndAlso m_blnEntry = False AndAlso m_blnFind = False AndAlso Not NoAction Then
                    Return True
                Else
                    Return m_blnEntry
                End If
            End Get
            Set(ByVal Value As Boolean)
                m_blnEntry = Value
            End Set
        End Property

        '--------------------------
        ' Find Activity property.
        '--------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating that the current screen has no actions.
        ''' </summary>
        ''' <value>True if the screen has no activities.</value>
        ''' <remarks>
        ''' Use the NoAction property to indicate that the screen has no actions specified.
        ''' <br/><br/>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property NoAction() As Boolean
            Get
                Return m_blnNoAction
            End Get
            Set(ByVal Value As Boolean)
                m_blnNoAction = Value
            End Set
        End Property

        '--------------------------
        ' Find Activity property.
        '--------------------------
        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating that the current screen allows finding records.
        ''' </summary>
        ''' <value>True if the screen allows the finding of records.</value>
        ''' <remarks>
        ''' Use the DeleteActivity property to indicate that the user can find records
        ''' on the current screen.
        ''' <br/><br/>
        ''' NOTE: If ChangeActivity or DeleteActivity is true, then FindActivity returns True.
        ''' If ChangeActivity, DeleteActivity, FindActivity and EntryActivity are all False,
        ''' then all these activities are considered True indicating that the user can find,
        ''' delete, change and add new records on the current screen unless the code prohibits
        ''' this explicitly (ie. by removing the code from within the Entry procedure).
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property FindActivity() As Boolean
            Get
                'If the database security table overides the activity
                If DisableSecurityFind Then
                    Return False
                End If
                ' If all the activities are FALSE (which means the default - none of the activities were set),
                ' then PowerHouse sets the activities to TRUE.
                If m_blnSlave = True Then
                    Return False
                ElseIf m_blnChange = False AndAlso m_blnDelete = False AndAlso m_blnEntry = False AndAlso m_blnFind = False AndAlso Not NoAction Then
                    Return True
                Else
                    ' If Change or Delete is set to TRUE, then FIND is implied.
                    If (m_blnChange OrElse m_blnDelete) AndAlso Not Me.DisableFind Then
                        Return True
                    Else
                        Return m_blnFind
                    End If
                End If
            End Get
            Set(ByVal Value As Boolean)
                m_blnFind = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Setting it to true disables an Update Procedure. Precompiler looks for an Update procedure, if doesn't find it, it sets DisableUpdate Property to True. By default it is False.
        ''' </summary>
        ''' <returns>True indicates that an Update procedure is disabled</returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Mayur]	September 7, 2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property DisableUpdate() As Boolean
            Get
                Return m_blnDisableUpdate
            End Get
            Set(ByVal Value As Boolean)
                m_blnDisableUpdate = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Setting it to true disables an Entry Procedure. Precompiler looks for an Entry procedure, if doesn't find it, it sets DisableEntry Property to True. By default it is False.
        ''' </summary>
        ''' <returns>True indicates that an Entry procedure is disabled</returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Mayur]	September 7, 2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property DisableEntry() As Boolean
            Get
                Return m_blnDisableEntry
            End Get
            Set(ByVal Value As Boolean)
                m_blnDisableEntry = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Setting it to true disables the Delete Procedure. Precompiler looks for the Delete procedure, if doesn't find it, it sets DisableDelete Property to True. By default it is False.
        ''' </summary>
        ''' <returns>True indicates that the Delete procedure is disabled</returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Mayur]	September 7, 2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property DisableDelete() As Boolean
            Get
                Return m_blnDisableDelete
            End Get
            Set(ByVal Value As Boolean)
                m_blnDisableDelete = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Gets or sets a value indicating that the screen will automatically close and
        ''' return to the calling screen.
        ''' </summary>
        ''' <returns>True indicates that the screen will close and return to the calling screen.</returns>
        ''' <remarks>
        ''' Use the AutoReturn property to indicate that the screen should exit upon successfully 
        ''' completing update sequence (PreUpdate,Update, and PostUpdate procedures).
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property AutoReturn() As Boolean
            Get
                Return m_blnAutoReturn
            End Get
            Set(ByVal Value As Boolean)
                m_blnAutoReturn = Value
            End Set
        End Property

        '--------------------------
        ' Language property.
        '--------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property Language() As String
            Get
                Return GlobalizationManager.SupportedLanguage
            End Get

            Set(ByVal Value As String)
                ApplicationState.Current.Language = Value.ToLower
            End Set
        End Property

        '--------------------------
        ' Language property.
        '--------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property LanguageChanged() As Boolean
            Get
                Return m_blnLanguageChanged

            End Get
            Set(ByVal Value As Boolean)
                m_blnLanguageChanged = Value
            End Set
        End Property

        '--------------------------
        ' TwoLetterISOLanguageCode property.
        '--------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public ReadOnly Property LanguageCode() As String
            Get

                Return GlobalizationManager.LanguageCode

            End Get

        End Property

        '--------------------------
        ' Mode property.
        '--------------------------
        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property Mode() As PageModeTypes
            Get
                If m_intPageModeType = PageModeTypes.Unknown Then
                    'Only first time get the value from ViewState otherwise always use
                    'the value retrived in first call or set in "Property Set"

                    SetModeValues(m_intPageModeType)
                    m_intPageModeType = PageModeTypes.NoMode
                End If
                Return m_intPageModeType
            End Get
            Set(ByVal Value As PageModeTypes)
                If Value = PageModeTypes.Entry And DisableSecurityEntry Then Value = PageModeTypes.Find
                If Value = PageModeTypes.Find And DisableSecurityFind Then Value = PageModeTypes.NoMode

                If Value = PageModeTypes.Unknown Then Value = PageModeTypes.NoMode

                m_intPageModeType = Value
                SetModeValues(Value)
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' This member supports the Renaissance Architect Framework infrastructure and 
        ''' is not intended to be used directly from your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Chris]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public ReadOnly Property SetAlteredFlag() As Boolean
            Get
                ' The AlteredRecord flag is not set to True if the value was changed when 
                ' FindMode is true except when in the PostFind or DetailPostFind or Postpath.  If in 
                ' NoMode (in our case we are in NoMode when searching for a record using FIND 
                ' and no records are found, or by pressing the cancel button), the AlteredRecord flag
                ' should not be set to True, unless we are running the INITIALIZE procedure.  In
                ' all other modes, the AlteredRecord status should change to True when the value changes.
                If Mode = PageModeTypes.Change OrElse Mode = PageModeTypes.Entry OrElse Mode = PageModeTypes.Correct OrElse
                (Mode = PageModeTypes.Find AndAlso m_blnInPostFindOrDetailPostFind) OrElse m_blnInInitialize OrElse m_blnExecutingBackout Then
                    Return True
                Else
                    Return False
                End If
            End Get
        End Property

        'At present this property is used from Designer Control to bypass
        'a call to Initialize
        ''' --- NeedLoadState ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of NeedLoadState.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property NeedLoadState() As Boolean
            Get
                Return m_blnNeedLoadState
            End Get
            Set(ByVal Value As Boolean)
                m_blnNeedLoadState = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' RunScreenFolderLength is used identify the folder of the Run Screen based on Run Screen Name
        ''' RunScreenFolderLength can be defined in "appSettings" section of web.Config
        ''' 
        ''' RunScreenFolderLength defined in web.config can be overrided in the page by assigning it in Init evenhandler of the Derived Page.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False), DefaultValue(2),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property RunScreenFolderLength() As Short
            Get
                Return m_intRunScreenFolderLength
            End Get
            Set(ByVal Value As Short)
                m_intRunScreenFolderLength = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' RunScreenFolderLength is used identify the folder of the Run Screen based on Run Screen Name
        ''' RunScreenFolderLength can be defined in "appSettings" section of web.Config
        ''' 
        ''' RunScreenFolderLength defined in web.config can be overrided in the page by assigning it in Init evenhandler of the Derived Page.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub SetRunScreenFolderLength()
            If m_intRunScreenFolderLength = -1 Then
                If m_strRunScreenFolderLength Is Nothing Then
                    m_strRunScreenFolderLength = System.Configuration.ConfigurationManager.AppSettings("RunScreenFolderLength")
                    If m_strRunScreenFolderLength Is Nothing Then
                        'RunScreenFolderLength is not defined in appSettings section of web.config 
                        m_strRunScreenFolderLength = "2"  'Set the default RunScreenFolderLength to 2
                    End If
                End If

                m_intRunScreenFolderLength = CShort(m_strRunScreenFolderLength)
            End If
        End Sub

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' UseLookUpIcon is used identify the if a lookup icon will be used
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	05/04/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function UseLookUpIcon() As Boolean
            If m_intUseLookUpIcon = -1 Then

                If Not IsNothing(System.Configuration.ConfigurationManager.AppSettings("UseLookUpIcon")) AndAlso System.Configuration.ConfigurationManager.AppSettings("UseLookUpIcon").ToString.ToUpper = "TRUE" Then
                    m_intUseLookUpIcon = 1
                Else
                    m_intUseLookUpIcon = 0
                End If
            End If

            If m_intUseLookUpIcon > 0 Then
                Return True
            Else
                Return False
            End If
        End Function

        ''' --- SetModeValues ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SetModeValues.
        ''' </summary>
        ''' <param name="Value"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub SetModeValues(ByVal Value As PageModeTypes)

            Select Case Value
                Case PageModeTypes.Find
                    m_blnFindMode = True
                    m_blnEntryMode = False
                    m_blnChangeMode = False
                    m_blnCorrectMode = False
                    m_blnSelectMode = False
                Case PageModeTypes.Select
                    m_blnFindMode = True
                    m_blnEntryMode = False
                    m_blnChangeMode = False
                    m_blnCorrectMode = False
                    m_blnSelectMode = True
                Case PageModeTypes.Entry
                    m_blnFindMode = False
                    m_blnEntryMode = True
                    m_blnChangeMode = False
                    m_blnCorrectMode = False
                    m_blnSelectMode = False
                Case PageModeTypes.Correct
                    m_blnFindMode = False
                    m_blnEntryMode = True
                    m_blnChangeMode = False
                    m_blnCorrectMode = True
                    m_blnSelectMode = False
                Case PageModeTypes.Change
                    If Me.UseAcceptProcessing Then m_blnFindMode = True
                    m_blnEntryMode = False
                    m_blnChangeMode = True
                    m_blnCorrectMode = False
                    m_blnSelectMode = False
                Case PageModeTypes.NoMode
                    m_blnFindMode = False
                    m_blnEntryMode = False
                    m_blnChangeMode = False
                    m_blnCorrectMode = False
                    m_blnSelectMode = False

                    'Clear the controls next time when Find Button is pressed
                    ControlsCleared = False
            End Select

        End Sub

        '--------------------------
        ' ChangeMode property.
        '--------------------------
        ''' --- ChangeMode ---------------------------------------------------------
        '''
        ''' <summary>
        ''' 	The screen is in Find mode and data has been displayed.  The user can
        '''     now update values.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public ReadOnly Property ChangeMode() As Boolean
            Get
                Return m_blnChangeMode
            End Get
        End Property

        '--------------------------
        ' CorrectMode property.
        '--------------------------
        ''' --- CorrectMode --------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	The screen is in Entry mode and the Entry procedure has completed.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public ReadOnly Property CorrectMode() As Boolean
            Get
                Return m_blnCorrectMode
            End Get
        End Property

        '--------------------------
        ' EntryMode property.
        '--------------------------
        ''' --- EntryMode ----------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	The screen is in the Entry sequence or appending data.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public ReadOnly Property EntryMode() As Boolean
            Get
                Return m_blnEntryMode AndAlso Not m_blnCorrectMode
            End Get
        End Property

        '--------------------------
        ' FindMode property.
        '--------------------------
        ''' --- FindMode -----------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	The screen is performing Find mode initialization, retrieving records,
        '''     or displaying records.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public ReadOnly Property FindMode() As Boolean
            Get
                Return m_blnFindMode
            End Get
        End Property

        '--------------------------
        ' SelectMode property.
        '--------------------------
        ''' --- SelectMode ---------------------------------------------------------
        '''
        ''' <summary>
        ''' 	The screen is performing Select processing.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public ReadOnly Property SelectMode() As Boolean
            Get
                Return m_blnSelectMode
            End Get
        End Property

        '--------------------------
        ' Name property.
        '--------------------------
        ''' --- FormName -----------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	The name of the screen.  This name is displayed on the standard toolbar.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property FormName() As String
            Get
                Return m_strPageName
            End Get
            Set(ByVal Value As String)
                Name = Value
                m_strPageName = Value
            End Set
        End Property

        '--------------------------
        ' Page (Screen) Level property
        '--------------------------
        ''' --- Level --------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Returns a value indicating the current screen level.
        ''' </summary>
        ''' <remarks>
        '''     The first screen starts at level 1, and each additional screen that is called
        '''     increments the level by 1.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property Level() As Integer
            Get
                Return intScreenLevel
            End Get
            Set(value As Integer)
                intScreenLevel = value
            End Set
        End Property

        '--------------------------
        ' Page property.
        '--------------------------
        ''' --- Page ---------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of Page.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Shadows Property Page() As Core.Windows.UI.Page

            Get
                Return Me
            End Get
            Set(ByVal Value As Core.Windows.UI.Page)
                Me.Page = Value
            End Set

        End Property

        'Used to MantainTabOrder
        ''' --- ControlList --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ControlList.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property ControlList() As ControlListManager
            Get
                Return (m_clmControlList)
            End Get
            Set(ByVal Value As ControlListManager)
                m_clmControlList = Value
            End Set
        End Property

        '--------------------------------
        ' HasPathRequestFields property.
        '--------------------------------
        ''' --- HasPathRequestFields -----------------------------------------------
        ''' 
        ''' <summary>
        ''' 	This property indicates that the current screen has fields that are 
        '''     prompted for during the Find sequence.
        ''' </summary>
        ''' <remarks>This property is used by the framework to perform certain actions,
        ''' and is generated by the Renaissance Architect Wizard or Renaissance Architect
        ''' Forward Engineering component.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property HasPathRequestFields() As Boolean
            Get
                Return m_blnHasPathRequestFields
            End Get
            Set(ByVal Value As Boolean)
                m_blnHasPathRequestFields = Value
            End Set
        End Property

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property AllowAcceptInDetailPostFind() As Boolean
            Get
                Return m_blnAllowAcceptInDetailPostFind
            End Get
            Set(ByVal Value As Boolean)
                m_blnAllowAcceptInDetailPostFind = Value
            End Set
        End Property

        '--------------------------------
        ' Submit property.
        '--------------------------------
        ''' --- Submit -------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of Submit.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property Submit() As Boolean
            Get
                Return m_blnSubmit
            End Get
            Set(ByVal Value As Boolean)
                m_blnSubmit = Value
            End Set
        End Property

        ''' --- ToolbarAction ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ToolbarAction.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property ToolbarAction() As ToolbarIcons
            Get
                Return m_intToolbarAction
            End Get
            Set(value As ToolbarIcons)
                m_intToolbarAction = value
            End Set
        End Property

        ''' --- RequireSelectProcessing --------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Subject to "Display" property enables or disables Fields in "Find" mode for search criteria
        ''' </summary>
        ''' <remarks>Rules to follow when using this property:
        ''' <para>
        '''     <list type="numbered">
        '''         <item>Set it to "Disable" to disable Select Processing on a form.</item>
        '''         <item>To enable Select Processing only on Primary (not to be confused with Primary File)
        '''             Area of the screen set it to "OnPrimary"</item>
        '''         <item>To enable Select Processing on Primary as well as on Grid fields (In case of Primary/Detail screen)
        '''             set it to "OnPrimaryAndGrid"</item>
        '''         <item>To enable only Grid Fields, set this property to "OnPrimaryAndGrid",
        '''             set "Display" Property of individual NonGrid Fields such that
        '''             it disables the field in Find Mode e.g. Find, EntryFind or EntryChangeFind.</item>
        '''     </list>
        ''' </para>
        ''' <para>
        ''' <note>
        '''     Setting this property to "OnPrimaryAndGrid" on a screen, which has no Core Grid Control
        '''     on it, will behave same way as setting it to "OnPrimary"
        '''     In short, setting this property to other than "Disable" will halt
        '''     for user input when user click on "Find" toolbar button, regardless
        '''     whether user has any Field enabled for entering search criteria or not.
        ''' </note>
        ''' </para>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Description("Subject to ""Display"" property enables or disables Fields in ""Find"" mode for search criteria."),
        Category("Core"),
        DefaultValue(GetType(SelectProcessing), "OnPrimary"),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property RequireSelectProcessing() As SelectProcessing
            Get
                Return m_intRequireSelectProcessing
            End Get
            Set(ByVal Value As SelectProcessing)
                m_intRequireSelectProcessing = Value
            End Set
        End Property

        ' Accept processing.
        '--------------------------
        ' IsRequest property.
        '--------------------------
        ''' --- IsRequest ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsRequest.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property IsRequest() As Boolean
            Get
                Return blnIsRequest
            End Get
            Set(ByVal Value As Boolean)
                blnIsRequest = Value
            End Set
        End Property

        ' Accept processing.
        '--------------------------
        ' IsAppend property.
        '--------------------------
        ''' --- IsAppend -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsAppend.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property IsAppend() As Boolean
            Get
                Return blnIsAppend
            End Get
            Set(ByVal Value As Boolean)
                blnIsAppend = Value
            End Set
        End Property

        ''' --- NextAppendInRow ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of NextAppendInRow.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property NextAppendInRow() As Integer
            'This property is used as a flag to write Client-side script to allow user to Append multiple rows in Grid
            Get
                If Me.IsExecutingAppend Then
                    Return m_intNextAppendInRow
                Else
                    Return -1
                End If
            End Get
            Set(ByVal Value As Integer)
                m_intNextAppendInRow = Value
            End Set
        End Property

        '--------------------------
        ' IsInAppendOrEntry property.
        '--------------------------
        ''' --- IsInAppendOrEntry --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsInAppendOrEntry.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property IsInAppendOrEntry() As Boolean
            Get
                Return blnIsInAppendOrEntry
            End Get
            Set(ByVal Value As Boolean)
                blnIsInAppendOrEntry = Value
            End Set
        End Property

        ' IsAppendFromEntry processing.
        '--------------------------
        ' IsAppendFromEntry property.
        '--------------------------
        ''' --- IsAppendFromEntry --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsAppendFromEntry.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property IsAppendFromEntry() As Boolean
            Get
                Return blnIsAppendFromEntry
            End Get
            Set(ByVal Value As Boolean)
                blnIsAppendFromEntry = Value
            End Set
        End Property

        ' DisableAppendFromEntry processing.
        '--------------------------
        ' DisableAppendFromEntry property.
        '--------------------------
        ''' --- DisableAppendFromEntry --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Gets or sets a boolean value indicating that the automatic call to the Append
        ''' method from the Entry method is to be disabled.
        ''' </summary>
        ''' <remarks>
        ''' Setting DisableAppendFromEntry to True will bypass the automatic call of the Append method
        ''' when executing the Entry method.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend Property DisableAppendFromEntry() As Boolean
            Get
                Return m_blnDisableAppendFromEntry
            End Get
            Set(ByVal Value As Boolean)
                m_blnDisableAppendFromEntry = Value
            End Set
        End Property

        ' IsInPostEntry processing.
        '--------------------------
        ' IsInPostEntry property.
        '--------------------------
        ''' --- IsInPostEntry ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsInPostEntry.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property IsInPostEntry() As Boolean
            Get
                Return blnIsInPostEntry
            End Get
            Set(ByVal Value As Boolean)
                blnIsInPostEntry = Value
            End Set
        End Property



        ' AppendFromGridNew processing.
        '--------------------------
        ' AppendFromGridNew property.
        '--------------------------
        ''' --- IsAppendFromGrid ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsAppendFromGrid.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property IsAppendFromGrid() As Boolean
            Get
                Return blnAppendFromGridNew
            End Get
            Set(ByVal Value As Boolean)
                blnAppendFromGridNew = Value
            End Set
        End Property

        ' Accept processing.
        '--------------------------
        ' IsPathComplete property.
        '--------------------------
        ''' --- IsPathComplete -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsPathComplete.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property IsPathComplete() As Boolean
            Get
                Return blnIsPathComplete
            End Get
            Set(ByVal Value As Boolean)
                blnIsPathComplete = Value
            End Set
        End Property

        ' Accept processing.
        '--------------------------
        ' Data List Designer property.
        '--------------------------
        ''' --- GridDesigner -------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Sets or gets the numbered designer that is associated to the grid.
        ''' </summary>
        ''' <remarks>
        ''' This property is used by the framework to execute the associated numbered designer 
        ''' when the user presses the Edit icon for a particular row in the grid.  
        ''' <note>
        ''' This property is generated by the PreCompiler in the Init method of the page.  
        ''' </note>
        ''' </remarks>
        ''' <example>
        ''' Me.GridDesigner = "dsrDesigner_03"
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property GridDesigner() As String
            Get
                Return m_strGridDesigner
            End Get
            Set(ByVal Value As String)
                m_strGridDesigner = Value
            End Set
        End Property

        ''' --- StopScreen -------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Sets or gets If the screen is a stop screen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <example>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property StopScreen() As Boolean
            Get
                Return m_strStopScreen
            End Get
            Set(ByVal Value As Boolean)
                m_strStopScreen = Value
                Dim arrStop() As String = StopScreens.Split(",")
                Dim blnAdd As Boolean = True
                For i As Integer = 0 To arrStop.Length - 1
                    If arrStop(i) = Me.FormName Then
                        blnAdd = False
                        Exit For
                    End If
                Next
                If blnAdd Then
                    If StopScreens.Length > 0 Then
                        StopScreens = StopScreens & ","
                    End If
                    StopScreens = StopScreens & Me.FormName
                End If
            End Set
        End Property

        ''' --- StopScreen -------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Sets or gets If the screen is a stop screen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <example>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property StopScreens() As String
            Get
                Return strStopScreens
            End Get
            Set(ByVal Value As String)
                strStopScreens = Value
            End Set
        End Property

        ''' --- ReturnStopScreen -------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Sets or gets If the screen is a stop screen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <example>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property ReturnStopScreen() As Boolean
            Get
                Return blnReturnStopScreen
            End Get
            Set(ByVal Value As Boolean)
                blnReturnStopScreen = Value
            End Set
        End Property

        '------------------------
        ' IsMenuScreen property
        '------------------------
        ''' --- IsMenuScreen -------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Get or sets a value indicating that the current screen is a screen of
        '''     type menu.
        ''' </summary>
        ''' <remarks>
        '''     This property is used by the framework in order to perform specific actions
        '''     that are specific to menu screens.  
        ''' <note>
        ''' This property is only applicable when the screen is a menu screen and is not
        ''' part of the menu tree.  This property should be set in the Init method of the page.
        ''' </note>
        ''' </remarks>
        ''' <example>
        ''' Me.IsMenuScreen = True
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(True),
        Category("Core"),
        DefaultValue(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property IsMenuScreen() As Boolean
            Get
                Return m_blnIsMenuScreen
            End Get
            Set(ByVal Value As Boolean)
                m_blnIsMenuScreen = Value
            End Set
        End Property


        ''' --- PrimaryFile --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PrimaryFile.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property PrimaryFile() As String
            Get
                Return m_strPrimaryFile
            End Get
            Set(ByVal Value As String)
                m_strPrimaryFile = Value
            End Set
        End Property



        ''' --- MetaComboColumnNames -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of MetaComboColumnNames.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend ReadOnly Property MetaComboColumnNames() As ArrayList
            Get
                If m_colMetaComboColumnNames Is Nothing Then
                    m_colMetaComboColumnNames = New ArrayList
                End If
                Return m_colMetaComboColumnNames
            End Get
        End Property

        ''' --- UserComboColumnNames -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of UserComboColumnNames.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend ReadOnly Property UserComboColumnNames() As ArrayList
            Get
                If m_colUserComboColumnNames Is Nothing Then
                    m_colUserComboColumnNames = New ArrayList
                End If
                Return m_colUserComboColumnNames
            End Get
        End Property

        ''' --- UserComboValues ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of UserComboValues.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend ReadOnly Property UserComboValues() As ArrayList
            Get
                If m_colUserComboValues Is Nothing Then
                    m_colUserComboValues = New ArrayList
                End If
                Return m_colUserComboValues
            End Get
        End Property

#Region " Window Position properties "

        '''' --- Top ----------------------------------------------------------------
        '''' 
        '''' <summary>
        '''' 	Top (Y) position of the form. 
        '''' </summary>
        '''' <remarks>The default -1 specifies vertically centering the screen.
        '''' </remarks>
        '''' <history>
        '''' 	[Campbell]	7/4/2005	Created
        '''' </history>
        '''' --- End of Comments ----------------------------------------------------
        '<Description("Top (Y) position of the form. The default -1 specifies vertically center of the screen"), _
        'DefaultValue("-1"), _
        'EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)> _
        'Public Property Top() As Integer
        '    Get
        '        Return m_intTop
        '    End Get
        '    Set(ByVal Value As Integer)
        '        m_intTop = Value
        '    End Set
        'End Property

        '''' --- Left ---------------------------------------------------------------
        '''' 
        '''' <summary>
        '''' 	Left (X) position of the form. 
        '''' </summary>
        '''' <remarks>The default -1 specifies horizontally centering the screen.
        '''' </remarks>
        '''' <history>
        '''' 	[Campbell]	7/4/2005	Created
        '''' </history>
        '''' --- End of Comments ----------------------------------------------------
        '<Description("Left (X) position of the form. The default -1 specifies horizontally center of the screen"), _
        'DefaultValue("-1"), _
        'EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)> _
        'Public Property Left() As Integer
        '    Get
        '        Return m_intLeft
        '    End Get
        '    Set(ByVal Value As Integer)
        '        m_intLeft = Value
        '    End Set
        'End Property

        '''' --- Height -------------------------------------------------------------
        '''' 
        '''' <summary>
        '''' 	Height of the form in Pixels.
        '''' </summary>
        '''' <remarks>Default value is 750 pixels.
        '''' </remarks>
        '''' <history>
        '''' 	[Campbell]	7/4/2005	Created
        '''' </history>
        '''' --- End of Comments ----------------------------------------------------
        '<Description("Height of the form in Pixel"), _
        'DefaultValue("750"), _
        'EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)> _
        'Public Property Height() As Integer
        '    Get
        '        Return m_intHeight
        '    End Get
        '    Set(ByVal Value As Integer)
        '        m_intHeight = Value
        '    End Set
        'End Property

        '''' --- Width --------------------------------------------------------------
        '''' <exclude/>
        '''' 
        '''' <summary>
        '''' 	Width of the form in Pixels.
        '''' </summary>
        '''' <remarks>Default value is 1000 pixels.
        '''' </remarks>
        '''' <history>
        '''' 	[Campbell]	7/4/2005	Created
        '''' </history>
        '''' --- End of Comments ----------------------------------------------------
        '<Description("Width of the form in Pixel"), _
        'DefaultValue("1000"), _
        'EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)> _
        'Public Property Width() As Integer
        '    Get
        '        Return m_intWidth
        '    End Get
        '    Set(ByVal Value As Integer)
        '        m_intWidth = Value
        '    End Set
        'End Property

#End Region

        ''' --- FileForRecordStatus ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Returns the primary file object.
        ''' </summary>
        ''' <remarks>AlteredRecord, DeletedRecord and NewRecord uses m_bfoFileForRecordStatus 
        ''' to return the primary file unless it is changed with the SET ASSUMED (Which we don't 
        ''' support at present) statement. If there is no assumed record-structure, the status is
        ''' the same as that of the current record-structure, that gets set in GetData.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property FileForRecordStatus() As BaseFileObject
            Get
                If Me.PrimaryFileObject Is Nothing Then
                    Return m_bfoFileForRecordStatus
                Else
                    Return Me.PrimaryFileObject
                End If
            End Get

            Set(ByVal Value As BaseFileObject)
                If Not Me.m_bfoFileForRecordStatus Is Nothing Then
                    m_bfoFileForRecordStatus.HasLastGetData = False
                End If
                m_bfoFileForRecordStatus = Value
            End Set
        End Property

        ''' --- PrimaryFileObject --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PrimaryFileObject.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public ReadOnly Property PrimaryFileObject() As BaseFileObject
            Get
                Return m_bfoPrimaryFile
            End Get
        End Property

        ''' --- AccessOk -----------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Indicates whether the last retrieval succeeded or failed.
        ''' </summary>
        ''' <remarks>AccessOK will return True if the last retrieval succeeded, and False if it failed.  
        ''' This property relates to a session and not to a specific screen, meaning that if the last 
        ''' retrieval was on another screen, and this property is referenced in the current screen, 
        ''' the value returned will be based on that retrieval.  
        ''' <note>
        ''' This property is usually used while retrieving records optionally, and is used to determine 
        ''' whether records were found.
        ''' </note>
        ''' </remarks>
        ''' <example>
        ''' fleEMPLOYEE.GetData(GetDataOptions.IsOptional) <br/>
        ''' If AccessOk Then <br/>
        '''     T_EMP_EXISTS.Value = "Y"
        ''' End If
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property AccessOk() As Boolean
            Get
                'The ACCESSOK condition relates to a session and not to a specific screen.
                Return blnAccessOk
            End Get
            Set(value As Boolean)
                blnAccessOk = value
            End Set
        End Property

        ''' --- PaginationType -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PaginationType.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property PaginationType() As PaginationTypes
            Get
                Return objPaginationType
            End Get
            Set(ByVal Value As PaginationTypes)
                objPaginationType = Value
            End Set
        End Property

        ''' --- PushMessage -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PushMessage.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property PushMessage() As String
            Get
                Return m_strPushMessage
            End Get
            Set(ByVal Value As String)
                m_strPushMessage = Value
            End Set
        End Property

        ''' --- PushStack -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' Used to retrieve the procedures being called by the Push verb.
        ''' This will be used to determine if the PostCommand should be run
        ''' or executed on a PushPostCommands stack to ensure they are run after
        ''' the Push procedures have completed.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend ReadOnly Property PushStack() As String
            Get
                Return m_strPush
            End Get
        End Property

        ''' --- PushPostCommandStack -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' Used to retrieve the PostCommands called but not executed due to a Push
        ''' verb that is still active.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend ReadOnly Property PushPostCommandStack() As String
            Get
                Return m_strPushPostCommand
            End Get
        End Property



        ''' --- DisplayToolbar --------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Indicates whether Toolbar should be visible on this screen or not.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Property DisplayToolbar() As Boolean
            Get
                Return m_blnDisplayToolbar
            End Get
            Set(ByVal Value As Boolean)
                m_blnDisplayToolbar = Value
            End Set
        End Property

        ''' --- IsFlickerFree --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Use XMLHTTP to send data back and forth without page flicker.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property IsFlickerFree() As Microsoft.VisualBasic.TriState
            Get
                If m_blnIsFlickerFree = TriState.UseDefault Then
                    If ReadIsFlickerFree() Then
                        Return TriState.True
                    Else
                        Return TriState.False
                    End If
                End If
                Return m_blnIsFlickerFree
            End Get
            Set(ByVal Value As Microsoft.VisualBasic.TriState)
                m_blnIsFlickerFree = Value
            End Set
        End Property

        <Browsable(False),
       EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property HasChanged() As Hashtable
            Get
                Return htHasChanged
            End Get
            Set(ByVal Value As Hashtable)
                htHasChanged = Value
            End Set
        End Property
#End Region

#Region "Methods"

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub ToggleMenu()
            If blHideMenu Then
                blHideMenu = False
            Else
                blHideMenu = True
            End If
        End Sub
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Private Sub MultiAccept(ByVal key As String, ByVal value As String)

            If IsNothing(hsMultiAccept) Then hsMultiAccept = New Hashtable

            If hsMultiAccept.Contains(key & m_intAcceptSequence) Then
                hsMultiAccept.Item(key & m_intAcceptSequence) = value
            Else
                hsMultiAccept.Add(key & m_intAcceptSequence, value)
            End If




        End Sub

        Private Function GetMultiAccept(ByVal key As String) As String


            If IsNothing(hsMultiAccept) Then Return ""

            If hsMultiAccept.Contains(key & m_intAcceptSequence) Then
                Return hsMultiAccept.Item(key & m_intAcceptSequence)
            End If

            Return ""

        End Function



        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub EntryCommand()

            Push(PushTypes.Entry)

        End Sub


        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub FindCommand()

            Push(PushTypes.Find)

        End Sub


        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub UpdateCommand()



            ' Call the PreUpdate procedure.

            Try
                PreUpdate()
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try



            ' Call the Update procedure.  

            Try
                Update()
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try

            ' Commit the default transaction (TRANS_UPDATE).

            Try
                TRANS_UPDATE(TransactionMethods.Commit)
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try


            ' Call the PostUpdate procedure.
            Try
                PostUpdate()
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try

            'Save The Recieving list after the Update

            Try
                SaveParamsReceived()
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try

            ' Commit the default transaction (TRANS_UPDATE).

            Try
                TRANS_UPDATE(TransactionMethods.Commit)
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try

            If Me.HasGrid AndAlso Not NavigationType = NavigationTypes.Submit Then
                m_blnShowGridFromUpdate = True
                RaisePrepareGridControlsForDisplay(True)
                m_blnShowGridFromUpdate = False
            End If

            ' Since we called the Update, put the screen in Change mode.
            If Mode = PageModeTypes.Find OrElse Mode = PageModeTypes.Entry OrElse Mode = PageModeTypes.Correct Then
                Mode = PageModeTypes.Change
            End If

            m_blnUpdateCmdCalled = True

        End Sub


        Public Sub ReplaceContent(ByVal strid As String)
            If m_strReplaceContent.IndexOf("~" & strid & "~") = -1 AndAlso Not m_strReplaceContent.EndsWith("~" & strid) AndAlso Not m_strReplaceContent.StartsWith(strid & "~") Then
                If m_strReplaceContent <> "" Then m_strReplaceContent = m_strReplaceContent & "~"
                m_strReplaceContent = m_strReplaceContent & strid
            End If
        End Sub



        ''' --- CallPreDisplayFormatting -------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CallPreDisplayFormatting.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Sub CallPreDisplayFormatting()

            m_blnIsInDisplayPreDisplayFormatting = True

            Try
                PreDisplayFormatting()
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try
            m_blnIsInDisplayPreDisplayFormatting = False

        End Sub

        ''' --- CallDisplayFormatting -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CallDisplayFormatting.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Sub CallDisplayFormatting()

            m_blnIsInDisplayPreDisplayFormatting = True
            DisplayFormatting()
            m_blnIsInDisplayPreDisplayFormatting = False

        End Sub

        ''' <summary>
        ''' 	Places one or more commands on the screen's pending buffer.
        ''' </summary>
        ''' <example>
        ''' Push(PushTypes.Find)
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Sub Push(ByVal Name As PushTypes)

            Push(Name.ToString)

        End Sub

        ''' --- Push ---------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Places one or more commands on the screen's pending buffer.
        ''' </summary>
        ''' <param name="Designer">The designer procedure to place on the screen's pending buffer.</param>
        ''' <remarks>
        '''  This method puts one or more commands on the pending buffer.  Once the
        ''' user has finished executing a specific procedure, the pending buffer is checked
        ''' for the commands to execute.
        ''' <note>
        ''' The Push method has a First In First Out configuration.  The following will be executed as follows: <br/>
        ''' Push(PushTypes.NextRecord)<br/>
        ''' Push(PushTypes.Find)<br/>
        ''' <br/>
        ''' In the example listed above, the Find will be executed first, then the NextRecord command.
        ''' </note>
        ''' </remarks>
        ''' <example>
        ''' Push(dsrDesigner_BAT)
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Sub Push(ByVal Designer As Designer)

            Push(Designer.Name)

        End Sub

        ''' --- Push ---------------------------------------------------------------
        ''' <exclude/>
        ''' <summary>
        ''' 	Places one or more commands on the screen's pending buffer.
        ''' </summary>
        ''' <param name="Name"></param>
        ''' <example>
        ''' Push(dsrDesigner_BAT)
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Sub Push(ByVal Name As String)

            Dim strSeparator As String = ","
            If m_strPush.Length = 0 Then strSeparator = String.Empty
            m_strPush = Name + strSeparator + m_strPush

        End Sub


        ''' <summary>
        ''' 	Places one or more commands on the screen's pending buffer.
        ''' </summary>
        ''' <param name="Name">The designer procedures to place on the screen's pending buffer.</param>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Sub Push(ByVal ParamArray Name() As Designer)

            Dim intCount As Integer
            Dim strSeparator As String = ","
            For intCount = 0 To UBound(Name)
                If m_strPush.Length = 0 Then
                    m_strPush = m_strPush + Name(intCount).Name
                Else
                    m_strPush = m_strPush + strSeparator + Name(intCount).Name
                End If
            Next

        End Sub


        ''' <summary>
        ''' 	Places one or more commands on the screen's pending buffer.
        ''' </summary>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Sub Push(ByVal ParamArray Name() As PushTypes)

            Dim intCount As Integer
            Dim strSeparator As String = ","
            For intCount = 0 To UBound(Name)
                If m_strPush.Length = 0 Then
                    m_strPush = m_strPush + Name(intCount).ToString
                Else
                    m_strPush = m_strPush + strSeparator + Name(intCount).ToString
                End If
            Next

        End Sub

        ''' --- HasPendingPush -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of HasPendingPush.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function HasPendingPush() As Boolean

            If m_strPush.Length > 0 Then
                Return True
            Else
                If m_strPush.Length > 0 Then
                    Return True
                Else
                    Return False
                End If
            End If

        End Function

        ''' --- HasPendingPushPostCommand -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of HasPendingPushPostCommand.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function HasPendingPushPostCommand() As Boolean

            If m_strPushPostCommand.Length > 0 Then
                Return True
            Else
                If m_strPushPostCommand.Length > 0 Then
                    Return True
                Else
                    Return False
                End If
            End If

        End Function

        ''' --- PushPostCommand ---------------------------------------------------
        ''' <exclude/>
        ''' <summary>
        ''' Used to store the PostCommands if there is currently a Push verb 
        ''' active.  This ensures that the Push verbs complete before the PostCommand
        ''' items are executed.
        ''' </summary>
        ''' <param name="Name"></param>
        ''' <example>
        ''' PushPostCommand("Designer_BAT")
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Sub PushPostCommand(ByVal Name As String)

            Dim strSeparator As String = ","
            If m_strPushPostCommand.Length = 0 Then strSeparator = String.Empty
            m_strPushPostCommand = Name + strSeparator + m_strPushPostCommand

        End Sub

        ' Used by the PUSH verb to post back the grid specific options.
        ''' --- ReturnGridControlId ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ReturnGridControlId.
        ''' </summary>
        ''' <param name="Name"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function ReturnGridControlId(ByVal Name As String) As String

            Dim strControlId As String = String.Empty
            If ScreenType <> ScreenTypes.Grid AndAlso ScreenType <> ScreenTypes.Composite Then
                strControlId = String.Empty
            Else
                RaiseEvent GetControlId(Name, strControlId)
            End If
            Return strControlId

        End Function

        ''' --- GeneratePushVerbScript ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GeneratePushVerbScript.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub GeneratePushVerbScript()

            Dim strCurrentPushProcedure As String
            Dim strEventArgument As String = String.Empty
            Dim blnClientSideProcedure As Boolean = False
            Dim strScript As StringBuilder = New StringBuilder("<script defer id=""scriptPush"" Language=""javascript"">").Append(vbNewLine)

            ' Determine which verb to execute first if we have multiple push verbs in the list.
            If m_strPush.IndexOf(",") > 0 Then
                strCurrentPushProcedure = Split(m_strPush, ",")(0)
                m_strPush = m_strPush.Replace(strCurrentPushProcedure + ",", "")

            Else
                strCurrentPushProcedure = m_strPush

            End If

            ' Generate the appropriate procedure to call.
            ' NOTE: Designer procedures (including PUSH ID) use the actual name passed in
            '       ie. dsrDesigner_01
            Select Case strCurrentPushProcedure
                Case PushTypes.Find.ToString
                    strCurrentPushProcedure = "Toolbar1$ImageFind"
                    strEventArgument = "PUSH"
                Case PushTypes.NextRecord.ToString
                    strCurrentPushProcedure = "Toolbar1$ImageNext2"
                Case PushTypes.NextData.ToString
                    strCurrentPushProcedure = ReturnGridControlId(strCurrentPushProcedure)
                    If strCurrentPushProcedure.Equals(String.Empty) Then
                        strCurrentPushProcedure = "Toolbar1$ImageNext2"
                        strEventArgument = String.Empty
                    Else
                        strEventArgument = "Pagination" + strCurrentPushProcedure.Substring(strCurrentPushProcedure.IndexOf("$lnk") + 4) + "~Page"
                    End If
                Case PushTypes.FirstRecord.ToString
                    strCurrentPushProcedure = "Toolbar1$ImageFirst2"
                Case PushTypes.PreviousData.ToString
                    strCurrentPushProcedure = ReturnGridControlId(strCurrentPushProcedure)
                    If strCurrentPushProcedure.Equals(String.Empty) Then
                        strCurrentPushProcedure = "Toolbar1$ImagePrevious2"
                        strEventArgument = String.Empty
                    Else
                        strEventArgument = "Pagination" + strCurrentPushProcedure.Substring(strCurrentPushProcedure.IndexOf("$lnk") + 4) + "~Page"
                    End If
                Case PushTypes.PreviousRecord.ToString
                    strCurrentPushProcedure = "Toolbar1$ImagePrevious2"
                Case PushTypes.LastRecord.ToString
                    strCurrentPushProcedure = "Toolbar1$ImageLast2"
                Case PushTypes.Entry.ToString
                    strCurrentPushProcedure = "Toolbar1$ImageAdd"
                Case PushTypes.Delete.ToString
                    strCurrentPushProcedure = "Toolbar1$ImageDelete"
                Case PushTypes.Update.ToString
                    strCurrentPushProcedure = "Toolbar1$ImageSubmit"
                Case PushTypes.Append.ToString
                    blnPUSHAPPEND = True
                    strCurrentPushProcedure = ReturnGridControlId(strCurrentPushProcedure)
                    If strCurrentPushProcedure = "" Then
                        strCurrentPushProcedure = "Toolbar1$ImageAdd"
                    End If
                Case PushTypes.Return.ToString
                    strCurrentPushProcedure = "return ToolbarClick('Toolbar1$ImageExit','CONTINUE');"
                    blnClientSideProcedure = True
                Case PushTypes.Return_to_stop.ToString
                    ReturnStopScreen = True
                    RunscreenReturnToStop = Me.FormName
                    strCurrentPushProcedure = "return ToolbarClick('Toolbar1$ImageExit','CONTINUE');"
                    blnClientSideProcedure = True
            End Select

            ' Generate the ONLOAD script that will post back the PUSH event.
            With strScript
                If PushMessage.Length > 0 Then
                    .Append("var timeOutId;").Append(vbNewLine)
                End If
                .Append("function Push()").Append(vbNewLine)
                .Append("{").Append(vbNewLine)

                'Check if we have some messages
                Dim colMessages As ArrayList = Me.GetMessages
                Dim NoOfMgs As Integer = colMessages.Count
                If NoOfMgs > 0 Then
                    Dim Message As stcMessage
                    Dim i As Integer
                    Dim m_MsgText As String = ""

                    If PushMessage.Length = 0 Then
                        'Generate an alert if there is at least one non IM message (m_IsNotIMMessage = True)
                        'Default for m_IsNotIMMessage is NotSet
                        If m_IsNotIMMessage = BooleanTypes.True Then
                            .Append("alert('")
                            'loop through the messages
                            For i = 1 To NoOfMgs
                                Message = colMessages.Item(i)
                                .Append(Message.Text.Replace(vbNewLine, "\n")).Append("\n")
                                If i < NoOfMgs Then .Append("\n")
                            Next i
                            .Append("')").Append(vbNewLine)
                            m_colMessages.Clear()
                        End If
                    End If
                End If

                If blnClientSideProcedure Then
                    .Append("    ").Append(strCurrentPushProcedure).Append(vbNewLine)
                Else
                    If PushMessage.Length > 0 Then
                        .Append("    clearTimeout(timeOutId);").Append(vbNewLine)
                    End If
                    .Append("    __doPostBack('").Append(strCurrentPushProcedure).Append("','").Append(strEventArgument).Append("');").Append(vbNewLine)
                    If PushMessage.Length > 0 OrElse strCurrentPushProcedure.IndexOf("Toolbar1$") >= 0 Then
                        m_strPushProcedure = strCurrentPushProcedure
                    End If
                End If
                .Append("}").Append(vbNewLine)
                .Append("</script>").Append(vbNewLine)
            End With

            'CoreBodyTag.Attributes.Remove("onLoad")
            'Page.ClientScript.RegisterClientScriptBlock(Me.GetType(), "Push", strScript.ToString)

            'If PushMessage.Length > 0 Then
            '    CoreBodyTag.Attributes.Add("onload", " javascript:Pageunload(); timeOutId = setTimeout('return Push();',500);")
            'Else
            '    CoreBodyTag.Attributes.Add("onload", " javascript:Pageunload(); return Push();")
            'End If

        End Sub

        ''' --- GeneratePushPostCommandScript ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GeneratePushPostCommandScript.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub GeneratePushPostCommandScript()

            Dim strCurrentPushPostCmd As String
            Dim strEventArgument As String = String.Empty
            Dim blnClientSideProcedure As Boolean = False
            Dim strScript As StringBuilder = New StringBuilder("<script defer id=""scriptPushPostCmd"" Language=""javascript"">").Append(vbNewLine)

            ' Determine which verb to execute first if we have multiple push verbs in the list.
            If m_strPushPostCommand.IndexOf(",") > 0 Then
                strCurrentPushPostCmd = Split(m_strPushPostCommand, ",")(0)
                m_strPushPostCommand = m_strPushPostCommand.Replace(strCurrentPushPostCmd + ",", "")

            Else
                strCurrentPushPostCmd = m_strPushPostCommand

            End If
            strEventArgument = "PostCommand"

            ' Generate the ONLOAD script that will post back the PUSH event.
            With strScript
                If PushMessage.Length > 0 Then
                    .Append("var timeOutId;").Append(vbNewLine)
                End If
                .Append("function PushPostCommand()").Append(vbNewLine)
                .Append("{").Append(vbNewLine)

                'Check if we have some messages
                Dim colMessages As ArrayList = Me.GetMessages
                Dim NoOfMgs As Integer = colMessages.Count
                If NoOfMgs > 0 Then
                    Dim Message As stcMessage
                    Dim i As Integer
                    Dim m_MsgText As String = ""

                    If PushMessage.Length = 0 Then
                        'Generate an alert if there is at least one non IM message (m_IsNotIMMessage = True)
                        'Default for m_IsNotIMMessage is NotSet
                        If m_IsNotIMMessage = BooleanTypes.True Then
                            .Append("alert('")
                            'loop through the messages
                            For i = 1 To NoOfMgs
                                Message = colMessages.Item(i)
                                .Append(Message.Text.Replace(vbNewLine, "\n")).Append("\n")
                                If i < NoOfMgs Then .Append("\n")
                            Next i
                            .Append("')").Append(vbNewLine)
                            m_colMessages.Clear()
                        End If
                    End If
                End If

                If blnClientSideProcedure Then
                    .Append("    ").Append(strCurrentPushPostCmd).Append(vbNewLine)
                Else
                    If PushMessage.Length > 0 Then
                        .Append("    clearTimeout(timeOutId);").Append(vbNewLine)
                    End If
                    .Append("    __doPostBack('").Append(strCurrentPushPostCmd).Append("','").Append(strEventArgument).Append("');").Append(vbNewLine)
                    If PushMessage.Length > 0 Then
                        m_strPushProcedure = strCurrentPushPostCmd
                    End If
                End If
                .Append("}").Append(vbNewLine)
                .Append("</script>").Append(vbNewLine)
            End With

            'CoreBodyTag.Attributes.Remove("onLoad")
            'Page.ClientScript.RegisterClientScriptBlock(Me.GetType(), "PushPostCmd", strScript.ToString)

            'If PushMessage.Length > 0 Then
            '    CoreBodyTag.Attributes.Add("onload", " javascript:Pageunload(); timeOutId = setTimeout('return PushPostCommand();',500);")
            'Else
            '    CoreBodyTag.Attributes.Add("onload", " javascript:Pageunload(); return PushPostCommand();")
            'End If

        End Sub

        ''' --- ResetTabIndex ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ResetTabIndex.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Function ResetTabIndex() As Boolean

            'If Not ChangedSelectedTab AndAlso (Request("__EVENTTARGET") = Nothing _
            'OrElse (Request("__EVENTTARGET").ToString = "Toolbar1$ImageFind" _
            'Or Request("__EVENTTARGET").ToString = "Toolbar1$ImageAdd" _
            'Or Request("__EVENTTARGET").ToString = "Toolbar1$ImageCancel" _
            'Or Request("__EVENTTARGET").ToString = "Toolbar1$ImageSubmit" _
            'Or Request("__EVENTTARGET").ToString = "Toolbar1$ImageNext" _
            'Or Request("__EVENTTARGET").ToString = "Toolbar1$ImageNext2" _
            'Or Request("__EVENTTARGET").ToString = "Toolbar1$ImageFirst" _
            'Or Request("__EVENTTARGET").ToString = "Toolbar1$ImageFirst2" _
            'Or Request("__EVENTTARGET").ToString = "Toolbar1$ImageLast" _
            'Or Request("__EVENTTARGET").ToString = "Toolbar1$ImageLast2" _
            'Or Request("__EVENTTARGET").ToString = "Toolbar1$ImagePrevious" _
            'Or Request("__EVENTTARGET").ToString = "Toolbar1$ImagePrevious2")) Then
            '    Return True
            'Else
            '    Return False
            'End If
            Return False
        End Function

        ' This method removes the run screen flags for a specific key when moving
        ' to a previous control in the ACCEPT, REQUEST, PROMPT sequence.
        ''' --- RemoveRunScreens ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RemoveRunScreens.
        ''' </summary>
        ''' <param name="Key"></param>
        ''' <param name="Sequence"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub RemoveRunScreens(ByVal Key As String, ByRef Sequence As Integer)

            If Not m_htRunFlag Is Nothing AndAlso m_htRunFlag.ContainsKey(Key) Then
                If Sequence >= 1 Then
                    m_htRunFlag.Item(Key) = m_htRunFlag.Item(Key).ToString.Substring(0, Sequence)
                Else
                    m_htRunFlag.Item(Key) = String.Empty
                End If
            End If

        End Sub

        ' This method determines when the user moves to a previous control in the
        ' ACCEPT, REQUEST, PROMPT sequence and updates the flag appropriately.
        ''' --- MoveToPreviousControl ----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of MoveToPreviousControl.
        ''' </summary>
        ''' <param name="FieldName"></param>
        ''' <param name="Flag"></param>
        ''' <param name="Sequence"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub MoveToPreviousControl(ByVal Field As Control, ByRef Flag As String, ByVal Sequence As Integer)

            If Not ControlHasFocus Is Nothing AndAlso Not ControlHadFocus Is Nothing AndAlso Field.Name = DirectCast(ControlHasFocus, Control).Name AndAlso DirectCast(ControlHasFocus, Control).TabIndex < DirectCast(ControlHadFocus, Control).TabIndex Then
                If Sequence > Flag.Length Then
                    Flag = Flag.PadRight(Sequence - 1, "Y")
                Else
                    Flag = Flag.Substring(0, Sequence - 1)
                End If
                RemoveRunScreens(cPROCEDURE, m_intProcedureRunScreenSequence)
            End If

        End Sub

        ' This function determines whether this field can be skipped with regards to setting
        ' focus to it.  This will depend on whether the user selected another field that is 
        ' later in the sequence or whether the user did a SKIP ALL.
        ''' --- SkipFocusOnThisField -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SkipFocusOnThisField.
        ''' </summary>
        ''' <param name="FieldName"></param>
        ''' <param name="ClearHyperlinkEventArgument"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function SkipFocusOnThisField(ByVal Field As Control) As Boolean

            Dim retVal As Boolean = False
            Dim isreadonly As Boolean = False
            Dim isfieldreadonly As Boolean = False

            If IsNothing(ControlHasFocus) Then
                Return False
            End If

            If (ControlHasFocus.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.TextBox") Then
                isreadonly = DirectCast(ControlHasFocus, TextBox).IsReadonly OrElse Not DirectCast(ControlHasFocus, TextBox).IsEnabled
            End If
            If (ControlHasFocus.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.ComboBox") Then
                isreadonly = DirectCast(ControlHasFocus, ComboBox).IsReadOnly OrElse Not DirectCast(ControlHasFocus, ComboBox).IsEnabled
            End If
            If (ControlHasFocus.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.DateControl") Then
                isreadonly = Not DirectCast(ControlHasFocus, DateControl).IsEnabled
            End If

            If Not ControlHasFocus Is Nothing _
                AndAlso Field.Name <> DirectCast(ControlHasFocus, Control).Name _
                AndAlso (DirectCast(ControlHasFocus, Control).TabIndex > Field.TabIndex AndAlso Not isreadonly) Then
                retVal = True
            End If



            If Not ControlHasFocus Is Nothing AndAlso ControlHasFocus.GetType().ToString = "Core.Windows.UI.Core.Windows.UI.DataList" Then
                retVal = False
            ElseIf Not ControlHasFocus Is Nothing AndAlso ControlHasFocus.GetType().ToString = "Core.Windows.UI.Core.Windows.UI.Designer" Then
                retVal = False
            ElseIf Not ControlHadFocus Is Nothing AndAlso ControlHadFocus.GetType().ToString = "Core.Windows.UI.Core.Windows.UI.GridButton" Then
                retVal = False
            ElseIf Not ControlHasFocus Is Nothing AndAlso ControlHasFocus.GetType().ToString = "System.Windows.Controls.Button" AndAlso IsNothing(RunningDesigner) Then
                retVal = False
            ElseIf Not ControlHasFocus Is Nothing AndAlso ControlHasFocus.GetType().ToString = "System.Windows.Controls.ComboBox" Then
                retVal = False
            ElseIf Not ControlHasFocus Is Nothing AndAlso ControlHasFocus.GetType().ToString = "Core.Windows.UI.Core.Windows.UI.CoreTreeViewItem" Then
                retVal = False
            ElseIf Not ControlHasFocus Is Nothing AndAlso ControlHasFocus.GetType().ToString = "System.Windows.Controls.Button" Then
                retVal = False
                If Not ControlHadFocus Is Nothing _
              AndAlso Field.Name <> DirectCast(ControlHadFocus, Control).Name _
              AndAlso (DirectCast(ControlHadFocus, Control).TabIndex > Field.TabIndex AndAlso Not isreadonly) Then
                    retVal = True
                End If
            End If

            If (Field.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.TextBox") Then
                isfieldreadonly = DirectCast(Field, TextBox).IsReadonly OrElse Not DirectCast(Field, TextBox).IsEnabled
            End If
            If (Field.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.ComboBox") Then
                isfieldreadonly = DirectCast(Field, ComboBox).IsReadOnly OrElse Not DirectCast(Field, ComboBox).IsEnabled
            End If
            If (Field.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.DateControl") Then
                isfieldreadonly = Not DirectCast(Field, DateControl).IsEnabled
            End If

            If isfieldreadonly Then
                retVal = False
            End If

            If RequireTerminate Then
                SkipAll = True
            End If


            If SkipAll Then
                retVal = True
            End If

            Return retVal

        End Function

        Private Function SetFocusNextObject(ByVal Field As Control)

            Dim controls As Control() = Me.Descendents



        End Function

        ''' --- RequireSkipAll -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RequireSkipAll.
        ''' </summary>
        ''' <param name="EventArgument"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function RequireSkipAll(ByVal EventArgument As String) As Boolean
            'Skip all remaining fields in the designer if
            '- user clicked on Submit while executing a current designer
            '- user clicked on DataList button in Grid while executing the designer

            If (EventArgument = String.Empty AndAlso ((m_strRequestedTarget).Equals("Toolbar1$ImageSubmit"))) AndAlso Me.IsExecutingAppend Then
                'In case of Submit, SkipAll and Terminate Append
                m_blnSkipAllAndTerminateAppend = True
            End If

            Return (Me.DataListButtonClicked AndAlso (Not Me.EventTarget.Replace("$", "_").Equals(Me.m_strRequestedTarget)) AndAlso (Not Me.EnableNumberedDesigners)) OrElse m_strPendingBuffer.Equals("SKIPALL") OrElse EventArgument.Equals("SKIPALL") OrElse (EventArgument = String.Empty AndAlso ((m_strRequestedTarget).Equals("Toolbar1$ImageSubmit")))
        End Function

        ''' --- DataListButtonClicked ----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of DataListButtonClicked.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function DataListButtonClicked() As Boolean
            'This function checks the requested Button
            If (Me.ScreenType = ScreenTypes.Grid OrElse Me.ScreenType = ScreenTypes.Composite) AndAlso (m_strRequestedTarget <> String.Empty) Then
                With m_strRequestedTarget
                    Return .EndsWith("btnGridRowEdit") OrElse .EndsWith("btnGridRowDelete") OrElse .EndsWith("btnGridRowNew")
                End With
            End If
            Return False
        End Function

        ''' --- SetAcceptControl ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SetAcceptControl.
        ''' </summary>
        ''' <param name="fldField"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub SetAcceptControl(ByRef fldField As TextBox)
            If Not fldField Is Nothing Then 'DependancyGrid001/2: If we ever need to change this condition, also change condition marked as "DependancyGrid001"
                ' Turn off InFieldValidation and store the control name.
                m_strUniqueControlId = fldField.RenderedID
                UniqueControl = fldField
                ' Create the PostBack event.
                fldField.SetAcceptRequestPrompt = True
                'CoreDebugLog("SetAcceptControl", m_strUniqueControlId)
                'fldField.Display = BehaviorTypes.NotSet
                ThrowCustomApplicationException(cAcceptRequestPromptException)
            End If

        End Sub


        Private Sub SetAcceptControl(ByRef fldField As ComboBox)
            If Not fldField Is Nothing Then 'DependancyGrid001/2: If we ever need to change this condition, also change condition marked as "DependancyGrid001"
                ' Turn off InFieldValidation and store the control name.
                m_strUniqueControlId = fldField.RenderedID
                UniqueControl = fldField
                ' Create the PostBack event.
                fldField.SetAcceptRequestPrompt = True
                'CoreDebugLog("SetAcceptControl", m_strUniqueControlId)                
                ThrowCustomApplicationException(cAcceptRequestPromptException)
            End If

        End Sub

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub SetAcceptControl(ByRef fldField As Object)

            If Not fldField Is Nothing Then 'DependancyGrid001/2: If we ever need to change this condition, also change condition marked as "DependancyGrid001"
                Select Case fldField.GetType.ToString()
                    Case "Core.Windows.UI.Core.Windows.UI.TextBox"
                        SetAcceptControl(DirectCast(fldField, TextBox))
                    Case "Core.Windows.UI.Core.Windows.UI.DateControl"
                        SetAcceptControl(DirectCast(fldField, DateControl))
                    Case "Core.Windows.UI.Core.Windows.UI.ComboBox"
                        SetAcceptControl(DirectCast(fldField, ComboBox))
                End Select
            End If

        End Sub

        ''' --- SetAcceptControl ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SetAcceptControl.
        ''' </summary>
        ''' <param name="fldField"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub SetAcceptControl(ByRef fldField As DateControl)

            If Not fldField Is Nothing Then 'DependancyGrid001/2: If we ever need to change this condition, also change condition marked as "DependancyGrid001"
                ' Turn off InFieldValidation and store the control name.
                m_strUniqueControlId = fldField.RenderedID
                UniqueControl = fldField
                ' Create the PostBack event.
                fldField.SetAcceptRequestPrompt = True
                'CoreDebugLog("SetAcceptControl", m_strUniqueControlId)
                ThrowCustomApplicationException(cAcceptRequestPromptException)
            End If

        End Sub

        ' Handles the Accept or Request exception.
        ''' --- HandleAcceptRequestPromptException ---------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of HandleAcceptRequestPromptException.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub HandleAcceptRequestPromptException()

            'Dim strOldPageBodyOnloadTag As String = CoreBodyTag.Attributes("onload")

            ''Page.ClientScript.RegisterClientScriptBlock(Me.GetType(),"SetAcceptRequestPrompt", strScript.ToString)
            'If Not m_strPopupComboName Is Nothing AndAlso Not m_strPopupComboName.Equals(String.Empty) Then
            '    CoreBodyTag.Attributes.Add("onload", "SetAcceptRequestPrompt('" + m_strUniqueControlId + "', true);" & Replace(strOldPageBodyOnloadTag, "onLoadSetFocus();", ""))
            'Else
            '    CoreBodyTag.Attributes.Add("onload", "SetAcceptRequestPrompt('" + m_strUniqueControlId + "', false);" & Replace(strOldPageBodyOnloadTag, "onLoadSetFocus();", ""))
            'End If

            '' Add the following for the PostBackAcceptRequestPrompt.
            '' This is done so that when the user is on the last control (in AcceptProcessing), 
            '' and presses the tab key, we submit the form to continue the AcceptProcessing.
            'If Not CoreBodyTag.Attributes("onClick") Is Nothing AndAlso CoreBodyTag.Attributes("onClick").IndexOf("document.forms(0).hidPendingBuffer.value = 'BodyTagClicked';") = -1 Then
            '    CoreBodyTag.Attributes.Add("onClick", CoreBodyTag.Attributes("onClick") + "alert(document.forms(0).hidPendingBuffer.value); document.forms(0).hidPendingBuffer.value = 'BodyTagClicked';")
            'End If

            'm_strInitScript.Append("  strPBARPRequestedTarget='").Append(m_strRequestedTarget).Append("';").Append(vbNewLine)
            'm_strInitScript.Append("  blnPBARPHasError=").Append(HasError.ToString.ToLower).Append(";").Append(vbNewLine)
            'm_strInitScript.Append("  strPBARPEventTarget='").Append(EventTarget).Append("';").Append(vbNewLine)
            'm_strInitScript.Append("  strPBARPEventArgument='").Append(EventArgument).Append("';").Append(vbNewLine)

            '' Indicate the field that receives the focus.  This will be used in the event
            '' that a hyperlink is clicked for a previous control in the sequence.


            ' Accept processing.
            If Me.HasGrid Then
                ' If there is a grid, in case of an error 
                ' we need to display controls as labels in Grid
                ' Please note for non-grid screen it will call following method
                ' however, following method only raises an event
                ' If we ever need to write some logic other than raising
                ' an event, we need to change above if condition 
                RaisePrepareGridControlsForDisplay(True)
            End If

            If Not IsNothing(UniqueControl) Then

                Select Case UniqueControl.GetType.ToString()
                    Case "Core.Windows.UI.Core.Windows.UI.TextBox"
                        SetFocusField(DirectCast(UniqueControl, TextBox).Name)
                        RaiseEvent DisplayControl()
                        ControlHasFocus = DirectCast(UniqueControl, TextBox)
                        DirectCast(UniqueControl, TextBox).Focus()
                        DirectCast(UniqueControl, TextBox).SelectAll()
                    Case "Core.Windows.UI.Core.Windows.UI.DateControl"
                        SetFocusField(DirectCast(UniqueControl, DateControl).Name)
                        RaiseEvent DisplayControl()
                        DirectCast(UniqueControl, DateControl).Focus()
                        ControlHasFocus = DirectCast(UniqueControl, DateControl)
                    Case "Core.Windows.UI.Core.Windows.UI.ComboBox"
                        SetFocusField(DirectCast(UniqueControl, ComboBox).Name)
                        RaiseEvent DisplayControl()
                        DirectCast(UniqueControl, ComboBox).Focus()
                        ControlHasFocus = DirectCast(UniqueControl, ComboBox)
                End Select
            End If


        End Sub

        ''' --- RetrieveFlagInformation --------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RetrieveFlagInformation.
        ''' </summary>
        ''' <param name="Flag"></param>
        ''' <param name="FlagName"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub RetrieveFlagInformation(ByRef Flag As Hashtable, ByVal FlagName As String)

            'Flag = Session(FormName + "_" + Level.ToString + "_" + FlagName)
            If Flag Is Nothing Then Flag = New Hashtable

        End Sub

        ''' --- RetrieveFlagInformation --------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RetrieveFlagInformation.
        ''' </summary>
        ''' <param name="Flag"></param>
        ''' <param name="FlagName"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub RetrieveFlagInformation(ByRef Flag As String, ByVal FlagName As String)

            'Flag = Session(FormName + "_" + Level.ToString + "_" + FlagName)
            If Flag = Nothing Then Flag = String.Empty

        End Sub

        ''' --- RemoveFlagInformation ----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RemoveFlagInformation.
        ''' </summary>
        ''' <param name="FlagName"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub RemoveFlagInformation(ByVal FlagName As String)

            'Session.Remove(FormName + "_" + Level.ToString + "_" + FlagName)

        End Sub

        ''' --- RetrieveFlags ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RetrieveFlags.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RetrieveFlags()

            RetrieveFlagInformation(m_htFileInfo, "ROWIDCHECKSUM")

            If Me.UseAcceptProcessing Then
                RetrieveFlagInformation(m_htRunFlag, "RUN_FLAG")
                RetrieveFlagInformation(m_htPutFlag, "PUT_FLAG")
                RetrieveFlagInformation(m_htGetFlag, "GET_FLAG")
                RetrieveFlagInformation(m_htUpdateFlag, "UPDATE_FLAG")
                RetrieveFlagInformation(m_strAcceptFlag, "ACCEPT_FLAG")
                RetrieveFlagInformation(m_strFinishAcceptFlag, "FINISH_ACCEPT_FLAG")
                RetrieveFlagInformation(m_strRequestFlag, "REQUEST_FLAG")
                RetrieveFlagInformation(m_strDoExternalFlag, "EXTERNAL_FLAG")
                RetrieveFlagInformation(m_strLookUpFlag, "LOOKUP_FLAG")
                RetrieveFlagInformation(m_strEditFlag, "EDIT_FLAG")
            Else
                RetrieveFlagInformation(m_strRunFlag, "RUN_FLAG")
                RetrieveFlagInformation(m_strUpdateFlag, "UPDATE_FLAG")
                RetrieveFlagInformation(m_strPutFlag, "PUT_FLAG")
                RetrieveFlagInformation(m_strGetFlag, "GET_FLAG")
                RetrieveFlagInformation(m_strLookUpFlag, "LOOKUP_FLAG")
            End If

            'hsFunction = Session(FormName + "_" + Level.ToString + "_Function")
            If IsNothing(hsFunction) Then
                hsFunction = New Hashtable
            End If

        End Sub

        Protected Sub AcceptDesigner(ByRef fldField As TextBox, ID As String)

            Dim LstOcc As Integer = 1
            'If Not ScreenSession("LstOcc_" + ID) Is Nothing Then LstOcc = ScreenSession("LstOcc_" + ID)

            If Occurrence = LstOcc Then
                Accept(fldField)

                ' Increment the value for the next occurrence.
                'ScreenSession("LstOcc_" + ID) = Occurrence + 1

                ' Clear the Function flags.
                hsFunction.Remove(m_intAcceptSequence)
                'Session(FormName + "_" + Level.ToString + "_Function") = hsFunction



                ' Clear the RunScreen and Accept flag information.
                RemoveFlagInformation("RUN_FLAG")
                m_intRunScreenSequence = 0
                RemoveFlagInformation("ACCEPT_FLAG")
                m_intAcceptSequence = 0
                m_strAcceptFlag = ""
            End If

        End Sub

        ''' --- RemoveFlags --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RemoveFlags.
        ''' </summary>
        ''' <param name="SaveState"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RemoveFlags(ByVal SaveState As Boolean)

            RemoveFlagInformation("RUN_FLAG")
            RemoveFlagInformation("VALIDATE")
            RemoveFlagInformation("CLEARVALIDATE")
            RemoveFlagInformation("ROWIDCHECKSUM")
            'Session(FormName + "_" + Level.ToString + "_Function") = Nothing
            'Session(FormName + "_" + Level.ToString + "_NavigationType") = Nothing
            'Session(FormName + "_" + Level.ToString + "_MultiAccept") = Nothing
            m_intRunScreenSequence = 0
            m_intProcedureRunScreenSequence = 0
            m_intFunctionKeySequence = 0
            m_htRunFlag = Nothing

            If Me.UseAcceptProcessing Then
                RemoveFlagInformation("ACCEPT_FLAG")
                RemoveFlagInformation("FINISH_ACCEPT_FLAG")
                RemoveFlagInformation("REQUEST_FLAG")
                RemoveFlagInformation("PUT_FLAG")
                RemoveFlagInformation("GET_FLAG")
                RemoveFlagInformation("EXTERNAL_FLAG")
                RemoveFlagInformation("LOOKUP_FLAG")
                RemoveFlagInformation("UPDATE_FLAG")
                RemoveFlagInformation("EDIT_FLAG")

                m_intAcceptSequence = 0
                m_intRequestSequence = 0
                m_intPutSequence = 0
                m_intDoExternalSequence = 0
                m_intLookUpSequence = 0

                m_strEditFlag = String.Empty
                m_strAcceptFlag = String.Empty
                m_strFinishAcceptFlag = String.Empty
                m_strRequestFlag = String.Empty
                m_strPutFlag = String.Empty
                m_strDoExternalFlag = String.Empty
                m_strLookUpFlag = String.Empty
                m_htPutFlag = Nothing

            End If
        End Sub

        Public Sub ResetSequence()


            m_intRunScreenSequence = 0
            m_intProcedureRunScreenSequence = 0
            m_intFunctionKeySequence = 0

        End Sub

        ''' --- RemoveFlags --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RemoveFlags.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RemoveFlags()
            RemoveFlags(False)
        End Sub

        ''' --- MethodWasExecuted --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of MethodWasExecuted.
        ''' </summary>
        ''' <param name="Flag"></param>
        ''' <param name="Sequence"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function MethodWasExecuted(ByVal Flag As Hashtable, ByVal Sequence As Integer) As Boolean

            Dim strKey As String
            If m_strControlName.Length > 0 Then
                strKey = m_strControlName
            Else
                strKey = cPROCEDURE
            End If

            If Not Flag Is Nothing AndAlso Flag.ContainsKey(strKey) Then
                If Substring(Flag.Item(strKey).ToString, Sequence, 1) = "Y" Then
                    Return True
                Else
                    Return False
                End If
            Else
                Return False
            End If

        End Function

        ''' --- MethodWasExecuted --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of MethodWasExecuted.
        ''' </summary>
        ''' <param name="Flag"></param>
        ''' <param name="Sequence"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function MethodWasExecuted(ByVal Flag As String, ByVal Sequence As Integer) As Boolean

            If Substring(Flag, Sequence, 1) = "Y" Then
                Return True
            Else
                Return False
            End If

        End Function

        ''' --- SetMethodExecutedFlag ----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SetMethodExecutedFlag.
        ''' </summary>
        ''' <param name="Flag"></param>
        ''' <param name="FlagName"></param>
        ''' <param name="Sequence"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub SetMethodExecutedFlag(ByRef Flag As Hashtable, ByVal FlagName As String, ByVal Sequence As Integer)

            Dim strKey As String = String.Empty
            Dim strValue As String = String.Empty
            If m_strControlName.Length > 0 Then
                strKey = m_strControlName
            Else
                strKey = cPROCEDURE
            End If

            ' Set the value in the hashtable.
            If Not Flag Is Nothing AndAlso Flag.ContainsKey(strKey) Then
                Flag.Item(strKey) = Flag.Item(strKey).ToString.PadRight(Sequence - 1).Substring(0, Sequence - 1) + "Y"
            Else
                If Flag Is Nothing Then Flag = New Hashtable
                For i As Integer = 1 To Sequence - 1
                    strValue = strValue & " "
                Next
                Flag.Add(strKey, strValue + "Y")
            End If

            'Session(FormName + "_" + Level.ToString + "_" + FlagName) = Flag

        End Sub
        ''' --- ClearMethodExecutedFlag ----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ClearMethodExecutedFlag.
        ''' </summary>
        ''' <param name="Flag"></param>
        ''' <param name="FlagName"></param>
        ''' <param name="Sequence"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub ClearMethodExecutedFlag(ByRef Flag As Hashtable, ByVal FlagName As String, ByVal Sequence As Integer)

            Dim strKey As String = String.Empty
            Dim strValue As String = String.Empty
            If m_strControlName.Length > 0 Then
                strKey = m_strControlName
            Else
                strKey = cPROCEDURE
            End If

            ' Set the value in the hashtable.
            If Not Flag Is Nothing AndAlso Flag.ContainsKey(strKey) Then
                Flag.Item(strKey) = Flag.Item(strKey).ToString.Substring(0, Sequence - 1) + " "
            Else
                If Flag Is Nothing Then Flag = New Hashtable
                For i As Integer = 1 To Sequence - 1
                    strValue = strValue & " "
                Next
                Flag.Add(strKey, strValue + " ")
            End If

            'Session(FormName + "_" + Level.ToString + "_" + FlagName) = Flag

        End Sub

        ''' --- SetMethodExecutedFlag ----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SetMethodExecutedFlag.
        ''' </summary>
        ''' <param name="Flag"></param>
        ''' <param name="FlagName"></param>
        ''' <param name="Sequence"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub SetMethodExecutedFlag(ByRef Flag As String, ByVal FlagName As String, ByVal Sequence As Integer)

            Flag = Flag.PadRight(Sequence - 1, " ").Substring(0, Sequence - 1) + "Y"
            'Session(FormName + "_" + Level.ToString + "_" + FlagName) = Flag

        End Sub

        ''' --- Put ----------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	PowerHouse PUT verb.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="Reset"></param>
        ''' <param name="PutType"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <example>
        ''' PutData(fleTEST)<br/>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Function PutData(ByRef FileObject As BaseFileObject, Optional ByVal Reset As ResetOptions = ResetOptions.NoReset, Optional ByVal PutType As PutTypes = PutTypes.None, Optional ByVal At As Integer = -1) As Boolean

            Dim blnReturnValue As Boolean
            Dim strFileName As String
            Dim stcFile As stcFileInfo

            m_intPutSequence += 1

            ' Get the file name (either Alias name or Base name).
            If FileObject.AliasName.TrimEnd.Length > 0 Then
                strFileName = FileObject.AliasName
            Else
                strFileName = FileObject.BaseName
            End If


            strFileName &= m_intPutSequence.ToString

            Dim blnMethodWasExecuted As Boolean

            If Me.UseAcceptProcessing Then
                blnMethodWasExecuted = MethodWasExecuted(m_htPutFlag, m_intPutSequence)
            Else
                blnMethodWasExecuted = MethodWasExecuted(m_strPutFlag, m_intPutSequence)
            End If

            If Not blnMethodWasExecuted Then

                ' If the PUT was called with the New, Deleted or NotDeleted option, and
                ' the recordstatus does not match, then don't do anything.
                If FileObject.ContinuePut(PutType) Then
                    FileObject.PutData(CBool(Reset), PutType, At)

                    ' Store the RowId and CheckSum_Value.
                    If m_htFileInfo Is Nothing Then m_htFileInfo = New Hashtable

                    stcFile.RowId = FileObject.RecordLocation
                    If Not FileObject.IsTextFile Then
                        stcFile.CheckSum = FileObject.GetDecimalValue("CHECKSUM_VALUE")
                    End If
                    stcFile.AlteredRecord = FileObject.AlteredRecord
                    stcFile.DeletedRecord = FileObject.DeletedRecord
                    stcFile.NewRecord = FileObject.NewRecord

                    If m_htFileInfo.Contains(strFileName) Then
                        m_htFileInfo.Item(strFileName) = stcFile
                    Else
                        m_htFileInfo.Add(strFileName, stcFile)
                    End If
                    'Session(FormName + "_" + Level.ToString + "_" + "ROWIDCHECKSUM") = m_htFileInfo
                End If

                ' Save the sequence information and set a flag indicating ACCEPT was run.
                If Me.UseAcceptProcessing Then
                    SetMethodExecutedFlag(m_htPutFlag, "PUT_FLAG", m_intPutSequence)
                Else
                    SetMethodExecutedFlag(m_strPutFlag, "PUT_FLAG", m_intPutSequence)
                End If

                blnReturnValue = True
            Else

                ' If the first time the PUT was called with the New, Deleted or NotDeleted option, and
                ' the recordstatus did not match, then don't do anything since nothing was done
                ' the first time.  Otherwise, set the appropriate values.
                If FileObject.ContinuePut(PutType) Then

                    ' Call the Reset option.
                    If CBool(Reset) Then
                        FileObject.CallReset()
                        FileObject.AlteredRecord = False
                        FileObject.DeletedRecord = False
                    Else
                        ' Retrieve the RowId and CheckSum_Value.
                        stcFile = CType(m_htFileInfo.Item(strFileName), stcFileInfo)
                        FileObject.SetValue("ROW_ID") = stcFile.RowId
                        If Not FileObject.IsTextFile Then
                            FileObject.SetValue("CHECKSUM_VALUE") = stcFile.CheckSum
                        End If
                        FileObject.AlteredRecord = stcFile.AlteredRecord
                        FileObject.DeletedRecord = stcFile.DeletedRecord
                        FileObject.NewRecord = stcFile.NewRecord
                        FileObject.AcceptChanges()
                    End If

                End If

                blnReturnValue = True
            End If

            ' Cleanup.
            strFileName = Nothing
            stcFile = Nothing

            Return blnReturnValue

        End Function

        ''' --- Accept -------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Prompts the user for a value.
        ''' </summary>
        ''' <param name="fldField">The field for which the user will be prompted.</param>
        ''' <remarks>
        ''' The Accept method prompts the user for a value, checks and edits this value, stores this value
        ''' in the associated record buffer (the variable or file object related to the field) and then displays the
        ''' formatted value.  
        ''' <note>
        ''' The Accept method performs several processing steps.  They are as follows:<br/>
        '''  1. The user is prompted for input.  <br/>
        '''     If there is a value in the field, the current value is highlighted.<br/>
        '''     The entered value or null value is then assigned to the predefined variable FieldText.<br/>
        '''     If the field is of type Character, then the Upshift or Downshift is applied if specified.<br/>
        '''  2. The Input event associated to this field is then executed if applicable.  <br/>
        '''     This event can be used to change the value of FieldText.<br/>
        '''  3. If the FieldText size is 0, then the m_blnPromptOk member is set to False indicating no value was entered or substituted in the Input event.<br/>
        '''     This value is set to True if the user entered a value or a value was set during the Input event.<br/>
        '''     The rest of this step is ignored and execution resumes at step 8 if the m_blnPromptOK member is set to False and the Required,<br/>
        '''     Duplicate or Default properties are not set.<br/>
        '''     The duplicate buffer is assigned the value of FieldText.<br/>
        '''     Fields of type Numeric are checked for numbers and scaled by the input scale (if scaling is turned on).<br/>
        '''     Date fields are checked for a proper date.<br/>
        '''     The FieldValue predefined variable is then assigned with the numeric value of FieldText if this field<br/>
        '''     is of type Numeric or Date.<br/>
        '''  4. Dictionary editing is performed on FieldText (for fields of type Character) and FieldValue (for fields of type Numeric or Date).<br/>
        '''     This editing is as follows: <br/><br/>
        '''     The value is checked to ensure that it is within the range of possible values (if applicable) as specified in the FieldValues property.<br/>
        '''     The value is checked to ensure that it matches the Pattern as specified in the Pattern property.<br/>
        '''     The LookupOn and LookupNotOn events are initiated to check if the value is found or not found on the specified files.<br/>
        '''     The OldValue function can be used to determine the value in the record buffer of the associated item.<br/>
        '''  5. The Edit event associated to this field is then executed if applicable.  Use the FieldText (Character) or FieldValue (for Numeric and Date fields)<br/>
        '''     predefined items to change the value if necessary.  This value will be re-assigned to the underlying record buffers in the next step.<br/>
        '''  6. The value is assigned to the associated record buffer (the associated variable or file object) and in the duplicate record buffer.<br/>
        '''  7. The Process event associated to this field is executed if applicable.  This event can be used to to perform processing or data manipulation<br/>
        '''     on the changed item.<br/>
        '''  8. The value is retrieved from the associated record buffer for display purposes.  The value is placed in FieldText.  Numeric items are scaled by<br/>
        '''     the output scale (if scaling is turned on) prior to being placed in FieldText and are right justified.  A Date item is placed in FieldText as a number,<br/>
        '''     without the separator.<br/>
        '''  9. The associated Output event is execute if applicable.<br/>
        '''     This event can be used to reformat the FieldText value prior to the final formatting options being applied.
        ''' 10. For Numeric fields, numeric formatting is applied including the application of the Picture property.  Date fields are formatted using the<br/>
        '''     specified date format.  Character fields are formatted under the control of the Picture property.  The value is then displayed in the field.
        ''' </note>
        ''' </remarks>
        ''' <example>Accept(fldEMPLOYEE_EMPLOYEE_NAME)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function Accept(ByRef fldField As TextBox) As Boolean
            Dim blnReturnValue As Boolean

            Try

                m_CurrentField = fldField.RenderedID
                If Me.UseAcceptProcessing Then

                    m_intAcceptSequence += 1
                    If Not IsNothing(hsFunction) Then
                        m_strControlName = fldField.Name
                        If IsFunctionKey AndAlso (m_intPageActionType = PageActionType.ToolbarClick OrElse m_intPageActionType = PageActionType.DesignerClick OrElse m_intPageActionType = PageActionType.DataListButtonClick) AndAlso (m_strAcceptFlag.Length = m_intAcceptSequence) Then
                            m_strAcceptFlag = m_strAcceptFlag.ToString.Substring(0, m_strAcceptFlag.ToString.Length - 1)
                            'Session(FormName + "_" + Level.ToString + "_" + "ACCEPT_FLAG") = m_strAcceptFlag
                            If Not hsFunction.Contains(m_intAcceptSequence & "OCCURS" & Me.Occurrence) Then
                                hsFunction.Add(m_intAcceptSequence & "OCCURS" & Me.Occurrence, New ArrayList)
                            End If

                            FunctionKey(m_CurrentField)

                        ElseIf hsFunction.Contains(m_intAcceptSequence & "OCCURS" & Me.Occurrence) Then
                            FunctionKey(m_CurrentField, False)
                        End If
                    End If
                    MoveToPreviousControl(fldField, m_strAcceptFlag, m_intAcceptSequence)

                    If (Not ControlHadFocus Is Nothing AndAlso ControlHadFocus.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.TextBox" AndAlso DirectCast(ControlHadFocus, TextBox).Name = fldField.Name AndAlso Mode = PageModeTypes.Change) Then
                        SetMethodExecutedFlag(m_strAcceptFlag, "ACCEPT_FLAG", m_intAcceptSequence)
                    End If

                    'If MoveToPreviousControl(fldField.Name) OrElse (Not MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence) AndAlso Not SkipFocusOnThisField(fldField.Name)) Then
                    If Not MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence) AndAlso Not SkipFocusOnThisField(fldField) Then

                        ' Call the onClick event for the textbox if a Popup.
                        'If fldField.PopupHeight > 0 AndAlso m_strPendingBuffer.IndexOf("|M") > -1 Then
                        '    CoreBodyTag.Attributes("onload") = CoreBodyTag.Attributes("onload") + "document.all('" + fldField.RenderedID + "').fireEvent('onclick');"
                        'End If

                        ' Save the sequence information and set a flag indicating ACCEPT was run.
                        SetMethodExecutedFlag(m_strAcceptFlag, "ACCEPT_FLAG", m_intAcceptSequence)

                        SetAcceptControl(fldField)

                    Else
                        Dim blnClearLookup As Boolean = False


                        ' NOTE: This should not have an ANDALSO since we want to clear the EventTarget if a LOOKUP was used.
                        'If MoveToPreviousControl(fldField.Name, True) OrElse (Not MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence)) And SkipFocusOnThisField(fldField.Name, True) Then
                        If Not MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence) And SkipFocusOnThisField(fldField) Then
                            ' Save the sequence information and set a flag indicating ACCEPT was run.
                            SetMethodExecutedFlag(m_strAcceptFlag, "ACCEPT_FLAG", m_intAcceptSequence)

                            ' If we hit a run screen or accept verb, then don't run this again on the 
                            ' postback.  Otherwise the screen doesn't open properly.
                            If blnClearLookup Then
                                RemoveRunScreens(fldField.Name, 0)
                                ' Set to true for now.  This ensures that if we hit a runscreen or accept verb,
                                ' that we don't clear this on the postback.
                                'ScreenSession("CL" & fldField.Name) = True
                            End If
                        End If



                        Dim blnIsInFieldValidation As Boolean = True
                        If m_intAcceptSequence < m_strAcceptFlag.Length Then
                            blnIsInFieldValidation = False
                        End If

                        ' Keep track of the ACCEPT field in case an error occurs.
                        m_fldAcceptField = fldField

                        ' Clear the messages.
                        If Not m_blnInvalidPattern Then m_colMessages = New ArrayList

                        ' Call the VALIDATE.
                        m_strControlName = fldField.Name


                        If m_strAcceptFlag.Length = m_intAcceptSequence Then
                            blnReturnValue = Validate(fldField, ValidateTypes.Accept, blnIsInFieldValidation)
                        End If



                        m_strControlName = String.Empty

                        ' Clear the value since we didn't throw a runscreen/accept exception.
                        'RemoveScreenSession("CL" & fldField.Name)
                        If Not m_htRunFlag Is Nothing AndAlso m_htRunFlag.ContainsKey(cPROCEDURE) Then m_strRunFlag = m_htRunFlag.Item(cPROCEDURE)
                    End If
                Else
                    ' Clear the messages.
                    If Not m_blnInvalidPattern Then m_colMessages = New ArrayList
                End If

                If blnReturnValue Then
                    'When value changes, update the Row Status for the record on grid
                    fldField.RaiseDataChanged()
                    SetMethodExecutedFlag(m_strFinishAcceptFlag, "FINISH_ACCEPT_FLAG", 1)
                End If

                Return blnReturnValue

            Catch ex As CustomApplicationException
                If ex.Message = "Error" Then
                    m_intAcceptSequence = m_intAcceptSequence - 1
                    m_intLookUpSequence = 0
                End If
                Throw ex
            Catch ex As Exception
                Throw ex
            End Try

        End Function

        ''' --- Accept -------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Prompts the user for a value.
        ''' </summary>
        ''' <param name="fldField">The field for which the user will be prompted.</param>
        ''' <remarks>
        ''' The Accept method prompts the user for a value, checks and edits this value, stores this value
        ''' in the associated record buffer (the variable or file object related to the field) and then displays the
        ''' formatted value.  
        ''' <note>
        ''' The Accept method performs several processing steps.  They are as follows:<br/>
        '''  1. The user is prompted for input.  <br/>
        '''     If there is a value in the field, the current value is highlighted.<br/>
        '''     The entered value or null value is then assigned to the predefined variable FieldText.<br/>
        '''     If the field is of type Character, then the Upshift or Downshift is applied if specified.<br/>
        '''  2. The Input event associated to this field is then executed if applicable.  <br/>
        '''     This event can be used to change the value of FieldText.<br/>
        '''  3. If the FieldText size is 0, then the m_blnPromptOk member is set to False indicating no value was entered or substituted in the Input event.<br/>
        '''     This value is set to True if the user entered a value or a value was set during the Input event.<br/>
        '''     The rest of this step is ignored and execution resumes at step 8 if the m_blnPromptOK member is set to False and the Required,<br/>
        '''     Duplicate or Default properties are not set.<br/>
        '''     The duplicate buffer is assigned the value of FieldText.<br/>
        '''     Fields of type Numeric are checked for numbers and scaled by the input scale (if scaling is turned on).<br/>
        '''     Date fields are checked for a proper date.<br/>
        '''     The FieldValue predefined variable is then assigned with the numeric value of FieldText if this field<br/>
        '''     is of type Numeric or Date.<br/>
        '''  4. Dictionary editing is performed on FieldText (for fields of type Character) and FieldValue (for fields of type Numeric or Date).<br/>
        '''     This editing is as follows: <br/><br/>
        '''     The value is checked to ensure that it is within the range of possible values (if applicable) as specified in the FieldValues property.<br/>
        '''     The value is checked to ensure that it matches the Pattern as specified in the Pattern property.<br/>
        '''     The LookupOn and LookupNotOn events are initiated to check if the value is found or not found on the specified files.<br/>
        '''     The OldValue function can be used to determine the value in the record buffer of the associated item.<br/>
        '''  5. The Edit event associated to this field is then executed if applicable.  Use the FieldText (Character) or FieldValue (for Numeric and Date fields)<br/>
        '''     predefined items to change the value if necessary.  This value will be re-assigned to the underlying record buffers in the next step.<br/>
        '''  6. The value is assigned to the associated record buffer (the associated variable or file object) and in the duplicate record buffer.<br/>
        '''  7. The Process event associated to this field is executed if applicable.  This event can be used to to perform processing or data manipulation<br/>
        '''     on the changed item.<br/>
        '''  8. The value is retrieved from the associated record buffer for display purposes.  The value is placed in FieldText.  Numeric items are scaled by<br/>
        '''     the output scale (if scaling is turned on) prior to being placed in FieldText and are right justified.  A Date item is placed in FieldText as a number,<br/>
        '''     without the separator.<br/>
        '''  9. The associated Output event is execute if applicable.<br/>
        '''     This event can be used to reformat the FieldText value prior to the final formatting options being applied.
        ''' 10. For Numeric fields, numeric formatting is applied including the application of the Picture property.  Date fields are formatted using the<br/>
        '''     specified date format.  Character fields are formatted under the control of the Picture property.  The value is then displayed in the field.
        ''' </note>
        ''' </remarks>
        ''' <example>Accept(fldEMPLOYEE_EMPLOYEE_TYPE)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function Accept(ByRef fldField As ComboBox) As Boolean
            Dim blnReturnValue As Boolean

            Try


                m_CurrentField = fldField.RenderedID

                If Me.UseAcceptProcessing Then

                    m_intAcceptSequence += 1
                    If Not IsNothing(hsFunction) Then
                        m_strControlName = fldField.Name
                        If IsFunctionKey AndAlso (m_intPageActionType = PageActionType.ToolbarClick OrElse m_intPageActionType = PageActionType.DesignerClick OrElse m_intPageActionType = PageActionType.DataListButtonClick) AndAlso (m_strAcceptFlag.Length = m_intAcceptSequence) Then
                            m_strAcceptFlag = m_strAcceptFlag.ToString.Substring(0, m_strAcceptFlag.ToString.Length - 1)
                            'Session(FormName + "_" + Level.ToString + "_" + "ACCEPT_FLAG") = m_strAcceptFlag
                            If Not hsFunction.Contains(m_intAcceptSequence & "OCCURS" & Me.Occurrence) Then
                                hsFunction.Add(m_intAcceptSequence & "OCCURS" & Me.Occurrence, New ArrayList)
                            End If

                            FunctionKey(m_CurrentField)

                        ElseIf hsFunction.Contains(m_intAcceptSequence & "OCCURS" & Me.Occurrence) Then
                            FunctionKey(m_CurrentField, False)
                        End If
                    End If
                    MoveToPreviousControl(fldField, m_strAcceptFlag, m_intAcceptSequence)

                    If (Not ControlHadFocus Is Nothing AndAlso ControlHadFocus.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.ComboBox" AndAlso DirectCast(ControlHadFocus, ComboBox).Name = fldField.Name AndAlso Mode = PageModeTypes.Change) Then
                        SetMethodExecutedFlag(m_strAcceptFlag, "ACCEPT_FLAG", m_intAcceptSequence)
                    End If

                    'If MoveToPreviousControl(fldField.Name) OrElse (Not MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence) AndAlso Not SkipFocusOnThisField(fldField.Name)) Then
                    If Not MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence) AndAlso Not SkipFocusOnThisField(fldField) Then

                        ' Save the sequence information and set a flag indicating ACCEPT was run.
                        SetMethodExecutedFlag(m_strAcceptFlag, "ACCEPT_FLAG", m_intAcceptSequence)
                        m_strPopupComboName = fldField.RenderedID

                        SetAcceptControl(fldField)

                    Else
                        Dim blnClearLookup As Boolean = False
                        ' NOTE: This should not have an ANDALSO since we want to clear the EventTarget if a LOOKUP was used.
                        'If MoveToPreviousControl(fldField.Name, True) OrElse (Not MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence)) And SkipFocusOnThisField(fldField.Name, True) Then
                        If Not MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence) And SkipFocusOnThisField(fldField) Then
                            ' Save the sequence information and set a flag indicating ACCEPT was run.
                            SetMethodExecutedFlag(m_strAcceptFlag, "ACCEPT_FLAG", m_intAcceptSequence)

                            ' If we hit a run screen or accept verb, then don't run this again on the 
                            ' postback.  Otherwise the screen doesn't open properly.
                            If blnClearLookup Then
                                RemoveRunScreens(fldField.Name, 0)
                                ' Set to true for now.  This ensures that if we hit a runscreen or accept verb,
                                ' that we don't clear this on the postback.
                                'ScreenSession("CL" & fldField.Name) = True
                            End If
                        End If



                        ' Keep track of the ACCEPT field in case an error occurs.
                        m_fldAcceptField = fldField

                        Dim blnIsInFieldValidation As Boolean = True
                        If m_intAcceptSequence < m_strAcceptFlag.Length Then
                            blnIsInFieldValidation = False
                        End If

                        ' Keep track of the ACCEPT field in case an error occurs.
                        m_fldAcceptField = fldField

                        ' Clear the messages.
                        If Not m_blnInvalidPattern Then m_colMessages = New ArrayList

                        ' Call the VALIDATE.
                        m_strControlName = fldField.Name
                        If m_strAcceptFlag.Length = m_intAcceptSequence Then
                            blnReturnValue = Validate(fldField, ValidateTypes.Accept, blnIsInFieldValidation)
                        End If
                        m_strControlName = String.Empty

                        ' Clear the value since we didn't throw a runscreen/accept exception.
                        'RemoveScreenSession("CL" & fldField.Name)
                        If Not m_htRunFlag Is Nothing AndAlso m_htRunFlag.ContainsKey(cPROCEDURE) Then m_strRunFlag = m_htRunFlag.Item(cPROCEDURE)
                    End If
                Else
                    ' Clear the messages.
                    If Not m_blnInvalidPattern Then m_colMessages = New ArrayList

                    blnReturnValue = Validate(fldField, ValidateTypes.Accept)
                End If

                If blnReturnValue Then
                    'When value changes, update the Row Status for the record on grid
                    fldField.RaiseDataChanged()
                    SetMethodExecutedFlag(m_strFinishAcceptFlag, "FINISH_ACCEPT_FLAG", 1)
                End If

                Return blnReturnValue

            Catch ex As CustomApplicationException
                m_intAcceptSequence = m_intAcceptSequence - 1
                Throw ex
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        ''' --- Accept -------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Prompts the user for a value.
        ''' </summary>
        ''' <param name="fldField">The field for which the user will be prompted.</param>
        ''' <remarks>
        ''' The Accept method prompts the user for a value, checks and edits this value, stores this value
        ''' in the associated record buffer (the variable or file object related to the field) and then displays the
        ''' formatted value.  
        ''' <note>
        ''' The Accept method performs several processing steps.  They are as follows:<br/>
        '''  1. The user is prompted for input.  <br/>
        '''     If there is a value in the field, the current value is highlighted.<br/>
        '''     The entered value or null value is then assigned to the predefined variable FieldText.<br/>
        '''     If the field is of type Character, then the Upshift or Downshift is applied if specified.<br/>
        '''  2. The Input event associated to this field is then executed if applicable.  <br/>
        '''     This event can be used to change the value of FieldText.<br/>
        '''  3. If the FieldText size is 0, then the m_blnPromptOk member is set to False indicating no value was entered or substituted in the Input event.<br/>
        '''     This value is set to True if the user entered a value or a value was set during the Input event.<br/>
        '''     The rest of this step is ignored and execution resumes at step 8 if the m_blnPromptOK member is set to False and the Required,<br/>
        '''     Duplicate or Default properties are not set.<br/>
        '''     The duplicate buffer is assigned the value of FieldText.<br/>
        '''     Fields of type Numeric are checked for numbers and scaled by the input scale (if scaling is turned on).<br/>
        '''     Date fields are checked for a proper date.<br/>
        '''     The FieldValue predefined variable is then assigned with the numeric value of FieldText if this field<br/>
        '''     is of type Numeric or Date.<br/>
        '''  4. Dictionary editing is performed on FieldText (for fields of type Character) and FieldValue (for fields of type Numeric or Date).<br/>
        '''     This editing is as follows: <br/><br/>
        '''     The value is checked to ensure that it is within the range of possible values (if applicable) as specified in the FieldValues property.<br/>
        '''     The value is checked to ensure that it matches the Pattern as specified in the Pattern property.<br/>
        '''     The LookupOn and LookupNotOn events are initiated to check if the value is found or not found on the specified files.<br/>
        '''     The OldValue function can be used to determine the value in the record buffer of the associated item.<br/>
        '''  5. The Edit event associated to this field is then executed if applicable.  Use the FieldText (Character) or FieldValue (for Numeric and Date fields)<br/>
        '''     predefined items to change the value if necessary.  This value will be re-assigned to the underlying record buffers in the next step.<br/>
        '''  6. The value is assigned to the associated record buffer (the associated variable or file object) and in the duplicate record buffer.<br/>
        '''  7. The Process event associated to this field is executed if applicable.  This event can be used to to perform processing or data manipulation<br/>
        '''     on the changed item.<br/>
        '''  8. The value is retrieved from the associated record buffer for display purposes.  The value is placed in FieldText.  Numeric items are scaled by<br/>
        '''     the output scale (if scaling is turned on) prior to being placed in FieldText and are right justified.  A Date item is placed in FieldText as a number,<br/>
        '''     without the separator.<br/>
        '''  9. The associated Output event is execute if applicable.<br/>
        '''     This event can be used to reformat the FieldText value prior to the final formatting options being applied.
        ''' 10. For Numeric fields, numeric formatting is applied including the application of the Picture property.  Date fields are formatted using the<br/>
        '''     specified date format.  Character fields are formatted under the control of the Picture property.  The value is then displayed in the field.
        ''' </note>
        ''' </remarks>
        ''' <example>Accept(fldEMPLOYEE_DOB)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function Accept(ByRef fldField As DateControl) As Boolean
            Dim blnReturnValue As Boolean

            Try


                m_CurrentField = fldField.RenderedID

                If Me.UseAcceptProcessing Then

                    m_intAcceptSequence += 1
                    If Not IsNothing(hsFunction) Then
                        m_strControlName = fldField.Name
                        If IsFunctionKey AndAlso (m_intPageActionType = PageActionType.ToolbarClick OrElse m_intPageActionType = PageActionType.DesignerClick OrElse m_intPageActionType = PageActionType.DataListButtonClick) AndAlso (m_strAcceptFlag.Length = m_intAcceptSequence) Then
                            m_strAcceptFlag = m_strAcceptFlag.ToString.Substring(0, m_strAcceptFlag.ToString.Length - 1)
                            'Session(FormName + "_" + Level.ToString + "_" + "ACCEPT_FLAG") = m_strAcceptFlag
                            If Not hsFunction.Contains(m_intAcceptSequence & "OCCURS" & Me.Occurrence) Then
                                hsFunction.Add(m_intAcceptSequence & "OCCURS" & Me.Occurrence, New ArrayList)
                            End If

                            FunctionKey(m_CurrentField)

                        ElseIf hsFunction.Contains(m_intAcceptSequence & "OCCURS" & Me.Occurrence) Then
                            FunctionKey(m_CurrentField, False)
                        End If
                    End If

                    MoveToPreviousControl(fldField, m_strAcceptFlag, m_intAcceptSequence)

                    If (Not ControlHadFocus Is Nothing AndAlso ControlHadFocus.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.DateControl" AndAlso DirectCast(ControlHadFocus, DateControl).Name = fldField.Name AndAlso Mode = PageModeTypes.Change) Then
                        SetMethodExecutedFlag(m_strAcceptFlag, "ACCEPT_FLAG", m_intAcceptSequence)
                    End If

                    'If MoveToPreviousControl(fldField.Name) OrElse (Not MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence) AndAlso Not SkipFocusOnThisField(fldField.Name)) Then
                    If Not MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence) AndAlso Not SkipFocusOnThisField(fldField) Then

                        ' Save the sequence information and set a flag indicating ACCEPT was run.
                        SetMethodExecutedFlag(m_strAcceptFlag, "ACCEPT_FLAG", m_intAcceptSequence)

                        SetAcceptControl(fldField)

                    Else
                        Dim blnClearLookup As Boolean = False
                        ' NOTE: This should not have an ANDALSO since we want to clear the EventTarget if a LOOKUP was used.
                        'If MoveToPreviousControl(fldField.Name, True) OrElse (Not MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence)) And SkipFocusOnThisField(fldField.Name, True) Then
                        If Not MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence) And SkipFocusOnThisField(fldField) Then
                            ' Save the sequence information and set a flag indicating ACCEPT was run.
                            SetMethodExecutedFlag(m_strAcceptFlag, "ACCEPT_FLAG", m_intAcceptSequence)

                            ' If we hit a run screen or accept verb, then don't run this again on the 
                            ' postback.  Otherwise the screen doesn't open properly.
                            If blnClearLookup Then
                                RemoveRunScreens(fldField.Name, 0)
                                ' Set to true for now.  This ensures that if we hit a runscreen or accept verb,
                                ' that we don't clear this on the postback.
                                'ScreenSession("CL" & fldField.Name) = True
                            End If
                        End If



                        ' Keep track of the ACCEPT field in case an error occurs.
                        m_fldAcceptField = fldField

                        Dim blnIsInFieldValidation As Boolean = True
                        If m_intAcceptSequence < m_strAcceptFlag.Length Then
                            blnIsInFieldValidation = False
                        End If

                        ' Clear the messages.
                        If Not m_blnInvalidPattern Then m_colMessages = New ArrayList

                        ' Call the VALIDATE.
                        IsExecutingInFieldValidation = True
                        m_strControlName = fldField.Name
                        If m_strAcceptFlag.Length = m_intAcceptSequence Then
                            blnReturnValue = Validate(fldField, ValidateTypes.Accept, blnIsInFieldValidation)
                        End If
                        IsExecutingInFieldValidation = False
                        m_strControlName = String.Empty

                        ' Clear the value since we didn't throw a runscreen/accept exception.
                        'RemoveScreenSession("CL" & fldField.Name)
                        If Not m_htRunFlag Is Nothing AndAlso m_htRunFlag.ContainsKey(cPROCEDURE) Then m_strRunFlag = m_htRunFlag.Item(cPROCEDURE)
                    End If
                Else
                    ' Clear the messages.
                    If Not m_blnInvalidPattern Then m_colMessages = New ArrayList

                    blnReturnValue = Validate(fldField, ValidateTypes.Accept)
                End If

                If blnReturnValue Then
                    'When value changes, update the Row Status for the record on grid
                    fldField.RaiseDataChanged()
                    SetMethodExecutedFlag(m_strFinishAcceptFlag, "FINISH_ACCEPT_FLAG", 1)
                End If

                Return blnReturnValue

            Catch ex As CustomApplicationException
                m_intAcceptSequence = m_intAcceptSequence - 1
                Throw ex
            Catch ex As Exception
                Throw ex
            End Try
        End Function



        ''' --- RequestPrompt ------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Prompts the user for a value.
        ''' </summary>
        ''' <param name="fldField">The field for which the user will be prompted.</param>
        ''' <remarks>
        ''' The RequestPrompt method prompts the user for a value, stores this value
        ''' in the associated record buffer (the variable or file object related to the field) and then displays the
        ''' formatted value.  
        ''' <note>
        ''' The RequestPrompt method performs several processing steps.  They are as follows:<br/>
        '''  1. The user is prompted for input.  <br/>
        '''     If there is a value in the field, the current value is highlighted.<br/>
        '''     The entered value or null value is then assigned to the predefined variable FieldText.<br/>
        '''     If the field is of type Character, then the Upshift or Downshift is applied if specified.<br/>
        '''  2. The Input event associated to this field is then executed if applicable.  <br/>
        '''     This event can be used to change the value of FieldText.<br/>
        '''  3. If the FieldText size is 0, then the m_blnPromptOk member is set to False indicating no value was entered or substituted in the Input event.<br/>
        '''     This value is set to True if the user entered a value or a value was set during the Input event.<br/>
        '''     The rest of this step is ignored and execution resumes at step 8 if the m_blnPromptOK member is set to False and the Required,<br/>
        '''     Duplicate or Default properties are not set.<br/>
        '''     The duplicate buffer is assigned the value of FieldText.<br/>
        '''     Fields of type Numeric are checked for numbers and scaled by the input scale (if scaling is turned on).<br/>
        '''     Date fields are checked for a proper date.<br/>
        '''     The FieldValue predefined variable is then assigned with the numeric value of FieldText if this field<br/>
        '''     is of type Numeric or Date.<br/>
        '''  4. The value is assigned to the associated record buffer (the associated variable or file object) and in the duplicate record buffer.<br/>
        '''  5. The value is retrieved from the associated record buffer for display purposes.  The value is placed in FieldText.  Numeric items are scaled by<br/>
        '''     the output scale (if scaling is turned on) prior to being placed in FieldText and are right justified.  A Date item is placed in FieldText as a number,<br/>
        '''     without the separator.<br/>
        '''  6. The associated Output event is execute if applicable.<br/>
        '''     This event can be used to reformat the FieldText value prior to the final formatting options being applied.
        '''  7. For Numeric fields, numeric formatting is applied including the application of the Picture property.  Date fields are formatted using the<br/>
        '''     specified date format.  Character fields are formatted under the control of the Picture property.  The value is then displayed in the field.
        ''' </note>
        ''' </remarks>
        ''' <example>RequestPrompt(fldEMPLOYEE_EMPLOYEE_NAME)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function RequestPrompt(ByRef fldField As TextBox) As Boolean

            Try



                If Me.UseAcceptProcessing Then
                    m_intRequestSequence += 1

                    MoveToPreviousControl(fldField, m_strRequestFlag, m_intRequestSequence)


                    If Not IsNothing(hsFunction) Then
                        m_strControlName = fldField.Name
                        If IsFunctionKey AndAlso (m_intPageActionType = PageActionType.DesignerClick OrElse m_intPageActionType = PageActionType.DataListButtonClick) AndAlso m_strRequestFlag.Length = m_intRequestSequence Then
                            m_strRequestFlag = m_strRequestFlag.ToString.Substring(0, m_strRequestFlag.ToString.Length - 1)
                            If Not hsFunction.Contains(m_intAcceptSequence) Then
                                hsFunction.Add(m_intAcceptSequence & "OCCURS" & Me.Occurrence, New ArrayList)
                            End If

                            FunctionKey(m_CurrentField)

                        ElseIf hsFunction.Contains(m_intAcceptSequence & "OCCURS" & Me.Occurrence) Then
                            FunctionKey(m_CurrentField, False)
                        End If
                    End If

                    If Not MethodWasExecuted(m_strRequestFlag, m_intRequestSequence) Then

                        ' If a request was previously performed on this field, set the values
                        ' to the previous values and set the REQUEST_FLAG indicating that we
                        'have run this REQUEST in the sequence.
                        If fldField.RequestWasPerformed Then

                            ' Assign the values from the previous request.
                            m_blnPromptOK = fldField.RequestPromptOk
                            FieldText = fldField.RequestValue


                            ' Save the sequence information and set a flag indicating ACCEPT was run.
                            SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                            If FieldText = "" AndAlso fldField.ValueChangedByUser Then
                                Validate(fldField, ValidateTypes.Request)
                            End If

                        Else

                            ' Save the sequence information and set a flag indicating ACCEPT was run.
                            SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)


                            UniqueControl = fldField

                            ' Create the PostBack event.
                            fldField.SetAcceptRequestPrompt = True

                            ThrowCustomApplicationException(cAcceptRequestPromptException)

                        End If

                    Else

                        ' Check if the request was previously performed on
                        ' this field.
                        If fldField.RequestWasPerformed Then

                            ' Assign the values from the previous request.
                            m_blnPromptOK = fldField.RequestPromptOk
                            FieldText = fldField.RequestValue
                            If m_intRequestSequence > m_strRequestFlag.Length Then SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                        Else
                            Dim blnClearLookup As Boolean = False
                            ' NOTE: This should not have an ANDALSO since we want to clear the EventTarget if a LOOKUP was used.
                            If Not MethodWasExecuted(m_strRequestFlag, m_intRequestSequence) And SkipFocusOnThisField(fldField) Then
                                ' Save the sequence information and set a flag indicating ACCEPT was run.
                                SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                                ' If we hit a run screen or accept verb, then don't run this again on the 
                                ' postback.  Otherwise the screen doesn't open properly.
                                If blnClearLookup Then
                                    RemoveRunScreens(fldField.Name, 0)
                                    ' Set to true for now.  This ensures that if we hit a runscreen or accept verb,
                                    ' that we don't clear this on the postback.
                                    'ScreenSession("CL" & fldField.Name) = True
                                End If
                            End If


                            m_fldAcceptField = fldField

                            Dim blnIsInFieldValidation As Boolean = True
                            If m_intRequestSequence < m_strRequestFlag.Length Then
                                blnIsInFieldValidation = False
                            End If

                            ' Call the VALIDATE.
                            m_strControlName = fldField.Name
                            Dim blnReturnValue As Boolean = Validate(fldField, ValidateTypes.Request, blnIsInFieldValidation)
                            m_strControlName = String.Empty
                            m_fldAcceptField = Nothing
                            If Not m_htRunFlag Is Nothing AndAlso m_htRunFlag.ContainsKey(cPROCEDURE) Then m_strRunFlag = m_htRunFlag.Item(cPROCEDURE)
                            Return blnReturnValue
                        End If

                    End If
                Else
                    Return Validate(fldField, ValidateTypes.Request)
                End If

            Catch ex As CustomApplicationException
                If ex.Message <> "3" Then
                    m_intRequestSequence = m_intRequestSequence - 1
                End If

                Throw ex
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        ''' --- RequestPrompt ------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Prompts the user for a value.
        ''' </summary>
        ''' <param name="fldField">The field for which the user will be prompted.</param>
        ''' <remarks>
        ''' The RequestPrompt method prompts the user for a value, stores this value
        ''' in the associated record buffer (the variable or file object related to the field) and then displays the
        ''' formatted value.  
        ''' <note>
        ''' The RequestPrompt method performs several processing steps.  They are as follows:<br/>
        '''  1. The user is prompted for input.  <br/>
        '''     If there is a value in the field, the current value is highlighted.<br/>
        '''     The entered value or null value is then assigned to the predefined variable FieldText.<br/>
        '''     If the field is of type Character, then the Upshift or Downshift is applied if specified.<br/>
        '''  2. The Input event associated to this field is then executed if applicable.  <br/>
        '''     This event can be used to change the value of FieldText.<br/>
        '''  3. If the FieldText size is 0, then the m_blnPromptOk member is set to False indicating no value was entered or substituted in the Input event.<br/>
        '''     This value is set to True if the user entered a value or a value was set during the Input event.<br/>
        '''     The rest of this step is ignored and execution resumes at step 8 if the m_blnPromptOK member is set to False and the Required,<br/>
        '''     Duplicate or Default properties are not set.<br/>
        '''     The duplicate buffer is assigned the value of FieldText.<br/>
        '''     Fields of type Numeric are checked for numbers and scaled by the input scale (if scaling is turned on).<br/>
        '''     Date fields are checked for a proper date.<br/>
        '''     The FieldValue predefined variable is then assigned with the numeric value of FieldText if this field<br/>
        '''     is of type Numeric or Date.<br/>
        '''  4. The value is assigned to the associated record buffer (the associated variable or file object) and in the duplicate record buffer.<br/>
        '''  5. The value is retrieved from the associated record buffer for display purposes.  The value is placed in FieldText.  Numeric items are scaled by<br/>
        '''     the output scale (if scaling is turned on) prior to being placed in FieldText and are right justified.  A Date item is placed in FieldText as a number,<br/>
        '''     without the separator.<br/>
        '''  6. The associated Output event is execute if applicable.<br/>
        '''     This event can be used to reformat the FieldText value prior to the final formatting options being applied.
        '''  7. For Numeric fields, numeric formatting is applied including the application of the Picture property.  Date fields are formatted using the<br/>
        '''     specified date format.  Character fields are formatted under the control of the Picture property.  The value is then displayed in the field.
        ''' </note>
        ''' </remarks>
        ''' <example>RequestPrompt(fldEMPLOYEE_EMPLOYEE_STATUS)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function RequestPrompt(ByRef fldField As ComboBox) As Boolean
            Try


                If Me.UseAcceptProcessing Then
                    m_intRequestSequence += 1

                    MoveToPreviousControl(fldField, m_strRequestFlag, m_intRequestSequence)


                    If Not IsNothing(hsFunction) Then
                        m_strControlName = fldField.Name
                        If IsFunctionKey AndAlso (m_intPageActionType = PageActionType.DesignerClick OrElse m_intPageActionType = PageActionType.DataListButtonClick) AndAlso m_strRequestFlag.Length = m_intRequestSequence Then
                            m_strRequestFlag = m_strRequestFlag.ToString.Substring(0, m_strRequestFlag.ToString.Length - 1)
                            If Not hsFunction.Contains(m_intAcceptSequence) Then
                                hsFunction.Add(m_intAcceptSequence & "OCCURS" & Me.Occurrence, New ArrayList)
                            End If

                            FunctionKey(m_CurrentField)

                        ElseIf hsFunction.Contains(m_intAcceptSequence & "OCCURS" & Me.Occurrence) Then
                            FunctionKey(m_CurrentField, False)
                        End If
                    End If

                    If Not MethodWasExecuted(m_strRequestFlag, m_intRequestSequence) Then

                        ' If a request was previously performed on this field, set the values
                        ' to the previous values and set the REQUEST_FLAG indicating that we
                        ' have run this REQUEST in the sequence.
                        If fldField.RequestWasPerformed Then

                            ' Assign the values from the previous request.
                            m_blnPromptOK = fldField.RequestPromptOk
                            FieldText = fldField.RequestValue
                            'fldField.InFieldValidation = False

                            ' Save the sequence information and set a flag indicating ACCEPT was run.
                            SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                            If FieldText = "" AndAlso fldField.ValueChangedByUser Then
                                Validate(fldField, ValidateTypes.Request)
                            End If

                        Else

                            ' Save the sequence information and set a flag indicating ACCEPT was run.
                            SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                            UniqueControl = fldField
                            ' Turn off InFieldValidation and store the control name.
                            'fldField.InFieldValidation = False
                            m_strUniqueControlId = fldField.RenderedID

                            m_strPopupComboName = fldField.RenderedID

                            ' Create the PostBack event.
                            fldField.SetAcceptRequestPrompt = True

                            ThrowCustomApplicationException(cAcceptRequestPromptException)

                        End If

                    Else

                        ' Check if the request was previously performed on
                        ' this field.
                        If fldField.RequestWasPerformed Then

                            ' Assign the values from the previous request.
                            m_blnPromptOK = fldField.RequestPromptOk
                            FieldText = fldField.RequestValue
                            If m_intRequestSequence > m_strRequestFlag.Length Then SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                        Else
                            Dim blnClearLookup As Boolean = False
                            ' NOTE: This should not have an ANDALSO since we want to clear the EventTarget if a LOOKUP was used.
                            If Not MethodWasExecuted(m_strRequestFlag, m_intRequestSequence) And SkipFocusOnThisField(fldField) Then
                                ' Save the sequence information and set a flag indicating ACCEPT was run.
                                SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                                ' If we hit a run screen or accept verb, then don't run this again on the 
                                ' postback.  Otherwise the screen doesn't open properly.
                                If blnClearLookup Then
                                    RemoveRunScreens(fldField.Name, 0)
                                    ' Set to true for now.  This ensures that if we hit a runscreen or accept verb,
                                    ' that we don't clear this on the postback.
                                    'ScreenSession("CL" & fldField.Name) = True
                                End If
                            End If

                            ' Reset the field attributes.
                            'fldField.InFieldValidation = True
                            m_fldAcceptField = fldField

                            Dim blnIsInFieldValidation As Boolean = True
                            If m_intRequestSequence < m_strRequestFlag.Length Then
                                blnIsInFieldValidation = False
                            End If

                            ' Call the VALIDATE.
                            m_strControlName = fldField.Name
                            Dim blnReturnValue As Boolean = Validate(fldField, ValidateTypes.Request, blnIsInFieldValidation)
                            m_strControlName = String.Empty
                            m_fldAcceptField = Nothing
                            If Not m_htRunFlag Is Nothing AndAlso m_htRunFlag.ContainsKey(cPROCEDURE) Then m_strRunFlag = m_htRunFlag.Item(cPROCEDURE)
                            Return blnReturnValue

                        End If
                    End If
                Else
                    Return Validate(fldField, ValidateTypes.Request)
                End If
            Catch ex As CustomApplicationException
                m_intRequestSequence = m_intRequestSequence - 1
                Throw ex
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        ''' --- RequestPrompt ------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Prompts the user for a value.
        ''' </summary>
        ''' <param name="fldField">The field for which the user will be prompted.</param>
        ''' <remarks>
        ''' The RequestPrompt method prompts the user for a value, stores this value
        ''' in the associated record buffer (the variable or file object related to the field) and then displays the
        ''' formatted value.  
        ''' <note>
        ''' The RequestPrompt method performs several processing steps.  They are as follows:<br/>
        '''  1. The user is prompted for input.  <br/>
        '''     If there is a value in the field, the current value is highlighted.<br/>
        '''     The entered value or null value is then assigned to the predefined variable FieldText.<br/>
        '''     If the field is of type Character, then the Upshift or Downshift is applied if specified.<br/>
        '''  2. The Input event associated to this field is then executed if applicable.  <br/>
        '''     This event can be used to change the value of FieldText.<br/>
        '''  3. If the FieldText size is 0, then the m_blnPromptOk member is set to False indicating no value was entered or substituted in the Input event.<br/>
        '''     This value is set to True if the user entered a value or a value was set during the Input event.<br/>
        '''     The rest of this step is ignored and execution resumes at step 8 if the m_blnPromptOK member is set to False and the Required,<br/>
        '''     Duplicate or Default properties are not set.<br/>
        '''     The duplicate buffer is assigned the value of FieldText.<br/>
        '''     Fields of type Numeric are checked for numbers and scaled by the input scale (if scaling is turned on).<br/>
        '''     Date fields are checked for a proper date.<br/>
        '''     The FieldValue predefined variable is then assigned with the numeric value of FieldText if this field<br/>
        '''     is of type Numeric or Date.<br/>
        '''  4. The value is assigned to the associated record buffer (the associated variable or file object) and in the duplicate record buffer.<br/>
        '''  5. The value is retrieved from the associated record buffer for display purposes.  The value is placed in FieldText.  Numeric items are scaled by<br/>
        '''     the output scale (if scaling is turned on) prior to being placed in FieldText and are right justified.  A Date item is placed in FieldText as a number,<br/>
        '''     without the separator.<br/>
        '''  6. The associated Output event is execute if applicable.<br/>
        '''     This event can be used to reformat the FieldText value prior to the final formatting options being applied.
        '''  7. For Numeric fields, numeric formatting is applied including the application of the Picture property.  Date fields are formatted using the<br/>
        '''     specified date format.  Character fields are formatted under the control of the Picture property.  The value is then displayed in the field.
        ''' </note>
        ''' </remarks>
        ''' <example>RequestPrompt(fldEMPLOYEE_EMPLOYEE_DOB)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function RequestPrompt(ByRef fldField As DateControl) As Boolean
            Try


                If Me.UseAcceptProcessing Then
                    m_intRequestSequence += 1

                    MoveToPreviousControl(fldField, m_strRequestFlag, m_intRequestSequence)


                    If Not IsNothing(hsFunction) Then
                        m_strControlName = fldField.Name
                        If IsFunctionKey AndAlso (m_intPageActionType = PageActionType.DesignerClick OrElse m_intPageActionType = PageActionType.DataListButtonClick) AndAlso m_strRequestFlag.Length = m_intRequestSequence Then
                            m_strRequestFlag = m_strRequestFlag.ToString.Substring(0, m_strRequestFlag.ToString.Length - 1)
                            If Not hsFunction.Contains(m_intAcceptSequence) Then
                                hsFunction.Add(m_intAcceptSequence & "OCCURS" & Me.Occurrence, New ArrayList)
                            End If

                            FunctionKey(m_CurrentField)

                        ElseIf hsFunction.Contains(m_intAcceptSequence & "OCCURS" & Me.Occurrence) Then
                            FunctionKey(m_CurrentField, False)
                        End If
                    End If

                    If Not MethodWasExecuted(m_strRequestFlag, m_intRequestSequence) Then

                        ' If a request was previously performed on this field, set the values
                        ' to the previous values and set the REQUEST_FLAG indicating that we
                        ' have run this REQUEST in the sequence.
                        If fldField.RequestWasPerformed Then

                            ' Assign the values from the previous request.
                            m_blnPromptOK = fldField.RequestPromptOk
                            FieldText = fldField.RequestValue
                            'fldField.InFieldValidation = False

                            ' Save the sequence information and set a flag indicating ACCEPT was run.
                            SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                            If FieldText = "" AndAlso fldField.ValueChangedByUser Then
                                Validate(fldField, ValidateTypes.Request)
                            End If

                        Else

                            ' Save the sequence information and set a flag indicating ACCEPT was run.
                            SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                            ' Turn off InFieldValidation and store the control name.
                            'fldField.InFieldValidation = False
                            m_strUniqueControlId = fldField.RenderedID

                            ' Create the PostBack event.
                            fldField.SetAcceptRequestPrompt = True

                            ThrowCustomApplicationException(cAcceptRequestPromptException)

                        End If

                    Else

                        ' Check if the request was previously performed on
                        ' this field.
                        If fldField.RequestWasPerformed Then

                            ' Assign the values from the previous request.
                            m_blnPromptOK = fldField.RequestPromptOk
                            FieldText = fldField.RequestValue
                            If m_intRequestSequence > m_strRequestFlag.Length Then SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                        Else
                            Dim blnClearLookup As Boolean = False
                            ' NOTE: This should not have an ANDALSO since we want to clear the EventTarget if a LOOKUP was used.
                            If Not MethodWasExecuted(m_strRequestFlag, m_intRequestSequence) And SkipFocusOnThisField(fldField) Then
                                ' Save the sequence information and set a flag indicating ACCEPT was run.
                                SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                                ' If we hit a run screen or accept verb, then don't run this again on the 
                                ' postback.  Otherwise the screen doesn't open properly.
                                If blnClearLookup Then
                                    RemoveRunScreens(fldField.Name, 0)
                                    ' Set to true for now.  This ensures that if we hit a runscreen or accept verb,
                                    ' that we don't clear this on the postback.
                                    'ScreenSession("CL" & fldField.Name) = True
                                End If
                            End If

                            ' Reset the field attributes.
                            'fldField.InFieldValidation = True
                            m_fldAcceptField = fldField

                            Dim blnIsInFieldValidation As Boolean = True
                            If m_intRequestSequence < m_strRequestFlag.Length Then
                                blnIsInFieldValidation = False
                            End If

                            ' Call the VALIDATE.
                            m_strControlName = fldField.Name
                            Dim blnReturnValue As Boolean = Validate(fldField, ValidateTypes.Request, blnIsInFieldValidation)
                            m_strControlName = String.Empty
                            m_fldAcceptField = Nothing
                            If Not m_htRunFlag Is Nothing AndAlso m_htRunFlag.ContainsKey(cPROCEDURE) Then m_strRunFlag = m_htRunFlag.Item(cPROCEDURE)
                            Return blnReturnValue
                        End If

                    End If
                Else
                    Return Validate(fldField, ValidateTypes.Request)
                End If
            Catch ex As CustomApplicationException
                m_intRequestSequence = m_intRequestSequence - 1
                Throw ex
            Catch ex As Exception
                Throw ex
            End Try
        End Function




        ''' --- Prompt ------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Prompts the user for a value.
        ''' </summary>
        ''' <param name="fldField">The field for which the user will be prompted.</param>
        ''' <remarks>
        ''' The Prompt method prompts the user for a value, stores this value
        ''' in the associated record buffer (the variable or file object related to the field) and then displays the
        ''' formatted value.  
        ''' <note>
        ''' The Prompt method performs several processing steps.  They are as follows:<br/>
        '''  1. The user is prompted for input.  <br/>
        '''     If there is a value in the field, the current value is highlighted.<br/>
        '''     The entered value or null value is then assigned to the predefined variable FieldText.<br/>
        '''     If the field is of type Character, then the Upshift or Downshift is applied if specified.<br/>
        '''  2. The Input event associated to this field is then executed if applicable.  <br/>
        '''     This event can be used to change the value of FieldText.<br/>
        '''  3. If the FieldText size is 0, then the m_blnPromptOk member is set to False indicating no value was entered or substituted in the Input event.<br/>
        '''     This value is set to True if the user entered a value or a value was set during the Input event.<br/>
        '''     The rest of this step is ignored and execution resumes at step 8 if the m_blnPromptOK member is set to False and the Required,<br/>
        '''     Duplicate or Default properties are not set.<br/>
        '''     The duplicate buffer is assigned the value of FieldText.<br/>
        '''     Fields of type Numeric are checked for numbers and scaled by the input scale (if scaling is turned on).<br/>
        '''     Date fields are checked for a proper date.<br/>
        '''     The FieldValue predefined variable is then assigned with the numeric value of FieldText if this field<br/>
        '''     is of type Numeric or Date.<br/>
        '''  4. The value is assigned to the associated record buffer (the associated variable or file object) and in the duplicate record buffer.<br/>
        '''  5. The value is retrieved from the associated record buffer for display purposes.  The value is placed in FieldText.  Numeric items are scaled by<br/>
        '''     the output scale (if scaling is turned on) prior to being placed in FieldText and are right justified.  A Date item is placed in FieldText as a number,<br/>
        '''     without the separator.<br/>
        '''  6. The associated Output event is execute if applicable.<br/>
        '''     This event can be used to reformat the FieldText value prior to the final formatting options being applied.
        '''  7. For Numeric fields, numeric formatting is applied including the application of the Picture property.  Date fields are formatted using the<br/>
        '''     specified date format.  Character fields are formatted under the control of the Picture property.  The value is then displayed in the field.
        ''' </note>
        ''' </remarks>
        ''' <example>Prompt(fldEMPLOYEE_EMPLOYEE_NAME)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function Prompt(ByRef fldField As TextBox) As Boolean

            If Me.UseAcceptProcessing Then
                m_intRequestSequence += 1

                MoveToPreviousControl(fldField, m_strRequestFlag, m_intRequestSequence)

                If Not MethodWasExecuted(m_strRequestFlag, m_intRequestSequence) AndAlso Not SkipFocusOnThisField(fldField) Then

                    ' Save the sequence information and set a flag indicating PROMPT was run.
                    SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                    ' Turn off InFieldValidation and store the control name.
                    'fldField.InFieldValidation = False
                    m_strUniqueControlId = fldField.RenderedID

                    ' Create the PostBack event.
                    fldField.SetAcceptRequestPrompt = True

                    ThrowCustomApplicationException(cAcceptRequestPromptException)

                Else

                    Dim blnClearLookup As Boolean = False
                    ' NOTE: This should not have an ANDALSO since we want to clear the EventTarget if a LOOKUP was used.
                    If Not MethodWasExecuted(m_strRequestFlag, m_intRequestSequence) And SkipFocusOnThisField(fldField) Then
                        ' Save the sequence information and set a flag indicating ACCEPT was run.
                        SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                        ' If we hit a run screen or accept verb, then don't run this again on the 
                        ' postback.  Otherwise the screen doesn't open properly.
                        If blnClearLookup Then
                            RemoveRunScreens(fldField.Name, 0)
                            ' Set to true for now.  This ensures that if we hit a runscreen or accept verb,
                            ' that we don't clear this on the postback.
                            'ScreenSession("CL" & fldField.Name) = True
                        End If
                    End If

                    ' Reset the field attributes.
                    'fldField.InFieldValidation = True
                    m_fldAcceptField = fldField

                    Dim blnIsInFieldValidation As Boolean = True
                    If m_intRequestSequence < m_strRequestFlag.Length Then
                        blnIsInFieldValidation = False
                    End If

                    ' Call the VALIDATE.
                    m_strControlName = fldField.Name
                    Dim blnReturnValue As Boolean = Validate(fldField, ValidateTypes.Request, blnIsInFieldValidation)
                    m_strControlName = String.Empty
                    m_fldAcceptField = Nothing
                    If Not m_htRunFlag Is Nothing AndAlso m_htRunFlag.ContainsKey(cPROCEDURE) Then m_strRunFlag = m_htRunFlag.Item(cPROCEDURE)
                    Return blnReturnValue

                End If
            Else
                Return Validate(fldField, ValidateTypes.Request)
            End If

        End Function

        ''' --- Prompt ------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Prompts the user for a value.
        ''' </summary>
        ''' <param name="fldField">The field for which the user will be prompted.</param>
        ''' <remarks>
        ''' The Prompt method prompts the user for a value, stores this value
        ''' in the associated record buffer (the variable or file object related to the field) and then displays the
        ''' formatted value.  
        ''' <note>
        ''' The Prompt method performs several processing steps.  They are as follows:<br/>
        '''  1. The user is prompted for input.  <br/>
        '''     If there is a value in the field, the current value is highlighted.<br/>
        '''     The entered value or null value is then assigned to the predefined variable FieldText.<br/>
        '''     If the field is of type Character, then the Upshift or Downshift is applied if specified.<br/>
        '''  2. The Input event associated to this field is then executed if applicable.  <br/>
        '''     This event can be used to change the value of FieldText.<br/>
        '''  3. If the FieldText size is 0, then the m_blnPromptOk member is set to False indicating no value was entered or substituted in the Input event.<br/>
        '''     This value is set to True if the user entered a value or a value was set during the Input event.<br/>
        '''     The rest of this step is ignored and execution resumes at step 8 if the m_blnPromptOK member is set to False and the Required,<br/>
        '''     Duplicate or Default properties are not set.<br/>
        '''     The duplicate buffer is assigned the value of FieldText.<br/>
        '''     Fields of type Numeric are checked for numbers and scaled by the input scale (if scaling is turned on).<br/>
        '''     Date fields are checked for a proper date.<br/>
        '''     The FieldValue predefined variable is then assigned with the numeric value of FieldText if this field<br/>
        '''     is of type Numeric or Date.<br/>
        '''  4. The value is assigned to the associated record buffer (the associated variable or file object) and in the duplicate record buffer.<br/>
        '''  5. The value is retrieved from the associated record buffer for display purposes.  The value is placed in FieldText.  Numeric items are scaled by<br/>
        '''     the output scale (if scaling is turned on) prior to being placed in FieldText and are right justified.  A Date item is placed in FieldText as a number,<br/>
        '''     without the separator.<br/>
        '''  6. The associated Output event is execute if applicable.<br/>
        '''     This event can be used to reformat the FieldText value prior to the final formatting options being applied.
        '''  7. For Numeric fields, numeric formatting is applied including the application of the Picture property.  Date fields are formatted using the<br/>
        '''     specified date format.  Character fields are formatted under the control of the Picture property.  The value is then displayed in the field.
        ''' </note>
        ''' </remarks>
        ''' <example>Prompt(fldEMPLOYEE_EMPLOYEE_STATUS)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function Prompt(ByRef fldField As ComboBox) As Boolean

            If Me.UseAcceptProcessing Then
                m_intRequestSequence += 1

                MoveToPreviousControl(fldField, m_strRequestFlag, m_intRequestSequence)

                If Not MethodWasExecuted(m_strRequestFlag, m_intRequestSequence) AndAlso Not SkipFocusOnThisField(fldField) Then

                    ' Save the sequence information and set a flag indicating PROMPT was run.
                    SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                    ' Turn off InFieldValidation and store the control name.
                    'fldField.InFieldValidation = False
                    m_strUniqueControlId = fldField.RenderedID

                    m_strPopupComboName = fldField.RenderedID

                    ' Create the PostBack event.
                    fldField.SetAcceptRequestPrompt = True

                    ThrowCustomApplicationException(cAcceptRequestPromptException)

                Else

                    Dim blnClearLookup As Boolean = False
                    ' NOTE: This should not have an ANDALSO since we want to clear the EventTarget if a LOOKUP was used.
                    If Not MethodWasExecuted(m_strRequestFlag, m_intRequestSequence) And SkipFocusOnThisField(fldField) Then
                        ' Save the sequence information and set a flag indicating ACCEPT was run.
                        SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                        ' If we hit a run screen or accept verb, then don't run this again on the 
                        ' postback.  Otherwise the screen doesn't open properly.
                        If blnClearLookup Then
                            RemoveRunScreens(fldField.Name, 0)
                            ' Set to true for now.  This ensures that if we hit a runscreen or accept verb,
                            ' that we don't clear this on the postback.
                            'ScreenSession("CL" & fldField.Name) = True
                        End If
                    End If

                    ' Reset the field attributes.
                    'fldField.InFieldValidation = True
                    m_fldAcceptField = fldField

                    Dim blnIsInFieldValidation As Boolean = True
                    If m_intRequestSequence < m_strRequestFlag.Length Then
                        blnIsInFieldValidation = False
                    End If

                    ' Call the VALIDATE.
                    m_strControlName = fldField.Name
                    Dim blnReturnValue As Boolean = Validate(fldField, ValidateTypes.Request, blnIsInFieldValidation)
                    m_strControlName = String.Empty
                    m_fldAcceptField = Nothing
                    If Not m_htRunFlag Is Nothing AndAlso m_htRunFlag.ContainsKey(cPROCEDURE) Then m_strRunFlag = m_htRunFlag.Item(cPROCEDURE)
                    Return blnReturnValue
                End If
            Else
                Return Validate(fldField, ValidateTypes.Request)
            End If

        End Function

        ''' --- Prompt ------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Prompts the user for a value.
        ''' </summary>
        ''' <param name="fldField">The field for which the user will be prompted.</param>
        ''' <remarks>
        ''' The Prompt method prompts the user for a value, stores this value
        ''' in the associated record buffer (the variable or file object related to the field) and then displays the
        ''' formatted value.  
        ''' <note>
        ''' The Prompt method performs several processing steps.  They are as follows:<br/>
        '''  1. The user is prompted for input.  <br/>
        '''     If there is a value in the field, the current value is highlighted.<br/>
        '''     The entered value or null value is then assigned to the predefined variable FieldText.<br/>
        '''     If the field is of type Character, then the Upshift or Downshift is applied if specified.<br/>
        '''  2. The Input event associated to this field is then executed if applicable.  <br/>
        '''     This event can be used to change the value of FieldText.<br/>
        '''  3. If the FieldText size is 0, then the m_blnPromptOk member is set to False indicating no value was entered or substituted in the Input event.<br/>
        '''     This value is set to True if the user entered a value or a value was set during the Input event.<br/>
        '''     The rest of this step is ignored and execution resumes at step 8 if the m_blnPromptOK member is set to False and the Required,<br/>
        '''     Duplicate or Default properties are not set.<br/>
        '''     The duplicate buffer is assigned the value of FieldText.<br/>
        '''     Fields of type Numeric are checked for numbers and scaled by the input scale (if scaling is turned on).<br/>
        '''     Date fields are checked for a proper date.<br/>
        '''     The FieldValue predefined variable is then assigned with the numeric value of FieldText if this field<br/>
        '''     is of type Numeric or Date.<br/>
        '''  4. The value is assigned to the associated record buffer (the associated variable or file object) and in the duplicate record buffer.<br/>
        '''  5. The value is retrieved from the associated record buffer for display purposes.  The value is placed in FieldText.  Numeric items are scaled by<br/>
        '''     the output scale (if scaling is turned on) prior to being placed in FieldText and are right justified.  A Date item is placed in FieldText as a number,<br/>
        '''     without the separator.<br/>
        '''  6. The associated Output event is execute if applicable.<br/>
        '''     This event can be used to reformat the FieldText value prior to the final formatting options being applied.
        '''  7. For Numeric fields, numeric formatting is applied including the application of the Picture property.  Date fields are formatted using the<br/>
        '''     specified date format.  Character fields are formatted under the control of the Picture property.  The value is then displayed in the field.
        ''' </note>
        ''' </remarks>
        ''' <example>RequestPrompt(fldEMPLOYEE_EMPLOYEE_DOB)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function Prompt(ByRef fldField As DateControl) As Boolean

            If Me.UseAcceptProcessing Then
                m_intRequestSequence += 1

                MoveToPreviousControl(fldField, m_strRequestFlag, m_intRequestSequence)

                If Not MethodWasExecuted(m_strRequestFlag, m_intRequestSequence) AndAlso Not SkipFocusOnThisField(fldField) Then

                    ' Save the sequence information and set a flag indicating PROMPT was run.
                    SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                    ' Turn off InFieldValidation and store the control name.
                    'fldField.InFieldValidation = False
                    m_strUniqueControlId = fldField.RenderedID

                    ' Create the PostBack event.
                    fldField.SetAcceptRequestPrompt = True

                    ThrowCustomApplicationException(cAcceptRequestPromptException)

                Else

                    Dim blnClearLookup As Boolean = False
                    ' NOTE: This should not have an ANDALSO since we want to clear the EventTarget if a LOOKUP was used.
                    If Not MethodWasExecuted(m_strRequestFlag, m_intRequestSequence) And SkipFocusOnThisField(fldField) Then
                        ' Save the sequence information and set a flag indicating ACCEPT was run.
                        SetMethodExecutedFlag(m_strRequestFlag, "REQUEST_FLAG", m_intRequestSequence)

                        ' If we hit a run screen or accept verb, then don't run this again on the 
                        ' postback.  Otherwise the screen doesn't open properly.
                        If blnClearLookup Then
                            RemoveRunScreens(fldField.Name, 0)
                            ' Set to true for now.  This ensures that if we hit a runscreen or accept verb,
                            ' that we don't clear this on the postback.
                            'ScreenSession("CL" & fldField.Name) = True
                        End If
                    End If

                    ' Reset the field attributes.
                    'fldField.InFieldValidation = True
                    m_fldAcceptField = fldField

                    Dim blnIsInFieldValidation As Boolean = True
                    If m_intRequestSequence < m_strRequestFlag.Length Then
                        blnIsInFieldValidation = False
                    End If

                    ' Call the VALIDATE.
                    m_strControlName = fldField.Name
                    Dim blnReturnValue As Boolean = Validate(fldField, ValidateTypes.Request, blnIsInFieldValidation)
                    m_strControlName = String.Empty
                    m_fldAcceptField = Nothing
                    If Not m_htRunFlag Is Nothing AndAlso m_htRunFlag.ContainsKey(cPROCEDURE) Then m_strRunFlag = m_htRunFlag.Item(cPROCEDURE)
                    Return blnReturnValue

                End If
            Else
                Return Validate(fldField, ValidateTypes.Request)
            End If

        End Function


        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function Highlight(ByRef fldField As TextBox) As Boolean
            fldField.Highlight = True

            If fldField.RenderedID.StartsWith("dtl") Then
                If IsNothing(fldField.HighlightOccurence) Then
                    fldField.HighlightOccurence = New Hashtable
                End If

                If Not fldField.HighlightOccurence.Contains(Me.Occurrence) Then
                    fldField.HighlightOccurence.Add(Me.Occurrence, "")
                End If
            End If

        End Function

        '<EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)> _
        'Protected Function Highlight(ByRef fldField As ComboBox) As Boolean
        '    fldField.Highlight = True
        '    If IsNothing(fldField.HighlightOccurence) Then
        '        fldField.HighlightOccurence = New Hashtable
        '    End If

        '    If Not fldField.HighlightOccurence.Contains(Me.Occurrence) Then
        '        fldField.HighlightOccurence.Add(Me.Occurrence, "")
        '    End If
        'End Function

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function Highlight(ByRef fldField As DateControl) As Boolean
            fldField.Highlight = True
            If IsNothing(fldField.HighlightOccurence) Then
                fldField.HighlightOccurence = New Hashtable
            End If

            If Not fldField.HighlightOccurence.Contains(Me.Occurrence) Then
                fldField.HighlightOccurence.Add(Me.Occurrence, "")
            End If
        End Function
        ''' --- Display ------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Displays a value in a field.
        ''' </summary>
        ''' <param name="fldField">The field where the value will be displayed.</param>
        ''' <remarks>
        ''' The Display method retrieves the value from the associated record buffer (the variable or file object related to the field) and then displays the
        ''' formatted value.  
        ''' <note>
        ''' The Display method performs several processing steps.  They are as follows:<br/>
        '''  1. The value is retrieved from the associated record buffer for display purposes.  The value is placed in FieldText.  Numeric items are scaled by<br/>
        '''     the output scale (if scaling is turned on) prior to being placed in FieldText and are right justified.  A Date item is placed in FieldText as a number,<br/>
        '''     without the separator.<br/>
        '''  2. The associated Output event is execute if applicable.<br/>
        '''     This event can be used to reformat the FieldText value prior to the final formatting options being applied.
        '''  3. For Numeric fields, numeric formatting is applied including the application of the Picture property.  Date fields are formatted using the<br/>
        '''     specified date format.  Character fields are formatted under the control of the Picture property.  The value is then displayed in the field.
        ''' </note>
        ''' </remarks>
        ''' <example>Display(fldEMPLOYEE_EMPLOYEE_NAME)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function Display(ByRef fldField As TextBox) As Boolean

            If DisplayFileForDelete <> "" Then
                If fldField.FieldName.IndexOf(".") > -1 AndAlso fldField.FieldName.Substring(0, fldField.FieldName.IndexOf(".")) = DisplayFileForDelete AndAlso Not fldField.Fixed Then
                    Return Validate(fldField, ValidateTypes.Display)
                End If
            Else
                Return Validate(fldField, ValidateTypes.Display)
            End If



        End Function

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function DisplayReset(ByRef fldField As TextBox) As Boolean

            m_strDisplayReset = fldField.RenderedID

            If DisplayFileForDelete <> "" Then
                If fldField.FieldName.IndexOf(".") > -1 AndAlso fldField.FieldName.Substring(0, fldField.FieldName.IndexOf(".")) = DisplayFileForDelete AndAlso Not fldField.Fixed Then
                    Return Validate(fldField, ValidateTypes.Display)
                End If
            Else
                Return Validate(fldField, ValidateTypes.Display)
            End If

        End Function

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function DisplayReset(ByRef fldField As ComboBox) As Boolean

            m_strDisplayReset = fldField.RenderedID

            If DisplayFileForDelete <> "" Then
                If fldField.FieldName.IndexOf(".") > -1 AndAlso fldField.FieldName.Substring(0, fldField.FieldName.IndexOf(".")) = DisplayFileForDelete AndAlso Not fldField.Fixed Then
                    Return Validate(fldField, ValidateTypes.Display)
                End If
            Else
                Return Validate(fldField, ValidateTypes.Display)
            End If

        End Function




        ''' --- Display ------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Displays a value in a field.
        ''' </summary>
        ''' <param name="fldField">The field where the value will be displayed.</param>
        ''' <remarks>
        ''' The Display method retrieves the value from the associated record buffer (the variable or file object related to the field) and then displays the
        ''' formatted value.  
        ''' <note>
        ''' The Display method performs several processing steps.  They are as follows:<br/>
        '''  1. The value is retrieved from the associated record buffer for display purposes.  The value is placed in FieldText.  Numeric items are scaled by<br/>
        '''     the output scale (if scaling is turned on) prior to being placed in FieldText and are right justified.  A Date item is placed in FieldText as a number,<br/>
        '''     without the separator.<br/>
        '''  2. The associated Output event is execute if applicable.<br/>
        '''     This event can be used to reformat the FieldText value prior to the final formatting options being applied.
        '''  3. For Numeric fields, numeric formatting is applied including the application of the Picture property.  Date fields are formatted using the<br/>
        '''     specified date format.  Character fields are formatted under the control of the Picture property.  The value is then displayed in the field.
        ''' </note>
        ''' </remarks>
        ''' <example>Display(fldEMPLOYEE_EMPLOYEE_TYPE)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function Display(ByRef fldField As ComboBox) As Boolean

            If DisplayFileForDelete <> "" Then
                If fldField.FieldName.IndexOf(".") > -1 AndAlso fldField.FieldName.Substring(0, fldField.FieldName.IndexOf(".")) = DisplayFileForDelete Then
                    Return Validate(fldField, ValidateTypes.Display)
                End If
            Else
                Return Validate(fldField, ValidateTypes.Display)
            End If

        End Function

        ''' --- Display ------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Displays a value in a field.
        ''' </summary>
        ''' <param name="fldField">The field where the value will be displayed.</param>
        ''' <remarks>
        ''' The Display method retrieves the value from the associated record buffer (the variable or file object related to the field) and then displays the
        ''' formatted value.  
        ''' <note>
        ''' The Display method performs several processing steps.  They are as follows:<br/>
        '''  1. The value is retrieved from the associated record buffer for display purposes.  The value is placed in FieldText.  Numeric items are scaled by<br/>
        '''     the output scale (if scaling is turned on) prior to being placed in FieldText and are right justified.  A Date item is placed in FieldText as a number,<br/>
        '''     without the separator.<br/>
        '''  2. The associated Output event is execute if applicable.<br/>
        '''     This event can be used to reformat the FieldText value prior to the final formatting options being applied.
        '''  3. For Numeric fields, numeric formatting is applied including the application of the Picture property.  Date fields are formatted using the<br/>
        '''     specified date format.  Character fields are formatted under the control of the Picture property.  The value is then displayed in the field.
        ''' </note>
        ''' </remarks>
        ''' <example>Display(fldEMPLOYEE_EMPLOYEE_DOB)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function Display(ByRef fldField As DateControl) As Boolean

            If DisplayFileForDelete <> "" Then
                If fldField.FieldName.IndexOf(".") > -1 AndAlso fldField.FieldName.Substring(0, fldField.FieldName.IndexOf(".")) = DisplayFileForDelete Then
                    Return Validate(fldField, ValidateTypes.Display)
                End If
            Else
                Return Validate(fldField, ValidateTypes.Display)
            End If

        End Function



        ''' --- Edit ---------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Edits a value in a field.
        ''' </summary>
        ''' <param name="fldField">The field for which the value will be edited.</param>
        ''' <remarks>
        ''' The Edit method performs value checking, initiates the LookupOn and LookupNotOn events and executes the associated Edit and Process events for the named field.  
        ''' <note>
        ''' The Edit method performs the following processing steps:<br/>
        '''  1. Dictionary editing is performed on FieldText (for fields of type Character) and FieldValue (for fields of type Numeric or Date).<br/>
        '''     This editing is as follows: <br/><br/>
        '''     The value is checked to ensure that it is within the range of possible values (if applicable) as specified in the FieldValues property.<br/>
        '''     The value is checked to ensure that it matches the Pattern as specified in the Pattern property.<br/>
        '''     The LookupOn and LookupNotOn events are initiated to check if the value is found or not found on the specified files.<br/>
        '''     The OldValue function can be used to determine the value in the record buffer of the associated item.<br/>
        '''  2. The Edit event associated to this field is then executed if applicable.  Use the FieldText (Character) or FieldValue (for Numeric and Date fields)<br/>
        '''     predefined items to change the value if necessary.  This value will be re-assigned to the underlying record buffers in the next step.<br/>
        '''  3. The Process event associated to this field is executed if applicable.  This event can be used to to perform processing or data manipulation<br/>
        '''     on the changed item.<br/>
        ''' </note>
        ''' </remarks>
        ''' <example>Edit(fldEMPLOYEE_EMPLOYEE_BENEFIT)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function Edit(ByRef fldField As TextBox) As Boolean

            Return Validate(fldField, ValidateTypes.Edit)

        End Function

        ''' --- Edit ---------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Edits a value in a field.
        ''' </summary>
        ''' <param name="fldField">The field for which the value will be edited.</param>
        ''' <remarks>
        ''' The Edit method performs value checking, initiates the LookupOn and LookupNotOn events and executes the associated Edit and Process events for the named field.  
        ''' <note>
        ''' The Edit method performs the following processing steps:<br/>
        '''  1. Dictionary editing is performed on FieldText (for fields of type Character) and FieldValue (for fields of type Numeric or Date).<br/>
        '''     This editing is as follows: <br/><br/>
        '''     The value is checked to ensure that it is within the range of possible values (if applicable) as specified in the FieldValues property.<br/>
        '''     The value is checked to ensure that it matches the Pattern as specified in the Pattern property.<br/>
        '''     The LookupOn and LookupNotOn events are initiated to check if the value is found or not found on the specified files.<br/>
        '''     The OldValue function can be used to determine the value in the record buffer of the associated item.<br/>
        '''  2. The Edit event associated to this field is then executed if applicable.  Use the FieldText (Character) or FieldValue (for Numeric and Date fields)<br/>
        '''     predefined items to change the value if necessary.  This value will be re-assigned to the underlying record buffers in the next step.<br/>
        '''  3. The Process event associated to this field is executed if applicable.  This event can be used to to perform processing or data manipulation<br/>
        '''     on the changed item.<br/>
        ''' </note>
        ''' </remarks>
        ''' <example>Edit(fldEMPLOYEE_EMPLOYEE_BENEFIT)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function Edit(ByRef fldField As ComboBox) As Boolean

            Return Validate(fldField, ValidateTypes.Edit)

        End Function

        ''' --- Edit ---------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Edits a value in a field.
        ''' </summary>
        ''' <param name="fldField">The field for which the value will be edited.</param>
        ''' <remarks>
        ''' The Edit method performs value checking, initiates the LookupOn and LookupNotOn events and executes the associated Edit and Process events for the named field.  
        ''' <note>
        ''' The Edit method performs the following processing steps:<br/>
        '''  1. Dictionary editing is performed on FieldText (for fields of type Character) and FieldValue (for fields of type Numeric or Date).<br/>
        '''     This editing is as follows: <br/><br/>
        '''     The value is checked to ensure that it is within the range of possible values (if applicable) as specified in the FieldValues property.<br/>
        '''     The value is checked to ensure that it matches the Pattern as specified in the Pattern property.<br/>
        '''     The LookupOn and LookupNotOn events are initiated to check if the value is found or not found on the specified files.<br/>
        '''     The OldValue function can be used to determine the value in the record buffer of the associated item.<br/>
        '''  2. The Edit event associated to this field is then executed if applicable.  Use the FieldText (Character) or FieldValue (for Numeric and Date fields)<br/>
        '''     predefined items to change the value if necessary.  This value will be re-assigned to the underlying record buffers in the next step.<br/>
        '''  3. The Process event associated to this field is executed if applicable.  This event can be used to to perform processing or data manipulation<br/>
        '''     on the changed item.<br/>
        ''' </note>
        ''' </remarks>
        ''' <example>Edit(fldEMPLOYEE_EMPLOYEE_BENEFIT)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function Edit(ByRef fldField As DateControl) As Boolean

            Return Validate(fldField, ValidateTypes.Edit)

        End Function




        ''' --- AddMessage ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Adds a message to the messages collection.
        ''' </summary>
        ''' <param name="Message">A structure containing the message information.</param>
        ''' <remarks>The message collection contains the list of messages to display in the message bar on the screen.
        ''' </remarks>
        ''' <example>AddMessage(Message)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend Sub AddMessage(ByVal Message As stcMessage)
            If m_blnInDetailFind Then
                For i As Integer = 1 To m_colMessages.Count
                    If CType(m_colMessages.Item(i - 1), stcMessage).Text = Message.Text Then
                        Exit Sub
                    End If
                Next
                m_colMessages.Add(Message)
            Else
                m_colMessages.Add(Message)
            End If

        End Sub

        ''' --- AddMessage ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Adds messages to the current collection.
        ''' </summary>
        ''' <param name="Messages">A collection of Messages.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend Sub AddMessage(ByVal Messages As Collection)

            Dim Message As stcMessage

            ' Loop through the messages in the collection and
            ' add it to the current collection.
            For Each Message In Messages
                AddMessage(Message)
            Next

        End Sub

        ''' --- AddMessage ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Adds a message to the current Message Collection.
        ''' </summary>
        ''' 
        ''' <param name="Message">A string containing a specific message.</param>
        ''' <param name="Type">A MessageType describing the type of message.</param>
        ''' <param name="Parameters">An array of message parameters.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend Sub AddMessage(ByVal Message As String, ByVal Type As MessageTypes, ByVal ParamArray Parameters() As Object)

            Dim oMessage As stcMessage


            Try
                'Only set IM flag if we have not already found a non-IM type message
                If m_IsNotIMMessage <> BooleanTypes.True Then
                    'Check if this is not an internal message (IM)
                    If Message.StartsWith("IM.") Then
                        m_IsNotIMMessage = BooleanTypes.False
                    Else
                        m_IsNotIMMessage = BooleanTypes.True
                    End If
                End If

                oMessage = ReturnMessage(Message, Type, Parameters)
                AddMessage(oMessage)

                ' If the message was thrown in the Exit procedure, display it on the previous page.
                If m_blnExecutingExit AndAlso m_fldAcceptField Is Nothing Then
                    If Type = MessageTypes.Error OrElse Type = MessageTypes.Severe Then
                        oMessage.Type = MessageTypes.Warning
                        blnPassedMessagesError = True
                    End If

                End If

                If Type = MessageTypes.Error OrElse Type = MessageTypes.Severe Then

                    ' For SEVERE messages, run the BACKOUT procedure.
                    If Type = MessageTypes.Severe Then
                        Try
                            ' Call the Backout procedure.
                            m_blnExecutingBackout = True

                            Try
                                Backout()
                            Catch ex As CustomApplicationException
                                Throw ex
                            Catch ex As Exception
                                ExceptionManager.Publish(ex)
                                Throw ex
                            End Try
                            m_blnExecutingBackout = False
                            ' Save the RESET AT STARTUP variables.

                            ' Set the mode to NoMode in order to clear the screen.
                            Mode = PageModeTypes.NoMode

                            ' Store the VALIDATE flag in case the SEVERE is raised during the Validation process.
                            ' This ensures that EndValidate doesn't fail.
                            Dim flag As String ' = Session(FormName + "_" + Level.ToString + "_" + "VALIDATE") & ""
                            RemoveFlags()
                            ' Reset the value so the EndValidate doesn't fail.
                            'Session(FormName + "_" + Level.ToString + "_" + "VALIDATE") = flag
                        Catch ex As Exception
                            ' Do Nothing
                        End Try
                    End If

                    If ControlHasFocus Is Nothing OrElse ControlHasFocus.GetType.ToString() <> "Core.Windows.UI.Core.Windows.UI.Designer" Then
                        Me.HasError = True
                    End If

                    ThrowCustomApplicationException(cAddMessageError)
                End If

            Catch ex As CustomApplicationException

                Throw ex

            Catch ex As Exception

                ' Write the exception to the event log and throw an error.
                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Sub

        ''' --- ErrorMessage -------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Adds an Error message to the message collection.
        ''' </summary>
        ''' <param name="Message">A string containing a specific Error Message.</param>
        ''' <param name="Parameters">An array of message parameters.</param>
        ''' <remarks>
        ''' The ErrorMessage method stops execution and displays an error on the screen.
        ''' <note>
        ''' This method will stop code execution and will reprompt at the last executed Accept method if 
        ''' applicable.  A message will then be displayed in the messagebar area.
        ''' NOTE: The ErrorMessage method will cause the screen to close when called from the Intialize method.  
        ''' </note>
        ''' </remarks>
        ''' <example>ErrorMessage("The value you entered is not a valid status type.")<br/>
        ''' ErrorMessage("The value at row " + Occurrence + " is incorrect.")<br/><br/>
        ''' The following syntax is used when substituting values in error messages that are in the globalization dll:<br/>
        ''' Globalization value is "Employee {0} has exceeded his allowable expense limit of {1}"<br/>
        ''' ErrorMessage("MSG0001", fleEMPLOYEE.GetStringValue("EMPLOYEE_NAME"), T_TEMP.Value)
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function ErrorMessage(ByVal Message As String, ByVal ParamArray Parameters() As Object)

            'Cancel the push if there is an error
            m_strPush = ""

            If m_strPreviousFor.Length > 0 Then
                Dim objForInfo As ForInfo

                'Get the ForInfo for the passed "ForID"
                objForInfo = CType(m_hstNestedForInfo(m_strPreviousFor), ForInfo)

                'Reset Main Occurrence on the Page to Previous Value and if applicable, bind Grid Fields
                Me.SetOccurrence(objForInfo.PreviousOccurrence)

                'Release the reference to ForInfo
                objForInfo = Nothing

                m_strPreviousFor = ""

            End If

            If Me.m_blnInFindOrDetailFind AndAlso Me.m_blnIsGetDataIssuedFromFindOrDetailFind Then
                If m_intRecordsToFillInFindOrDetailFind < 0 Then m_intRecordsToFillInFindOrDetailFind = 0
                If Not Me.m_blnErrorInLastRecord AndAlso m_blnSkipRecordsWithError Then
                    m_intRecordsToFillInFindOrDetailFind += 1
                    Me.m_blnErrorInLastRecord = True
                End If
                'From Find or DetailFind, If GetData has already been issued (at least once), don't stop execution on error
                'Enum ErrorAsInformation has been added to Display Error with Error icon however, will not stop execution
                AddMessage(Message, MessageTypes.ErrorAsInformation, Parameters)
            ElseIf Message = "Record not found in lookup table ({0})." OrElse Message = "Value already exists ({0})." Then 'IM.RecordNotFound 'IM.ValueExists
                Dim strName As String = String.Empty
                If Not m_bfoFileForRecordStatus Is Nothing Then
                    If m_bfoFileForRecordStatus.AliasName.Length > 0 Then
                        strName = m_bfoFileForRecordStatus.AliasName
                    Else
                        strName = m_bfoFileForRecordStatus.BaseName
                    End If
                Else
                    strName = m_strLookupNotOnFile
                End If
                AddMessage(Message, MessageTypes.Error, strName)
            Else
                AddMessage(Message, MessageTypes.Error, Parameters)
            End If
        End Function

        ''' --- Information --------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Adds an Information message to the message collection.
        ''' </summary>
        ''' <param name="Message">A string containing a specific Error Message.</param>
        ''' <param name="Parameters">An array of message parameters.</param>
        ''' <remarks>
        ''' The Information method displays a information message to the user.
        ''' </remarks>
        ''' <example>Information("A record will be added to the Employee table.")<br/>
        ''' Information("The value at row " + Occurrence + " will be used.")<br/><br/>
        ''' The following syntax is used when substituting values in messages that are in the globalization dll:<br/>
        ''' Globalization value is "Employee {0} has exceeded his allowable expense limit of {1}"<br/>
        ''' Information("MSG0001", fleEMPLOYEE.GetStringValue("EMPLOYEE_NAME"), T_TEMP.Value)
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function Information(ByVal Message As String, ByVal ParamArray Parameters() As Object)
            If Message.Trim.Length > 0 Then
                AddMessage(Message, MessageTypes.Information, Parameters)
            End If
            Return Nothing
        End Function

        ''' --- ResponseMessage --------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Displays a popup message on the form and waits for the user to click OK.
        ''' </summary>
        ''' <param name="Message">A string containing a specific Error Message.</param>
        ''' <param name="Parameters">An array of message parameters.</param>
        ''' <remarks>
        ''' The ResponseMessage method displays a information message to the user.
        ''' </remarks>
        ''' <example>ResponseMessage("A record will be added to the Employee table.")<br/>
        ''' ResponseMessage("The value at row " + Occurrence + " will be used.")<br/><br/>
        ''' The following syntax is used when substituting values in messages that are in the globalization dll:<br/>
        ''' Globalization value is "Employee {0} has exceeded his allowable expense limit of {1}"<br/>
        ''' ResponseMessage("MSG0001", fleEMPLOYEE.GetStringValue("EMPLOYEE_NAME"), T_TEMP.Value)
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function ResponseMessage(ByVal Message As String, ByVal ParamArray Parameters() As Object)
            m_strResponseMessage = ReturnMessage(Message, MessageTypes.Information, Parameters).Text
            Return Nothing
        End Function

        ''' --- ReturnMessage ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Returns the translated message.
        ''' </summary>
        ''' 
        ''' <param name="Message">A string containing a specific message.</param>
        ''' <param name="Type">A MessageType describing the type of message.</param>
        ''' <param name="Parameters">An array of message parameters.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function ReturnMessage(ByVal Message As String, ByVal Type As MessageTypes, ByVal ParamArray Parameters() As Object) As stcMessage

            Dim oMessage As stcMessage
            Dim strMessageNumber As String
            Dim strNumber As String = String.Empty
            Dim strMessage As String = String.Empty

            Try

                strMessageNumber = Message

                ' Retrieve the message number.
                If Message.IndexOf("MSG") > -1 Then
                    strNumber = strMessageNumber.Substring(3)
                Else
                    strNumber = strMessageNumber
                End If

                ' Get the message from the resource file.
                If strMessageNumber.Trim.Length > 0 Then
                    strMessage = Page.GetString(strMessageNumber, Globalization.Core.Globalization.ResourceTypes.Message)
                    If strMessage Is Nothing Then strMessage = String.Empty
                Else
                    'To handle an empty error message
                    strMessage = strMessageNumber
                End If

                If strMessage = "????" Then
                    strMessage = Message
                End If

                ' Replace the substitution characters with the values.
                If Not IsNothing(Parameters) Then
                    If strMessage.Length > 0 Then
                        Try
                            strMessage = String.Format(strMessage, Parameters)
                        Catch ex As System.FormatException
                            strMessage = "Wrong number of substitution parameters."
                        Catch ex As Exception
                            strMessage = ex.Message
                        End Try
                    Else
                        strMessage = String.Empty
                    End If
                End If

                ' If the message doesn't exist in the globalization,
                ' the user must have hardcoded an overriden value.
                If strMessage = "????" Or strMessage.Trim.Length = 0 Then
                    'Display an unknown error message or an empty error message
                    strMessage = strNumber
                    strNumber = String.Empty
                End If

                'Add Message whether it is 
                oMessage.Text = strMessage
                oMessage.Number = strNumber
                oMessage.Type = Type

                Return oMessage

            Catch ex As CustomApplicationException

                Throw ex

            Catch ex As Exception

                ' Write the exception to the event log and throw an error.
                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function
        ''' --- Severe -------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Adds an Severe message to the message collection and aborts processing.
        ''' </summary>
        ''' <param name="Message">A string containing a specific Sever message.</param>
        ''' <param name="Parameters">An array of message parameters.</param>
        ''' <remarks>
        ''' The Severe method stops execution, re-initializes the buffers, calls the Backout method and positions the cursor in the field associated with the error message.
        ''' </remarks>
        ''' <example>Severe("The value you entered is not a valid status type.")<br/>
        ''' Severe("The value at row " + Occurrence + " is incorrect.")<br/><br/>
        ''' The following syntax is used when substituting values in error messages that are in the globalization dll:<br/>
        ''' Globalization value is "Employee {0} has exceeded his allowable expense limit of {1}"<br/>
        ''' Sever("MSG0001", fleEMPLOYEE.GetStringValue("EMPLOYEE_NAME"), T_TEMP.Value)
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function Severe(ByVal Message As String, ByVal ParamArray Parameters() As Object)
            AddMessage(Message, MessageTypes.Severe, Parameters)
            Return Nothing
        End Function

        ''' --- Warning ------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Adds a Warning message to the message collection.
        ''' </summary>
        ''' <param name="Message">A string containing a specific Error Message.</param>
        ''' <param name="Parameters">An array of message parameters.</param>
        ''' <remarks>
        ''' The Warning method displays a warning message to the user.
        ''' </remarks>
        ''' <example>Information("A record will be added to the Employee table.")<br/>
        ''' Information("The value at row " + Occurrence + " will be used.")<br/><br/>
        ''' The following syntax is used when substituting values in messages that are in the globalization dll:<br/>
        ''' Globalization value is "Employee {0} has exceeded his allowable expense limit of {1}"<br/>
        ''' Information("MSG0001", fleEMPLOYEE.GetStringValue("EMPLOYEE_NAME"), T_TEMP.Value)
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function Warning(ByVal Message As String, ByVal ParamArray Parameters() As Object)
            AddMessage(Message, MessageTypes.Warning, Parameters)
            Return Nothing
        End Function

        ''' --- DoExternal ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Executes an external program.
        ''' </summary>
        ''' <param name="External">A String containing the command to execute.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Function DoExternal(ByVal External As String) As Boolean

            DoExternal(External, Nothing)

        End Function

        ''' --- DoExternal ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Executes an external program.
        ''' </summary>
        ''' <param name="External">A String containing the command to execute.</param>
        ''' <param name="Parameters">An array of command parameters.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Function DoExternal(ByVal External As String, ByVal ParamArray Parameters() As Object) As Boolean

            ' TODO: Add code for DoExternal.  Created wrapper class for generation purpose.
            If Me.UseAcceptProcessing Then
                m_intDoExternalSequence += 1
                If Not MethodWasExecuted(m_strDoExternalFlag, m_intDoExternalSequence) Then

                    SetMethodExecutedFlag(m_strDoExternalFlag, "DOEXTERNAL_FLAG", m_intDoExternalSequence)
                Else

                End If
            Else

            End If

        End Function

        ''' --- RunCommand ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RunCommand.
        ''' </summary>
        ''' <param name="Command"></param>
        ''' <param name="OnError"></param>
        ''' <param name="NoWarn"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Function RunCommand(ByVal Command As String, Optional ByVal OnError As OnErrorOptions = OnErrorOptions.Terminate, Optional ByVal NoWarn As Boolean = False) As Boolean

            ' TODO: Add code for RunCommand.  Created wrapper class for generation purpose.
            If Me.UseAcceptProcessing Then
                m_intRunCommandSequence += 1
                If Not MethodWasExecuted(m_strRunCommandFlag, m_intRunCommandSequence) Then

                    SetMethodExecutedFlag(m_strRunCommandFlag, "RUNCOMMAND_FLAG", m_intRunCommandSequence)
                Else

                End If
            Else

            End If

        End Function



        ''' --- DesignerReports ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Executes SaveState and RunScreenScript code after a report designer has run.
        ''' </summary>
        ''' <param name="dsrDesigner"></param>
        ''' <param name="StateRequired"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <example>DesignerReports(dsr99)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Sub DesignerReports(ByRef dsrDesigner As Windows.UI.Designer, Optional ByVal StateRequired As Boolean = False)



            If m_strRunScreen.Length > 0 Then
                Dim strScript As StringBuilder
                Dim m_strOldPageBodyOnloadTag As String ' = CoreBodyTag.Attributes("onload")

                ' Set the command argument (intPosition).
                'dsrDesigner.CommandName = "RunScreen"
                'dsrDesigner.CommandArgument = "1"

                ' Create the script to cal the run screen.
                strScript = New StringBuilder("<script defer id=""scriptExecuteRunScreen"" Language=""javascript"">")
                strScript.Append(vbNewLine)
                strScript.Append("function ExecuteRunScreen()")
                strScript.Append(vbNewLine)
                strScript.Append("{")
                ' Note: For Debuging/Viewing Source of a modal screens
                ' To open in a non-modal window Change False to True 
                'If False Then
                '    strScript.Append("    window.open('../ReportPages/" + m_strRunScreen + ".aspx');")
                'Else
                '    strScript.Append("    window.showModalDialog('../DialogForm.aspx?DialogForm=")
                '    strScript.Append("ReportPages")
                '    strScript.Append("/")
                '    strScript.Append(m_strRunScreen)
                '    strScript.Append(".aspx")
                '    strScript.Append("&Processing=").Append(DisplayProcessingPage.ToString)
                '    strScript.Append("&Title=").Append(m_strRunScreen)
                '    strScript.Append("', '', '").Append(GetScreenDialogProperties(m_strRunScreen)).Append("');")
                '    strScript.Append(vbNewLine)
                '    strScript.Append("__doPostBack('")
                '    strScript.Append(dsrDesigner.ID)
                '    strScript.Append("','")
                '    strScript.Append("')")
                'End If
                'strScript.Append(vbNewLine)
                'strScript.Append("}")
                'strScript.Append("</script>")
                'strScript.Append(vbNewLine)
                'Page.ClientScript.RegisterClientScriptBlock(Me.GetType(), "ExecuteRunScreen", strScript.ToString)
                'CoreBodyTag.Attributes.Add("onload", "ExecuteRunScreen();" & m_strOldPageBodyOnloadTag)

                strScript = Nothing
            Else
                ' Remove the command argument.
                'dsrDesigner.CommandName = "RunScreen"
                'dsrDesigner.CommandArgument = String.Empty
            End If

        End Sub

        ''' --- GetDesigner --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Retreives the Designer Link object used during InFieldValidation.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetDesigner() As Windows.UI.Designer
            Dim strDesignerName As String = String.Empty
            Dim objDesignerLink As Core.Windows.UI.Designer = Nothing
            strDesignerName = Me.DesignerName
            If strDesignerName <> "" Then
                objDesignerLink = Me.FindControl(strDesignerName)
                If objDesignerLink Is Nothing Then
                    'This should not be the case. Something went wrong!!!
                End If
            End If
            Return objDesignerLink
        End Function


        Public Function FindControl(controlname As String) As Object

            Return New Object
        End Function


        '-------------------------------------------------------------------
        ' Name: SetCurrentRecordPosition
        ' Note: This Method is for internal use
        ' Function: This function gets a record count based on the current
        '           WHERE clause passed in, and based on NavigationType
        '           it sets the position of the Current Record
        ' Example: SetCurrentRecordPosition(MyFile, "WhereClause", "SelectIfCondition", "AccessClause, "OrderByClause")
        '-------------------------------------------------------------------
        ''' --- SetCurrentRecordPosition -------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SetCurrentRecordPosition.
        ''' </summary>
        ''' <param name="File"></param>
        ''' <param name="WhereClause"></param>
        ''' <param name="SelectIf"></param>
        ''' <param name="AccessClause"></param>
        ''' <param name="OrderByClause"></param>
        ''' <param name="WholeWhereCondition"></param>
        ''' <param name="SkippedRecords"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function SetCurrentRecordPosition(ByVal File As BaseFileObject, ByVal WhereClause As String, ByVal SelectIf As String, ByVal AccessClause As String, ByVal OrderByClause As String, ByRef WholeWhereCondition As String, ByVal SkippedRecords As Integer, Optional ByVal stroverridesql As String = "") As String

            Try
                Dim strBaseName As String
                Dim strAliasName As String
                Dim intOccurs As Integer
                Dim intRecordCount As Integer
                Dim blnIsDetail As Boolean = False
                Dim blnIsGrid As Boolean = False

                Dim strSQL As StringBuilder = New StringBuilder("")
                Dim strRelation As String
                Dim strSelectProcessing As String = String.Empty

                With File
                    strBaseName = .BaseName
                    strAliasName = .AliasName
                    intOccurs = .Occurs

                    'Occurs can't be Zero; by default Occurs is 1 
                    If intOccurs = 0 Then intOccurs = 1

                    blnIsDetail = (.Type = FileTypes.Detail)
                    blnIsGrid = .BoundToGrid
                End With
                If WholeWhereCondition Is Nothing Then WholeWhereCondition = String.Empty
                BuildWhereCondition(WholeWhereCondition, WhereClause)
                BuildWhereCondition(WholeWhereCondition, AccessClause)
                BuildWhereCondition(WholeWhereCondition, SelectIf)

                ' Don't call SelectProcessing if it is not GetData for "Detail" File
                ' For Non-Detail Files, if it is PostBack or a screen has 
                ' "Request" fields then call SelectProcessing
                If File.Type = FileTypes.Primary Then
                    m_blnIsRunningSelectProcessing = True

                    Try
                        BuildWhereCondition(WholeWhereCondition, SelectProcessing())
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                    m_blnIsRunningSelectProcessing = False
                End If

                If strAliasName.Trim.Length = 0 Then
                    strRelation = strBaseName
                Else
                    strRelation = strAliasName
                End If

                ' Add the navigation code.
                ' Set the record number when in FIND mode.
                If Page.Mode = PageModeTypes.Find Then
                    Dim lngRecNo As Long

                    intRecordCount = File.GetRecordCount(WholeWhereCondition, stroverridesql)
                    File.TotalRecordsFound = intRecordCount

                    If blnIsGrid Then
                        Me.TotalGridRecords = intRecordCount

                        TotalPages = (intRecordCount / intOccurs)
                        If intRecordCount > (intTotalPages * intOccurs) Then
                            TotalPages += 1
                        End If


                    End If

                    If Page.ScreenType = ScreenTypes.Grid Then Page.EnableNavigation = False
                    If Not blnIsDetail AndAlso File.Type <> FileTypes.Secondary Then NavigationRecordCount = intRecordCount

                    ' Get the record number.
                    If blnIsGrid Then
                        If Me.PageActionType = PageActionType.PaginationClick Then
                            ' In case of Pagination, a DataList control is setting proper GridRecordNumber
                            lngRecNo = GridRecordNumber
                        Else
                            'If not a pagination then always display the first Grid Record/Page
                            lngRecNo = 1
                        End If

                        If SkippedRecords > 0 Then
                            With File
                                Dim intTotalSkippedRecords As Integer
                                intTotalSkippedRecords = .TotalSkippedRecords + SkippedRecords
                                .TotalSkippedRecords = intTotalSkippedRecords
                            End With
                        End If
                    Else
                        lngRecNo = CurrentRecordNumber
                    End If

                    '---------------------------
                    ' Note: About Pagination and Calling SubSelect with IsGrid True
                    ' In a ScreenType = Grid, DataList calls  
                    ' Find with Next Navigation Type, while setting a Record Number 
                    ' one less than the requested Page's first record 
                    '
                    ' However in case of Primary Detail Screen DataList issues 
                    ' Find with NavigationType = Next of the Primary Table,
                    ' while setting Primary Table's Current Record to one less 
                    ' than the existing CurrentRecordNumber Property.
                    '
                    ' So in case of Primary Detail Screen, while running 
                    ' Sub Select for a Grid Table, has already set a proper 
                    ' lngRecNo with either GridRecordNumber or 1
                    '---------------------------
                    If (Not blnIsGrid) OrElse (blnIsGrid AndAlso Me.ScreenType = ScreenTypes.Grid AndAlso SkippedRecords < 0) Then
                        ' Change the record number based on the operation.
                        Select Case Page.NavigationType
                            Case NavigationTypes.First, NavigationTypes.None
                                lngRecNo = 1
                            Case NavigationTypes.Previous
                                If lngRecNo > 1 Then
                                    lngRecNo -= 1
                                End If
                            Case NavigationTypes.Next
                                If lngRecNo >= intRecordCount Then
                                    lngRecNo = intRecordCount
                                Else
                                    lngRecNo += 1
                                End If
                            Case NavigationTypes.Last
                                lngRecNo = intRecordCount
                        End Select
                    End If

                    ' Set m_lngRecNo.
                    If lngRecNo > 0 Then
                        If SkippedRecords <= 0 Then
                            m_lngRecNo = lngRecNo - 1
                        End If
                        File.CurrentRecordPosition = lngRecNo
                    Else
                        m_lngRecNo = 0
                        File.CurrentRecordPosition = 1
                    End If

                End If

                ' Set the CurrentRecordNumber for the main navigation.
                If Not blnIsDetail AndAlso File.Type <> FileTypes.Secondary Then
                    m_intCurrentRecordNumber = m_lngRecNo + 1
                End If

            Catch ex As CustomApplicationException

                ExceptionManager.Publish(ex)
                Throw ex

            Catch ex As Exception

                ' Write the exception to the event log and throw an error.
                ExceptionManager.Publish(ex)
                Throw ex

            End Try
            Return Nothing
        End Function

        ''' --- TotalRecordsProcessed ----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	A count of the Total Records Processed.
        ''' </summary>
        ''' <remarks>
        ''' <note>Only to be used while skipping records with an error in Find/DetailFind.</note>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Overridable Property TotalRecordsProcessed() As Integer
            'Note: Only to be used in While skipping records with an error in Find/DetailFind
            Get
                Return intTotalRecordsProcessed
            End Get
            Set(ByVal Value As Integer)
                intTotalRecordsProcessed = Value
            End Set
        End Property

        ''' --- CallPath -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CallPath.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub CallPath()
            Dim blnCallPath As Boolean = True
            'Determine whether to get Request Values from Record Buffer or from Path
            Select Case Me.PageActionType
                Case PageActionType.ToolbarClick
                    Select Case Me.ToolbarAction
                        Case ToolbarIcons.First, ToolbarIcons.Previous, ToolbarIcons.Next, ToolbarIcons.Last
                            blnCallPath = False
                        Case ToolbarIcons.Submit
                            If Me.UseAcceptProcessing Then blnCallPath = False
                    End Select
                Case PageActionType.PaginationClick
                    blnCallPath = False
            End Select

            ' Set m_blnExecutingPath to True so that any call to 
            ' SetValue in FileObject doesn't alter a record
            m_blnExecutingPath = True

            ' Call the Path procedure.
            If blnCallPath Then
                'Reset the Path
                m_intPath = 0
                'Require Validate Requests from SelectProcessing
                m_blnRequireValidateRequest = True

                CoreWebTrace("Path", "Start Path")

                Try
                    Path()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
                CoreWebTrace("Path", "End Path")

                m_blnExecutingPostPath = True
                m_blnInPostFindOrDetailPostFind = True
                CoreWebTrace("Path", "Start PostPath")

                Try
                    PostPath()  ' This happens after SELECT processing.
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
                CoreWebTrace("Path", "End PostPath")
                m_blnInPostFindOrDetailPostFind = False
                m_blnExecutingPostPath = False

                'Store Previous Path
                'ViewState("Path") = m_intPath
            Else

                CoreWebTrace("Path", "Start RaiseUpdateRequestBuffer")
                Me.RaiseUpdateRequestBuffer()

                'Doesn't Require Validate Requests from SelectProcessing, rather
                'use values from Request Buffer (from File Object)
                m_blnRequireValidateRequest = False

                'Restore the Previous Path into the current Path Variable
                m_intPath = GetPreviousPath()

                CoreWebTrace("Path", "End RaiseUpdateRequestBuffer")
            End If

            ' Reset m_blnExecutingPath back to False so that any call to 
            ' SetValue in FileObject mark a record as altered
            m_blnExecutingPath = False

        End Sub

        ''' --- UpdateProcessing ---------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	This method calls the PreUpdate, Update and PostUpdate methods.
        ''' </summary>
        ''' <remarks>
        ''' The CallUpdate method should be used only in the PreCommands/PostCommands event of a 
        ''' designer in order to call Update processing which includes the PreUpdate, Update 
        ''' and PostUpdate methods.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Sub UpdateProcessing()

            If Not UpdateProcessingCalled Then
                CallUpdate()
                UpdateProcessingCalled = True
            End If

        End Sub

        ''' --- CallCancel ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	This method is calls the cancel code.
        ''' </summary>
        ''' <remarks>
        ''' This method is calls the cancel code.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Sub CallCancel()

            m_intRequestSequence = 0 ' Remove the Request Sequence value from ViewState as the Find process completed.
            blnFindComplete = False

            m_strHidControl = String.Empty
            m_htSearchTypes = New Hashtable
            RaiseClearControls()
            m_preCancelMode = Mode
            Mode = PageModeTypes.NoMode
            IsInAppendOrEntry = False
            NavigationType = NavigationTypes.Cancel
            If HasGrid Then
                RaiseShowGrid(True)
            End If



            RaiseEvent DisplayControl()
        End Sub

        ''' --- ClearScreen ---------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	This method is used to clear the screen (and puts the screen in NoMode).
        ''' </summary>
        ''' <remarks>
        ''' The ClearScreen method clears the screen and puts the screen in NoMode.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Sub ClearScreen()

            CallCancel()
            NavigationType = NavigationTypes.Cancel

        End Sub


          Private Sub ClearUniqueControl(sender As Object, e As EventArgs)
            Dim blnCalledByGrid As Boolean = False

            Dim dtime = TryCast(sender, DispatcherTimer)
            If dtime IsNot Nothing Then
                dtime.[Stop]()
            End If
            dtime = Nothing
            UniqueControl = Nothing

        End Sub
        ''' --- CallUpdate ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	This method calls the PreUpdate, Update and PostUpdate methods.
        ''' </summary>
        ''' <remarks>
        ''' The CallUpdate method should be used only in the PreCommands event of a 
        ''' designer in order to call Update processing which includes the PreUpdate, Update 
        ''' and PostUpdate methods.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Private Sub CallUpdate()

            Const cUpdatePush As String = "UpdatePush"

            If Not UpdateExecuted Then

               

                Dim dt As DispatcherTimer = New DispatcherTimer
                AddHandler dt.Tick, AddressOf ClearUniqueControl
                dt.Interval = New TimeSpan(0, 0, 0, 0, 3000)
                dt.Start()

                If Mode = PageModeTypes.Find Then
                    Mode = PageModeTypes.Change
                ElseIf Mode = PageModeTypes.Entry Then
                    Mode = PageModeTypes.Correct
                End If

                m_strRequestedControlFocusOverRide = ""

                ' Call the PreUpdate procedure.
                Try
                    PreUpdate()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

                ' Call the Update procedure. 
                m_blnExecutingUpdate = True
                Try
                    Update()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
                m_blnExecutingUpdate = False

                ' Commit the default transaction (TRANS_UPDATE).

                Try
                    TRANS_UPDATE(TransactionMethods.Commit)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

                Try
                    ExecuteNamedTransactions(TransactionMethods.Commit)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

                ' Set UpdateExecuted to true.  This ensures that if we
                ' call a RunScreen or Accept verb in the PostUpdate, that 
                ' we don't call the Update again and resave the current record.
                UpdateExecuted = True

                ' Remove the flags and Save State
                RemoveFlags(True)
            Else
                ' Assign pending Push verbs.
                'm_strPush = Me.ViewState(cUpdatePush)
                If m_strPush Is Nothing Then m_strPush = String.Empty
            End If

            ' In case of RunScreen or Accept verb in PostFind, we need to save the Push status.
            Try

                ' Call the PostUpdate procedure.
                Try
                    PostUpdate()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

                'Save The Recieving list after the Update
                Try
                    SaveParamsReceived()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

                ' Commit the default transaction (TRANS_UPDATE).
                Try
                    TRANS_UPDATE(TransactionMethods.Commit)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
                Try
                    ExecuteNamedTransactions(TransactionMethods.Commit)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

                If UpdateMessage() AndAlso PushMessage.Length = 0 Then Information("Update completed.") 'IM.UpdateComplete
                If PushMessage.Length > 0 Then Information(PushMessage)

            Catch ex As CustomApplicationException

                ' Save any pending push verb status and clear the value
                ' of m_strPush.  This ensures that the RunScreen or Accept is
                ' executed before the push.
                If Not m_strPush Is Nothing AndAlso m_strPush.Length > 0 Then
                    'If Not Me.ViewState("UpdatePush") Is Nothing Then
                    '    Me.ViewState(cUpdatePush) = m_strPush
                    'Else
                    '    Me.ViewState.Add(cUpdatePush, m_strPush)
                    'End If
                End If
                m_strPush = String.Empty

                If Not ex.Message = cRunScreenException.ToString AndAlso m_fldAcceptField Is Nothing Then
                    UpdateExecuted = False
                End If

                Throw ex

            Catch ex As Exception

                Throw ex

            End Try

            ' Set UpdateExecuted back to false.
            UpdateExecuted = False

            If Me.AutoReturn Then
                blnAutoReturn = True

                ' Call the EXIT procedure.
                m_blnExecutingExit = True
                Try
                    [Exit]()
                Catch ex As CustomApplicationException
                    If m_fldAcceptField Is Nothing Then
                        SetByPassExit()
                    Else
                        ' In case of Accept verb.
                        Throw ex
                    End If
                Catch ex As Exception
                    Throw ex
                End Try
                m_blnExecutingExit = False


                m_blnPagePostProcessCalled = True
                m_blnByPassExit = True

            End If

        End Sub

        ''' --- UpdateMessage --------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Determines whether to display the Update message upon completion of
        '''     the Update process.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function UpdateMessage() As Boolean

            If Not System.Configuration.ConfigurationManager.AppSettings("UpdateMessage") Is Nothing AndAlso System.Configuration.ConfigurationManager.AppSettings("UpdateMessage") = "Off" Then
                Return False
            Else
                Return True
            End If

        End Function
        ''' --- CallFind -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CallFind.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub CallFind()

            Mouse.OverrideCursor = Cursors.Wait

            Dim blnInFindProcedure As Boolean
            Dim blnInPostFind As Boolean
            Try
                'Grid looks for m_blnCallFind to conditionally enable Append Icon on Top of Grid
                m_blnCallFind = True

                ' Used in FileObject to check if GetData is from Find or not
                m_blnInFind = True

                'Setting m_blnBindGridFields flag to "False" limits the use of Grid Fields
                'directly or indirectly inside the "For"/"ForMissing" method in
                '"Find, PostFind, DetailFind and DetailPostfind" methods i.e. Grid Fields will not be accessible inside the
                '"For"/"ForMissing" loop in "Find, PostFind, DetailFind and DetailPostfind" methods
                'This behaviour is by design
                m_blnBindGridFields = False

                ' Only run the find once.  If the PostFind has a RunScreen,
                ' then don't run this code again.  This ensures that we have
                ' the same record information as prior to the RunScreen call.
                If Not blnFindComplete Then
                    Framework.Core.Windows.Framework.ApplicationState.Current.Createempty = True
                    m_blnInFindOrDetailFind = True
                    m_intRecordsToFillInFindOrDetailFind = -1

                    CoreWebTrace("Find", "Start Find")
                    blnInFindProcedure = True

                    Try
                        Find()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                    blnInFindProcedure = False
                    CoreWebTrace("Find", "End Find")

                    blnFindComplete = True

                    InitializeExecuted = True

                    ' This handles tracking the Request Sequence value.  Since we don't run the path
                    ' again, we need to re-use this value to ensure that if the PostFind has additional 
                    ' requests, that when we check if method was executed that it returns the proper value.



                End If

                m_intRecordsToFillInFindOrDetailFind = -1
                m_blnInFindOrDetailFind = False

                CoreWebTrace("Find", "Start PostFind")
                blnInPostFind = True
                m_blnInPostFindOrDetailPostFind = True
                InPostFind = True

                Try
                    PostFind()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
                InPostFind = False
                m_blnInPostFindOrDetailPostFind = False
                blnInPostFind = False
                CoreWebTrace("Find", "End PostFind")

                m_blnInFindOrDetailFind = True
                m_blnInDetailFind = True
                m_intRecordsToFillInFindOrDetailFind = -1

                CoreWebTrace("Find", "Start DetailFind")
                Try
                    DetailFind()
                Catch ex As CustomApplicationException

                Catch ex As Exception
                    Throw (ex)
                End Try
                CoreWebTrace("Find", "End DetailFind")
                m_blnInDetailFind = False
                m_blnInFindOrDetailFind = False
                m_intRecordsToFillInFindOrDetailFind = -1

                CoreWebTrace("Find", "Start DetailPostfind")
                m_blnInPostFindOrDetailPostFind = True
                m_blnInDetailFind = True
                Try
                    If AllowAcceptInDetailPostFind Then
                        'If ScreenSession("AllowAcceptInDetailPostFind") Is Nothing Then
                        m_blnInDetailFind = True
                        m_blnInPostFindOrDetailPostFind = False
                        CoreWebTrace("Find", "End DetailPostfind")

                        'ResetBindGridFieldsFlag so that now onwards "For" and "ForMissing" can call "BindGridFields"
                        ResetBindGridFieldsFlag()

                        CurrentRecordNumber = m_intCurrentRecordNumber
                        ' Used in FileObject to check if GetData is from Find or not
                        m_blnInFind = False

                        CoreWebTrace("Find", "Start RaiseShowGrid")
                        RaiseShowGrid(False)
                        CoreWebTrace("Find", "End RaiseShowGrid")

                        'Reset Occurrence back to 1, without binding grid fields
                        m_blnBindGridFields = False
                        Me.SetOccurrence(0)
                        m_blnBindGridFields = True
                        'ScreenSession("AllowAcceptInDetailPostFind") = True
                        'End If
                    End If

                    Try
                        DetailPostfind()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                    'RemoveScreenSession("AllowAcceptInDetailPostFind")
                Catch ex As CustomApplicationException
                    If ex.Message <> cAddMessageError.ToString Then
                        Throw (ex)
                    End If
                Catch ex As Exception
                    Throw (ex)
                End Try

                ' Remove the Request Sequence value from ViewState as the Find process completed.
                m_intRequestSequence = 0
                Framework.Core.Windows.Framework.ApplicationState.Current.Createempty = False

                m_blnInDetailFind = True
                m_blnInPostFindOrDetailPostFind = False
                CoreWebTrace("Find", "End DetailPostfind")

                'ResetBindGridFieldsFlag so that now onwards "For" and "ForMissing" can call "BindGridFields"
                ResetBindGridFieldsFlag()

                CurrentRecordNumber = m_intCurrentRecordNumber
                ' Used in FileObject to check if GetData is from Find or not
                m_blnInFind = False

                CoreWebTrace("Find", "Start RaiseShowGrid")
                RaiseShowGrid(False)
                CoreWebTrace("Find", "End RaiseShowGrid")

                'Reset Occurrence back to 1, without binding grid fields
                m_blnBindGridFields = False
                Me.SetOccurrence(0)
                m_blnBindGridFields = True


                blnFindComplete = False
                m_blnInDetailFind = False

            Catch ex As CustomApplicationException

                ' If an error is thrown in the find procedure.
                If ex.Message <> cRunScreenException.ToString AndAlso ex.Message <> cAcceptRequestPromptException.ToString AndAlso blnInFindProcedure Then 'IM.NORECORDS
                    m_blnInFindOrDetailFind = True
                    m_intRecordsToFillInFindOrDetailFind = -1
                    m_blnInFind = False
                    CurrentRecordNumber = m_intCurrentRecordNumber
                    RaiseShowGrid(False)
                    Me.HasErrorInFind = True
                    ' If we are in the Find procedure, and an Accept/Request fails, the ActionField recieves focus in PowerHouse.
                    ' Set the screen back to NoMode.  This ensures the user doesn't have access to the field again, and has to press Cancel 
                    ' prior to being able to do another Find again.
                    If blnInFindProcedure Then
                        Mode = PageModeTypes.NoMode
                        m_strRequestedControlFocusOverRide = ""
                        m_fldAcceptField = Nothing
                        RaiseClearControls()
                        ControlsCleared = True
                        blnFindComplete = False
                        ClearSequence()
                        Throw ex
                    End If
                Else
                    RaiseClearRequestValues()
                    If (ex.Message.ToUpper = "NO RECORDS FOUND." OrElse ex.Message.Equals("AUCUN ENREGISTREMENT TROUV.")) Then 'IM.NORECORDS
                        RaiseShowGrid(True)
                    ElseIf Me.HasGrid AndAlso blnPrepareGrid Then
                        'If there is a grid, in case of an error 
                        'we need to display controls as labels in Grid
                        'Please note for non-grid screen it will call following method
                        'however, following method only raises an event
                        'If we ever need to write some logic other than raising
                        'an event, we need to change above if condition 
                        RaisePrepareGridControlsForDisplay(True)
                    End If
                    ' Only set the mode to NoMode if the error is not a RunScreen exception.
                    ' Also ensure it's not a Validate error (datatype error, range error, etc).  Validate errors should put focus back in the field.
                    If ex.Message <> cRunScreenException.ToString AndAlso ex.Message <> cAcceptRequestPromptException.ToString AndAlso blnInPostFind AndAlso Not m_blnValidateError Then
                        Mode = PageModeTypes.NoMode
                        m_strRequestedControlFocusOverRide = ""
                        m_fldAcceptField = Nothing
                        RaiseClearControls()
                        ControlsCleared = True
                        blnFindComplete = False
                    ElseIf ex.Message = cAcceptRequestPromptException.ToString Then
                        ' Ensure that if we found records, to display the current record number.
                        CurrentRecordNumber = m_intCurrentRecordNumber
                        Throw ex
                    End If

                    ' Don't throw an error if in DetailPostFind.  Display the data found.
                    If Not (m_blnInPostFindOrDetailPostFind AndAlso Not blnInPostFind) OrElse ex.Message = cReturn.ToString Then Throw ex

                    blnFindComplete = False
                End If


                If ex.Message = cRunScreenException.ToString Then
                    Throw ex
                End If

            Catch ex As Exception

                ' Write the exception to the event log and throw an error.
                ExceptionManager.Publish(ex)
                Throw ex
            End Try

        End Sub

        ''' --- ResetBindGridFieldsFlag --------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Resets the Bind Grid Fields Flag.
        ''' </summary>
        ''' <remarks>Setting this flag to "False" limits the use of Grid 
        ''' Fields directly or indirectly inside the "For"/"ForMissing" method in
        ''' "Find, PostFind, DetailFind and DetailPostfind" methods i.e. Grid Fields will 
        ''' not be accessible inside the "For"/"ForMissing" loop in "Find, PostFind, 
        ''' DetailFind and DetailPostfind" methods.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Sub ResetBindGridFieldsFlag()
            'Setting m_blnBindGridFields flag to "False" limits the use of Grid Fields
            'directly or indirectly inside the "For"/"ForMissing" method in
            '"Find, PostFind, DetailFind and DetailPostfind" methods i.e. Grid Fields will not be accessible inside the
            '"For"/"ForMissing" loop in "Find, PostFind, DetailFind and DetailPostfind" methods
            'This behaviour is by design
            m_blnBindGridFields = True
        End Sub



        ''' --- ReturnAndClose -----------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Terminates the current code execution and returns to the previous screen.
        ''' </summary>
        ''' <remarks>Raises a RETURN error and sets the correct flags in order to 
        ''' close the current screen.
        ''' </remarks>
        ''' <example>ReturnAndClose()</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Sub ReturnAndClose()

            Try
                If m_blnExecutingUpdate Then
                    ' Commit any transactions when called from Update.
                    Try
                        TRANS_UPDATE(TransactionMethods.Commit)
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                    Try
                        ExecuteNamedTransactions(TransactionMethods.Commit)
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                End If

                ' Check if any of the files have an altered status.  
                ' This sets IsDirty to true if an altered file is found.
                RaiseCheckFileStatuses()

                ' Call the EXIT procedure.
                m_blnExecutingExit = True
                Try
                    If IsDirty Then
                        m_blnExecutingBackout = True
                        Try
                            Backout()
                        Catch ex As CustomApplicationException
                            Throw ex
                        Catch ex As Exception
                            ExceptionManager.Publish(ex)
                            Throw ex
                        End Try
                        m_blnExecutingBackout = False
                    End If

                    Try
                        [Exit]()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                Catch ex As CustomApplicationException
                    If m_fldAcceptField Is Nothing Then
                        SetByPassExit()
                    Else
                        ' In case of Accept verb.
                        Throw ex
                    End If
                Catch ex As Exception
                    Throw ex
                End Try
                m_blnExecutingExit = False

                If Not IsDirty Then
                    Try
                        SaveParamsReceived()
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                End If

                ' Check if we need to pass back any messages.
                If m_colMessages.Count > 0 Then
                    'oMessage = m_colMessages
                    blnPassedMessagesError = m_blnHasError
                End If

                m_blnPagePostProcessCalled = True
                m_blnByPassExit = True
                m_blnCloseWindow = True

                ThrowCustomApplicationException(cReturn)

            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try

        End Sub

        ''' --- ReturnToStop -----------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Terminates the current code execution and returns to the previous screen.
        ''' </summary>
        ''' <remarks>Raises a RETURN error and sets the correct flags in order to 
        ''' close the current screen.
        ''' </remarks>
        ''' <example>ReturnAndClose()</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Sub ReturnToStop()

            Try
                ' Check if any of the files have an altered status.  
                ' This sets IsDirty to true if an altered file is found.
                RaiseCheckFileStatuses()

                ReturnStopScreen = True
                RunscreenReturnToStop = Me.FormName

                If Not m_blnExecutingExit Then
                    ' Call the EXIT procedure.
                    m_blnExecutingExit = True
                    Try
                        [Exit]()
                    Catch ex As CustomApplicationException
                        If m_fldAcceptField Is Nothing Then
                            SetByPassExit()
                        Else
                            ' In case of Accept verb.
                            Throw ex
                        End If
                    Catch ex As Exception
                        Throw ex
                    End Try
                    m_blnExecutingExit = False
                End If

                Try
                    SaveParamsReceived()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

                ' Check if we need to pass back any messages.
                If m_colMessages.Count > 0 Then
                    'oMessage = m_colMessages
                    blnPassedMessagesError = m_blnHasError
                End If

                m_blnPagePostProcessCalled = True
                m_blnByPassExit = True
                m_blnCloseWindow = True

                ThrowCustomApplicationException(cReturn)

            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try

        End Sub

        ''' --- UpdateProcessingCalled -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of UpdateProcessingCalled.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property UpdateProcessingCalled() As Boolean
            Get
                Return blnUpdateProcessing
            End Get
            Set(ByVal Value As Boolean)
                blnUpdateProcessing = Value
            End Set
        End Property


        ''' --- UpdateProcessingCalled -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of UpdateProcessingCalled.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Property InPostFind() As Boolean
            Get
                Return blnPostFind
            End Get
            Set(ByVal Value As Boolean)
                blnPostFind = Value
            End Set
        End Property

        ''' --- InitializeExecuted -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of InitializeExecuted.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Property InitializeExecuted() As String
            Get
                Return strInitializeExecuted
            End Get
            Set(ByVal Value As String)
                strInitializeExecuted = Value
            End Set
        End Property



        ''' --- UserID -------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Retrieves the logged-on user.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <example>T_TEMP.Value = UserID()</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend ReadOnly Property UserID() As String
            Get
                Return ApplicationState.Current.CurrentUser.ADUserName.Split("\")(ApplicationState.Current.CurrentUser.ADUserName.Split("\").Length - 1)

            End Get
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Returns the account of the logged-on user.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <example>T_TEMP.Value = SignOnAccount()</example>
        ''' <history>
        ''' 	[mayur]	3/18/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected ReadOnly Property SignOnAccount() As String
            Get
                Return Framework.Core.Security.SecurityManager.GetCurrentAccount
            End Get
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' SignOnUser returns the logged-on user.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <example>T_TEMP.Value = SignOnUser()</example>
        ''' <history>
        ''' 	[mayur]	3/18/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected ReadOnly Property SignOnUser() As String
            Get
                Return Me.UserID
            End Get
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' SignOnGroup returns the user's logon group.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	3/18/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected ReadOnly Property SignOnGroup() As String
            Get
                Return "        "
            End Get
        End Property


#Region " Properties for Function Keys "

        ''' --- m_strSkipAllCode --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strSkipAllCode.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strSkipAllCode As String = "keycode == cSkipall && (event.ctrlLeft || event.ctrlKey)"

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        ''' <summary>
        ''' This is an internal property and is not meant to be used in your code.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property SkipAllCode() As String
            Get
                Return m_strSkipAllCode
            End Get
            Set(ByVal Value As String)
                m_strSkipAllCode = Value
            End Set
        End Property

        ''' --- m_strCancelCode --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_strCancelCode.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_strCancelCode As String = String.Empty

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        ''' <summary>
        ''' This is an internal property and is not meant to be used in your code.
        ''' </summary>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <Browsable(False),
        EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Property CancelCode() As String
            Get
                Return m_strCancelCode
            End Get
            Set(ByVal Value As String)
                m_strCancelCode = Value
            End Set
        End Property

        Private m_strFunctionKeys(11) As String

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' This is an internal property and is not meant to be used in your code.
        ''' </summary>
        ''' <param name="Key"></param>
        ''' <value></value>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Friend Property PageFunctionKey(ByVal Key As Integer) As String
            Get
                If m_strFunctionKeys(Key) Is Nothing Then
                    Return String.Empty
                ElseIf m_strFunctionKeys(Key).StartsWith("D") Then
                    Return "Used by Designer"
                ElseIf m_strFunctionKeys(Key).StartsWith("P") Then
                    Return m_strFunctionKeys(Key).Substring(1)
                Else
                    Return String.Empty
                End If
            End Get
            Set(ByVal Value As String)
                If m_strFunctionKeys(Key) Is Nothing Then
                    m_strFunctionKeys(Key) = String.Empty
                End If
                If m_strFunctionKeys(Key).StartsWith("D") Then
                    'Ignore this value, In order to set this property remove property from Designer's FunctionKey Property
                Else
                    If Value = String.Empty Then
                        m_strFunctionKeys(Key) = String.Empty
                    Else
                        m_strFunctionKeys(Key) = "P" + Value
                    End If
                End If
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Value that you want to be typed-in when you press F1. This property will be ignored if a Designer on a Page already uses this function key.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public Property F1() As String
            Get
                Return PageFunctionKey(0)
            End Get
            Set(ByVal Value As String)
                PageFunctionKey(0) = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Value that you want to be typed-in when you press F2. This property will be ignored if a Designer on a Page already uses this function key.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public Property F2() As String
            Get
                Return PageFunctionKey(1)
            End Get
            Set(ByVal Value As String)
                PageFunctionKey(1) = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Value that you want to be typed-in when you press F3. This property will be ignored if a Designer on a Page already uses this function key.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public Property F3() As String
            Get
                Return PageFunctionKey(2)
            End Get
            Set(ByVal Value As String)
                PageFunctionKey(2) = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Value that you want to be typed-in when you press F4. This property will be ignored if a Designer on a Page already uses this function key.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public Property F4() As String
            Get
                Return PageFunctionKey(3)
            End Get
            Set(ByVal Value As String)
                PageFunctionKey(3) = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Value that you want to be typed-in when you press F5. This property will be ignored if a Designer on a Page already uses this function key.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public Property F5() As String
            Get
                Return PageFunctionKey(4)
            End Get
            Set(ByVal Value As String)
                PageFunctionKey(4) = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Value that you want to be typed-in when you press F6. This property will be ignored if a Designer on a Page already uses this function key.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public Property F6() As String
            Get
                Return PageFunctionKey(5)
            End Get
            Set(ByVal Value As String)
                PageFunctionKey(5) = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Value that you want to be typed-in when you press F7. This property will be ignored if a Designer on a Page already uses this function key.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public Property F7() As String
            Get
                Return PageFunctionKey(6)
            End Get
            Set(ByVal Value As String)
                PageFunctionKey(6) = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Value that you want to be typed-in when you press F8. This property will be ignored if a Designer on a Page already uses this function key.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public Property F8() As String
            Get
                Return PageFunctionKey(7)
            End Get
            Set(ByVal Value As String)
                PageFunctionKey(7) = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Value that you want to be typed-in when you press F9. This property will be ignored if a Designer on a Page already uses this function key.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public Property F9() As String
            Get
                Return PageFunctionKey(8)
            End Get
            Set(ByVal Value As String)
                PageFunctionKey(8) = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Value that you want to be typed-in when you press F10. This property will be ignored if a Designer on a Page already uses this function key.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public Property F10() As String
            Get
                Return PageFunctionKey(9)
            End Get
            Set(ByVal Value As String)
                PageFunctionKey(9) = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Value that you want to be typed-in when you press F11. This property will be ignored if a Designer on a Page already uses this function key.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public Property F11() As String
            Get
                Return PageFunctionKey(10)
            End Get
            Set(ByVal Value As String)
                PageFunctionKey(10) = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Value that you want to be typed-in when you press F12. This property will be ignored if a Designer on a Page already uses this function key.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Public Property F12() As String
            Get
                Return PageFunctionKey(11)
            End Get
            Set(ByVal Value As String)
                PageFunctionKey(11) = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        '''     This member supports the Renaissance Architect Framework infrastructure and is 
        '''     not intended to be used directly from your code.
        ''' </summary>
        ''' 
        ''' <history>
        ''' 	[Mayur]	25/08/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend Property RecordsForLoop() As Integer
            'Note: RecordsForLoop is used as One based
            Get
                Return intRecordsForLoop
            End Get
            Set(ByVal Value As Integer)
                intRecordsForLoop = Value
            End Set
        End Property

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        '''     Setting FieldMark to True, selects First Row in a grid and allow user to run Designer by simply pressing an Enter Key.
        ''' </summary>
        ''' 
        ''' <history>
        ''' 	[Mayur]	15/09/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        Protected Friend Property FieldMark() As Boolean
            Get
                Return m_blnFieldMark
            End Get
            Set(ByVal Value As Boolean)
                m_blnFieldMark = Value
            End Set
        End Property
#End Region

        ''' --- GetMessages --------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Retrieves the Messages collection.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function GetMessages() As ArrayList

            Return m_colMessages

        End Function

        ''' --- DeleteSystemVal ----------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Allows the deletion of values defined at the operating system level.
        ''' </summary>
        ''' <param name="Name">A String containing the name of the systemval to delete.</param>
        ''' <param name="Type">A String indicating the type of systemval.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <example>DeleteSystemVal("PARAMS")<br/>
        ''' DeleteSystemVal("QUIZ_PARAMS", "0001", "LNM$JOB")</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend Function DeleteSystemVal(ByVal Name As String,
          Optional ByVal Type As String = "0001",
          Optional ByVal Table As String = "",
          Optional ByVal SessionId As String = "") As Boolean

            Select Case Type
                Case "0001"
                    'UI.SessionInformation.Remove(Name + Type)
                Case "0002", "0003"
                    'UI.SessionInformation.RemoveApplication(Name + Type)
            End Select

        End Function




        ''' --- RaiseGetDropdownItemsDB -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Gets the dropdown items list from the screen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RaiseGetDropdownItemsDB()
            RaiseEvent GetDropDownItemsDB()
        End Sub

        ''' <summary>
        '''     Retrieves values defined at the operating system level.
        ''' </summary>
        ''' <param name="Name">A String containing the name of the systemval to delete.</param>
        ''' <example>
        '''     GetSystemVal("PARAMS") <br />
        '''     GetSystemVal("QUIZ_PARAMS", "0002") Returns "ALL"
        ''' </example>
        ''' <history>
        '''     [Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(EditorBrowsableState.Always)>
        Protected Friend Function GetSystemVal(Name As String, TypeCode As String) As String

            Dim strValue As String = Nothing

            If TypeCode = "" Then
                strValue = SessionInformation.GetSession(Name + "0001", Process.GetCurrentProcess.MachineName)

                If IsNothing(strValue) Then
                    strValue = SessionInformation.GetApplicationSession(Name + "0002")
                End If
                If IsNothing(strValue) Then
                    strValue = SessionInformation.GetApplicationSession(Name + "0003")
                End If
            Else
                Select Case TypeCode
                    Case "0001"
                        strValue = SessionInformation.GetSession(Name + "0001", Process.GetCurrentProcess.MachineName)
                    Case "0002", "0003"
                        strValue = SessionInformation.GetApplicationSession(Name + TypeCode)
                End Select

            End If

            If IsNothing(strValue) Then strValue = String.Empty
            Return strValue
        End Function

        <EditorBrowsable(EditorBrowsableState.Always)>
        Protected Friend Function GetSystemVal(Name As String) As String

            Dim TypeCode As String = ""
            Dim strValue As String = Nothing

            If TypeCode = "" Then
                strValue = SessionInformation.GetSession(Name + "0001", Process.GetCurrentProcess.MachineName)

                If IsNothing(strValue) Then
                    strValue = SessionInformation.GetApplicationSession(Name + "0002")
                End If
                If IsNothing(strValue) Then
                    strValue = SessionInformation.GetApplicationSession(Name + "0003")
                End If
            Else
                Select Case TypeCode
                    Case "0001"
                        strValue = SessionInformation.GetSession(Name + "0001", Process.GetCurrentProcess.MachineName)
                    Case "0002", "0003"
                        strValue = SessionInformation.GetApplicationSession(Name + TypeCode)
                End Select

            End If

            If IsNothing(strValue) Then strValue = String.Empty
            Return strValue
        End Function

        ''' --- SetSystemVal -------------------------------------------------------
        ''' <summary>
        '''     Assigns values at the operating system level.
        ''' </summary>
        ''' <param name="Name">A String containing the name of the systemval.</param>
        ''' <param name="Value">A String containing the value to be assigned to the systemval.</param>
        ''' <param name="Type">A String indicating the type of systemval.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <example>
        '''     SetSystemVal("PARAMS", T_TEMP.Value) <br />
        '''     SetSystemValue("QUIZ_PARAMS", "ALL", "0001")
        ''' </example>
        ''' <history>
        '''     [Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------

        <EditorBrowsable(EditorBrowsableState.Always)>
        Protected Function SetSystemVal(Name As String,
                                        Value As String) As Boolean
            SetSystemVal(Name, Value, "0001")
        End Function

        <EditorBrowsable(EditorBrowsableState.Always)>
        Protected Function SetSystemVal(Name As String,
                                        Value As String,
                                        Type As String) As Boolean

            If Type = "0001" Then
                SessionInformation.SetSession(Name + Type, Value, Process.GetCurrentProcess.MachineName)
            Else
                SessionInformation.SetApplicationSession(Name + Type, Value)
            End If

            Return True
        End Function

        ''' --- RaiseClearControls -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Will clear all controls on screen.
        ''' </summary>
        ''' <param name="RaiseEvents"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RaiseClearControls(Optional ByVal RaiseEvents As Boolean = False)

            Dim coreTempTextBox As New Core.Windows.UI.TextBox
            Dim blnPriorValue As Boolean
            blnPriorValue = m_blnRaiseDataChangedEvent

            If Not RaiseEvents Then m_blnRaiseDataChangedEvent = False

            RaiseEvent ClearControls()

            m_blnRaiseDataChangedEvent = blnPriorValue

        End Sub

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RaiseCloseRunscreen()

            RaiseEvent CloseRunscreen()
        End Sub

        ''' --- RaiseResetValueChanged ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RaiseResetValueChanged.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RaiseResetValueChanged(Optional ByVal ClearValues As Boolean = False)
            RaiseEvent ResetValueChanged(Me, ClearValues)
        End Sub

        ''' --- RaiseClearRequestValues --------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RaiseClearRequestValues.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RaiseClearRequestValues()

            RaiseEvent ClearRequestValues()

        End Sub

        ''' --- RaiseUpdateRequestBuffer -------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RaiseUpdateRequestBuffer.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RaiseUpdateRequestBuffer()

            RaiseEvent UpdateRequestBuffer()

        End Sub

        ''' --- RaiseBindGridFields ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RaiseBindGridFields.
        ''' </summary>
        ''' <param name="RowPosition"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Sub RaiseBindGridFields(ByVal RowPosition As Integer)
            'Note: Should not be called from out side the framework
            'At present gets called from the "FOR" method on Page, File and Temporary
            RaiseEvent BindGridFields(RowPosition)
        End Sub

#Region "Validation Code"

        ''' --- InFieldValidation --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Used to perform infield validation.
        ''' </summary>
        ''' <param name="sender"></param>
        ''' <param name="ValidateType"></param>
        ''' <remarks>InFieldValidation will call the generic Validate 
        ''' routine (which is called on submit). 
        ''' <para>
        ''' <note>This function handles maintaining state.</note>
        ''' </para>
        ''' </remarks>
        ''' <example>InFieldValidation(txtTextBox1, ValidateTypes.Accept)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function InFieldValidation(ByRef sender As Object, Optional ByVal ValidateType As ValidateTypes = ValidateTypes.Accept) As Boolean

            Try

                Return PerformOperation(sender)

                ' NOTE: CustomApplicationExceptions are handled within PerformOperation, so
                '       there is no need to add CustomApplicationException error handler code.

            Catch ex As Exception

                ' Write the exception to the event log and throw an error.
                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function

        ''' --- UseDefaultValueForTemporary ----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of UseDefaultValueForTemporary.
        ''' </summary>
        ''' <param name="sender"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function UseDefaultValueForTemporary(ByRef sender As FieldObjectTextBox) As Boolean

            If sender.FieldName.IndexOf(".") = -1 AndAlso Not sender.ValueChanged AndAlso SetFieldDefaults(Replace(sender.FieldName, ".", "_")).Length > 0 Then
                Return True
            Else
                Return False
            End If

        End Function

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function UseDefaultValueForTemporary(ByRef sender As FieldObjectDateBox) As Boolean

            If sender.FieldName.IndexOf(".") = -1 AndAlso Not sender.ValueChanged AndAlso SetFieldDefaults(Replace(sender.FieldName, ".", "_")).Length > 0 Then
                Return True
            Else
                Return False
            End If

        End Function

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function UseDefaultValueForTemporary(ByRef sender As FieldObjectComboBox) As Boolean

            If sender.FieldName.IndexOf(".") = -1 AndAlso Not sender.ValueChanged AndAlso SetFieldDefaults(Replace(sender.FieldName, ".", "_")).Length > 0 Then
                Return True
            Else
                Return False
            End If

        End Function

        ''' --- RecordBuffer -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RecordBuffer.
        ''' </summary>
        ''' <param name="TableName"></param>
        ''' <param name="FieldName"></param>
        ''' <param name="RecordBufferType"></param>
        ''' <param name="ReturnFieldType"></param>
        ''' <param name="FieldText"></param>
        ''' <param name="FieldValue"></param>
        ''' <remarks>
        ''' <note>Implementation should be overridden in derived page.</note>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Overridable Sub RecordBuffer(ByVal TableName As String, ByVal FieldName As String, ByVal RecordBufferType As RecordBufferType, ByVal ReturnFieldType As ReturnFieldType, ByRef FieldText As String, ByRef FieldValue As Decimal)
            ' Implementation should be overrided in derived page
        End Sub

        Private Function IsCurrentControl(ByVal Id As String) As Boolean

            'Return ((Id + "$ctl00") = Request("RequestedControlFocusOverRide")) _
            'OrElse (Not Request("RequestedControlFocusOverRide") Is Nothing AndAlso Request("RequestedControlFocusOverRide").IndexOf("$ctl" + Occurrence.ToString.PadLeft(2, "0") + "$" + Id + "$") > 0)
            Return True

        End Function


        Private Sub StartValidate()
            'Dim Flag As String = Session(FormName + "_" + Level.ToString + "_" + "VALIDATE") & ""
            'Session(FormName + "_" + Level.ToString + "_" + "VALIDATE") = Flag & "Y"

            'If Flag.Length = 0 Then
            '    Session(FormName + "_" + Level.ToString + "_" + "CLEARVALIDATE") = Nothing
            'Else
            '    Session(FormName + "_" + Level.ToString + "_" + "CLEARVALIDATE") = Flag.Length
            'End If
        End Sub

        Private Sub EndValidate()
            'Dim Flag As String = Session(FormName + "_" + Level.ToString + "_" + "VALIDATE") & ""
            'Session(FormName + "_" + Level.ToString + "_" + "VALIDATE") = Flag.Substring(0, Flag.Length - 1)
        End Sub

        Private Function IsValidateWithIn() As Boolean
            Return True '(Session(FormName + "_" + Level.ToString + "_" + "VALIDATE") & "").ToString.Length > 1
        End Function

        Private Function RemoveAccept() As Boolean
            'If Not IsNothing(Session(FormName + "_" + Level.ToString + "_" + "CLEARVALIDATE")) And CDec(Session(FormName + "_" + Level.ToString + "_" + "CLEARVALIDATE")) > 0 Then
            '    If m_strAcceptFlag.Length - CDec(Session(FormName + "_" + Level.ToString + "_" + "CLEARVALIDATE")) > 0 Then
            '        m_strAcceptFlag = m_strAcceptFlag.Substring(0, m_strAcceptFlag.Length - CDec(Session(FormName + "_" + Level.ToString + "_" + "CLEARVALIDATE")))
            '    Else
            '        m_strAcceptFlag = ""
            '    End If
            '    Session(FormName + "_" + Level.ToString + "_" + "ACCEPT_FLAG") = m_strAcceptFlag
            '    Session(FormName + "_" + Level.ToString + "_" + "CLEARVALIDATE") = Nothing
            'End If

            Return True
        End Function

        ''' <summary>
        ''' FnKeyExecuted returns true if a function key has been executed for a field.
        ''' This was coded for the COLONIAL so that they could run Designer procedures while
        ''' in a field.  By default Designer procedures are disabled while in a field as in 
        ''' PowerHouse they would not be able to execute a Designer unless they are in the 
        ''' action field.  
        ''' </summary>
        ''' <returns>A boolean indicating a function key is executed for the current accept.</returns>
        ''' <remarks></remarks>
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function FnKeyExecuted() As Boolean
            If hsFunction Is Nothing Then
                Return False
            ElseIf hsFunction.Contains(m_intAcceptSequence & "OCCURS" & Me.Occurrence) Then
                Return True
            Else
                Return False
            End If
        End Function

        ''' --- Validate ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Will validate the data entered on the screen by user.
        ''' </summary>
        ''' <param name="sender">A Textbox which contains the data to be validated.</param>
        ''' <param name="ValidateType">A ValidateType.</param>
        ''' <param name="InFieldValidate"></param>
        ''' <remarks>Validates the data entered as well as performing dictionary functions,
        ''' lookups and assignments to FIELDTEXT and FIELDVALUE. In addition, Validate also
        ''' calls the INPUT, EDIT, PROCESS and OUTPUT procedures used by PowerHouse.
        ''' </remarks>
        ''' <example>Validate(txtTextBox1, ValidateType.Accept)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        Public Overloads Function Validate(ByRef sender As TextBox, Optional ByVal ValidateType As ValidateTypes = ValidateTypes.Accept, Optional ByVal InFieldValidate As Boolean = False) As Boolean

            Dim underlyingDataType As DataTypes
            Dim strPreviousValue As String = ""
            Dim strPreviousFieldText As String = FieldText
            Dim dblPreviousFieldValue As Decimal = FieldValue
            Dim strOldFieldText As String = String.Empty   ' Ensures that if the EDIT fails, that we reset the values in order
            Dim decOldFieldValue As Decimal = 0            ' to reset any SUM INTO values, etc.
            Dim blnEditFailed As Boolean = False
            Dim blnNullResponseAccept As Boolean
            Dim blnUseDefaultValue As Boolean           ' Used for TEMPORARIES only.
            Dim blnIsNewMasterOnSlaveScreen As Boolean = Me.Slave AndAlso sender.FieldName.IndexOf(".") > 0 AndAlso sender.RaiseGetNewRecordStatus AndAlso sender.RaiseGetFileType = FileTypes.Master
            Dim blnResetFromInputAndNull As Boolean = False

            sender.DisplayExecuted = False

            Try
                StartValidate()
                'Clear the Fieldtext from the previous field
                FieldText = ""
                FieldValue = 0

                If sender.UnderLyingDataType = ItemDataTypes.Integer OrElse sender.UnderLyingDataType = ItemDataTypes.SignedInteger OrElse sender.UnderLyingDataType = ItemDataTypes.UnsignedNumeric Then
                    underlyingDataType = DataTypes.Numeric
                Else
                    underlyingDataType = sender.UnderLyingDataType
                End If

                ' If this field does not have the REFRESH option then exit (when called after running a run screen).
                If ValidateType = ValidateTypes.Display AndAlso m_blnIsInDisplayPreDisplayFormatting AndAlso ((m_blnReturnedFromRunScreen AndAlso Not sender.Refresh) OrElse (blnIsNewMasterOnSlaveScreen)) Then
                    EndValidate()
                    Exit Function
                End If

                m_CurrentField = sender.Name
                If Not m_blnRequireValidateRequest AndAlso ValidateType = ValidateTypes.Request Then
                    'Doesn't Require Validate on Request Fields from SelectProcessing, 
                    'rather it use values from Request Buffer (from File Object)
                    m_blnPromptOK = True
                    EndValidate()
                    Exit Function
                End If

                ' In ACCEPT processing, if the value was not modified and it is not blank, then exit the function.
                If ValidateType = ValidateTypes.Accept AndAlso (Not sender.ValueChanged) AndAlso sender.Text <> "" AndAlso IsCurrentField(sender) AndAlso Not (blnIsNewMasterOnSlaveScreen) Then
                    blnUseDefaultValue = UseDefaultValueForTemporary(sender)
                    If blnUseDefaultValue Then
                        ' Temporaries that have a default (whose value was not changed) receive the default value.
                    Else
                        'Check that no 'K'haracters have been typed into this field
                        If (NullResponse(sender.RenderedID) <> "K") Then
                            blnNullResponseAccept = True
                        End If
                    End If
                End If

                Dim blnRequiredDuplicateOrDefaultSet As Boolean = False
                Dim blnRaiseEdit As Boolean
                Dim strDefaultValue As String = ""
                Dim blnHasDefault As Boolean = False
                Dim blnLookupNotOnExecuted As Boolean = False
                Dim strTableFieldName As String = sender.FieldName
                Dim strTableName As String = sender.TableName
                Dim strFieldName As String = strTableFieldName.Replace(strTableName + ".", "")
                Dim intInputScale As Integer = sender.GetInputScale
                Dim blnUseScaling As Boolean = sender.UseScaling



                If Not blnNullResponseAccept Then
                    ' Set FIELDTEXT to the value of the control.
                    Dim blnUseTextProperty As Boolean = False
                    If ValidateType <> ValidateTypes.Display Then

                        If Me.UseAcceptProcessing Then
                            blnUseTextProperty = (sender.ValueChangedByUser AndAlso Not sender.DisplayExecuted) AndAlso (IsCurrentField(sender))
                            If Not FnKeyExecuted() Then m_intRunScreenSequence = 0
                        Else
                            blnUseTextProperty = InFieldValidate
                        End If
                        If blnUseTextProperty Then
                            FieldText = sender.Text

                            If sender.MultiAccept AndAlso ValidateType = ValidateTypes.Accept Then
                                MultiAccept(sender.Name, FieldText)
                            End If

                            If Me.UseAcceptProcessing Then
                                ' If we had a value before, and we are deleting it (equivalent to entering 0 in PowerHouse),
                                ' then we need to set SubmittedValue to 0 so we don't get a "Required field" error during Entry.
                                If Not sender.OldSubmittedValue Is Nothing Then
                                    If FieldText.Length = 0 AndAlso sender.OldSubmittedValue.Length > 0 Then
                                        sender.SubmittedValue = ""
                                    End If
                                End If

                                'If Not IsNothing(Request("hidControl")) AndAlso Request("hidControl").ToString.IndexOf("||") >= 0 Then
                                '    Dim strControl As String = Request("hidControl").ToString.Substring(0, Request("hidControl").ToString.IndexOf("||"))
                                '    Dim strValue As String = Request("hidControl").ToString.Substring(Request("hidControl").ToString.IndexOf("||") + 2)
                                '    If strControl = sender.RenderedID AndAlso _
                                '    strValue <> sender.Text Then
                                '        If Not FnKeyExecuted() Then RemoveRunScreens(sender.Name, 0)
                                '    End If
                                'End If
                            End If
                        Else
                            If sender.MultiAccept AndAlso ValidateType = ValidateTypes.Accept Then

                                If MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence + 1) Then
                                    FieldText = GetMultiAccept(sender.Name)
                                Else
                                    FieldText = sender.SubmittedValue
                                    MultiAccept(sender.Name, FieldText)
                                End If

                            Else
                                FieldText = sender.SubmittedValue
                            End If

                            If FieldText Is Nothing Then FieldText = ""
                            ' If the user goes back to a field where they already entered a value (and this field used a lookup screen),
                            ' then if the value was changed this time around, clear the RunScreen flag in order to perform the lookup again.
                            'If (ValidateType = ValidateTypes.Accept OrElse ValidateType = ValidateTypes.Request) AndAlso IsCurrentControl(sender.Name) _
                            'AndAlso Not Request(Request("RequestedControlFocusOverRide")) Is Nothing AndAlso Request(Request("RequestedControlFocusOverRide")) <> Request("hidPrevValue") Then
                            '    If Me.UseAcceptProcessing Then
                            '        If Not m_htRunFlag Is Nothing AndAlso m_htRunFlag.Contains(sender.Name) Then
                            '            If Not FnKeyExecuted() Then m_htRunFlag.Remove(sender.Name)
                            '        End If
                            '    End If
                            'End If
                        End If

                        ' If the value of the field is "" and the initial value (OldText)
                        ' was not blank, then create a space to duplicate PowerHouse behaviour.
                        'If (ValidateType = ValidateTypes.Accept OrElse ValidateType = ValidateTypes.Request) AndAlso Not (blnIsNewMasterOnSlaveScreen) Then
                        '    If blnUseTextProperty Then
                        '        If sender.Text.Length = 0 And sender.OldText.Length > 0 Then
                        '            FieldText = cEmptyString
                        '            sender.SubmittedValue = FieldText
                        '        End If
                        '    Else
                        '        If FieldText.Length = 0 And sender.AcceptProcessingOldText.Length > 0 Then
                        '            FieldText = cEmptyString
                        '            sender.SubmittedValue = FieldText
                        '        End If
                        '    End If
                        'End If

                        ' Call SetShiftUpDown for character fields.
                        If sender.DataType = DataTypes.Character Then
                            FieldText = SetShiftUpDown(FieldText, sender.ShiftType)
                        End If
                    End If
                End If ' If Not blnNullResponseAccept Then

                ' Call the INPUT procedure when processing the ACCEPT or REQUEST verbs.  
                ' These(verbs) then execute code to prepare for editing.
                If ValidateType = ValidateTypes.Accept Or ValidateType = ValidateTypes.Request Then

                    ' Store the previous value from the field and
                    ' re-display this value if the user closed the form
                    ' without selecting a value.
                    If sender.UseLookupCharacter Then
                        strPreviousValue = sender.OldText
                    End If

                    If sender.OldSubmittedValue <> FieldText Then
                        blnFieldDiff = True
                    End If

                    '----------------------------
                    ' Call the INPUT procedure.
                    '----------------------------
                    Dim blnInputChangedValue As Boolean
                    Dim strFieldText As String = FieldText
                    If m_blnChangeMode = True Then m_blnFindMode = False
                    sender.RaiseInput()
                    blnFieldDiff = False
                    If m_blnChangeMode = True Then m_blnFindMode = True
                    If Not strFieldText.Equals(FieldText) Then
                        sender.ValueChanged = True
                        blnInputChangedValue = True
                        If blnNullResponseAccept Then
                            blnResetFromInputAndNull = True
                        End If
                        blnUseDefaultValue = False
                    End If

                    ' Determine if the current value is the same as the record buffer.  If so,
                    ' set the ValueChanged back to FALSE (only if the INPUT procedure didn't change the value).
                    sender.RaiseGetRecordBuffer(strFieldText, 0, underlyingDataType)
                    If FieldText.Equals(strFieldText) AndAlso blnInputChangedValue AndAlso sender.SubmittedValue = sender.GetLookupCharacter _
                    AndAlso sender.GetLookupCharacter <> "" AndAlso Not FieldText.Trim.Equals(strFieldText.Trim) Then sender.ValueChanged = False

                    ' If the FIELDTEXT predefined item has a size of zero, the
                    ' PROMPTOK predefined condition is set to FALSE for the field,
                    ' otherwise it is set to TRUE.
                    If Not sender.ValueChanged AndAlso (FieldText.Length = 0 OrElse blnUseDefaultValue) Then
                        m_blnPromptOK = False
                    Else
                        m_blnPromptOK = True
                    End If

                    If (Mode = PageModeTypes.Find OrElse Mode = PageModeTypes.Select) AndAlso ValidateType = ValidateTypes.Request Then
                        sender.RequestValue = FieldText
                        If Me.UseAcceptProcessing Then
                            sender.RequestWasPerformed = True
                            sender.RequestPromptOk = m_blnPromptOK
                        End If
                    End If

                    ' Set the previous value from the field to the 
                    ' control if a lookup screen was called and no
                    ' value was selected by the user.
                    If strPreviousValue.Length > 0 AndAlso (Not m_strLookupValue Is Nothing AndAlso m_strLookupValue.TrimEnd.Equals("")) Then
                        FieldText = strPreviousValue
                        sender.Text = strPreviousValue
                    End If

                    If Not Me.UseAcceptProcessing Then
                        If m_blnInFieldValidation And sender.UseLookupCharacter Then
                            If m_strLookupValue <> Nothing AndAlso Not m_strLookupValue.TrimEnd.Equals("") Then
                                sender.SubmittedValue = m_strLookupValue
                                If Mode = PageModeTypes.Find Then
                                    sender.RequestValue = m_strLookupValue
                                End If
                            End If
                        End If
                    End If


                    ' Determine if this field has a default.
                    If sender.SubmittedValue = "" AndAlso sender.Text = "" Then
                        strDefaultValue = SetFieldDefaults(Replace(sender.FieldName, ".", "_"))
                    End If
                    If strDefaultValue.TrimEnd.Length > 0 Then
                        blnHasDefault = True
                        sender.SubmittedValue = strDefaultValue
                    End If

                    ' If PromptOk is false because the user didn't enter anything, but a value was assigned to this field
                    ' through code, then assume that the Required flag is false since there is a value set for this field. (QKCD9161)
                    Dim blnRequired As BooleanTypes = sender.Required
                    If Not m_blnPromptOK AndAlso sender.DisplayExecuted Then
                        ' Check the value from the record buffer or 
                        ' underlying variable and assign it to FIELDTEXT.
                        sender.RaiseGetRecordBuffer(strFieldText, 0, underlyingDataType)
                        If underlyingDataType = DataTypes.Numeric Then
                            If Not (strFieldText.TrimEnd = "0" And Not blnHasDefault) Then
                                blnRequired = BooleanTypes.False
                            End If
                        Else
                            If strFieldText.TrimEnd.Length > 0 Then
                                blnRequired = BooleanTypes.False
                            End If
                        End If
                    End If

                    ' If we have a slave screen, check the values to ensure that required fields don't throw
                    ' an error if there is a value already in the field.  This is due to the fact that we 
                    ' are not using the text value.  This will fail however if the value that was entered is also
                    ' a default value (ie. " ", 0)
                    If Not m_blnPromptOK AndAlso blnIsNewMasterOnSlaveScreen Then
                        sender.RaiseGetRecordBuffer(strFieldText, 0, underlyingDataType)
                        Select Case underlyingDataType
                            Case DataTypes.Character
                                If strFieldText.TrimEnd.Length > 0 Then
                                    blnRequired = BooleanTypes.False
                                End If
                            Case DataTypes.Numeric, DataTypes.Date
                                If IsNumeric(strFieldText) AndAlso VAL(strFieldText) <> 0 Then
                                    blnRequired = BooleanTypes.False
                                End If
                        End Select
                    End If

                    ' PromptOk is false because the user didn't enter anything, but the record status for the current 
                    ' file object is not New, then set required to false since we don't need to throw the Required field exception.
                    If Not m_blnPromptOK AndAlso blnRequired AndAlso sender.FieldName.IndexOf(".") > 0 AndAlso Not sender.RaiseGetNewRecordStatus AndAlso Not sender.RaiseGetFileType = FileTypes.Reference Then
                        blnRequired = BooleanTypes.False
                    End If

                    ' If we are updating an existing record, and fieldtext is blank, then we really should not
                    ' continue the check for Required, Lookups and Defaults.
                    If ValidateType = ValidateTypes.Accept AndAlso Not m_blnPromptOK AndAlso sender.FieldName.IndexOf(".") > 0 AndAlso blnRequired = BooleanTypes.True AndAlso Not sender.RaiseGetNewRecordStatus AndAlso Mode <> PageModeTypes.Entry AndAlso Not IsAppend Then
                        blnRequired = BooleanTypes.False
                        blnHasDefault = False
                    End If

                    ' If the PROMPTOK condition is FALSE and none of the REQUIRED, DUPLICATE or DEFAULT
                    ' options are specified, then skip the edit processing.  Since blnRequiredDuplicateOrDefaultSet
                    ' is defaulted to FALSE, set it to TRUE if this condition is not met.
                    If (Not m_blnPromptOK AndAlso (sender.AcceptProcessingOldText Is Nothing OrElse sender.AcceptProcessingOldText.Length = 0) AndAlso (blnRequired = BooleanTypes.True Or sender.Duplicate = BooleanTypes.True _
                    Or blnHasDefault = BooleanTypes.True)) Or m_blnPromptOK Then
                        blnRequiredDuplicateOrDefaultSet = True

                        If ValidateType <> ValidateTypes.Request Then

                            If sender.Duplicate = BooleanTypes.True AndAlso FieldText = "" Then
                                'm_hstFieldDuplicate = ScreenSession("Duplicate")
                                If IsNothing(m_hstFieldDuplicate) Then m_hstFieldDuplicate = New Hashtable
                                If m_hstFieldDuplicate.Contains(sender.Name) Then
                                    FieldText = m_hstFieldDuplicate.Item(sender.Name)
                                    If FieldText <> "" Then
                                        blnRaiseEdit = True
                                        m_blnPromptOK = True
                                        sender.ValueChanged = True
                                    End If
                                End If
                            End If

                            ' If this is a required field and PROMPTOK is FALSE, then
                            ' throw an error indicating this is a required field.
                            If sender.Required = BooleanTypes.True AndAlso Not m_blnPromptOK AndAlso Mode <> PageModeTypes.Select _
                            AndAlso (sender.FieldName.IndexOf(".") = -1 OrElse (sender.FieldName.IndexOf(".") > 0 _
                            AndAlso (sender.RaiseGetNewRecordStatus AndAlso Not sender.RaiseGetFileType = FileTypes.Reference) _
                            OrElse (Not sender.RaiseGetNewRecordStatus AndAlso sender.RaiseGetFileType = FileTypes.Reference))) Then
                                If Not m_blnPromptOK AndAlso strFieldText.Trim = "" Then

                                    If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                        AddMessage("Ce champ est requis", MessageTypes.Error) 'IM.Required
                                    Else
                                        AddMessage("This field is Required", MessageTypes.Error) 'IM.Required
                                    End If
                                End If
                                If strFieldText.Trim = "" AndAlso FieldText = "" Then

                                    If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                        AddMessage("Ce champ est requis", MessageTypes.Error) 'IM.Required
                                    Else
                                        AddMessage("This field is Required", MessageTypes.Error) 'IM.Required
                                    End If
                                End If

                            ElseIf m_blnPromptOK AndAlso sender.SubmittedValue = "" AndAlso sender.Required = BooleanTypes.True Then

                                If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                    AddMessage("Ce champ est requis", MessageTypes.Error) 'IM.Required
                                Else
                                    AddMessage("This field is Required", MessageTypes.Error) 'IM.Required
                                End If

                            End If

                            ' Set the DEFAULT for this field if no value was entered.
                            If ValidateType = ValidateTypes.Accept And (Not m_blnPromptOK) Then
                                ' If we are in ENTRY mode, check if there is a default.
                                If Me.Mode = PageModeTypes.Find OrElse Me.Mode = PageModeTypes.Change OrElse Me.Mode = PageModeTypes.Entry OrElse Me.AppendMode _
                                OrElse blnUseDefaultValue OrElse (Me.Mode = PageModeTypes.Correct AndAlso FieldText = "") Then
                                    ' If a DEFAULT was set for this field,
                                    ' then assign it to FIELDTEXT.
                                    If strDefaultValue.TrimEnd.Length > 0 Then
                                        FieldText = strDefaultValue
                                        If Not blnUseDefaultValue Then
                                            sender.ValueChanged = True
                                        End If
                                    End If
                                End If
                            End If
                        End If

                        ' If the DUPLICATE flag was set or the DEFAULT option was specified,
                        ' then continue PREPARE FOR EDITING, and optionally execute the EDIT
                        ' and PROCESS procedure.  Also store the value in the record buffer
                        ' or underlying item(variable).
                        If sender.Duplicate = BooleanTypes.True Or FieldText.Length <> 0 Then
                            If ValidateType <> ValidateTypes.Request AndAlso sender.Duplicate = BooleanTypes.True Then
                                If ValidateType <> ValidateTypes.Request Then
                                    'm_hstFieldDuplicate = ScreenSession("Duplicate")
                                    If IsNothing(m_hstFieldDuplicate) Then m_hstFieldDuplicate = New Hashtable
                                    m_hstFieldDuplicate.Item(sender.Name) = FieldText
                                    'ScreenSession("Duplicate") = m_hstFieldDuplicate
                                End If
                            End If

                            ' If the field type is NUMERIC, the field is checked for numbers.
                            ' The result is scaled by the input scale.
                            If (sender.DataType = DataTypes.Numeric OrElse (sender.DataType = DataTypes.Character AndAlso sender.Fill.Trim.Length > 0)) Then

                                If IsNumeric(FieldText.Trim) Then
                                    ' Check if Decimal is not specified then,
                                    ' we want to ensure that user has not entered
                                    ' a value with decimal
                                    If sender.Decimal >= 0 OrElse intInputScale >= 0 Then
                                        If FieldText.LastIndexOf(".") >= 0 Then
                                            Dim intDecimalEntered As Integer
                                            intDecimalEntered = FieldText.Substring(FieldText.LastIndexOf(".") + 1).Length
                                            If intDecimalEntered > Max(sender.Decimal, intInputScale) AndAlso Not sender.UnderLyingDataType = ItemDataTypes.Numeric Then
                                                m_blnValidateError = True
                                                If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                                    AddMessage("Il y a trop de dcimales.", MessageTypes.Error) 'IM.Decimal
                                                Else
                                                    AddMessage("There are too many decimal places.", MessageTypes.Error) 'IM.Decimal
                                                End If

                                            End If
                                        End If
                                    End If

                                    ' Add the INPUT SCALE.
                                    If blnUseScaling AndAlso intInputScale <> 0 AndAlso sender.SubmittedValue <> "" AndAlso strDefaultValue <> FieldText Then
                                        If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("en") Then
                                            FieldText *= 10 ^ intInputScale

                                        Else
                                            Thread.CurrentThread.CurrentCulture = New CultureInfo("en-CA")
                                            FieldText *= 10 ^ intInputScale
                                            Thread.CurrentThread.CurrentCulture = New CultureInfo(ApplicationState.Current.Language)
                                            Thread.CurrentThread.CurrentUICulture = New CultureInfo(ApplicationState.Current.Language)
                                        End If

                                    End If
                                ElseIf Not FieldText = " " Then
                                    m_blnValidateError = True

                                    If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                        AddMessage("Cette entre doit tre numrique.", MessageTypes.Error) 'IM.Numeric                                        
                                    Else
                                        AddMessage("This entry must be numeric.", MessageTypes.Error) 'IM.Numeric
                                    End If
                                End If

                            End If

                            If sender.DataType = DataTypes.Numeric OrElse underlyingDataType = ItemDataTypes.Numeric Then
                                If IsNumeric(FieldText) Then
                                    FieldValue = CDec(FieldText)
                                Else
                                    FieldValue = 0
                                End If

                                If sender.DataType = DataTypes.Numeric OrElse underlyingDataType = ItemDataTypes.Numeric Then
                                    If sender.Significance > 0 Then
                                        If sender.Significance > sender.MaxLength Then
                                            FieldText = FieldValue.ToString.PadLeft(sender.MaxLength, "0")
                                        Else
                                            FieldText = FieldValue.ToString.PadLeft(sender.Significance, "0")
                                        End If
                                    End If
                                End If

                            End If

                            If sender.DataType = DataTypes.Numeric AndAlso sender.UnderLyingDataType = ItemDataTypes.Character Then
                                If sender.Fill.Length > 0 Then
                                    If FieldValue >= 0 Then
                                        FieldText = FieldValue.ToString.PadLeft(sender.MaxLength, sender.Fill)
                                    Else
                                        FieldText = "-" & Abs(FieldValue).ToString.PadLeft(sender.MaxLength - 1, sender.Fill)
                                    End If
                                Else
                                    If FieldValue >= 0 Then
                                        FieldText = FieldValue.ToString.PadLeft(sender.MaxLength, "0")
                                    Else
                                        FieldText = "-" & Abs(FieldValue).ToString.PadLeft(sender.MaxLength - 1, "0")
                                    End If
                                End If
                                sender.RequestValue = FieldText
                            End If
                        End If
                    End If
                End If

                ' Retrieve the value from the associated buffer and move it into
                ' FIELDTEXT and where appropriate into FIELDVALUE.
                If ValidateType = ValidateTypes.Edit Then
                    If m_strEditFlag.IndexOf(sender.Name + ",") = -1 Then
                        If sender.ValueChangedByUser AndAlso m_strEditFlag.IndexOf(sender.Name + "_ERROR,") > -1 Then
                            m_strEditFlag = m_strEditFlag + sender.Name + ","
                            'Session(FormName + "_" + Level.ToString + "_" + "EDIT_FLAG") = m_strEditFlag
                        Else
                            ' Retrieve the value from the record buffer or 
                            ' underlying variable and assign it to FIELDTEXT.
                            sender.RaiseGetRecordBuffer(FieldText, FieldValue, underlyingDataType)
                        End If
                    End If

                End If

                ' Perform specified editing for ACCEPT verb processing (based on 
                ' blnRequiredDuplicateOrDefaultSet being set to TRUE) or EDIT verb processing.
                If (ValidateType = ValidateTypes.Accept AndAlso (blnRequiredDuplicateOrDefaultSet Or m_blnPromptOK)) Or ValidateType = ValidateTypes.Edit Then
                    Dim blnSuccess As Boolean

                    ' For Unsigned Integers/Numbers, if a negative value is entered, 
                    ' display the Negative error message.
                    If (sender.UnderLyingDataType = ItemDataTypes.Integer OrElse sender.UnderLyingDataType = ItemDataTypes.UnsignedNumeric) AndAlso FieldValue < 0 Then
                        m_blnValidateError = True

                        If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                            AddMessage("Cette entre ne doit pas tre ngative.", MessageTypes.Error) 'IM.Negative
                        Else
                            AddMessage("This entry must not be negative.", MessageTypes.Error) 'IM.Negative
                        End If
                    End If

                    ' Check the VALUES options passing FIELDTEXT for character
                    ' fields or FIELDVALUE for numeric and date fields.
                    If sender.Values Is Nothing Then
                        blnSuccess = True
                    Else
                        If sender.DataType = DataTypes.Numeric Then
                            If blnUseScaling AndAlso intInputScale <> 0 Then
                                blnSuccess = sender.Values.IsValueInRange(FieldValue, intInputScale)
                            Else
                                blnSuccess = sender.Values.IsValueInRange(FieldValue)
                            End If
                        Else
                            blnSuccess = sender.Values.IsValueInRange(FieldText)
                        End If
                    End If
                    If Not blnSuccess Then
                        m_blnValidateError = True

                        If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                            AddMessage("Cette entre n'est pas dans la plage de valeurs acceptable", MessageTypes.Error) 'IM.Range
                        Else
                            AddMessage("This entry isn't within the acceptable range of values", MessageTypes.Error) 'IM.Range
                        End If
                    End If

                    Dim strTextValue As String

                    ' Check for pattern matching.
                    ' Numeric and date fields are converted to character strings.
                    If underlyingDataType = DataTypes.Character Then
                        strTextValue = FieldText
                    Else
                        strTextValue = FieldValue.ToString()
                    End If
                    Dim strPattern As String
                    Try
                        strPattern = GetPattern(sender.FieldName)
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                    If strPattern Is Nothing Then strPattern = String.Empty
                    If sender.Pattern.Length > 0 OrElse strPattern.Length > 0 Then
                        If strPattern.Length = 0 Then strPattern = sender.Pattern
                        blnSuccess = MatchPattern(strTextValue, strPattern)
                    End If

                    ' If the MatchPattern was false, 
                    ' return an error to the user.
                    If Not blnSuccess Then
                        m_blnValidateError = True
                        If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                            AddMessage("Cette entre n'est pas dans la plage de valeurs acceptable", MessageTypes.Error) 'IM.Range
                        Else
                            AddMessage("This entry isn't within the acceptable range of values", MessageTypes.Error) 'IM.Range
                        End If
                    End If

                    m_intLookUpSequence += 1
                    ' Check the lookups to ensure a correct value was entered.
                    If Not (blnHasDefault AndAlso FieldText = strDefaultValue AndAlso sender.Required <> BooleanTypes.True AndAlso sender.Duplicate <> BooleanTypes.True) Then
                        sender.RaiseLookupOn()
                    End If
                    If sender.SubmittedValue <> sender.OldSubmittedValue OrElse Not MethodWasExecuted(m_strLookUpFlag, m_intLookUpSequence) Then

                        ' If we find a specific record and then edit the record, if the field is silent,
                        ' then it doesn't check the LookupNotOn.  If a sequential search is done,
                        ' then the LookupNotOn is executed.
                        If Not (Me.ChangeMode AndAlso Not Me.IsInAppendOrEntry AndAlso sender.Silent AndAlso SearchWasFiltered(sender.FieldName)) Then
                            If sender.FieldName.IndexOf(".") > 0 Then m_strLookupNotOnFile = sender.FieldName.Substring(0, sender.FieldName.IndexOf("."))
                            m_blnExecutingLookupNotOn = True
                            m_blnLookupOnSameFile = False
                            sender.RaiseLookupNotOn(blnLookupNotOnExecuted)
                            m_blnExecutingLookupNotOn = False
                            m_strLookupNotOnFileName = String.Empty
                        End If

                        ' Save the sequence information and set a flag indicating LOOKUP was run.
                        SetMethodExecutedFlag(m_strLookUpFlag, "LOOKUP_FLAG", m_intLookUpSequence)
                    End If
                End If

                ' Call the EDIT and PROCESS procedures as part of the ACCEPT or EDIT verb processing.
                If ((ValidateType = ValidateTypes.Accept And (m_blnPromptOK Or (blnRequiredDuplicateOrDefaultSet And blnRaiseEdit))) _
                And sender.ValueChanged) Or ValidateType = ValidateTypes.Edit Then

                    ' Assign the RecordBuffer value to m_OldValue.  This value 
                    ' will be used when the OLDVALUE function is called.  We then set
                    ' FIELDTEXT/FIELDVALUE to the recordbuffer.  We have taken this 
                    ' approach since PowerHouse changed any reference of the named item
                    ' on which the EDIT procedure is based and replaces it with either
                    ' FIELDTEXT or FIELDVALUE.
                    Dim strTempFieldText As String = FieldText
                    Dim strTempFieldValue As Decimal = FieldValue

                    ' Retrieve the value from the record buffer or 
                    ' underlying variable and assign it to FIELDTEXT/FIELDVALUE.
                    ' This will become the value that will be used for OldValue.
                    sender.RaiseGetRecordBuffer(FieldText, FieldValue, underlyingDataType)

                    ' Ensure that for Numeric fields with an underlying datatype 
                    ' of Character, that we update FieldValue.
                    If sender.DataType = DataTypes.Numeric AndAlso underlyingDataType = DataTypes.Character Then
                        If IsNumeric(FieldText) Then
                            FieldValue = CDec(FieldText)
                        Else
                            FieldValue = 0
                        End If
                    End If

                    ' Assign the OldValue information.
                    m_OldValue.Field = sender.FieldName
                    m_OldValue.FieldText = FieldText
                    m_OldValue.FieldValue = FieldValue

                    strOldFieldText = FieldText
                    decOldFieldValue = FieldValue

                    ' Assign the temporary values back to FIELDTEXT/FIELDVALUE.
                    FieldText = strTempFieldText
                    FieldValue = strTempFieldValue

                    If sender.DataType = DataTypes.Numeric AndAlso underlyingDataType = ItemDataTypes.Numeric Then

                        If sender.Significance > 0 Then
                            If sender.Significance > sender.MaxLength Then
                                FieldText = FieldValue.ToString.PadLeft(sender.MaxLength, "0")
                            Else
                                FieldText = FieldValue.ToString.PadLeft(sender.Significance, "0")
                            End If
                        End If

                    End If

                    If sender.ValueChangedByUser Then
                        If intInputScale = 0 AndAlso sender.Decimal > 0 Then
                            FieldText = Framework.Core.Framework.QDesign.Round(CDec(FieldText), sender.Decimal) * (10 ^ sender.Decimal)
                            FieldValue = FieldText
                        End If
                    End If

                    ' Store the value of FIELDTEXT or FIELDVALUE to the
                    ' record buffer or underlying variable.
                    sender.RaiseSetRecordBuffer(FieldText, FieldValue, underlyingDataType)

                    If Not sender.IsDefine Then sender.RaiseSetEditFlag(False)
                    '----------------------------
                    ' Call the EDIT procedure.
                    '----------------------------
                    blnEditFailed = True


                    Try
                        If sender.OldSubmittedValue <> FieldText Then
                            blnFieldDiff = True
                        End If
                        sender.RaiseEdit()
                        blnFieldDiff = False
                    Catch ex As CustomApplicationException
                        m_strEditFlag = m_strEditFlag + sender.Name + "_ERROR,"
                        'Session(FormName + "_" + Level.ToString + "_" + "EDIT_FLAG") = m_strEditFlag
                        Throw (ex)
                    Catch ex As Exception
                        Throw (ex)
                    End Try

                    blnEditFailed = False

                    If Not sender.IsDefine Then sender.RaiseSetEditFlag(True)
                End If

                ' Store the value in the record buffer.
                If ((ValidateType = ValidateTypes.Accept And (m_blnPromptOK Or blnRequiredDuplicateOrDefaultSet)) _
                OrElse (m_blnPromptOK AndAlso ValidateType = ValidateTypes.Request)) Then

                    ' Store the value of FIELDTEXT or FIELDVALUE to the
                    ' record buffer or underlying variable.
                    If FieldText.Length > 0 Then sender.RaiseSetRecordBuffer(FieldText, FieldValue, underlyingDataType, ValidateType = ValidateTypes.Request)
                End If

                '----------------------------
                ' Call the PROCESS procedure.
                '----------------------------
                If ((ValidateType = ValidateTypes.Accept And (m_blnPromptOK Or blnRequiredDuplicateOrDefaultSet)) _
                 And sender.ValueChanged) Or ValidateType = ValidateTypes.Edit Then
                    sender.RaiseProcess()
                End If

                ' If fixed, don't change the value unless a specific display verb is called.
                'If sender.Fixed AndAlso m_blnIsInDisplayPreDisplayFormatting Then
                '    EndValidate()
                '    Exit Function
                'End If

                ' For non-EDIT verb processing, retrieve the value for display, 
                ' perform the OUTPUT procedure and execute DISPLAY formatting.
                If ValidateType <> ValidateTypes.Edit Then
                    Dim strUnderlyingValue As String

                    ' Retrieve the value from the record buffer or 
                    ' underlying variable and assign it to FIELDTEXT.
                    sender.RaiseGetRecordBuffer(FieldText, FieldValue, underlyingDataType)
                    intInputScale = sender.GetInputScale
                    Dim intMaxLength As Integer = sender.MaxLength

                    ' Scale the numeric items and right justify the value.
                    If sender.DataType = DataTypes.Numeric Then
                        ' Remove the leading zeros if coming from a character datatype.
                        If IsNumeric(FieldText) AndAlso FieldText.StartsWith("0") AndAlso FieldText.Trim <> "0" Then
                            FieldText = FieldText.TrimStart("0")
                            If FieldText.StartsWith(".") Then FieldText = "0" & FieldText
                        End If

                        strUnderlyingValue = FieldValue.ToString

                        If ValidateType <> ValidateTypes.Request AndAlso NULL(FieldText) = cEmptyString Then
                            FieldText = 0
                        End If

                        If FieldText <> cEmptyString Then
                            If FieldText.Trim.Length <> 0 AndAlso blnUseScaling AndAlso sender.GetOutputScale <> 0 Then
                                FieldText = QDesign.Round(CDec(FieldText), sender.GetOutputScale, RoundOptionTypes.Zero) * (10 ^ sender.GetOutputScale)
                            End If

                            ' Right-justify the record buffer value in FIELDTEXT.
                            'FieldText = FieldText.Trim.PadLeft(intMaxLength)
                        End If
                    Else
                        strUnderlyingValue = FieldText
                    End If

                    '----------------------------
                    ' Call the OUTPUT procedure.
                    '----------------------------
                    sender.RaiseOutput()

                    ' Format the values prior to displaying based on data type.
                    If (sender.DataType = DataTypes.Numeric AndAlso (IsNumeric(FieldText) OrElse FieldText.Trim.Length = 0)) OrElse (Not sender.DataType = DataTypes.Numeric AndAlso (sender.BWZ = BooleanTypes.True OrElse sender.Fill <> "")) Then
                        ' If the field is NUMERIC, FIELDTEXT is converted to a display string
                        ' using the numeric picture and format options.
                        If ValidateType <> ValidateTypes.Request OrElse (ValidateType = ValidateTypes.Request AndAlso IsNumeric(FieldText)) Then
                            If FieldText.Trim.Length <> 0 AndAlso Not blnUseScaling AndAlso intInputScale > 0 Then
                                FieldText = QDesign.Round(CDec(FieldText), intInputScale) * (10 ^ intInputScale)
                            End If



                            Dim strThousandSeparator As String = ","
                            If sender.m_IsBoundToTemporary AndAlso sender.Picture.Length = 0 OrElse sender.UnderLyingDataType = DataTypes.Character Then
                                strThousandSeparator = ""
                            End If

                            If blnUseScaling = True AndAlso FieldText.IndexOf(".") > 0 Then
                                FieldText = FieldText.Substring(0, FieldText.IndexOf(".")).Trim
                            End If

                            Dim strMessage As String
                            Dim elementName As String = String.Empty
                            If strTableFieldName.IndexOf(".") > -1 Then elementName = strTableFieldName.Substring(strTableFieldName.IndexOf(".") + 1)
                            strMessage = ApplyNumericFormatting(elementName, FieldText, sender.BWZ, sender.TrailingSign, sender.LeadingSign, sender.Picture,
                                    sender.GetSignificance, sender.Fill, sender.Float, sender.MaxLength, sender.ItemSize, sender.UnderLyingDataType, sender.DataType, sender.Decimal, intInputScale, strThousandSeparator)

                            If sender.DataType = DataTypes.Numeric Then
                                FieldText = FieldText.Trim()
                            End If

                            If strMessage.Length > 0 Then
                                AddMessage(strMessage, MessageTypes.Error)
                            End If

                            If sender.DataType = DataTypes.Character AndAlso sender.Fill <> "" Then
                                ' Store the value of FIELDTEXT or FIELDVALUE to the
                                ' record buffer or underlying variable.
                                sender.RaiseSetRecordBuffer(FieldText, FieldValue, underlyingDataType)
                            End If
                        End If
                    Else
                        ApplyCharacterFormatting(FieldText, sender.Picture)
                    End If

                    If Not sender.PreDisplay = BooleanTypes.True AndAlso sender.FieldName.IndexOf(".") > -1 AndAlso sender.FieldName.Substring(0, sender.FieldName.IndexOf(".")) = DisplayFileForDelete Then
                        FieldText = ""
                    End If

                    ' Store this in case a RunScreen is called since we don't update the screen
                    ' values in this case.  This ensures that when posting back, that when checking
                    ' the present value (coming from OldText) and comparing against the PostedValue,
                    ' that we don't have a different value and therefore updating the SubmittedValue.
                    m_oldTextField = sender
                    m_oldTextValue = sender.OldText

                    ' Assign FIELDTEXT back to the control.  For fields
                    ' of type CHARACTER, truncate the value if no picture.
                    ' If the length of FIELDTEXT is greater than the
                    ' length of the control, truncate FIELDTEXT 
                    ' to the length of the control.

                    If sender.DataType = DataTypes.Character And sender.Picture.Trim = "" Then
                        If FieldText.Length <= intMaxLength Then

                            sender.Text = FieldText.TrimEnd
                            sender.OldText = FieldText.TrimEnd
                        Else
                            sender.Text = FieldText.Substring(0, intMaxLength).TrimEnd
                            sender.OldText = FieldText.Substring(0, intMaxLength).TrimEnd
                        End If
                    Else
                        If Not (ValidateType = ValidateTypes.Display AndAlso sender.ValueChanged) Then
                            sender.Text = FieldText
                            sender.OldText = FieldText
                        End If
                    End If

                    Select Case ValidateType
                        Case ValidateTypes.Accept, ValidateTypes.Request
                            sender.OldSubmittedValue = sender.SubmittedValue
                    End Select
                End If




                If IsValidateWithIn() Then
                    FieldText = strPreviousFieldText
                    FieldValue = dblPreviousFieldValue
                End If

                EndValidate()


                ' Stores whether the DISPLAY verb was executed during the current postback
                ' on this field.  This will change the Text property, therefore if we have
                ' an Accept/RequestPrompt verb on this field, this text property is invalid
                ' (meaning we should use SubmittedValue instead).
                If ValidateType = ValidateTypes.Display Then
                    sender.DisplayExecuted = True
                End If


                If blnResetFromInputAndNull Then
                    sender.ValueChanged = False
                End If

                If HasError Then HasError = False

                Return sender.ValueChanged

            Catch ex As CustomApplicationException

                ' Remove the flag if not completed.
                EndValidate()

                If Not m_blnInDetailFind OrElse ex.Message = cRunScreenException.ToString Then

                    ' Ensure we re-run setting the value in case a SUM INTO needs to be reset.
                    If blnEditFailed AndAlso ex.Message <> cAcceptRequestPromptException.ToString Then
                        sender.RaiseSetRecordBuffer(strOldFieldText, decOldFieldValue, underlyingDataType)
                        blnEditFailed = False
                    End If

                    ' IF condition modified from version 483.  See SourceSafe history.
                    If ex.Message <> cRunScreenException.ToString Then

                        'In case of Request in Find/Select, if Custom Error is thrown, we reset the Request values to empty or False
                        If ValidateType = ValidateTypes.Request Then
                            sender.RequestValue = String.Empty
                            If Me.UseAcceptProcessing Then
                                sender.RequestWasPerformed = False
                                sender.RequestPromptOk = False
                            End If
                        End If

                        ' Indicate the control to move the focus to.
                        SetFocusField(sender.Name)

                        'RegisterHiddenField("RequestedControlFocusOverRide", sender.RenderedID)

                        If ex.Message <> cAcceptRequestPromptException.ToString Then

                            If Me.UseAcceptProcessing Then
                                ' Reset the text field with the original value.
                                sender.Text = sender.OldText
                                sender.SubmittedValue = ""
                            Else
                                sender.Text = ""
                                sender.OldText = ""
                            End If

                            If ApplicationState.Current.LookupCharacter <> sender.Text AndAlso sender.LookupCharacter <> sender.Text Then
                                If sender.UseLookupCharacter Then
                                    If sender.Text = sender.LookupCharacter And sender.Text.Length > 0 Then
                                        sender.OldSubmittedValue = sender.Text
                                    End If
                                Else
                                    If sender.Text = ApplicationState.Current.LookupCharacter And sender.Text.Length > 0 Then
                                        sender.OldSubmittedValue = sender.Text
                                    End If
                                End If
                            End If

                            ' Set the SubmittedValue back to the OldSubmittedValue.
                            sender.SubmittedValue = sender.OldSubmittedValue

                            ' If there is no OldSubmittedValue, then reset the 
                            ' ValueChanged to FALSE.
                            If sender.OldSubmittedValue = "" Then
                                sender.ValueChanged = False
                            End If
                            ' Keep track of the ACCEPT field in case an error occurs.
                            'If (Session(FormName + "_" + Level.ToString + "_" + "VALIDATE") & "").ToString.Length = 0 AndAlso Not sender.Silent Then m_fldAcceptField = sender
                            'RemoveAccept()
                        End If
                    End If
                    m_strNavigationControl = sender.Name

                    ' Set the previous value from the field to the 
                    ' control if a lookup screen was called and no
                    ' value was selected by the user.
                    If strPreviousValue.Length > 0 AndAlso ex.Message <> cRunScreenException.ToString Then
                        sender.OldText = strPreviousValue
                    End If

                    If ex.Message = cRunScreenException.ToString Then
                        'RegisterHiddenFields("RequestedControlFocusOverRide", "")
                    End If

                    Throw ex


                End If



            Catch ex As Exception

                ' Write the exception to the event log and throw an error.
                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function

        Private Function IsNumeric(value As String)

            If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("en") Then
                Return Microsoft.VisualBasic.IsNumeric(value)

            Else
                Thread.CurrentThread.CurrentCulture = New CultureInfo("en-CA")
                Try
                    Dim result As Integer = Decimal.Parse(value)
                    Return True
                Catch e As System.Exception
                    Return False
                Finally
                    Thread.CurrentThread.CurrentCulture = New CultureInfo(ApplicationState.Current.Language)
                    Thread.CurrentThread.CurrentUICulture = New CultureInfo(ApplicationState.Current.Language)
                End Try
            End If

        End Function

        ''' --- ValidateParmPrompt -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Will validate the data entered on the parameter screen by user.
        ''' </summary>
        ''' <param name="ParmInfo">The parameter information stored in PARMTYPE.</param>
        ''' <param name="FieldText">The value of FieldText.</param>
        ''' <remarks>Validates the data entered in a parameter prompt.
        ''' </remarks>
        ''' <example>ValidateParmPrompt(PARM1TYPE.value, FieldText)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Function ValidateParmPrompt(ByVal ParmInfo As String, ByRef FieldText As String) As Boolean

            Dim values As String = ParmInfo.Split("~")(4)
            Dim chooseFlag As String = ParmInfo.Split("~")(3).Trim
            Dim ar() As String = FieldText.Trim.Split(",")
            Dim originalFieldText As String = FieldText
            For i As Integer = 0 To ar.Length - 1
                FieldText = ar(i)
                If ParmInfo.Split("~")(0) = "NUM" Then
                    If FieldText.Trim <> "" Then
                        If Not IsNumeric(FieldText.Trim) Then
                            ErrorMessage("This entry must contain a numeric value.  Please re-enter.")
                        End If
                        If Not ParmValueInRange(CDec(FieldText), values) Then
                            If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                AddMessage("Cette entre n'est pas dans la plage de valeurs acceptable", MessageTypes.Error) 'IM.Range
                            Else
                                AddMessage("This entry isn't within the acceptable range of values", MessageTypes.Error) 'IM.Range
                            End If
                        End If
                    ElseIf values.Length > 0 Then
                        If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                            AddMessage("Cette entre n'est pas dans la plage de valeurs acceptable", MessageTypes.Error) 'IM.Range
                        Else
                            AddMessage("This entry isn't within the acceptable range of values", MessageTypes.Error) 'IM.Range
                        End If
                    End If
                ElseIf ParmInfo.Split("~")(0) = "DTE" Then
                    If FieldText <> "" Then
                        If FieldText.Trim.Length < 8 Then FieldText = "0" & FieldText.Trim
                        If ConvertScreenDateToNumber(FieldText, FieldValue, GlobalizationManager, GetDefaultDateFormat) Then
                            FieldText = FieldValue.ToString
                        Else

                            If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                ErrorMessage("Cette entre doit tre une date valide. Veuillez r-entrer.")
                            Else
                                ErrorMessage("This entry must be a valid date.  Please re-enter.")
                            End If
                        End If
                    End If
                Else
                    If Not ParmValueInRange(FieldText, values) Then
                        If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                            AddMessage("Cette entre n'est pas dans la plage de valeurs acceptable", MessageTypes.Error) 'IM.Range
                        Else
                            AddMessage("This entry isn't within the acceptable range of values", MessageTypes.Error) 'IM.Range
                        End If
                    End If
                End If

                Dim fieldLength As Integer = VAL(ParmInfo.Split("~")(1))
                If fieldLength < FieldText.Trim.Length Then
                    ErrorMessage("Maxlength for this field is " & VAL(ParmInfo.Split("~")(1)) & ".  Please re-enter")
                End If

                ar(i) = FieldText
            Next
            FieldText = Join(ar, ",")

            Return True

        End Function

        ''' --- FormatParmPrompt -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Formats the value of FieldText for a parm prompt.
        ''' </summary>
        ''' <param name="ParmInfo">The parameter information stored in PARMTYPE.</param>
        ''' <param name="FieldText">The value of FieldText.</param>
        ''' <returns>A string representing the formatted FieldText value.</returns>
        ''' <remarks>Formats the data entered in a parameter prompt for display.
        ''' </remarks>
        ''' <example>FieldText = FormatParmPrompt(PARM1TYPE.value, FieldText)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Function FormatParmPrompt(ByVal ParmInfo As String, ByVal FieldText As String) As String

            Dim originalFieldText As String = FieldText
            Dim ar() As String = FieldText.Trim.Split(",")
            For i As Integer = 0 To ar.Length - 1
                FieldText = ar(i)
                Dim fieldLength As Integer = CInt(ParmInfo.Split("~")(1))
                If FieldText.Length > fieldLength Then FieldText = FieldText.Substring(0, fieldLength)
                If ParmInfo.Split("~")(0) = "DTE" Then
                    If IsNumeric(FieldText) Then
                        FieldText = ConvertNumberToScreenDate(CDec(FieldText), GlobalizationManager, GetDefaultDateFormat, "", True)
                    End If
                End If
                ar(i) = FieldText
            Next
            FieldText = Join(ar, ",")

            Return FieldText

        End Function

        ''' --- ConfigureParmFields -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Configures the current parameter's fields.
        ''' </summary>
        ''' <param name="Field">The parameter information stored in PARMTYPE.</param>
        ''' <param name="ParmLabel">The value of FieldText.</param>
        ''' <param name="ParmInfo">The parameter information</param>
        ''' <example>ConfigureParmFields(Field1, PARM1, PARM1TYPE.Value)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Sub ConfigureParmFields(ByRef Field As TextBox, ByRef ParmLabel As CoreCharacter, ByVal ParmInfo As String)

            If ParmInfo.Trim.Length > 0 Then
                ParmLabel.Value = ParmInfo.Split("~")(2)
                Select Case ParmInfo.Split("~")(5).Trim
                    Case "U"
                        Field.ShiftType = ShiftTypes.UpShift
                        Field.DataType = DataTypes.Character
                    Case "D"
                        Field.ShiftType = ShiftTypes.DownShift
                        Field.DataType = DataTypes.Character
                End Select
                If ParmInfo.Split("~")(3) = "Y" Then
                    Field.Choose = True
                End If
            Else
                Field.Display = BehaviorTypes.ChangeEntryFind
                Field.DisplayAsLabel = True
            End If

        End Sub

        ''' --- ParmValueInRange -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Determines if the value entered is within the proper range.
        ''' </summary>
        ''' <param name="Value">The value entered by the user.</param>
        ''' <param name="Values">The range or list of acceptable values.</param>
        ''' <returns>A boolean indicating whether the value is valid.</returns>
        ''' <remarks>Indicates .
        ''' </remarks>
        ''' <example>FieldText = FormatParmPrompt(PARM1TYPE.value, FieldText)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Function ParmValueInRange(ByVal Value As Decimal, ByVal Values As String) As Boolean

            Values = Values.Trim
            If Values.Length = 0 Then
                Return True
            Else
                If Values.IndexOf("-") > -1 AndAlso Values.IndexOf(",") = -1 Then
                    Dim minVal As Decimal = CDec(Values.Substring(0, Values.IndexOf("-")))
                    Dim maxVal As Decimal = CDec(Values.Substring(Values.IndexOf("-") + 1))
                    If Value >= minVal AndAlso Value <= maxVal Then
                        Return True
                    Else
                        Return False
                    End If
                ElseIf Values.IndexOf(",") > -1 AndAlso Values.IndexOf("-") = -1 Then
                    Dim ar() As String = Values.Split(",")
                    Dim returnValue As Boolean = False
                    For i As Integer = 0 To ar.Length - 1
                        If Value = CDec(ar(i).Trim) Then
                            returnValue = True
                        End If
                    Next
                    Return returnValue
                End If
            End If

        End Function

        ''' --- ParmValueInRange -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Determines if the value entered is within the proper range.
        ''' </summary>
        ''' <param name="Value">The value entered by the user.</param>
        ''' <param name="Values">The range or list of acceptable values.</param>
        ''' <returns>A boolean indicating whether the value is valid.</returns>
        ''' <remarks>Indicates .
        ''' </remarks>
        ''' <example>FieldText = FormatParmPrompt(PARM1TYPE.value, FieldText)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Function ParmValueInRange(ByVal Value As String, ByVal Values As String) As Boolean

            Values = Values.Trim
            If Values.Length = 0 Then
                Return True
            Else
                If Values.IndexOf("-") > -1 AndAlso Values.IndexOf(",") = -1 Then
                    Dim minVal As String = CDec(Values.Substring(0, Values.IndexOf("-")))
                    Dim maxVal As String = CDec(Values.Substring(Values.IndexOf("-") + 1))
                    If Value >= minVal AndAlso Value <= maxVal Then
                        Return True
                    Else
                        Return False
                    End If
                ElseIf Values.IndexOf(",") > -1 AndAlso Values.IndexOf("-") = -1 Then
                    Dim ar() As String = Values.Split(",")
                    Dim returnValue As Boolean = False
                    For i As Integer = 0 To ar.Length - 1
                        If Value.Trim = ar(i).Trim Then
                            returnValue = True
                        End If
                    Next
                    Return returnValue
                End If
            End If

        End Function


        ''' --- Validate -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Will validate the data entered on the screen by user.
        ''' </summary>
        ''' <param name="sender">A DateControl which contains the data to be validated.</param>
        ''' <param name="ValidateType">A ValidateType.</param>
        ''' <param name="InFieldValidate"></param>
        ''' <remarks>Validates the data entered as well as performing dictionary functions,
        ''' lookups and assignments to FIELDTEXT and FIELDVALUE. In addition, Validate also
        ''' calls the INPUT, EDIT, PROCESS and OUTPUT procedures used by PowerHouse.
        ''' </remarks>
        ''' <example>Validate(dtDateControl1, ValidateType.Accept)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Overloads Function Validate(ByRef sender As DateControl, Optional ByVal ValidateType As ValidateTypes = ValidateTypes.Accept, Optional ByVal InFieldValidate As Boolean = False) As Boolean

            Dim underlyingDataType As DataTypes
            Dim strPreviousFieldDate As String = FieldText
            Dim dblPreviousFieldValue As Decimal = FieldValue
            Dim strOldFieldDate As String ' Ensures that if the EDIT fails, that we reset the values in order
            Dim decOldFieldValue As Decimal = 0            ' to reset any SUM INTO values, etc.
            Dim blnEditFailed As Boolean = False
            Dim blnNullResponseAccept As Boolean
            Dim blnUseDefaultValue As Boolean           ' Used for TEMPORARIES only.
            Dim blnIsNewMasterOnSlaveScreen As Boolean = Me.Slave AndAlso sender.FieldName.IndexOf(".") > 0 AndAlso sender.RaiseGetNewRecordStatus AndAlso sender.RaiseGetFileType = FileTypes.Master
            Dim blnResetFromInputAndNull As Boolean = False

            Try

                If sender.invaliddate Then
                    sender.invaliddate = False
                    DateError = True

                    If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                        AddMessage("Cette entre doit tre une date.", MessageTypes.Error) 'IM.Date
                    Else
                        AddMessage("This entry must be a date.", MessageTypes.Error) 'IM.Date
                    End If
                End If

                sender.DisplayExecuted = False
                StartValidate()
                'Clear the FieldDate from the previous field
                FieldText = ""
                FieldValue = 0

                If sender.UnderLyingDataType = ItemDataTypes.Integer OrElse sender.UnderLyingDataType = ItemDataTypes.SignedInteger OrElse sender.UnderLyingDataType = ItemDataTypes.UnsignedNumeric Then
                    underlyingDataType = DataTypes.Numeric
                Else
                    underlyingDataType = sender.UnderLyingDataType
                End If

                ' If this field does not have the REFRESH option then exit (when called after running a run screen).
                If ValidateType = ValidateTypes.Display AndAlso m_blnIsInDisplayPreDisplayFormatting AndAlso ((m_blnReturnedFromRunScreen AndAlso Not sender.Refresh) OrElse (blnIsNewMasterOnSlaveScreen)) Then
                    EndValidate()
                    Exit Function
                End If

                If Not m_blnRequireValidateRequest AndAlso ValidateType = ValidateTypes.Request Then
                    'Doesn't Require Validate on Request Fields from SelectProcessing, 
                    'rather it use values from Request Buffer (from File Object)
                    m_blnPromptOK = True
                    EndValidate()
                    Exit Function
                End If

                ' In ACCEPT processing, if the value was not modified and it is not blank, then exit the function.
                If ValidateType = ValidateTypes.Accept AndAlso (Not sender.ValueChanged) AndAlso Not sender.Text Is Nothing AndAlso IsCurrentField(sender) AndAlso Not (blnIsNewMasterOnSlaveScreen) Then
                    blnUseDefaultValue = UseDefaultValueForTemporary(sender)
                    If blnUseDefaultValue Then
                        ' Temporaries that have a default (whose value was not changed) receive the default value.
                    Else
                        'Check that no 'K'haracters have been typed into this field
                        If (NullResponse(sender.RenderedID) <> "K") Then
                            blnNullResponseAccept = True
                        End If
                    End If
                End If

                Dim blnRequiredDuplicateOrDefaultSet As Boolean = False
                Dim blnRaiseEdit As Boolean
                Dim intPreEditFieldValue As Integer
                Dim strDefaultValue As Date?
                Dim blnHasDefault As Boolean = False
                Dim blnLookupNotOnExecuted As Boolean = False
                Dim strTableFieldName As String = sender.FieldName
                Dim strTableName As String = sender.TableName
                Dim strFieldName As String = strTableFieldName.Replace(strTableName + ".", "")
                Dim strDateFormat As String = sender.DateFormat

                If strDateFormat Is Nothing OrElse strDateFormat.Length = 0 Then
                    strDateFormat = GetDefaultDateFormat()
                End If

                Thread.CurrentThread.CurrentCulture.DateTimeFormat.DateSeparator = "/"
                Thread.CurrentThread.CurrentCulture.DateTimeFormat.ShortDatePattern = strDateFormat
                Thread.CurrentThread.CurrentCulture.DateTimeFormat.LongDatePattern = strDateFormat

                If Not blnNullResponseAccept Then
                    'If DateFormat is not specified and if FieldDate is Number and 
                    'is of 8 characters, we are assuming that it is a date in the default date format. 
                    'format so we are passing an overridden Date format as default date format
                    'Wednesday, April 06, 2005 2:16:58 PM


                    ' Set FieldDate to the value of the control.
                    Dim blnUseTextProperty As Boolean = False
                    If ValidateType <> ValidateTypes.Display Then
                        If Me.UseAcceptProcessing Then
                            blnUseTextProperty = (sender.ValueChangedByUser AndAlso Not sender.DisplayExecuted) AndAlso (IsCurrentField(sender) AndAlso (NullResponse(sender.RenderedID) = "K" OrElse NullResponse(sender.RenderedID) = "D"))
                            If Not FnKeyExecuted() Then m_intRunScreenSequence = 0
                        Else
                            blnUseTextProperty = InFieldValidate
                        End If
                        If blnUseTextProperty Then
                            FieldText = sender.Text

                            If sender.MultiAccept AndAlso ValidateType = ValidateTypes.Accept Then
                                MultiAccept(sender.Name, FieldText)
                            End If

                            If Me.UseAcceptProcessing Then
                                ' If we had a date value before, and we are deleting it (equivalent to entering 0 in PowerHouse),
                                ' then we need to set SubmittedValue to 0 so we don't get a "Required field" error during Entry.
                                If FieldText Is Nothing AndAlso Not sender.OldSubmittedValue Is Nothing Then
                                    sender.Text = Nothing
                                End If

                                'If Not IsNothing(Request("hidControl")) AndAlso Request("hidControl").ToString.IndexOf("||") >= 0 Then
                                '    Dim strControl As String = Request("hidControl").ToString.Substring(0, Request("hidControl").ToString.IndexOf("||"))
                                '    Dim strValue As String = Request("hidControl").ToString.Substring(Request("hidControl").ToString.IndexOf("||") + 2)
                                '    If strControl = sender.RenderedID AndAlso _
                                '    strValue <> sender.Text Then
                                '        If Not FnKeyExecuted() Then RemoveRunScreens(sender.Name, 0)
                                '    End If
                                'End If
                            End If
                        Else
                            If sender.MultiAccept AndAlso ValidateType = ValidateTypes.Accept Then

                                If MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence + 1) Then
                                    FieldText = GetMultiAccept(sender.Name)
                                Else
                                    FieldText = sender.Text
                                    MultiAccept(sender.Name, FieldText)
                                End If

                            Else
                                FieldText = sender.Text
                            End If

                        End If
                    End If

                    ' If the value of the field is "" and the initial value (OldText)
                    ' was not blank, then create a space to duplicate PowerHouse behaviour.
                    If (ValidateType = ValidateTypes.Accept OrElse ValidateType = ValidateTypes.Request) AndAlso Not (blnIsNewMasterOnSlaveScreen) Then
                        If blnUseTextProperty Then
                            If sender.Text Is Nothing And Not sender.OldText Is Nothing Then
                                FieldText = ""
                                sender.Text = New Date?
                            End If
                        Else
                            If FieldText Is Nothing And Not sender.AcceptProcessingOldText Is Nothing Then
                                FieldText = ""
                                sender.Text = ""
                            End If
                        End If
                    End If
                End If ' If Not blnNullResponseAccept Then

                ' Call the INPUT procedure when processing the ACCEPT or REQUEST verbs.  
                ' These(verbs) then execute code to prepare for editing.
                If ValidateType = ValidateTypes.Accept Or ValidateType = ValidateTypes.Request Then

                    If sender.OldSubmittedValue <> FieldText Then
                        blnFieldDiff = True
                    End If
                    '----------------------------
                    ' Call the INPUT procedure.
                    '----------------------------
                    Dim blnInputChangedValue As Boolean
                    Dim strFieldDate As String = FieldText
                    If m_blnChangeMode = True Then m_blnFindMode = False
                    sender.RaiseInput()
                    blnFieldDiff = False
                    If m_blnChangeMode = True Then m_blnFindMode = True
                    If Not strFieldDate.Equals(FieldText) Then
                        sender.ValueChanged = True
                        blnInputChangedValue = True
                        If blnNullResponseAccept Then
                            blnResetFromInputAndNull = True
                        End If
                        blnUseDefaultValue = False
                    End If

                    ' Determine if the current value is the same as the record buffer.  If so,
                    ' set the ValueChanged back to FALSE (only if the INPUT procedure didn't change the value).
                    sender.RaiseGetRecordBuffer(strFieldDate, 0, underlyingDataType)
                    If FieldText.Equals(strFieldDate) AndAlso blnInputChangedValue AndAlso sender.Text = sender.LookupCharacter _
                    AndAlso sender.LookupCharacter <> "" Then sender.ValueChanged = False

                    ' If the FieldDate predefined item has a size of zero, the
                    ' PROMPTOK predefined condition is set to FALSE for the field,
                    ' otherwise it is set to TRUE.
                    If Not sender.ValueChanged AndAlso (FieldText Is Nothing OrElse FieldText.Length = 0 OrElse blnUseDefaultValue) Then
                        m_blnPromptOK = False
                    Else
                        m_blnPromptOK = True
                    End If

                    If (Mode = PageModeTypes.Find OrElse Mode = PageModeTypes.Select) AndAlso ValidateType = ValidateTypes.Request Then
                        sender.RequestValue = FieldText
                        If Me.UseAcceptProcessing Then
                            sender.RequestWasPerformed = True
                            sender.RequestPromptOk = m_blnPromptOK
                        End If
                    End If


                    If SetFieldDefaults(Replace(sender.FieldName, ".", "_")) = "" Then
                        strDefaultValue = Nothing
                    Else
                        ' Determine if this field has a default.
                        strDefaultValue = New Date(Convert.ToInt32(SetFieldDefaults(Replace(sender.FieldName, ".", "_")).Substring(0, 4)),
                                                   Convert.ToInt32(SetFieldDefaults(Replace(sender.FieldName, ".", "_")).Substring(4, 2)),
                                                   Convert.ToInt32(SetFieldDefaults(Replace(sender.FieldName, ".", "_")).Substring(6, 2)))
                    End If







                    If Not strDefaultValue Is Nothing Then blnHasDefault = True

                    ' If PromptOk is false because the user didn't enter anything, but a value was assigned to this field
                    ' through code, then assume that the Required flag is false since there is a value set for this field. (QKCD9161)
                    Dim blnRequired As BooleanTypes = sender.Required
                    If Not m_blnPromptOK AndAlso sender.DisplayExecuted Then
                        ' Check the value from the record buffer or 
                        ' underlying variable and assign it to FieldDate.
                        sender.RaiseGetRecordBuffer(strFieldDate, 0, underlyingDataType)
                        If sender.UnderLyingDataType = DataTypes.Numeric Then
                            If Not (strFieldDate Is Nothing And Not blnHasDefault) Then
                                blnRequired = BooleanTypes.False
                            End If
                        Else
                            If Not strFieldDate Is Nothing Then
                                blnRequired = BooleanTypes.False
                            End If
                        End If
                    End If

                    ' PromptOk is false because the user didn't enter anything, but the record status for the current 
                    ' file object is not New, then set required to false since we don't need to throw the Required field exception.
                    If Not m_blnPromptOK AndAlso blnRequired AndAlso sender.FieldName.IndexOf(".") > 0 AndAlso Not sender.RaiseGetNewRecordStatus AndAlso Not sender.RaiseGetFileType = FileTypes.Reference Then
                        blnRequired = BooleanTypes.False
                    End If

                    ' If we have a slave screen, check the values to ensure that required fields don't throw
                    ' an error if there is a value already in the field.  This is due to the fact that we 
                    ' are not using the text value.  This will fail however if the value that was entered is also
                    ' a default value (ie. " ", 0)
                    If Not m_blnPromptOK AndAlso blnIsNewMasterOnSlaveScreen Then
                        sender.RaiseGetRecordBuffer(strFieldDate, 0, underlyingDataType)
                        If IsNumeric(strFieldDate) AndAlso VAL(strFieldDate) <> 0 Then
                            blnRequired = BooleanTypes.False
                        End If
                    End If

                    ' If we are updating an existing record, and FieldDate is blank, then we really should not
                    ' continue the check for Required, Lookups and Defaults.
                    ' Changed condition to check the Mode is not Entry and that we are not running Append (which can run in Find mode).
                    ' This ensures that fields that have a 0 date don't get the Required message.
                    If ValidateType = ValidateTypes.Accept AndAlso Not m_blnPromptOK AndAlso sender.FieldName.IndexOf(".") > 0 AndAlso blnRequired = BooleanTypes.True AndAlso Not sender.RaiseGetNewRecordStatus AndAlso Mode <> PageModeTypes.Entry AndAlso Not IsAppend Then
                        blnRequired = BooleanTypes.False
                        blnHasDefault = False
                    End If

                    ' If the PROMPTOK condition is FALSE and none of the REQUIRED, DUPLICATE or DEFAULT
                    ' options are specified, then skip the edit processing.  Since blnRequiredDuplicateOrDefaultSet
                    ' is defaulted to FALSE, set it to TRUE if this condition is not met.
                    If (Not m_blnPromptOK AndAlso sender.AcceptProcessingOldText = "" AndAlso (blnRequired = BooleanTypes.True Or sender.Duplicate = BooleanTypes.True _
                    Or blnHasDefault = BooleanTypes.True)) Or m_blnPromptOK Then
                        blnRequiredDuplicateOrDefaultSet = True

                        If ValidateType <> ValidateTypes.Request Then

                            ' If the duplicate is used, set value changed to true.
                            If sender.Duplicate = BooleanTypes.True AndAlso FieldText Is Nothing Then
                                'm_hstFieldDuplicate = ScreenSession("Duplicate")
                                If IsNothing(m_hstFieldDuplicate) Then m_hstFieldDuplicate = New Hashtable
                                If m_hstFieldDuplicate.Contains(sender.Name) Then
                                    FieldText = m_hstFieldDuplicate.Item(sender.Name)
                                    If FieldText <> "" Then
                                        blnRaiseEdit = True
                                        m_blnPromptOK = True
                                        sender.ValueChanged = True
                                    End If
                                End If
                            End If

                            ' If this is a required field and PROMPTOK is FALSE, then
                            ' throw an error indicating this is a required field.
                            If sender.Required = BooleanTypes.True AndAlso Not m_blnPromptOK AndAlso Mode <> PageModeTypes.Select _
                            AndAlso (sender.FieldName.IndexOf(".") = -1 OrElse (sender.FieldName.IndexOf(".") > 0 _
                            AndAlso (sender.RaiseGetNewRecordStatus AndAlso Not sender.RaiseGetFileType = FileTypes.Reference) _
                            OrElse (Not sender.RaiseGetNewRecordStatus AndAlso sender.RaiseGetFileType = FileTypes.Reference))) Then

                                If Not m_blnPromptOK AndAlso (IsNothing(strFieldDate) OrElse strFieldDate.Trim = "") Then

                                    If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                        AddMessage("Ce champ est requis", MessageTypes.Error) 'IM.Required
                                    Else
                                        AddMessage("This field is Required", MessageTypes.Error) 'IM.Required
                                    End If
                                End If
                                If (IsNothing(strFieldDate) OrElse strFieldDate.Trim = "") AndAlso FieldText = "" Then

                                    If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                        AddMessage("Ce champ est requis", MessageTypes.Error) 'IM.Required
                                    Else
                                        AddMessage("This field is Required", MessageTypes.Error) 'IM.Required
                                    End If
                                End If

                            ElseIf m_blnPromptOK AndAlso sender.SubmittedValue = "" AndAlso sender.Required = BooleanTypes.True Then

                                If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                    AddMessage("Ce champ est requis", MessageTypes.Error) 'IM.Required
                                Else
                                    AddMessage("This field is Required", MessageTypes.Error) 'IM.Required
                                End If

                            End If

                            ' Set the DEFAULT for this field if no value was entered.
                            If ValidateType = ValidateTypes.Accept And (Not m_blnPromptOK) Then
                                ' If we are in ENTRY mode, check if there is a default.
                                If Me.Mode = PageModeTypes.Find OrElse Me.Mode = PageModeTypes.Change OrElse Me.Mode = PageModeTypes.Entry OrElse Me.AppendMode _
                                OrElse blnUseDefaultValue OrElse (Me.Mode = PageModeTypes.Correct AndAlso FieldText = "") Then
                                    ' If a DEFAULT was set for this field,
                                    ' then assign it to FieldDate.
                                    If Not strDefaultValue Is Nothing Then
                                        FieldText = strDefaultValue
                                        If Not blnUseDefaultValue Then
                                            sender.ValueChanged = True
                                        End If
                                    End If
                                End If
                            End If
                        End If

                        ' If the DUPLICATE flag was set or the DEFAULT option was specified,
                        ' then continue PREPARE FOR EDITING, and optionally execute the EDIT
                        ' and PROCESS procedure.  Also store the value in the record buffer
                        ' or underlying item(variable).
                        If sender.Duplicate = BooleanTypes.True Or Not FieldText Is Nothing Then

                            If ValidateType <> ValidateTypes.Request AndAlso sender.Duplicate = BooleanTypes.True Then
                                If ValidateType <> ValidateTypes.Request Then
                                    'm_hstFieldDuplicate = ScreenSession("Duplicate")
                                    If IsNothing(m_hstFieldDuplicate) Then m_hstFieldDuplicate = New Hashtable
                                    m_hstFieldDuplicate.Item(sender.Name) = FieldText
                                    'ScreenSession("Duplicate") = m_hstFieldDuplicate
                                End If
                            End If

                            ' Assign DATE and NUMERIC fields to FIELDVALUE. Convert the 
                            ' date to an eight digit number in the format YYYYMMDD.

                            If Not FieldText Is Nothing Then
                                Dim blnReturnValue As Boolean
                                ' If the field has a date format other than YYYYMMDD and is using the default value (because the user didn't enter a value),
                                ' the default value will be in the format YYYYMMDD, so we must use this when calling ConvertScreenDateToNumber in order to ensure FieldValue is set.
                                ' NOTE: DO NOT change this "YYYYMMDD".  This was added because QKCD9353 (FW) had the following default: FIELD GST-CHANGE-DATE OF SERVICE-TYPE DEF 19890701

                                'If ValidateType = ValidateTypes.Accept AndAlso (((Not m_blnPromptOK) AndAlso (Me.Mode = PageModeTypes.Entry OrElse Me.AppendMode = True) _
                                'AndAlso blnHasDefault) OrElse blnInputChangedValue) AndAlso strDateFormat.ToUpper <> "YYYYMMDD" Then
                                If ValidateType = ValidateTypes.Accept And (Not m_blnPromptOK) AndAlso (Me.Mode = PageModeTypes.Entry OrElse Me.AppendMode = True) _
                                 AndAlso blnHasDefault And strDateFormat.ToUpper <> "YYYYMMDD" Then
                                    blnReturnValue = ConvertScreenDateToNumber(FieldText, FieldValue, GlobalizationManager, "YYYYMMDD")
                                Else
                                    blnReturnValue = ConvertScreenDateToNumber(FieldText, FieldValue, GlobalizationManager, strDateFormat)
                                End If
                                ' If we have a character, we want to ensure that we can format this data.  PowerHouse treats this
                                ' as a date (so it should store as YYYYMMDD).
                                If sender.UnderLyingDataType = ItemDataTypes.Character Then
                                    FieldText = New Date(FieldValue.ToString.Substring(0, 4), FieldValue.ToString.Substring(4, 2), FieldValue.ToString.Substring(6, 2))
                                End If

                                If blnReturnValue Then
                                    If ValidateType = ValidateTypes.Request Then
                                        'While in select processing we need date value in YYYYMMDD
                                        sender.RequestValue = FieldValue.ToString
                                    End If
                                Else
                                    m_blnValidateError = True

                                    If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                        AddMessage("Cette entre doit tre une date.", MessageTypes.Error) 'IM.Date
                                    Else
                                        AddMessage("This entry must be a date.", MessageTypes.Error) 'IM.Date
                                    End If
                                End If
                            End If
                        End If
                    End If
                End If

                ' Retrieve the value from the associated buffer and move it into
                ' FieldDate and where appropriate into FIELDVALUE.
                If ValidateType = ValidateTypes.Edit Then

                    ' Retrieve the value from the record buffer or 
                    ' underlying variable and assign it to FieldDate.
                    sender.RaiseGetRecordBuffer(FieldText, FieldValue, underlyingDataType)
                End If

                ' Perform specified editing for ACCEPT verb processing (based on 
                ' blnRequiredDuplicateOrDefaultSet being set to TRUE) or EDIT verb processing.
                If (ValidateType = ValidateTypes.Accept AndAlso (blnRequiredDuplicateOrDefaultSet Or m_blnPromptOK)) Or ValidateType = ValidateTypes.Edit Then
                    Dim blnSuccess As Boolean

                    ' For Unsigned Integers/Numbers, if a negative value is entered, 
                    ' display the Negative error message.
                    If (sender.UnderLyingDataType = ItemDataTypes.Integer OrElse sender.UnderLyingDataType = ItemDataTypes.UnsignedNumeric) AndAlso FieldValue < 0 Then
                        m_blnValidateError = True

                        If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                            AddMessage("Cette entre ne doit pas tre ngative.", MessageTypes.Error) 'IM.Negative
                        Else
                            AddMessage("This entry must not be negative.", MessageTypes.Error) 'IM.Negative
                        End If
                    End If

                    ' Check the VALUES options passing FieldDate for character
                    ' fields or FIELDVALUE for numeric and date fields.
                    If sender.Values Is Nothing Then
                        blnSuccess = True
                    Else
                        blnSuccess = sender.Values.IsValueInRange(FieldValue)
                    End If
                    If Not blnSuccess Then
                        m_blnValidateError = True

                        If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                            AddMessage("Cette entre n'est pas dans la plage de valeurs acceptable", MessageTypes.Error) 'IM.Range
                        Else
                            AddMessage("This entry isn't within the acceptable range of values", MessageTypes.Error) 'IM.Range
                        End If
                    End If

                    Dim strTextValue As String

                    ' Check for pattern matching.
                    ' Numeric and date fields are converted to character strings.
                    strTextValue = FieldValue.ToString()
                    Dim strPattern As String
                    Try
                        strPattern = GetPattern(sender.FieldName)
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                    If strPattern Is Nothing Then strPattern = String.Empty
                    If sender.Pattern.Length > 0 OrElse strPattern.Length > 0 Then
                        If strPattern.Length = 0 Then strPattern = sender.Pattern
                        blnSuccess = MatchPattern(strTextValue, strPattern)
                    End If

                    ' If the MatchPattern was false, 
                    ' return an error to the user.
                    If Not blnSuccess Then
                        m_blnValidateError = True
                        If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                            AddMessage("Cette entre n'est pas dans la plage de valeurs acceptable", MessageTypes.Error) 'IM.Range
                        Else
                            AddMessage("This entry isn't within the acceptable range of values", MessageTypes.Error) 'IM.Range
                        End If
                    End If
                    m_intLookUpSequence += 1
                    ' Check the lookups to ensure a correct value was entered.
                    If Not (blnHasDefault AndAlso FieldText = strDefaultValue AndAlso sender.Required <> BooleanTypes.True AndAlso sender.Duplicate <> BooleanTypes.True) Then
                        sender.RaiseLookupOn()
                    End If
                    If sender.Text <> sender.OldSubmittedValue OrElse Not MethodWasExecuted(m_strLookUpFlag, m_intLookUpSequence) Then

                        ' If we find a specific record and then edit the record, if the field is silent,
                        ' then it doesn't check the LookupNotOn.  If a sequential search is done,
                        ' then the LookupNotOn is executed.
                        If Not (Me.ChangeMode AndAlso Not Me.IsInAppendOrEntry AndAlso sender.Silent AndAlso SearchWasFiltered(sender.FieldName)) Then
                            If sender.FieldName.IndexOf(".") > 0 Then m_strLookupNotOnFile = sender.FieldName.Substring(0, sender.FieldName.IndexOf("."))
                            m_blnExecutingLookupNotOn = True
                            m_blnLookupOnSameFile = False
                            sender.RaiseLookupNotOn(blnLookupNotOnExecuted)
                            m_blnExecutingLookupNotOn = False
                            m_strLookupNotOnFileName = String.Empty
                        End If
                        ' Save the sequence information and set a flag indicating LOOKUP was run.
                        SetMethodExecutedFlag(m_strLookUpFlag, "LOOKUP_FLAG", m_intLookUpSequence)
                    End If

                    ' If blnLookupNotOnExecuted is TRUE, then there is a 
                    ' coded LookupNotOn procedure.
                    If blnLookupNotOnExecuted Then

                    End If
                End If

                ' Call the EDIT and PROCESS procedures as part of the ACCEPT or EDIT verb processing.
                If ((ValidateType = ValidateTypes.Accept And (m_blnPromptOK Or (blnRequiredDuplicateOrDefaultSet And blnRaiseEdit))) _
                And sender.ValueChanged) Or ValidateType = ValidateTypes.Edit Then

                    ' For Date fields, assign FIELDVALUE to a temporary 
                    ' variable to determine if the EDIT procedure changes
                    ' this value.  If the value is not changed, then assign
                    ' the DATE value to the record buffer.  This is due to the 
                    ' fact the time portion is lost when assigning FIELDVALUE
                    ' to the record buffer.
                    intPreEditFieldValue = FieldValue

                    ' Assign the RecordBuffer value to m_OldValue.  This value 
                    ' will be used when the OLDVALUE function is called.  We then set
                    ' FieldDate/FIELDVALUE to the recordbuffer.  We have taken this 
                    ' approach since PowerHouse changed any reference of the named item
                    ' on which the EDIT procedure is based and replaces it with either
                    ' FieldDate or FIELDVALUE.
                    Dim strTempFieldDate As String = FieldText
                    Dim strTempFieldValue As Decimal = FieldValue

                    ' Retrieve the value from the record buffer or 
                    ' underlying variable and assign it to FieldDate/FIELDVALUE.
                    ' This will become the value that will be used for OldValue.
                    sender.RaiseGetRecordBuffer(FieldText, FieldValue, underlyingDataType)

                    ' Ensure that for Numeric fields with an underlying datatype 
                    ' of Character, that we update FieldValue.
                    If sender.DataType = DataTypes.Numeric AndAlso underlyingDataType = DataTypes.Character Then
                        If IsNumeric(FieldText) Then
                            FieldValue = FieldText
                        Else
                            FieldValue = 0
                        End If
                    End If

                    ' Assign the OldValue information.
                    m_OldValue.Field = sender.FieldName
                    m_OldValue.FieldDate = FieldText
                    m_OldValue.FieldValue = FieldValue

                    strOldFieldDate = FieldText
                    decOldFieldValue = FieldValue

                    ' Assign the temporary values back to FieldDate/FIELDVALUE.
                    FieldText = strTempFieldDate
                    FieldValue = strTempFieldValue

                    If sender.DataType = DataTypes.Numeric OrElse underlyingDataType = ItemDataTypes.Numeric Then

                        If sender.Significance > 0 Then
                            FieldText = FieldValue.ToString.PadLeft(sender.Significance, "0")
                        End If

                    End If

                    ' Store the value of FieldDate or FIELDVALUE to the
                    ' record buffer or underlying variable.
                    sender.RaiseSetRecordBuffer(FieldText, FieldValue, underlyingDataType)

                    If Not sender.IsDefine Then sender.RaiseSetEditFlag(False)
                    '----------------------------
                    ' Call the EDIT procedure.
                    '----------------------------
                    blnEditFailed = True
                    If sender.OldSubmittedValue <> FieldText Then
                        blnFieldDiff = True
                    End If
                    sender.RaiseEdit()
                    blnFieldDiff = False
                    blnEditFailed = False

                    If Not sender.IsDefine Then sender.RaiseSetEditFlag(True)
                End If

                ' Store the value in the record buffer.
                If ((ValidateType = ValidateTypes.Accept And (m_blnPromptOK Or blnRequiredDuplicateOrDefaultSet)) _
                OrElse (m_blnPromptOK AndAlso ValidateType = ValidateTypes.Request)) Then

                    ' Store the value of FieldDate or FIELDVALUE to the
                    ' record buffer or underlying variable.
                    If Not FieldText Is Nothing Then sender.RaiseSetRecordBuffer(FieldText, FieldValue, underlyingDataType, ValidateType = ValidateTypes.Request)

                End If

                '----------------------------
                ' Call the PROCESS procedure.
                '----------------------------
                If ((ValidateType = ValidateTypes.Accept And (m_blnPromptOK Or blnRequiredDuplicateOrDefaultSet)) _
                And sender.ValueChanged) Or ValidateType = ValidateTypes.Edit Then
                    sender.RaiseProcess()
                End If

                ' If fixed, don't change the value unless a specific display verb is called.
                'If sender.Fixed AndAlso m_blnIsInDisplayPreDisplayFormatting Then
                '    EndValidate()
                '    Exit Function
                'End If

                ' For non-EDIT verb processing, retrieve the value for display, 
                ' perform the OUTPUT procedure and execute DISPLAY formatting.
                If ValidateType <> ValidateTypes.Edit Then
                    Dim strUnderlyingValue As String

                    ' Retrieve the value from the record buffer or 
                    ' underlying variable and assign it to FieldDate.
                    sender.RaiseGetRecordBuffer(FieldText, FieldValue, underlyingDataType)



                    ' Scale the numeric items and right justify the value.
                    If sender.DataType = DataTypes.Numeric Then
                        strUnderlyingValue = FieldValue.ToString

                        If ValidateType <> ValidateTypes.Request AndAlso NULL(FieldText) = cEmptyString Then
                            FieldText = Nothing
                        End If
                    Else
                        strUnderlyingValue = FieldText
                    End If

                    '----------------------------
                    ' Call the OUTPUT procedure.
                    '----------------------------
                    sender.RaiseOutput()

                    ' Format the values prior to displaying based on data type.
                    ' If the field is DATE, FieldDate is converted to a display string
                    ' using the date format, separator, and null separator options.
                    'If IsNumeric(FieldDate) Then
                    '    FieldDate = ConvertNumberToScreenDate(CDec(FieldDate), GlobalizationManager, strDateFormat, strDateSeparator)
                    'End If

                    If Not sender.PreDisplay = BooleanTypes.True AndAlso sender.FieldName.IndexOf(".") > -1 AndAlso sender.FieldName.Substring(0, sender.FieldName.IndexOf(".")) = DisplayFileForDelete Then
                        FieldText = ""
                    End If

                    ' Store this in case a RunScreen is called since we don't update the screen
                    ' values in this case.  This ensures that when posting back, that when checking
                    ' the present value (coming from OldText) and comparing against the PostedValue,
                    ' that we don't have a different value and therefore updating the SubmittedValue.
                    m_oldTextField = sender
                    m_oldTextValue = sender.OldText.ToString

                    If IsNothing(FieldText) Then
                        sender.Text = ""
                    Else
                        sender.Text = FieldText
                    End If

                    If IsNothing(FieldText) Then
                        sender.OldText = ""
                    Else
                        sender.OldText = FieldText
                    End If




                    Select Case ValidateType
                        Case ValidateTypes.Accept, ValidateTypes.Request
                            sender.OldSubmittedValue = sender.Text
                    End Select

                End If

                If IsValidateWithIn() Then
                    FieldText = strPreviousFieldDate
                    FieldValue = dblPreviousFieldValue
                End If

                EndValidate()

                ' Stores whether the DISPLAY verb was executed during the current postback
                ' on this field.  This will change the Text property, therefore if we have
                ' an Accept/RequestPrompt verb on this field, this text property is invalid
                ' (meaning we should use SubmittedValue instead).
                If ValidateType = ValidateTypes.Display Then
                    sender.DisplayExecuted = True
                End If

                If blnResetFromInputAndNull Then
                    sender.ValueChanged = False
                End If

                If HasError Then HasError = False

                Return sender.ValueChanged

            Catch ex As CustomApplicationException

                ' Remove the flag if not completed.
                EndValidate()

                If Not m_blnInDetailFind OrElse ex.Message = cRunScreenException.ToString Then

                    ' Ensure we re-run setting the value in case a SUM INTO needs to be reset.
                    If blnEditFailed AndAlso ex.Message <> cAcceptRequestPromptException.ToString Then
                        sender.RaiseSetRecordBuffer(strOldFieldDate, decOldFieldValue, underlyingDataType)
                        blnEditFailed = False
                    End If

                    ' IF condition modified from version 483.  See SourceSafe history.
                    If ex.Message <> cRunScreenException.ToString Then

                        'In case of Request in Find/Select, if Custom Error is thrown, we reset the Request values to empty or False
                        If ValidateType = ValidateTypes.Request Then
                            sender.RequestValue = String.Empty
                            If Me.UseAcceptProcessing Then
                                sender.RequestWasPerformed = False
                                sender.RequestPromptOk = False
                            End If
                        End If

                        ' Indicate the control to move the focus to.
                        SetFocusField(sender.Name)
                        sender.Focus()
                        'RegisterHiddenField("RequestedControlFocusOverRide", sender.RenderedID)

                        If ex.Message <> cAcceptRequestPromptException.ToString Then
                            If Me.UseAcceptProcessing Then
                                ' Reset the text field with the original value.
                                sender.Text = sender.OldText
                            Else
                                sender.Text = Nothing
                                sender.OldText = ""
                            End If

                            ' Set the SubmittedValue back to the OldSubmittedValue.
                            sender.Text = sender.OldSubmittedValue

                            ' If there is no OldSubmittedValue, then reset the 
                            ' ValueChanged to FALSE.
                            If sender.OldSubmittedValue Is Nothing Then
                                sender.ValueChanged = False
                            End If

                            ' Keep track of the ACCEPT field in case an error occurs.
                            'If (Session(FormName + "_" + Level.ToString + "_" + "VALIDATE") & "").ToString.Length = 0 AndAlso Not sender.Silent Then m_fldAcceptField = sender
                            'RemoveAccept()
                        End If
                    End If
                    m_strNavigationControl = sender.Name


                    Throw ex

                End If



            Catch ex As Exception

                ' Write the exception to the event log and throw an error.
                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function

        ''' --- Validate -----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Will validate the data entered on the screen by user.
        ''' </summary>
        ''' <param name="sender">A ComboBox which contains the data to be validated.</param>
        ''' <param name="ValidateType">A ValidateType.</param>
        ''' <param name="InFieldValidate"></param>
        ''' <remarks>Validates the data entered as well as performing dictionary functions,
        ''' lookups and assignments to FIELDTEXT and FIELDVALUE. In addition, Validate also
        ''' calls the INPUT, EDIT, PROCESS and OUTPUT procedures used by PowerHouse.
        ''' </remarks>
        ''' <example>Validate(cboComboBox1, ValidateType.Accept)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Overloads Function Validate(ByRef sender As ComboBox, Optional ByVal ValidateType As ValidateTypes = ValidateTypes.Accept, Optional ByVal InFieldValidate As Boolean = False) As Boolean

            Dim underlyingDataType As DataTypes
            Dim strPreviousValue As String = ""
            Dim strPreviousFieldText As String = FieldText
            Dim dblPreviousFieldValue As Decimal = FieldValue
            Dim strOldFieldText As String = String.Empty   ' Ensures that if the EDIT fails, that we reset the values in order
            Dim decOldFieldValue As Decimal = 0            ' to reset any SUM INTO values, etc.
            Dim blnEditFailed As Boolean = False
            Dim blnNullResponseAccept As Boolean
            Dim blnUseDefaultValue As Boolean           ' Used for TEMPORARIES only.
            Dim blnIsNewMasterOnSlaveScreen As Boolean = Me.Slave AndAlso sender.FieldName.IndexOf(".") > 0 AndAlso sender.RaiseGetNewRecordStatus AndAlso sender.RaiseGetFileType = FileTypes.Master
            Dim blnResetFromInputAndNull As Boolean = False

            Try
                StartValidate()
                'Clear the Fieldtext from the previous field
                FieldText = ""
                FieldValue = 0

                If sender.UnderLyingDataType = ItemDataTypes.Integer OrElse sender.UnderLyingDataType = ItemDataTypes.SignedInteger OrElse sender.UnderLyingDataType = ItemDataTypes.UnsignedNumeric Then
                    underlyingDataType = DataTypes.Numeric
                Else
                    underlyingDataType = sender.UnderLyingDataType
                End If

                ' If this field does not have the REFRESH option then exit (when called after running a run screen).
                If ValidateType = ValidateTypes.Display AndAlso m_blnIsInDisplayPreDisplayFormatting AndAlso ((m_blnReturnedFromRunScreen AndAlso Not sender.Refresh) OrElse (blnIsNewMasterOnSlaveScreen)) Then
                    EndValidate()
                    Exit Function
                End If

                If Not m_blnRequireValidateRequest AndAlso ValidateType = ValidateTypes.Request Then
                    'Doesn't Require Validate on Request Fields from SelectProcessing, 
                    'rather it use values from Request Buffer (from File Object)
                    m_blnPromptOK = True
                    EndValidate()
                    Exit Function
                End If

                ' In ACCEPT processing, if the value was not modified and it is not blank, then exit the function.
                If ValidateType = ValidateTypes.Accept AndAlso (Not sender.ValueChanged) AndAlso sender.Text <> "" AndAlso IsCurrentField(sender) AndAlso Not (blnIsNewMasterOnSlaveScreen) Then
                    blnUseDefaultValue = UseDefaultValueForTemporary(sender)
                    If blnUseDefaultValue Then
                        ' Temporaries that have a default (whose value was not changed) receive the default value.
                    Else
                        blnNullResponseAccept = True
                    End If
                End If

                Dim blnRequiredDuplicateOrDefaultSet As Boolean = False
                Dim blnRaiseEdit As Boolean
                Dim strDefaultValue As String
                Dim blnHasDefault As Boolean = False
                Dim blnLookupNotOnExecuted As Boolean = False
                Dim strTableFieldName As String = sender.FieldName
                Dim strTableName As String = sender.TableName
                Dim strFieldName As String = strTableFieldName.Replace(strTableName + ".", "")
                Dim blnUseScaling As Boolean = sender.UseScaling
                Dim intInputScale As Integer = sender.GetInputScale

                If Not blnNullResponseAccept Then
                    ' Set FIELDTEXT to the value of the control.
                    Dim blnUseTextProperty As Boolean = False
                    If ValidateType <> ValidateTypes.Display Then

                        If Me.UseAcceptProcessing Then
                            blnUseTextProperty = sender.ValueChangedByUser AndAlso Not sender.DisplayExecuted
                            If Not FnKeyExecuted() Then m_intRunScreenSequence = 0
                        Else
                            blnUseTextProperty = InFieldValidate
                        End If
                        If blnUseTextProperty Then
                            FieldText = sender.Text

                            If sender.MultiAccept AndAlso ValidateType = ValidateTypes.Accept Then
                                MultiAccept(sender.Name, FieldText)
                            End If

                            If Me.UseAcceptProcessing Then
                                ' If we had a value before, and we are deleting it (equivalent to entering 0 in PowerHouse),
                                ' then we need to set SubmittedValue to 0 so we don't get a "Required field" error during Entry.
                                If FieldText.Length = 0 AndAlso sender.OldSubmittedValue.Length > 0 Then
                                    sender.SubmittedValue = cEmptyString
                                End If

                                'If Not IsNothing(Request("hidControl")) AndAlso Request("hidControl").ToString.IndexOf("||") >= 0 Then
                                '    Dim strControl As String = Request("hidControl").ToString.Substring(0, Request("hidControl").ToString.IndexOf("||"))
                                '    Dim strValue As String = Request("hidControl").ToString.Substring(Request("hidControl").ToString.IndexOf("||") + 2)
                                '    If strControl = sender.RenderedID AndAlso _
                                '    strValue <> sender.Text Then
                                '        If Not FnKeyExecuted() Then RemoveRunScreens(sender.Name, 0)
                                '    End If
                                'End If
                            End If
                        Else
                            If sender.MultiAccept AndAlso ValidateType = ValidateTypes.Accept Then

                                If MethodWasExecuted(m_strAcceptFlag, m_intAcceptSequence + 1) Then
                                    FieldText = GetMultiAccept(sender.Name)
                                Else
                                    FieldText = sender.Text
                                    MultiAccept(sender.Name, FieldText)
                                End If

                            Else
                                FieldText = sender.Text
                            End If
                            If FieldText Is Nothing Then FieldText = ""
                        End If

                        ' If the value of the field is "" and the initial value (OldText)
                        ' was not blank, then create a space to duplicate PowerHouse behaviour.
                        If (ValidateType = ValidateTypes.Accept OrElse ValidateType = ValidateTypes.Request) AndAlso IsCurrentField(sender) AndAlso Not (blnIsNewMasterOnSlaveScreen) Then
                            If blnUseTextProperty Then
                                If IsNothing(sender.OldText) Then
                                    sender.OldText = ""
                                End If
                                If sender.Text.Length = 0 And sender.OldText.Length > 0 Then FieldText = cEmptyString
                            Else
                                If IsNothing(sender.AcceptProcessingOldText) Then
                                    sender.AcceptProcessingOldText = ""
                                End If
                                ' Only set to a space if the value was changed.  If not, then we have may have an old value.
                                If FieldText.Length = 0 And sender.AcceptProcessingOldText.Length > 0 AndAlso sender.ValueChanged Then FieldText = cEmptyString
                            End If
                        End If

                        ' Call SetShiftUpDown for character fields.
                        If sender.DataType = DataTypes.Character Then
                            FieldText = SetShiftUpDown(FieldText, sender.ShiftType)
                        End If
                    End If
                End If ' If Not blnNullResponseAccept Then

                ' Call the INPUT procedure when processing the ACCEPT or REQUEST verbs.  
                ' These(verbs) then execute code to prepare for editing.
                If ValidateType = ValidateTypes.Accept Or ValidateType = ValidateTypes.Request Then

                    ' Store the previous value from the field and
                    ' re-display this value if the user closed the form
                    ' without selecting a value.
                    'If sender.UseLookupCharacter Then
                    '    strPreviousValue = sender.OldText
                    'End If

                    If sender.OldSubmittedValue <> FieldText Then
                        blnFieldDiff = True
                    End If
                    '----------------------------
                    ' Call the INPUT procedure.
                    '----------------------------
                    Dim blnInputChangedValue As Boolean
                    Dim strFieldText As String = FieldText
                    If m_blnChangeMode = True Then m_blnFindMode = False
                    sender.RaiseInput()
                    blnFieldDiff = False
                    If m_blnChangeMode = True Then m_blnFindMode = True
                    If Not strFieldText.Equals(FieldText) Then
                        sender.ValueChanged = True
                        blnInputChangedValue = True
                        If blnNullResponseAccept Then
                            blnResetFromInputAndNull = True
                        End If
                        blnUseDefaultValue = False
                    End If

                    ' Determine if the current value is the same as the record buffer.  If so,
                    ' set the ValueChanged back to FALSE (only if the INPUT procedure didn't change the value).
                    sender.RaiseGetRecordBuffer(strFieldText, 0, underlyingDataType)
                    'If FieldText.Equals(strFieldText) AndAlso blnInputChangedValue AndAlso sender.Text = sender.LookupCharacter _
                    'AndAlso sender.LookupCharacter <> "" Then sender.ValueChanged = False

                    ' If the FIELDTEXT predefined item has a size of zero, the
                    ' PROMPTOK predefined condition is set to FALSE for the field,
                    ' otherwise it is set to TRUE.
                    If Not sender.ValueChanged AndAlso (FieldText.Length = 0 OrElse blnUseDefaultValue) Then
                        m_blnPromptOK = False
                    Else
                        m_blnPromptOK = True
                    End If

                    If (Mode = PageModeTypes.Find OrElse Mode = PageModeTypes.Select) AndAlso ValidateType = ValidateTypes.Request Then
                        sender.RequestValue = FieldText
                        If Me.UseAcceptProcessing Then
                            sender.RequestWasPerformed = True
                            sender.RequestPromptOk = m_blnPromptOK
                        End If
                    End If

                    ' Set the previous value from the field to the 
                    ' control if a lookup screen was called and no
                    ' value was selected by the user.
                    If strPreviousValue.Length > 0 AndAlso (Not m_strLookupValue Is Nothing AndAlso m_strLookupValue.TrimEnd.Equals("")) Then
                        FieldText = strPreviousValue
                        sender.Text = strPreviousValue

                    End If

                    'If Not Me.UseAcceptProcessing Then
                    '    If m_blnInFieldValidation And sender.UseLookupCharacter Then
                    '        If m_strLookupValue <> Nothing AndAlso Not m_strLookupValue.TrimEnd.Equals("") Then
                    '            sender.Text = m_strLookupValue
                    '            If Mode = PageModeTypes.Find Then
                    '                sender.RequestValue = m_strLookupValue
                    '            End If
                    '        End If
                    '    End If
                    'End If

                    ' Determine if this field has a default.
                    strDefaultValue = SetFieldDefaults(Replace(sender.FieldName, ".", "_"))
                    If strDefaultValue.TrimEnd.Length > 0 Then blnHasDefault = True

                    ' If PromptOk is false because the user didn't enter anything, but a value was assigned to this field
                    ' through code, then assume that the Required flag is false since there is a value set for this field. (QKCD9161)
                    Dim blnRequired As BooleanTypes = sender.Required
                    If Not m_blnPromptOK AndAlso sender.DisplayExecuted Then
                        ' Check the value from the record buffer or 
                        ' underlying variable and assign it to FIELDTEXT.
                        sender.RaiseGetRecordBuffer(strFieldText, 0, underlyingDataType)
                        If sender.UnderLyingDataType = DataTypes.Numeric Then
                            If Not (strFieldText.TrimEnd = "0" And Not blnHasDefault) Then
                                blnRequired = BooleanTypes.False
                            End If
                        Else
                            If strFieldText.TrimEnd.Length > 0 Then
                                blnRequired = BooleanTypes.False
                            End If
                        End If
                    End If

                    ' If we have a slave screen, check the values to ensure that required fields don't throw
                    ' an error if there is a value already in the field.  This is due to the fact that we 
                    ' are not using the text value.  This will fail however if the value that was entered is also
                    ' a default value (ie. " ", 0)
                    If Not m_blnPromptOK AndAlso blnIsNewMasterOnSlaveScreen Then
                        sender.RaiseGetRecordBuffer(strFieldText, 0, underlyingDataType)
                        Select Case sender.UnderLyingDataType
                            Case DataTypes.Character
                                If strFieldText.TrimEnd.Length > 0 Then
                                    blnRequired = BooleanTypes.False
                                End If
                            Case DataTypes.Numeric, DataTypes.Date
                                If IsNumeric(strFieldText) AndAlso VAL(strFieldText) <> 0 Then
                                    blnRequired = BooleanTypes.False
                                End If
                        End Select
                    End If

                    ' PromptOk is false because the user didn't enter anything, but the record status for the current 
                    ' file object is not New, then set required to false since we don't need to throw the Required field exception.
                    If Not m_blnPromptOK AndAlso blnRequired AndAlso sender.FieldName.IndexOf(".") > 0 AndAlso Not sender.RaiseGetNewRecordStatus AndAlso Not sender.RaiseGetFileType = FileTypes.Reference Then
                        blnRequired = BooleanTypes.False
                    End If

                    ' If we are updating an existing record, and fieldtext is blank, then we really should not
                    ' continue the check for Required, Lookups and Defaults.
                    If ValidateType = ValidateTypes.Accept AndAlso Not m_blnPromptOK AndAlso sender.FieldName.IndexOf(".") > 0 AndAlso blnRequired = BooleanTypes.True AndAlso Not sender.RaiseGetNewRecordStatus AndAlso Mode <> PageModeTypes.Entry AndAlso Not IsAppend Then
                        blnRequired = BooleanTypes.False
                        blnHasDefault = False
                    End If

                    ' If the PROMPTOK condition is FALSE and none of the REQUIRED, DUPLICATE or DEFAULT
                    ' options are specified, then skip the edit processing.  Since blnRequiredDuplicateOrDefaultSet
                    ' is defaulted to FALSE, set it to TRUE if this condition is not met.
                    If IsNothing(sender.AcceptProcessingOldText) Then sender.AcceptProcessingOldText = ""
                    If (Not m_blnPromptOK AndAlso sender.AcceptProcessingOldText.Length = 0 AndAlso (blnRequired = BooleanTypes.True Or sender.Duplicate = BooleanTypes.True _
                    Or blnHasDefault = BooleanTypes.True)) Or m_blnPromptOK Then
                        blnRequiredDuplicateOrDefaultSet = True
                        If ValidateType <> ValidateTypes.Request Then
                            If sender.Duplicate = BooleanTypes.True AndAlso FieldText = "" Then
                                'm_hstFieldDuplicate = ScreenSession("Duplicate")
                                If IsNothing(m_hstFieldDuplicate) Then m_hstFieldDuplicate = New Hashtable
                                If m_hstFieldDuplicate.Contains(sender.Name) Then
                                    FieldText = m_hstFieldDuplicate.Item(sender.Name)
                                    If FieldText <> "" Then
                                        blnRaiseEdit = True
                                        m_blnPromptOK = True
                                        sender.ValueChanged = True
                                    End If
                                End If
                            End If

                            ' If this is a required field and PROMPTOK is FALSE, then
                            ' throw an error indicating this is a required field.
                            If sender.Required = BooleanTypes.True AndAlso Not m_blnPromptOK AndAlso Mode <> PageModeTypes.Select _
                            AndAlso (sender.FieldName.IndexOf(".") = -1 OrElse (sender.FieldName.IndexOf(".") > 0 _
                            AndAlso (sender.RaiseGetNewRecordStatus AndAlso Not sender.RaiseGetFileType = FileTypes.Reference) _
                            OrElse (Not sender.RaiseGetNewRecordStatus AndAlso sender.RaiseGetFileType = FileTypes.Reference))) Then

                                If Not m_blnPromptOK AndAlso strFieldText.Trim = "" Then
                                    If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                        AddMessage("Ce champ est requis", MessageTypes.Error) 'IM.Required
                                    Else
                                        AddMessage("This field is Required", MessageTypes.Error) 'IM.Required
                                    End If
                                End If
                                If strFieldText.Trim = "" AndAlso FieldText = "" Then
                                    If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                        AddMessage("Ce champ est requis", MessageTypes.Error) 'IM.Required
                                    Else
                                        AddMessage("This field is Required", MessageTypes.Error) 'IM.Required
                                    End If
                                End If

                            ElseIf m_blnPromptOK AndAlso sender.SubmittedValue = "" AndAlso sender.Required = BooleanTypes.True Then

                                If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                    AddMessage("Ce champ est requis", MessageTypes.Error) 'IM.Required
                                Else
                                    AddMessage("This field is Required", MessageTypes.Error) 'IM.Required
                                End If

                            End If





                            ' Set the DEFAULT for this field if no value was entered.
                            If ValidateType = ValidateTypes.Accept And (Not m_blnPromptOK) Then
                                ' If we are in ENTRY mode, check if there is a default.
                                If Me.Mode = PageModeTypes.Find OrElse Me.Mode = PageModeTypes.Change OrElse Me.Mode = PageModeTypes.Entry OrElse Me.AppendMode _
                                OrElse blnUseDefaultValue OrElse (Me.Mode = PageModeTypes.Correct AndAlso FieldText = "") Then
                                    ' If a DEFAULT was set for this field,
                                    ' then assign it to FIELDTEXT.
                                    If strDefaultValue.TrimEnd.Length > 0 Then
                                        FieldText = strDefaultValue
                                        If Not blnUseDefaultValue Then
                                            sender.ValueChanged = True
                                        End If
                                    End If
                                End If
                            End If
                        End If

                        ' If the DUPLICATE flag was set or the DEFAULT option was specified,
                        ' then continue PREPARE FOR EDITING, and optionally execute the EDIT
                        ' and PROCESS procedure.  Also store the value in the record buffer
                        ' or underlying item(variable).
                        If sender.Duplicate = BooleanTypes.True Or FieldText.Length <> 0 Then
                            If ValidateType <> ValidateTypes.Request AndAlso sender.Duplicate = BooleanTypes.True Then
                                If ValidateType <> ValidateTypes.Request Then
                                    'm_hstFieldDuplicate = ScreenSession("Duplicate")
                                    If IsNothing(m_hstFieldDuplicate) Then m_hstFieldDuplicate = New Hashtable
                                    m_hstFieldDuplicate.Item(sender.Name) = FieldText
                                    'ScreenSession("Duplicate") = m_hstFieldDuplicate
                                End If
                            End If

                            ' If the field type is NUMERIC, the field is checked for numbers.
                            ' The result is scaled by the input scale.
                            If sender.DataType = DataTypes.Numeric Then

                                If IsNumeric(FieldText) Then
                                    ' Check if Decimal is not specified then,
                                    ' we want to ensure that user has not entered
                                    ' a value with decimal
                                    'If sender.Decimal >= 0 Then
                                    '    If FieldText.LastIndexOf(".") >= 0 Then
                                    '        If FieldText.Substring(FieldText.LastIndexOf(".") + 1).Length > sender.Decimal Then
                                    '            m_blnValidateError = True
                                    '           AddMessage("There are too many decimal places.", MessageTypes.Error)'IM.Decimal
                                    '        End If
                                    '    End If
                                    'End If
                                    ' Add the INPUT SCALE.
                                    If blnUseScaling AndAlso intInputScale <> 0 AndAlso sender.Text <> "" AndAlso strDefaultValue <> FieldText Then
                                        FieldText *= 10 ^ intInputScale
                                    End If
                                ElseIf Not FieldText = " " Then
                                    m_blnValidateError = True

                                    If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                                        AddMessage("Cette entre doit tre numrique.", MessageTypes.Error) 'IM.Numeric
                                    Else
                                        AddMessage("This entry must be numeric.", MessageTypes.Error) 'IM.Numeric
                                    End If
                                End If

                            End If

                            If sender.DataType = DataTypes.Numeric OrElse underlyingDataType = ItemDataTypes.Numeric Then
                                If IsNumeric(FieldText) Then
                                    FieldValue = CDec(FieldText)
                                Else
                                    FieldValue = 0
                                End If


                                If sender.Significance > 0 Then
                                    FieldText = FieldValue.ToString.PadLeft(sender.Significance, "0")
                                End If

                            End If

                            If sender.DataType = DataTypes.Numeric AndAlso sender.UnderLyingDataType = ItemDataTypes.Character Then
                                If sender.Fill.Length > 0 Then
                                    If FieldValue >= 0 Then
                                        FieldText = FieldValue.ToString.PadLeft(0, sender.Fill)
                                    Else
                                        FieldText = "-" & Abs(FieldValue).ToString.PadLeft(0, sender.Fill)
                                    End If
                                Else
                                    If FieldValue >= 0 Then
                                        FieldText = FieldValue.ToString.PadLeft(0, "0")
                                    Else
                                        FieldText = "-" & Abs(FieldValue).ToString.PadLeft(0, "0")
                                    End If
                                End If
                                sender.RequestValue = FieldText
                            End If
                        End If
                    End If
                End If


                ' Retrieve the value from the associated buffer and move it into
                ' FIELDTEXT and where appropriate into FIELDVALUE.
                If ValidateType = ValidateTypes.Edit Then
                    ' Retrieve the value from the record buffer or 
                    ' underlying variable and assign it to FIELDTEXT.
                    sender.RaiseGetRecordBuffer(FieldText, FieldValue, underlyingDataType)
                End If

                ' Perform specified editing for ACCEPT verb processing (based on 
                ' blnRequiredDuplicateOrDefaultSet being set to TRUE) or EDIT verb processing.
                If (ValidateType = ValidateTypes.Accept AndAlso (blnRequiredDuplicateOrDefaultSet Or m_blnPromptOK)) Or ValidateType = ValidateTypes.Edit Then
                    Dim blnSuccess As Boolean

                    ' For Unsigned Integers/Numbers, if a negative value is entered, 
                    ' display the Negative error message.
                    If (sender.UnderLyingDataType = ItemDataTypes.Integer OrElse sender.UnderLyingDataType = ItemDataTypes.UnsignedNumeric) AndAlso FieldValue < 0 Then
                        m_blnValidateError = True

                        If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                            AddMessage("Cette entre ne doit pas tre ngative.", MessageTypes.Error) 'IM.Negative
                        Else
                            AddMessage("This entry must not be negative.", MessageTypes.Error) 'IM.Negative
                        End If
                    End If

                    ' Check the VALUES options passing FIELDTEXT for character
                    ' fields or FIELDVALUE for numeric and date fields.
                    If sender.Values Is Nothing Then
                        blnSuccess = True
                    Else
                        If sender.DataType = DataTypes.Numeric Then
                            If blnUseScaling AndAlso intInputScale <> 0 Then
                                ' Ensure we check the value based on the entered value 
                                ' and not the scaled value.
                                Dim scaledValue As Decimal = FieldValue
                                scaledValue /= 10 ^ intInputScale
                                blnSuccess = sender.Values.IsValueInRange(scaledValue)
                            Else
                                blnSuccess = sender.Values.IsValueInRange(FieldValue)
                            End If
                        Else
                            blnSuccess = sender.Values.IsValueInRange(FieldText)
                        End If
                    End If
                    If Not blnSuccess Then
                        m_blnValidateError = True

                        If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                            AddMessage("Cette entre n'est pas dans la plage de valeurs acceptable", MessageTypes.Error) 'IM.Range
                        Else
                            AddMessage("This entry isn't within the acceptable range of values", MessageTypes.Error) 'IM.Range
                        End If
                    End If

                    Dim strTextValue As String

                    ' Check for pattern matching.
                    ' Numeric and date fields are converted to character strings.
                    If underlyingDataType = DataTypes.Character Then
                        strTextValue = FieldText
                    Else
                        strTextValue = FieldValue.ToString()
                    End If
                    Dim strPattern As String
                    Try
                        strPattern = GetPattern(sender.FieldName)
                    Catch ex As CustomApplicationException
                        Throw ex
                    Catch ex As Exception
                        ExceptionManager.Publish(ex)
                        Throw ex
                    End Try
                    If strPattern Is Nothing Then strPattern = String.Empty
                    If sender.Pattern.Length > 0 OrElse strPattern.Length > 0 Then
                        If strPattern.Length = 0 Then strPattern = sender.Pattern
                        blnSuccess = MatchPattern(strTextValue, strPattern)
                    End If

                    ' If the MatchPattern was false, 
                    ' return an error to the user.
                    If Not blnSuccess Then
                        m_blnValidateError = True
                        If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                            AddMessage("Cette entre n'est pas dans la plage de valeurs acceptable", MessageTypes.Error) 'IM.Range
                        Else
                            AddMessage("This entry isn't within the acceptable range of values", MessageTypes.Error) 'IM.Range
                        End If
                    End If
                    m_intLookUpSequence += 1
                    ' Check the lookups to ensure a correct value was entered.
                    If Not (blnHasDefault AndAlso FieldText = strDefaultValue AndAlso sender.Required <> BooleanTypes.True AndAlso sender.Duplicate <> BooleanTypes.True) Then
                        sender.RaiseLookupOn()
                    End If
                    If sender.Text <> sender.OldSubmittedValue OrElse Not MethodWasExecuted(m_strLookUpFlag, m_intLookUpSequence) Then

                        ' If we find a specific record and then edit the record, if the field is silent,
                        ' then it doesn't check the LookupNotOn.  If a sequential search is done,
                        ' then the LookupNotOn is executed.
                        If Not (Me.ChangeMode AndAlso Not Me.IsInAppendOrEntry AndAlso sender.Silent AndAlso SearchWasFiltered(sender.FieldName)) Then
                            If sender.FieldName.IndexOf(".") > 0 Then m_strLookupNotOnFile = sender.FieldName.Substring(0, sender.FieldName.IndexOf("."))
                            m_blnExecutingLookupNotOn = True
                            m_blnLookupOnSameFile = False
                            sender.RaiseLookupNotOn(blnLookupNotOnExecuted)
                            m_blnExecutingLookupNotOn = False
                            m_strLookupNotOnFileName = String.Empty
                        End If

                        ' Save the sequence information and set a flag indicating LOOKUP was run.
                        SetMethodExecutedFlag(m_strLookUpFlag, "LOOKUP_FLAG", m_intLookUpSequence)
                    End If

                    ' If blnLookupNotOnExecuted is TRUE, then there is a 
                    ' coded LookupNotOn procedure.
                    If blnLookupNotOnExecuted Then

                    End If
                End If

                ' Call the EDIT and PROCESS procedures as part of the ACCEPT or EDIT verb processing.
                If ((ValidateType = ValidateTypes.Accept And (m_blnPromptOK Or (blnRequiredDuplicateOrDefaultSet And blnRaiseEdit))) _
                And sender.ValueChanged) Or ValidateType = ValidateTypes.Edit Then

                    ' Assign the RecordBuffer value to m_OldValue.  This value 
                    ' will be used when the OLDVALUE function is called.  We then set
                    ' FIELDTEXT/FIELDVALUE to the recordbuffer.  We have taken this 
                    ' approach since PowerHouse changed any reference of the named item
                    ' on which the EDIT procedure is based and replaces it with either
                    ' FIELDTEXT or FIELDVALUE.
                    Dim strTempFieldText As String = FieldText
                    Dim strTempFieldValue As Decimal = FieldValue

                    ' Retrieve the value from the record buffer or 
                    ' underlying variable and assign it to FIELDTEXT/FIELDVALUE.
                    ' This will become the value that will be used for OldValue.
                    sender.RaiseGetRecordBuffer(FieldText, FieldValue, underlyingDataType)

                    ' Ensure that for Numeric fields with an underlying datatype 
                    ' of Character, that we update FieldValue.
                    If sender.DataType = DataTypes.Numeric AndAlso underlyingDataType = DataTypes.Character Then
                        If IsNumeric(FieldText) Then
                            FieldValue = CDec(FieldText)
                        Else
                            FieldValue = 0
                        End If
                    End If


                    ' Assign the OldValue information.
                    m_OldValue.Field = sender.FieldName
                    m_OldValue.FieldText = FieldText
                    m_OldValue.FieldValue = FieldValue

                    strOldFieldText = FieldText
                    decOldFieldValue = FieldValue

                    ' Assign the temporary values back to FIELDTEXT/FIELDVALUE.
                    FieldText = strTempFieldText
                    FieldValue = strTempFieldValue

                    If sender.DataType = DataTypes.Numeric OrElse underlyingDataType = ItemDataTypes.Numeric Then

                        If sender.Significance > 0 Then
                            FieldText = FieldValue.ToString.PadLeft(sender.Significance, "0")
                        End If

                    End If

                    ' Store the value of FIELDTEXT or FIELDVALUE to the
                    ' record buffer or underlying variable.
                    sender.RaiseSetRecordBuffer(FieldText, FieldValue, underlyingDataType)

                    If Not sender.IsDefine Then sender.RaiseSetEditFlag(False)
                    '----------------------------
                    ' Call the EDIT procedure.
                    '----------------------------
                    blnEditFailed = True
                    If sender.OldSubmittedValue <> FieldText Then
                        blnFieldDiff = True
                    End If
                    sender.RaiseEdit()
                    blnFieldDiff = False
                    blnEditFailed = False

                    If Not sender.IsDefine Then sender.RaiseSetEditFlag(True)
                End If

                ' Store the value in the record buffer.
                If ((ValidateType = ValidateTypes.Accept And (m_blnPromptOK Or blnRequiredDuplicateOrDefaultSet)) _
                OrElse (m_blnPromptOK AndAlso ValidateType = ValidateTypes.Request)) Then

                    ' Store the value of FIELDTEXT or FIELDVALUE to the
                    ' record buffer or underlying variable.
                    If FieldText.Length > 0 Then sender.RaiseSetRecordBuffer(FieldText, FieldValue, underlyingDataType, ValidateType = ValidateTypes.Request)
                End If

                '----------------------------
                ' Call the PROCESS procedure.
                '----------------------------
                If ((ValidateType = ValidateTypes.Accept And (m_blnPromptOK Or blnRequiredDuplicateOrDefaultSet)) _
                 And sender.ValueChanged) Or ValidateType = ValidateTypes.Edit Then
                    sender.RaiseProcess()
                End If

                ' If fixed, don't change the value unless a specific display verb is called.
                'If sender.Fixed AndAlso m_blnIsInDisplayPreDisplayFormatting Then
                '    EndValidate()
                '    Exit Function
                'End If

                ' For non-EDIT verb processing, retrieve the value for display, 
                ' perform the OUTPUT procedure and execute DISPLAY formatting.
                If ValidateType <> ValidateTypes.Edit Then
                    Dim strUnderlyingValue As String

                    ' Retrieve the value from the record buffer or 
                    ' underlying variable and assign it to FIELDTEXT.
                    sender.RaiseGetRecordBuffer(FieldText, FieldValue, underlyingDataType)

                    ' To ensure the value is redisplayed.
                    If blnUseScaling AndAlso intInputScale <> 0 Then
                        FieldValue /= 10 ^ intInputScale
                    End If

                    Dim intMaxLength As Integer = 0

                    ' Scale the numeric items and right justify the value.
                    If sender.DataType = DataTypes.Numeric Then
                        If sender.UnderLyingDataType = ItemDataTypes.Character Then
                            strUnderlyingValue = FieldText
                        Else
                            strUnderlyingValue = FieldValue.ToString
                        End If


                        If ValidateType <> ValidateTypes.Request AndAlso NULL(FieldText) = cEmptyString Then
                            FieldText = 0
                        End If

                        If FieldText <> cEmptyString Then
                            ' Right-justify the record buffer value in FIELDTEXT.
                            FieldText = FieldText.Trim.PadLeft(intMaxLength)
                        End If
                    Else
                        strUnderlyingValue = FieldText
                    End If

                    '----------------------------
                    ' Call the OUTPUT procedure.
                    '----------------------------
                    Dim oldFieldText As String = FieldText
                    sender.RaiseOutput()
                    If FieldText.Equals(oldFieldText) Then
                        ' Value set in Output overrides the value set in Combo
                        ' To make it consistant, Value and Description of combo item
                        ' should match with the "value passed in Input" and "Description
                        ' set in Output"
                        sender.SelectedValue(sender.ValueChanged) = strUnderlyingValue.TrimEnd
                    Else
                        'Always display value specified in Output Procedure, "SelectedValue" value is the value stored in record buffer 
                        sender.SelectedValue(False) = strUnderlyingValue
                    End If

                    ' Format the values prior to displaying based on data type.
                    If sender.DataType = DataTypes.Numeric OrElse sender.BWZ = BooleanTypes.True Then
                        ' If the field is NUMERIC, FIELDTEXT is converted to a display string
                        ' using the numeric picture and format options.
                        If ValidateType <> ValidateTypes.Request OrElse (ValidateType = ValidateTypes.Request AndAlso IsNumeric(FieldText)) Then
                            Dim strThousandSeparator As String = ","
                            If sender.m_IsBoundToTemporary AndAlso sender.Picture.Length = 0 Then
                                strThousandSeparator = ""
                            End If

                            If blnUseScaling = True AndAlso FieldText.IndexOf(".") > 0 Then
                                FieldText = FieldText.Substring(0, FieldText.IndexOf(".")).Trim
                            End If

                            Dim strMessage As String
                            Dim elementName As String = String.Empty
                            If strTableFieldName.IndexOf(".") > -1 Then elementName = strTableFieldName.Substring(strTableFieldName.IndexOf(".") + 1)
                            strMessage = ApplyNumericFormatting(elementName, FieldText, sender.BWZ, sender.TrailingSign, sender.LeadingSign, sender.Picture,
                                    sender.GetSignificance, sender.Fill, sender.Float, 0, 0, sender.UnderLyingDataType, sender.DataType, 0, , strThousandSeparator)
                            If strMessage.Length > 0 Then
                                AddMessage(strMessage, MessageTypes.Error)
                            End If
                        End If
                    Else
                        ' If the field is CHARACTER, FIELDTEXT is converted to a display string 
                        ' under control of the character picture.
                        ApplyCharacterFormatting(FieldText, sender.Picture)
                    End If

                    ' Store this in case a RunScreen is called since we don't update the screen
                    ' values in this case.  This ensures that when posting back, that when checking
                    ' the present value (coming from OldText) and comparing against the PostedValue,
                    ' that we don't have a different value and therefore updating the SubmittedValue.
                    m_oldTextField = sender
                    m_oldTextValue = sender.OldText

                    ' Assign FIELDTEXT back to the control.  For fields
                    ' of type CHARACTER, truncate the value if no picture.
                    ' If the length of FIELDTEXT is greater than the
                    ' length of the control, truncate FIELDTEXT 
                    ' to the length of the control.
                    If sender.DataType = DataTypes.Character And sender.Picture.Trim = "" Then
                        If FieldText.Length <= intMaxLength Then
                            sender.Text = FieldText.TrimEnd
                            sender.OldText = FieldText.TrimEnd
                        Else
                            sender.Text = FieldText.TrimEnd
                            sender.OldText = FieldText.TrimEnd
                        End If
                    Else
                        sender.Text = FieldText
                        sender.OldText = FieldText
                    End If

                    Select Case ValidateType
                        Case ValidateTypes.Accept, ValidateTypes.Request
                            sender.OldSubmittedValue = sender.Text
                    End Select

                End If

                If IsValidateWithIn() Then
                    FieldText = strPreviousFieldText
                    FieldValue = dblPreviousFieldValue
                End If

                EndValidate()


                ' Stores whether the DISPLAY verb was executed during the current postback
                ' on this field.  This will change the Text property, therefore if we have
                ' an Accept/RequestPrompt verb on this field, this text property is invalid
                ' (meaning we should use SubmittedValue instead).
                If ValidateType = ValidateTypes.Display Then
                    sender.DisplayExecuted = True
                End If

                If blnResetFromInputAndNull Then
                    sender.ValueChanged = False
                End If

                Return sender.ValueChanged

            Catch ex As CustomApplicationException

                ' Remove the flag if not completed.
                EndValidate()

                If Not m_blnInDetailFind OrElse ex.Message = cRunScreenException.ToString Then

                    ' Ensure we re-run setting the value in case a SUM INTO needs to be reset.
                    If blnEditFailed AndAlso ex.Message <> cAcceptRequestPromptException.ToString Then
                        sender.RaiseSetRecordBuffer(strOldFieldText, decOldFieldValue, underlyingDataType)
                        blnEditFailed = False
                    End If

                    ' IF condition modified from version 483.  See SourceSafe history.
                    If ex.Message <> cRunScreenException.ToString Then

                        'In case of Request in Find/Select, if Custom Error is thrown, we reset the Request values to empty or False
                        If ValidateType = ValidateTypes.Request Then
                            sender.RequestValue = String.Empty
                            If Me.UseAcceptProcessing Then
                                sender.RequestWasPerformed = False
                                sender.RequestPromptOk = False
                            End If
                        End If

                        ' Indicate the control to move the focus to.
                        SetFocusField(sender.Name)
                        'RegisterHiddenField("RequestedControlFocusOverRide", sender.RenderedID)

                        If ex.Message <> cAcceptRequestPromptException.ToString Then
                            If Me.UseAcceptProcessing Then
                                ' Reset the text field with the original value.
                                sender.Text = sender.OldText
                                m_strPopupComboName = sender.RenderedID
                            Else
                                sender.Text = ""
                                sender.OldText = ""
                            End If

                            ' Set the SubmittedValue back to the OldSubmittedValue.
                            sender.Text = sender.OldSubmittedValue

                            ' If there is no OldSubmittedValue, then reset the 
                            ' ValueChanged to FALSE.
                            If sender.OldSubmittedValue = "" Then
                                sender.ValueChanged = False
                            End If
                            ' Keep track of the ACCEPT field in case an error occurs.
                            'If (Session(FormName + "_" + Level.ToString + "_" + "VALIDATE") & "").ToString.Length = 0 AndAlso Not sender.Silent Then m_fldAcceptField = sender
                            'RemoveAccept()
                        End If
                    End If
                    m_strNavigationControl = sender.Name

                    ' Set the previous value from the field to the 
                    ' control if a lookup screen was called and no
                    ' value was selected by the user.
                    If strPreviousValue.Length > 0 AndAlso ex.Message <> cRunScreenException.ToString Then

                        sender.OldText = strPreviousValue
                    End If


                    Throw ex

                End If



            Catch ex As Exception

                ' Write the exception to the event log and throw an error.
                ExceptionManager.Publish(ex)
                Throw ex

            End Try
        End Function

        'Public Function ReadViewState()
        '    Dim objViewStateStream As New StreamReader("c:\Temp\ViewState.txt")
        '    Dim objFormatter As LosFormatter
        '    Dim objStateBag As Object

        '    objFormatter = New LosFormatter
        '    objStateBag = objFormatter.Deserialize(objViewStateStream)

        'End Function

        ''' --- IsTableField -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Determines if the field is a Table Field.
        ''' </summary>
        ''' <param name="LongFieldName"></param>
        ''' <param name="TableName"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <example>IsTableField(sender.FieldName, sender.TableName)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Overridable Function IsTableField(ByVal LongFieldName As String, ByVal TableName As String) As Boolean
            If TableName.Trim = String.Empty Then
                Return False
            Else
                Return LongFieldName.IndexOf(TableName + ".") > 0  ' Assuming "." will not be the first character, with an Empty TableName
            End If
        End Function

        ''' --- OldValue -----------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Returns the value of the underlying record buffer during editing.
        ''' </summary>
        ''' <param name="Name">A String containing the name of field.</param>
        ''' <param name="Value">A String containing the current value of field.</param>
        ''' <remarks>
        ''' The OldValue function returns the current item in the underlying record buffer.  If the value passed in 
        ''' as value is not found, then this value is returned in case OldValue is used on a field that is not currently executing the Edit procedure.   
        ''' <note>
        ''' OldValue can should only be used during the Edit procedure to return the value in
        ''' the associated record buffer.  FieldText or FieldValue are used to handle the new value
        ''' associated to this field.  
        ''' </note>
        ''' </remarks>
        ''' <example>T_TEMP.Value = OldValue("SURNAME", "Smith")</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function OldValue(ByVal Name As String, ByVal Value As String) As String

            ' If the OldValue we are retrieving is the same as 
            ' the current item on which the validate is executing,
            ' then return the value from the array, otherwise return
            ' the value passed in.

            If IsUsingSqlServer() Then
                Name = Name.Substring(Name.IndexOf("dbo.") + 4)
            End If

            If m_OldValue.Field = Name Then
                Return m_OldValue.FieldText
            Else
                Return Value
            End If

        End Function

        ''' --- OldValue -----------------------------------------------------------
        '''
        ''' <summary>
        ''' 	Returns the value of the underlying record buffer during editing.
        ''' </summary>
        ''' <param name="Name">A String containing the name of field.</param>
        ''' <param name="Value">A String containing the current value of field.</param>
        ''' <remarks>
        ''' The OldValue function returns the current item in the underlying record buffer.  If the value passed in 
        ''' as value is not found, then this value is returned in case OldValue is used on a field that is not currently executing the Edit procedure.  
        ''' <note>
        ''' OldValue can should only be used during the Edit procedure to return the value in
        ''' the associated record buffer.  FieldText or FieldValue are used to handle the new value
        ''' associated to this field.  
        ''' </note>
        ''' </remarks>
        ''' <example>T_TEMP.Value = OldValue("YEAR", 1961)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function OldValue(ByVal Name As String, ByVal Value As Object) As Decimal
            Return OldValue(Name, CDec(Value))
        End Function
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function OldValue(ByVal Name As String, ByVal Value As Decimal) As Decimal

            ' If the OldValue we are retrieving is the same as 
            ' the current item on which the validate is executing,
            ' then return the value from the array, otherwise return
            ' the value passed in.

            If IsUsingSqlServer() Then

                If Name.StartsWith("INDEXED") Then
                    Name = Name.Replace("INDEXED.", "")
                Else
                    Name = Name.Substring(Name.IndexOf("dbo.") + 4)
                End If


            End If

            If m_OldValue.Field = Name Then
                Return m_OldValue.FieldValue
            Else
                Return Value
            End If

        End Function

        ''' --- OldValue -----------------------------------------------------------
        '''
        ''' <summary>
        ''' 	Returns the value of the underlying record buffer during editing.
        ''' </summary>
        ''' <param name="Name">A String containing the name of field.</param>
        ''' <param name="Value">A String containing the current value of field.</param>
        ''' <remarks>
        ''' The OldValue function returns the current item in the underlying record buffer.  If the value passed in 
        ''' as value is not found, then this value is returned in case OldValue is used on a field that is not currently executing the Edit procedure.  
        ''' <note>
        ''' OldValue can should only be used during the Edit procedure to return the value in
        ''' the associated record buffer.  FieldText or FieldValue are used to handle the new value
        ''' associated to this field.  <br/>
        ''' </note>
        ''' </remarks>
        ''' <example>T_TEMP.Value = OldValue("EMP_DATE", SysDateTime)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function OldValue(ByVal Name As String, ByVal Value As DateTime) As DateTime

            ' If the OldValue we are retrieving is the same as 
            ' the current item on which the validate is executing,
            ' then return the value from the array, otherwise return
            ' the value passed in.

            If IsUsingSqlServer() Then
                Name = Name.Substring(Name.IndexOf("dbo.") + 4)
            End If

            If m_OldValue.Field = Name Then
                Return CDate(m_OldValue.FieldText)
            Else
                Return Value
            End If

        End Function

#End Region






        ''' --- PopulateComboValues ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PopulateComboValues.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub PopulateComboValues()
            'Combo Items can be populated either from Meta_DropDown Table or from "Values"
            '(needs to be tested), or from the event handler in the code for that particular combo box
            '
            'This (PopulateComboValues) method, generates Combo Items for each combo box that 
            'needs Combo Items from the Database table Meta_DropDown, "Dictionary is used to 
            'identify items for all the combo based on m_colMetaComboColumnNames
            'Once it populates the Items from the database it raises an event 
            '(RaiseGenerateComboValues) so that each combo can populate its own items
            If Not m_colMetaComboColumnNames Is Nothing Then
                Try
                    Dim strSQL As StringBuilder
                    Dim strColumns As StringBuilder
                    Dim intColumn As Integer

                    If m_colMetaComboColumnNames.Count > 0 Then
                        strColumns = New StringBuilder(String.Empty)
                        strColumns.Append(" and Field_Name in (")
                        With m_colMetaComboColumnNames
                            For intColumn = 0 To .Count - 1
                                If intColumn = 0 Then
                                    strColumns.Append("'")
                                Else
                                    strColumns.Append("', '")
                                End If
                                strColumns.Append(.Item(intColumn))
                            Next
                            strColumns.Append("')")
                        End With

                        strSQL = New StringBuilder(String.Empty)
                        With strSQL
                            Dim strScreenId As String
                            strScreenId = Me.Name
                            If strScreenId Is Nothing OrElse strScreenId.Trim.Length = 0 Then
                                strScreenId = " "
                            End If
                            .Append("Select * from Meta_DropDown WHERE SCREEN_ID = '").Append(strScreenId).Append("'")
                            .Append(strColumns)
                            If Not strScreenId.Equals(" ") Then
                                .Insert(0, "Select * from (")
                                .Append(" union ")
                                .Append("select * from Meta_DropDown where SCREEN_ID=' '")
                                .Append(strColumns)
                                .Append(" and Field_Name not in (select Field_Name from Meta_DropDown ")
                                .Append("where SCREEN_ID='").Append(strScreenId).Append("'")
                                .Append(strColumns)
                                .Append("))")
                            End If
                            .Append(" order by SCREEN_ID desc, Field_Name, Seq_No")
                        End With

                        ' Fetch the result.

                        If IsUsingSqlServer() Then
                            m_tblColumnsTable = DataAccess.SqlServer.SqlHelper.ExecuteDataTable(GetConnectionString, CommandType.Text, strSQL.ToString)
                        Else
                            m_tblColumnsTable = DataAccess.Oracle.OracleHelper.ExecuteDataTable(GetConnectionString, CommandType.Text, strSQL.ToString)
                        End If

                    End If

                    RaiseGenerateComboValues(m_tblColumnsTable)

                Catch ex As Exception

                    ' Write the exception to the event log and throw an error.
                    ExceptionManager.Publish(ex)
                    Throw ex

                End Try

            End If
        End Sub

        ''' --- IsUsingSqlServer ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsUsingSqlServer.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function IsUsingSqlServer() As Microsoft.VisualBasic.TriState
            If m_blnIsUsingSqlServer = Microsoft.VisualBasic.TriState.UseDefault Then
                If System.Configuration.ConfigurationManager.AppSettings("AuthenticationDatabase") Is Nothing OrElse
                        System.Configuration.ConfigurationManager.AppSettings("AuthenticationDatabase").ToString.Equals(cSQL_SERVER) Then
                    m_blnIsUsingSqlServer = Microsoft.VisualBasic.TriState.True
                Else
                    m_blnIsUsingSqlServer = Microsoft.VisualBasic.TriState.False
                End If
            End If
            Return (m_blnIsUsingSqlServer = Microsoft.VisualBasic.TriState.True)
        End Function

        ''' --- ReadIsFlickerFree ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ReadIsFlickerFree.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Mayur]	19-Oct-05	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function ReadIsFlickerFree() As Boolean
            If Not System.Configuration.ConfigurationManager.AppSettings("FlickerFree") Is Nothing Then
                If System.Configuration.ConfigurationManager.AppSettings("FlickerFree").ToString.ToUpper.Equals("FALSE") Then
                    Return False
                Else
                    Return True
                End If
            End If
            Return True
        End Function

        ''' --- RoleBasedMenus -------------------------------------------------------
        ''' <exclude />
        ''' 
        ''' <summary>
        ''' 	Summary of RoleBasedMenus.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Function RoleBasedMenus() As Boolean
            If Not System.Configuration.ConfigurationManager.AppSettings("RoleBasedMenus") Is Nothing Then
                If System.Configuration.ConfigurationManager.AppSettings("RoleBasedMenus").ToString.ToUpper.Equals("TRUE") Then
                    Return True
                Else
                    Return False
                End If
            End If
            Return False
        End Function


        ''' --- MenuRole -------------------------------------------------------
        ''' <exclude />
        ''' 
        ''' <summary>
        ''' 	Summary of MenuRole.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Function MenuRole() As String

            Return strUserRoles

        End Function

        ''' --- UserBelongsToRole -------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Returns a boolean indicating whether the user belongs to a specific role.
        ''' </summary>
        ''' <param name="Role">A string value naming the role to check.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function UserBelongsToRole(ByVal Role As String) As Boolean

            If strUserRoles.Length > 0 Then
                Return ("|" & strUserRoles & "|").IndexOf("|" & Role & "|") > -1
            Else
                Return False
            End If

        End Function

        ''' --- RaiseGenerateComboValues -------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RaiseGenerateComboValues.
        ''' </summary>
        ''' <param name="ComboValuesTable"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub RaiseGenerateComboValues(ByVal ComboValuesTable As DataTable)
            RaiseEvent GenerateComboValues(ComboValuesTable)
        End Sub


        ''' --- PrepareForNewColumn ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PrepareForNewColumn.
        ''' </summary>
        ''' <param name="ColumnName"></param>
        ''' <param name="Script"></param>
        ''' <param name="ColumnNames"></param>
        ''' <param name="ColumnValues"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub PrepareForNewColumn(ByVal ColumnName As String, ByVal Script As StringBuilder, ByVal ColumnNames As StringBuilder, ByVal ColumnValues As StringBuilder)
            With Script
                .Append("	case '").Append(ColumnName).Append("':").Append(vbNewLine)
                With ColumnNames
                    .Remove(0, .Length).Append(vbNewLine)
                    .Append("		arrNames = new Array(")
                End With

                With ColumnValues
                    .Remove(0, .Length).Append(vbNewLine)
                    .Append("		arrValues = new Array(")
                End With
            End With
        End Sub

        ''' --- WriteColumnsToScript -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of WriteColumnsToScript.
        ''' </summary>
        ''' <param name="ColumnName"></param>
        ''' <param name="Script"></param>
        ''' <param name="ColumnNames"></param>
        ''' <param name="ColumnValues"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub WriteColumnsToScript(ByVal ColumnName As String, ByVal Script As StringBuilder, ByVal ColumnNames As StringBuilder, ByVal ColumnValues As StringBuilder)
            With Script
                .Append(ColumnNames).Append(");").Append(vbNewLine)
                .Append(ColumnValues).Append(");").Append(vbNewLine)
                .Append(vbTab).Append(vbTab).Append("break;").Append(vbNewLine)
            End With
        End Sub



        ''' --- RunDesigner --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Calls corresponding Designer Procedure.
        ''' </summary>
        ''' <param name="DesignerName">A String representing the name of Designer to run.</param>
        ''' <param name="RowPosition">An Integer indicating the desired row position in Grid on which to run the Designer.</param>
        ''' <remarks>This procedure will be called in response to the Submit(Save) event. The Designer Procedure 
        ''' can have a generic purpose in the Derived Page, or for a specific purpose to operate on a specified Row 
        ''' contained in a Grid which has been identified by the RowPosition value.
        ''' </remarks>
        ''' <example>RunDesigner("dsrSERV", 2)  - Run Designer SERV for Row 3 (Zero based)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Overridable Sub RunDesigner(ByVal DesignerName As String, Optional ByVal RowPosition As Integer = -1)

            ' To be overrided in Derived Page if page has designers

        End Sub



#Region " AlteredRecord, DeletedRecord and NewRecord methods "

        'AlteredRecord, DeletedRecord and NewRecord uses 
        'm_bfoFileForRecordStatus to return the primary file unless it is changed with the 
        'SET ASSUMED (Which we don't support at present) statement. If there is no assumed 
        'record-structure, the status is the same as that of the current record-structure,
        'that gets set in GetData

        ''' --- DeletedRecord ------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Returns a boolean indicating whether the current record in the File class (used in last GetData) has been marked for deletion.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function DeletedRecord() As Boolean
            If FileForRecordStatus Is Nothing Then
                'Error????
                Return False
            Else
                Return FileForRecordStatus.DeletedRecord
            End If
        End Function

        ''' --- AlteredRecord ------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Returns a boolean indicating whether the current record in the File class (used in last GetData) has been marked as altered.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function AlteredRecord() As Boolean
            If FileForRecordStatus Is Nothing Then
                'Error????
                Return False
            Else
                Return FileForRecordStatus.AlteredRecord
            End If
        End Function

        ''' --- NewRecord ----------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Returns a boolean indicating whether the current record in the File class (used in last GetData) has been marked as new.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function NewRecord() As Boolean
            If FileForRecordStatus Is Nothing Then
                'Error????
                Return False
            Else
                Return FileForRecordStatus.NewRecord
            End If
        End Function

#End Region

        Public Sub Keys(ByVal sender As Object, ByVal e As System.Windows.Input.KeyEventArgs) Handles Me.PreviewKeyDown

            If (e.KeyboardDevice.IsKeyDown(Key.LeftCtrl) OrElse e.KeyboardDevice.IsKeyDown(Key.RightCtrl) OrElse e.Key = Key.F12 OrElse e.Key = Key.F11) Then
                Select Case e.Key

                    Case Key.PageDown, Key.F12
                        RequireTerminate = True
                        SkipAll = True

                        If Not ControlHasFocus Is Nothing Then
                            Dim eInsertBack As New KeyEventArgs(Keyboard.PrimaryDevice, Keyboard.PrimaryDevice.ActiveSource, 0, Key.Tab)
                            eInsertBack.RoutedEvent = UIElement.KeyDownEvent
                            InputManager.Current.ProcessInput(eInsertBack)
                        End If


                        Dim dt As DispatcherTimer = New DispatcherTimer
                        AddHandler dt.Tick, AddressOf CallPageLoadDown
                        dt.Interval = New TimeSpan(0, 0, 0, 0, 400)
                        dt.Start()



                    Case Key.PageUp, Key.F11
                        RequireTerminate = True
                        If Not ControlHasFocus Is Nothing Then
                            Dim eInsertBack As New KeyEventArgs(Keyboard.PrimaryDevice, Keyboard.PrimaryDevice.ActiveSource, 0, Key.Tab)
                            eInsertBack.RoutedEvent = UIElement.KeyDownEvent
                            InputManager.Current.ProcessInput(eInsertBack)
                        End If

                        Dim dt As DispatcherTimer = New DispatcherTimer
                        AddHandler dt.Tick, AddressOf CallPageLoadUp
                        dt.Interval = New TimeSpan(0, 0, 0, 0, 400)
                        dt.Start()




                End Select
            End If


        End Sub

        Private Sub CallPageLoadDown(sender As Object, e As EventArgs)
            Dim blnCalledByGrid As Boolean = False

            Dim dtime = TryCast(sender, DispatcherTimer)
            If dtime IsNot Nothing Then
                dtime.[Stop]()
            End If
            dtime = Nothing
            RequireTerminate = True
            SkipAll = True
            Page_Load()

        End Sub
        Private Sub CallPageLoadUp(sender As Object, e As EventArgs)
            Dim blnCalledByGrid As Boolean = False

            Dim dtime = TryCast(sender, DispatcherTimer)
            If dtime IsNot Nothing Then
                dtime.[Stop]()
            End If
            dtime = Nothing
            RequireTerminate = True
            Page_Load(ControlHasFocus)
        End Sub


        Public Sub Page_UnLoad() Handles Me.Unloaded

            CallCloseTransactionObjects()
        End Sub

        Public toolbar As UserControl
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub LoadBase()
            ApplicationState.Current.CorePage = Me

        End Sub
        '-------------------------------------------------------------------
        ' Name: Page_Load
        ' Function: The page load event.
        ' Example: 
        '-------------------------------------------------------------------
        ''' --- Page_Load ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of Page_Load.
        ''' </summary>
        ''' <param name="sender"></param>
        ''' <param name="e"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub Page_Load(Optional control As Object = Nothing)


            m_intOccurrence = 0
            CoreWebTrace("Page_Load", "Start Page_Load")

            If helpScreens Is Nothing Then
                LoadHelpScreens()
            End If

            If Not UniqueControl Is Nothing AndAlso Not control Is Nothing Then
                If UniqueControl.Name = control.Name OrElse control.Name = "btnGridRowEdit" OrElse control.Name = "btnGridRowDelete" Then
                    UniqueControl = Nothing
                ElseIf Not IsNothing(RunningDesigner) AndAlso control.Name = RunningDesigner.Name Then
                    UniqueControl = Nothing
                Else
                    Exit Sub
                End If
            End If

            If Not IsNothing(control) Then
                ControlHadFocus = control
            End If


            ControlHasFocus = FocusManager.GetFocusedElement(Me.FindVisualParent(Of System.Windows.Window))

            If Not ControlHasFocus Is Nothing Then
                If ControlHasFocus.GetType().ToString = "System.Windows.Controls.TextBox" Then
                    ControlHasFocus = DirectCast(ControlHasFocus, System.Windows.Controls.TextBox).ParentOfType(Of ComboBox)()
                ElseIf ControlHasFocus.GetType().ToString = "System.Windows.Controls.Primitives.DatePickerTextBox" Then
                    ControlHasFocus = DirectCast(ControlHasFocus, System.Windows.Controls.Primitives.DatePickerTextBox).ParentOfType(Of DateControl)()
                ElseIf ControlHasFocus.GetType().ToString = "System.Windows.Controls.Primitives.CalendarDayButton" Then
                    ControlHasFocus = DirectCast(ControlHasFocus, System.Windows.Controls.Primitives.CalendarDayButton).ParentOfType(Of DateControl)()
                End If
            End If



            If (Not control Is Nothing AndAlso Not ControlHasFocus Is Nothing AndAlso control.Name = ControlHasFocus.Name) Then
                ControlHasFocus = control
            End If

            If (Not IsNothing(control) AndAlso (Mode = PageModeTypes.Change OrElse Mode = PageModeTypes.Correct)) Then
                If (control.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.TextBox") Then
                    If DirectCast(control, TextBox).FieldID = "" Then
                        PerformOperation(DirectCast(control, TextBox))
                        Exit Sub
                    End If
                ElseIf (control.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.ComboBox") Then
                    If DirectCast(control, ComboBox).FieldID = "" Then
                        PerformOperation(DirectCast(control, ComboBox))
                        Exit Sub
                    End If
                ElseIf (control.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.DateControl") Then
                    If DirectCast(control, DateControl).FieldID = "" Then
                        PerformOperation(DirectCast(control, DateControl))
                        Exit Sub
                    End If
                End If
            End If


            If Not ControlHasFocus Is Nothing AndAlso ControlHasFocus.GetType.ToString() = "System.Windows.Controls.Button" Then
                If DirectCast(ControlHasFocus, Button).Name = "CloseButton" Then
                    Exit Sub
                End If
            End If

            'If Not ControlHasFocus Is Nothing AndAlso ControlHasFocus.GetType.ToString() = "Core.Windows.UI.Core.Windows.UI.CoreTreeViewItem" AndAlso Not control Is Nothing Then
            '    Exit Sub
            'End If


            If ControlHasFocus Is Nothing OrElse (Not ControlHasFocus.GetType.ToString() = "Core.Windows.UI.Core.Windows.UI.TextBox" AndAlso
                Not ControlHasFocus.GetType.ToString() = "Core.Windows.UI.Core.Windows.UI.DateControl") Then
                Mouse.OverrideCursor = Cursors.Wait
            End If


            If NavigationType = NavigationTypes.Cancel Then
                UniqueControl = Nothing
                If HasError Then HasError = False
                If Not control Is Nothing Then
                    Exit Sub
                End If
            ElseIf NavigationType = NavigationTypes.Find Then
                If HasError Then HasError = False
            End If

            If (ToolbarAction = ToolbarIcons.Next _
                OrElse ToolbarAction = ToolbarIcons.First _
                OrElse ToolbarAction = ToolbarIcons.Next _
                OrElse ToolbarAction = ToolbarIcons.Previous _
                OrElse ToolbarAction = ToolbarIcons.Last _
                OrElse ToolbarAction = ToolbarIcons.Delete) _
                Then
                GridRecordNumber = 0
                CurrentPageSetNumber = 0
                CurrentPageNumber = 0
                If Not control Is Nothing Then
                    Exit Sub
                End If
            End If


            If Not control Is Nothing AndAlso (Mode = PageModeTypes.Change OrElse Mode = PageModeTypes.Correct) AndAlso PageActionType <> Framework.Core.Framework.PageActionType.DataListButtonClick Then
                If Not ControlHasFocus Is Nothing AndAlso ControlHasFocus.GetType.ToString() <> "Core.Windows.UI.Core.Windows.UI.Designer" Then
                    If control.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.GridButton" Then
                        PageActionType = Framework.Core.Framework.PageActionType.DataListButtonClick
                    Else
                        If (Mode = PageModeTypes.Change OrElse Mode = PageModeTypes.Correct) AndAlso control.GetType.ToString() = "Core.Windows.UI.Core.Windows.UI.TextBox" Then
                            If DirectCast(control, TextBox).FieldID = "" Then
                                PageActionType = Framework.Core.Framework.PageActionType.InFieldValidation
                            Else
                                PageActionType = Framework.Core.Framework.PageActionType.DesignerClick
                            End If
                        ElseIf (Mode = PageModeTypes.Change OrElse Mode = PageModeTypes.Correct) AndAlso control.GetType.ToString() = "Core.Windows.UI.Core.Windows.UI.DateControl" Then
                            If DirectCast(control, DateControl).FieldID = "" Then
                                PageActionType = Framework.Core.Framework.PageActionType.InFieldValidation
                            Else
                                PageActionType = Framework.Core.Framework.PageActionType.DesignerClick
                            End If
                        ElseIf (Mode = PageModeTypes.Change OrElse Mode = PageModeTypes.Correct) AndAlso control.GetType.ToString() = "Core.Windows.UI.Core.Windows.UI.ComboBox" Then
                            If DirectCast(control, ComboBox).FieldID = "" Then
                                PageActionType = Framework.Core.Framework.PageActionType.InFieldValidation
                            Else
                                PageActionType = Framework.Core.Framework.PageActionType.DesignerClick
                            End If
                        ElseIf (Mode = PageModeTypes.Change OrElse Mode = PageModeTypes.Correct) AndAlso control.GetType.ToString() = "Core.Windows.UI.Core.Windows.UI.Designer" Then
                            PageActionType = Framework.Core.Framework.PageActionType.DesignerClick

                        Else
                            PageActionType = Framework.Core.Framework.PageActionType.InFieldValidation
                        End If

                    End If
                End If
                PageActionObject = control
            ElseIf PageActionType = Framework.Core.Framework.PageActionType.InFieldValidation Then
                PageActionObject = Nothing
                PageActionType = Framework.Core.Framework.PageActionType.NotSet
            End If

            If Not NextControl Is Nothing Then
                PageActionObject = NextControl

                If PageActionObject.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.GridButton" Then
                    PageActionType = Framework.Core.Framework.PageActionType.DataListButtonClick
                End If
                NextControl = Nothing

                ClearSequence()

            End If

            If ControlHadFocus Is Nothing OrElse (Not ControlHadFocus.GetType.ToString() = "Core.Windows.UI.Core.Windows.UI.TextBox" AndAlso
               Not ControlHadFocus.GetType.ToString() = "Core.Windows.UI.Core.Windows.UI.DateControl") Then
                If skipTimeLoad Then
                    Load(Nothing, Nothing)
                Else
                    Dim dt As DispatcherTimer = New DispatcherTimer
                    AddHandler dt.Tick, AddressOf Load
                    dt.Interval = New TimeSpan(0, 0, 0, 0, 100)
                    dt.Start()
                End If

            Else
                Load(Nothing, Nothing)
            End If




            'Thread.Sleep(100)
            'Load(Nothing, Nothing)



        End Sub

        Private Sub Load(sender As Object, e As EventArgs)
            Dim blnCalledByGrid As Boolean = False

            Dim dtime = TryCast(sender, DispatcherTimer)
            If dtime IsNot Nothing Then
                dtime.[Stop]()
            End If
            dtime = Nothing
            skipTimeLoad = False


            '' Set the search wildcard character.
            'm_strGenericRetrievalCharacter = Application(cGenericRetrievalCharacter) & ""
            'If Not Application(cDefaultCentury) Is Nothing Then
            '    m_intDefaultCentury = Application(cDefaultCentury)
            '    ' If we have a 2 digit century, multiply by 100 to give us 
            '    ' the century that we add to the year entered.  (ie. 19 becomes 1900)
            '    If m_intDefaultCentury.ToString.Length = 2 Then
            '        m_intDefaultCentury *= 100
            '    End If
            'End If
            'If Not Application(cInputCenturyFrom) Is Nothing Then
            '    m_intDefaultInputCentury = Application(cInputCenturyFrom).ToString.Split(",")(0)
            '    m_intInputFromYear = Application(cInputCenturyFrom).ToString.Split(",")(1)
            '    ' If we have a 2 digit century, multiply by 100 to give us 
            '    ' the century that we add to the year entered.  (ie. 19 becomes 1900)
            '    If m_intDefaultInputCentury.ToString.Length = 2 Then
            '        m_intDefaultInputCentury *= 100
            '    End If
            'End If

            'SetRunScreenFolderLength()

            'm_strHidControl = Request("hidControl")
            'If m_strHidControl Is Nothing Then
            '    m_strHidControl = String.Empty
            'End If

            'Response.Write("<DIV id='DropList' style='DISPLAY: inline; Z-INDEX: 105; VISIBILITY: hidden; POSITION: absolute; '></DIV>")
            'CoreBodyTag.Attributes.Remove("onload")

            'Page level security checks
            CheckScreenPermissions()

            'CoreWebTrace("Page_Load", "Before UpdateSessionAccessTime")
            ''Update the Last Access Time to the Session Manager
            'UI.SessionInformation.UpdateSessionAccessTime()

            'CoreWebTrace("Page_Load", "After UpdateSessionAccessTime")

            If Me.ScreenType = ScreenTypes.Ghost Then
                DisplayPleaseWait()
            End If


            ' '' Register a function which prompts user before postBack, if Data has changed.
            ''RegisterContinuePostback()

            'If Not IsNothing(Me.Request("__EventTarget")) AndAlso Not IsNothing(Me.FindControl(Me.Request("__EventTarget"))) Then
            '    Dim objControl As Object
            '    objControl = Me.FindControl(Me.Request("__EventTarget"))
            '    If objControl.GetType().ToString = "Core.Windows.UI.Core.Windows.UI.ToolBarImageButton" Then
            '        PageActionType = PageActionType.ToolbarClick
            '        PageActionObject = objControl
            '        PagePrevDesignerObject = objControl
            '    End If
            '    If objControl.GetType().ToString = "Core.Windows.UI.Core.Windows.UI.Designer" Then

            '        If CBool(Me.Request("hidEnableNumberedDesigners")) Then
            '            PagePrevDesignerObject = objControl
            '        Else
            '            If objControl.IsFunctionkey Then
            '                PageFunctionObject = objControl
            '                IsFunctionKey = True

            '                Select Case Mode
            '                    Case PageModeTypes.Correct, PageModeTypes.Entry
            '                        Session(FormName + "_" + Level.ToString + "_NavigationType") = NavigationTypes.Entry

            '                End Select

            '            End If
            '        End If
            '    ElseIf objControl.GetType().ToString = "Core.Windows.UI.Core.Windows.UI.GridButton" Then
            '            PagePrevDesignerObject = objControl
            '    End If

            '    If Not IsNothing(Session(FormName + "_" + Level.ToString + "_NavigationType")) Then
            '        If NavigationType = NavigationTypes.None Then
            '            NavigationType = Session(FormName + "_" + Level.ToString + "_NavigationType")
            '        Else
            '            Session.Remove(FormName + "_" + Level.ToString + "_NavigationType")
            '        End If
            '    End If
            'End If

            '' Determine the ScreenLevel and the Mode 
            '' when the page is first loaded.
            'If Me.IsNewRequest Then

            '    ' Delete the ExitMessage if still exists since we can't display them in menu classes.
            '    ' There should only be an error message if a non-modal screen has a message in the 
            '    ' exit procedure and we open another modal form using the menu.
            '    If Not Me.IsPostBack Then
            '        oMessage = Nothing
            '    End If

            '    ' Set the IsPopup flag.
            '    If Request.QueryString("IsPopup") <> Nothing Then
            '        IsPopup = Request.QueryString("IsPopup")
            '    Else
            '        IsPopup = False
            '    End If

            '    ' Set the ScreenLevel session value 
            '    ' if passed in through the QueryString.
            '    If Request.QueryString("ScreenLevel") <> Nothing Then
            '        Session("ScreenLevel") = Request.QueryString("ScreenLevel")
            '        IsCalledFromMenu = True
            '    End If
            '    If Me.ViewState("ScreenLevel") Is Nothing Then Me.ViewState("ScreenLevel") = Session("ScreenLevel")

            '    ' Set the screen mode if passed in from calling screen or menu.
            '    If Request.QueryString("Mode") <> Nothing Then
            '        Mode = Request.QueryString("Mode")
            '    Else
            '        ' Get the mode passed in from a calling screen.
            '        If Session(FormName + "_" + Level.ToString + "_Mode") <> Nothing Then
            '            Mode = Session(FormName + "_" + Level.ToString + "_Mode")
            '        Else
            '            Mode = PageModeTypes.NoMode
            '        End If
            '    End If

            '    If EventTarget = "Toolbar1$ImageExit" Then
            '        Mode = PageModeTypes.NoMode
            '    End If



            '    ' Ensure controls are enabled properly.
            '    If Mode = PageModeTypes.Entry AndAlso Not IsFunctionKey Then
            '        DesignerMode = False

            '        ' Run the code as if the Add button was pressed.
            '        EventTarget = "Toolbar1$ImageAdd"
            '        If EventArgument = "SKIPALL" Then
            '            m_strPendingBuffer = "SKIPALL"
            '        Else
            '            EventArgument = "SUBMIT"
            '        End If
            '    End If

            '    ' If this is a menu screen, set the mode to Change mode if NoMode.
            '    If Mode = PageModeTypes.NoMode AndAlso IsMenuScreen Then
            '        Mode = PageModeTypes.Change
            '    ElseIf Mode = PageModeTypes.Change OrElse Mode = PageModeTypes.Correct Then
            '        If Not Me.Slave Then
            '            Mode = PageModeTypes.NoMode
            '        End If
            '    End If

            '    If Not Me.UseAcceptProcessing Then
            '        If Mode = PageModeTypes.Find Then
            '            Me.ViewState("CurrentMode") = "F"   ' Used during infieldvalidation for non-AcceptProcessing.
            '        ElseIf Mode = PageModeTypes.Entry Then
            '            Me.ViewState("CurrentMode") = "E"   ' Used during infieldvalidation for non-AcceptProcessing.
            '        End If
            '    End If

            '    'Set DesignerMode to fale if Page is in Find Mode.
            '    If Mode = PageModeTypes.Find Then
            '        DesignerMode = False
            '    End If

            '    ' Set the IsDirty flag to false the first time the page is loaded.
            '    IsDirty = False

            '    ' Reset the record counters.
            '    NavigationRecordCount = 0
            '    CurrentRecordNumber = 0
            '    CurrentPageSetNumber = 0
            '    CurrentPageNumber = 0

            '    ' Ensure that if we click the hyperlink from the menu to call the current screen
            '    ' again, that the previous values are cleared.
            '    If Not Me.IsPostBack Then
            '        If ControlsCleared = False AndAlso Not IsFunctionKey Then
            '            m_strHidControl = String.Empty
            '            m_htSearchTypes = New Hashtable
            '            RaiseClearControls()
            '            ControlsCleared = True
            '        End If
            '    End If
            'End If

            '' Add any existing messages from the previous postback (ie. In case of append 
            '' where the next row is automatically being prompted for). (Warnings and Info only)
            'If Not GlobalSession("Messages") Is Nothing Then
            '    If GlobalSession("Messages").GetType.FullName.IndexOf("stcMessage") > -1 Then
            '        AddMessage(CType(GlobalSession("Messages"), Common.stcMessage))
            '    Else
            '        AddMessage(CType(GlobalSession("Messages"), Collection))
            '    End If
            '    RemoveGlobalSession("Messages")
            'End If

            ' Retrieve the search types.
            m_htSearchTypes = SearchType

            'Set PageId that can be used to store and retrieve Internal Session
            m_strPageId = m_strPageName + "_" + Level.ToString

            CoreWebTrace("Page_Load", "Before SetGlobalizationManager")
            SetGlobalizationManager()
            CoreWebTrace("Page_Load", "After SetGlobalizationManager")

            CoreWebTrace("Page_Load", "Before Load Dictionaries")

            'RaiseEvent LoadValues()
            CoreWebTrace("Page_Load", "After Load Dictionaries")

            CoreWebTrace("Page_Load", "Before SetTableColumns")
            SetTableColumns()
            CoreWebTrace("Page_Load", "After SetTableColumns")

            CoreWebTrace("Page_Load", "Before RetrieveParamsReceived")
            ' Retrieve any params passed from a Calling Screen
            If InitializeExecuted = Nothing Then

                Try
                    RetrieveParamsReceived()
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
            End If

            CoreWebTrace("Page_Load", "After RetrieveParamsReceived")

            ' Any code for which Init event is too early and Load Event is too late, 
            ' should be written in ControlsLoad EventHandler
            CoreWebTrace("Page_Load", "Before ControlsLoad")
            If PageActionType <> Framework.Core.Framework.PageActionType.DataListButtonClick AndAlso ToolbarAction = ToolbarIcons.NotSet AndAlso (Mode = PageModeTypes.Change OrElse Mode = PageModeTypes.Correct) Then
                RaiseEvent ControlsLoad(ControlHadFocus, Nothing)
            End If

            If IsFunctionKey = True Then
                'If Not IsNothing(PagePrevDesignerObject) Then
                'PageActionObject = PagePrevDesignerObject
                If PageActionObject.GetType().ToString = "Core.Windows.UI.Core.Windows.UI.GridButton" Then
                    PageActionType = PageActionType.DataListButtonClick
                    m_blnCallPerformOperation = True
                ElseIf PageActionObject.GetType().ToString = "Core.Windows.UI.Core.Windows.UI.ToolBarImageButton" OrElse PageActionObject.ToString = "Core.Windows.UI.Core.Windows.UI.ToolBarImageButton" Then
                    PageActionType = PageActionType.ToolbarClick
                    m_blnCallPerformOperation = True
                Else
                    PageActionType = PageActionType.DesignerClick
                End If

            ElseIf Mode = PageModeTypes.Entry Then
                m_blnCallPerformOperation = True

                'ElseIf Not IsNothing(PagePrevDesignerObject) AndAlso Mode = PageModeTypes.Entry Then
                'Else
                '    m_blnCallPerformOperation = True
            End If

            CoreWebTrace("Page_Load", "After ControlsLoad")

            'm_strRequestedControlFocus = Request("RequestedControlFocus") & ""

            'Call overridable method to set any Relation to handle Record Navigation events in a FileObjects
            If Me.PageActionType <> PageActionType.InFieldValidation Then
                If m_NavigationType <> NavigationTypes.Cancel Then 'AndAlso m_NavigationType <> NavigationTypes.Entry Then
                    Dim blnSessionForInfieldValidation As Boolean = True

                    If m_blnSubmit Then
                        blnSessionForInfieldValidation = False
                    End If
                    If m_NavigationType = NavigationTypes.Delete Then
                        blnSessionForInfieldValidation = False
                    End If

                    Select Case Me.PageActionType
                        Case PageActionType.DataListButtonClick, PageActionType.InFieldValidation
                            blnSessionForInfieldValidation = True
                        Case PageActionType.DesignerClick
                            blnSessionForInfieldValidation = True
                            m_blnCallPerformOperation = True
                        Case PageActionType.PaginationClick
                            blnSessionForInfieldValidation = False
                            m_blnCallPerformOperation = True
                        Case PageActionType.ToolbarClick
                            If EventTarget.Equals("Toolbar1$ImageExit") Then
                                blnSessionForInfieldValidation = True
                                m_blnCallPerformOperation = True
                            End If
                        Case PageActionType.NotSet
                            If Not (Me.Mode = PageModeTypes.NoMode OrElse Me.Mode = PageModeTypes.Unknown) Then
                                m_blnCallPerformOperation = True
                            End If
                    End Select

                    ' Accept processing uses main state.
                    If UseAcceptProcessing Then blnSessionForInfieldValidation = False

                    ' During Add we don't want to retrieve State from Session otherwise it keeps previous records in FileObject
                    ' Which does not Add New Records as NewRecord property returns false
                    ' In Find we don't need to retrieve from Session Variables
                    If Me.NavigationType <> NavigationTypes.Entry AndAlso Me.NavigationType <> NavigationTypes.Find _
                    AndAlso NavigationType <> NavigationTypes.First AndAlso NavigationType <> NavigationTypes.Next _
                    AndAlso NavigationType <> NavigationTypes.Previous AndAlso NavigationType <> NavigationTypes.Last _
                    AndAlso Me.PageActionType <> PageActionType.PaginationClick Then
                        If HasGrid Then
                            If blnBackout Then
                                blnBackout = False
                            End If
                            m_blnCallPerformOperation = True
                            blnCalledByGrid = True
                        Else
                            If Not (NavigationType = NavigationTypes.Submit AndAlso (Mode = PageModeTypes.Find Or Mode = PageModeTypes.Entry)) Then
                                If blnBackout Then
                                    blnBackout = False
                                End If
                            End If
                        End If
                    ElseIf Me.NavigationType = NavigationTypes.Entry OrElse Me.NavigationType = NavigationTypes.Find AndAlso blnBackout Then
                        ' Ensure that if we did a backout, and then we do a Find or Entry,
                        ' that we remove the Backout value.
                        blnBackout = False
                    End If


                End If
            End If

            CoreWebTrace("Page_Load", "Before BindFields")
            BindFields()
            CoreWebTrace("Page_Load", "After BindFields")

            If InitializeExecuted = Nothing Then
                SetRelations()
                CallPagePostProcess()
            End If

            If PageActionType = Framework.Core.Framework.PageActionType.InFieldValidation AndAlso ToolbarAction = ToolbarIcons.NotSet AndAlso ControlHadFocus.GetType.ToString <> "Core.Windows.UI.Core.Windows.UI.Designer" Then
                If ControlHadFocus.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.TextBox" Then
                    PerformOperation(DirectCast(ControlHadFocus, TextBox))
                ElseIf ControlHadFocus.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.DateControl" Then
                    PerformOperation(DirectCast(ControlHadFocus, DateControl))
                ElseIf ControlHadFocus.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.ComboBox" Then
                    PerformOperation(DirectCast(ControlHadFocus, ComboBox))
                End If



            Else
                ' Call the generic PerformOperation.

                CoreWebTrace("Page_Load", "Before PerformOperation")
                If Me.UseAcceptProcessing Then
                    PerformOperationForAcceptProcessing(m_blnSubmit, m_blnLanguageChanged, blnCalledByGrid)
                Else
                    PerformOperation(m_blnSubmit, m_blnLanguageChanged, blnCalledByGrid)
                End If
                CoreWebTrace("Page_Load", "After PerformOperation")

            End If


            If (TotalPages > 0 AndAlso CurrentPageNumber = 0) Then
                CurrentPageNumber = 1
            End If



            Thread.Sleep(100)


            '    Dim dt As DispatcherTimer = New DispatcherTimer
            '    AddHandler dt.Tick, AddressOf RaiseEvents
            '    dt.Interval = New TimeSpan(0, 0, 0, 0, 200)
            '    dt.Start()



            'End Sub



            'Public Sub RaiseEvents(sender As Object, e As EventArgs)
            '    Dim dt = TryCast(sender, DispatcherTimer)
            '    If dt IsNot Nothing Then
            '        dt.[Stop]()
            '    End If
            '    dt = Nothing

            CoreWebTrace("Page_Load", "End Page_Load")

            If TotalGridRecords = 0 Then
                TotalPages = 0
                CurrentPageNumber = 0
            End If

            If Mode = PageModeTypes.NoMode Then
                IsDirty = False
            End If

            RaiseEvent ClearValues()
            RaiseEvent ChangeToolBarDisplay()
            RaiseEvent DisplayControl()
            ApplicationState.Current.Navigate = False

            If m_colMessages.Count > 0 Then

                Dim message As String
                Dim autoclose As Boolean = True
                Dim m As stcMessage
                For Each m In m_colMessages
                    message = message + m.Text
                    If m.Type = MessageTypes.Severe OrElse m.Type = MessageTypes.Error Then
                        autoclose = False
                    End If
                Next


                Try
                    DisplayAlert(message, autoclose)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

                m_colMessages = New ArrayList


            End If


            If m_strPush.Length > 0 Then
                Dim arrPush As String() = m_strPush.Split(",")
                m_strPush = ""
                Dim count = arrPush.Count - 1
                For i As Integer = 0 To arrPush.Count - 1
                    If count < 0 Then Exit For
                    If arrPush(count) = "Update" Then
                        PageActionType = PageActionType.ToolbarClick
                        NavigationType = NavigationTypes.Submit
                        CallPerformOperation = True
                        Submit = True
                        ToolbarAction = ToolbarIcons.Submit
                        CallSetVariables()
                        skipTimeLoad = True
                        Page_Load()
                    ElseIf arrPush(count) = "Return" Then
                        CallExit()
                    ElseIf arrPush(count) = "Find" Then
                        ClearSequence()
                        ResetGridVariables()
                        NavigationType = NavigationTypes.Find
                        CallPerformOperation = True
                        ResetAppendVariables()
                        PageActionType = PageActionType.ToolbarClick
                        ToolbarAction = ToolbarIcons.Find
                        CallSetVariables()
                        skipTimeLoad = True
                        Page_Load()

                    Else
                        Dim control As Control = Me.FindChild(Of Control)(arrPush(count))


                        If Not control Is Nothing AndAlso control.GetType.ToString = "Core.Windows.UI.Core.Windows.UI.Designer" Then
                            PageActionType = PageActionType.DesignerClick
                            skipTimeLoad = True
                            Page_Load(control)
                        End If

                    End If

                    count = count - 1

                Next

            End If



            Mouse.OverrideCursor = Cursors.Arrow
            ControlHadFocus = ControlHasFocus

            If firstcontrol Then
                'Dim cons = Me.GetDescendants(Of Control)
                'Dim c As Control 
                'For Each c in cons.Where(c.GetType.ToString.IndexOf("Core.Windows.UI.Core.Windows.UI.") >=0)

                'next


            End If
            firstcontrol = False
        End Sub


        Public Function GetHelpScreensHashTable(ByVal Language As String, ByVal FieldId As String) As Hashtable
            If helpScreens Is Nothing Then
                LoadHelpScreens()
            End If

            If colDictionaryKeys.Contains(Language.ToLower) Then
                Return helpScreens(CInt(colDictionaryKeys.Item(Language.ToLower))).GetDictionaryHashTable(FieldId)
            Else
                Return helpScreens(CInt(colDictionaryKeys.Item(colDictionaryKeys.Keys(0).ToLower))).GetDictionaryHashTable(FieldId)
            End If
        End Function

        Public Function GetHelpScreenItem(ByVal Language As String, ByVal FieldId As String) As HelpScreensItem
            If helpScreens Is Nothing Then
                LoadHelpScreens()
            End If

            If colDictionaryKeys.Contains(Language) Then
                Return helpScreens(CInt(colDictionaryKeys.Item(Language))).GetDictionaryItem(FieldId)
            Else
                ' There is no dictionary for the passed Language
                Return Nothing
            End If
        End Function

        Private Sub LoadHelpScreens()


            Dim nvcDictionarySettings As NameValueCollection = CType(System.Configuration.ConfigurationManager.GetSection("coreAppSettings/Dictionaries"), NameValueCollection)

            With nvcDictionarySettings
                'Declare a loca variable to hold multiple Dictionaries
                Dim objDictionaries(.Count - 1) As HelpScreens

                '
                colDictionaryKeys = New HybridDictionary
                For i As Integer = 0 To .Count - 1
                    colDictionaryKeys.Item(nvcDictionarySettings.Keys.Item(i)) = i
                    'We are not checking whether Dictionary File is exist or not
                    'So Path Provided in Web.Confi for Dictionary File should point to
                    'a valid Dictionary File

                    If File.Exists(nvcDictionarySettings.Item(i)) Then
                        objDictionaries(i) = New HelpScreens(nvcDictionarySettings.Item(i))
                    Else
                        objDictionaries(i) = New HelpScreens(System.IO.Path.GetDirectoryName(Process.GetCurrentProcess().MainModule.FileName) + nvcDictionarySettings.Item(i))
                    End If


                Next

                helpScreens = objDictionaries
            End With
        End Sub


        ''' --- CheckScreenPermissions ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CheckScreenPermissions.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub CheckScreenPermissions()
            'Note: If this code ever need to change, also make similar changes
            'in ApplicationPage.vb's Load event handler
            Dim objSecurityManager As New Framework.Core.Security.SecurityManager
            Dim intSecurityMenuEntry As Integer = 0
            Dim intSecurityMenuFind As Integer = 0
            Dim intSecurityMenuChange As Integer = 0
            Dim intSecurityMenuDelete As Integer = 0
            Dim intScreenActivityRights As ScreenActivities




            intScreenActivityRights = objSecurityManager.CheckPermissions(Me.FormName, intSecurityMenu)





            If intSecurityMenu = 2 Then
                If EntryActivity Then
                    If ((intScreenActivityRights And ScreenActivities.Entry) <> ScreenActivities.None) Then
                    Else
                        DisableSecurityEntry = True
                    End If
                End If
                If FindActivity Then
                    If ((intScreenActivityRights And ScreenActivities.Find) <> ScreenActivities.None) Then
                    Else
                        DisableSecurityFind = True
                    End If
                End If
                If ChangeActivity Then
                    If ((intScreenActivityRights And ScreenActivities.Change) <> ScreenActivities.None) Then
                    Else
                        DisableSecurityChange = True
                    End If

                End If
                If DeleteActivity Then
                    If ((intScreenActivityRights And ScreenActivities.Delete) <> ScreenActivities.None) Then
                    Else
                        DisableSecurityDelete = True
                    End If
                End If
            End If

            If Not EntryActivity And Not FindActivity And Not ChangeActivity Then
                objSecurityManager.NoPermissions(Me.FormName)
            End If

            objSecurityManager = Nothing

            intScreenActivityRights = Nothing
        End Sub

        ''' --- SetGlobalizationManager --------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SetGlobalizationManager.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Sub SetGlobalizationManager()

            If IsNothing(ApplicationState.Current.Language) OrElse ApplicationState.Current.Language = "" Then

                Dim nvcLanguageSettings As NameValueCollection = CType(System.Configuration.ConfigurationManager.GetSection("coreAppSettings/Dictionaries"), NameValueCollection)
                With nvcLanguageSettings
                    Dim arrLanguage(.Count - 1) As String
                    For i As Integer = 0 To .Count - 1
                        arrLanguage(i) = nvcLanguageSettings.Keys.Item(i).ToString
                    Next

                    For Each l As String In arrLanguage
                        If l.ToUpper = Thread.CurrentThread.CurrentCulture.ToString.ToUpper Then
                            ApplicationState.Current.Language = Thread.CurrentThread.CurrentCulture.ToString
                        End If
                    Next

                    If IsNothing(ApplicationState.Current.Language) OrElse ApplicationState.Current.Language = "" Then
                        ApplicationState.Current.Language = arrLanguage(0)

                    End If

                End With


            End If

            GlobalizationManager = New Globalization.Core.Globalization.GlobalizationManager(ApplicationState.Current.Language)


            Dim dateInfo = New DateTimeFormatInfo()
            dateInfo.ShortDatePattern = ApplicationState.Current.DateFormat
            dateInfo.LongDatePattern = ApplicationState.Current.DateFormat


            System.Threading.Thread.CurrentThread.CurrentCulture.DateTimeFormat = dateInfo
            System.Threading.Thread.CurrentThread.CurrentUICulture.DateTimeFormat = dateInfo


        End Sub

        ''' --- ReturnRoundedTime ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Returns an 8 digit time number as a 4 digit rounded number.
        ''' </summary>
        ''' <param name="Value">The time value as a string.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function ReturnRoundedTime(ByVal Value As String) As String

            If IsNumeric(Value) AndAlso Value.Trim.Length > 4 Then
                Return CInt(Value.Substring(0, 5) / 10)
            Else
                If Value.TrimEnd.Length = 0 Then
                    Return "0"
                Else
                    Return Value.Substring(0, 4)
                End If
            End If

        End Function

        ''' --- GetString ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Retrieves the string value of the key passed in.
        ''' </summary>
        ''' <param name="key">A String containing the name of the key to search for.</param>
        ''' <param name="ResourceType">A Resource Type which contains the desired key and corresponding value.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetString(ByVal key As String, ByVal ResourceType As Globalization.Core.Globalization.ResourceTypes) As String

            Return GlobalizationManager.GetString(key, ResourceType)

        End Function

        ''' --- RaiseProcessGridRecords --------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RaiseProcessGridRecords.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RaiseProcessGridRecords()

            RaiseEvent ProcessGridRecords()

        End Sub

        ''' --- RaiseDeleteGridRecords ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RaiseDeleteGridRecords.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RaiseDeleteGridRecords()

            RaiseEvent DeleteGridRecords()

        End Sub

        ''' --- RaiseShowGrid ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RaiseShowGrid.
        ''' </summary>
        ''' <param name="NoRecordsFound"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RaiseShowGrid(ByVal NoRecordsFound As Boolean, Optional ByVal GridLoaded As Boolean = False)
            If NoRecordsFound Then
                NoRecordFound = True
            Else
                NoRecordFound = False
            End If

            If GridLoaded Then
                IsGridLoaded = True
            Else
                IsGridLoaded = False
            End If

            If ShowGridEventEvent Is Nothing Then
                Dim dt As DispatcherTimer = New DispatcherTimer
                AddHandler dt.Tick, AddressOf ShowGrid
                dt.Interval = New TimeSpan(0, 0, 0, 0, 400)
                dt.Start()
            Else
                ShowGrid(Nothing, Nothing)
            End If





        End Sub
        Private NoRecordFound As Boolean
        Private IsGridLoaded As Boolean

        Public Sub ShowGrid(sender As Object, e As EventArgs)
            Dim dt = TryCast(sender, DispatcherTimer)
            If dt IsNot Nothing Then
                dt.[Stop]()
            End If
            dt = Nothing

            RaiseEvent ShowGridEvent(NoRecordFound, IsGridLoaded)
        End Sub


        ''' --- SetRelations -------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Use SetRelations to bind the grid to the associated occurring File class or Temporary class.
        ''' </summary>
        ''' <remarks>
        ''' The SetRelations is generated in the screen by the Renaissance Architect PreCompiler.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Overridable Sub SetRelations()

            'In derived page set any Relation to handle Record Navigation events in a FileObjects

        End Sub

        '-------------------------------------------------------------------
        ' Name: ScreenWasRun    
        ' Function: This function determines if the run screen was already
        '           run based on the sequence of screens run within a given
        '           procedural path (ie. when updating a record).
        ' Example: ScreenWasRun(RunScreenName, Me.Level + 1, 
        '           m_intRunScreenSequence) returns FALSE.
        '-------------------------------------------------------------------
        ''' --- ScreenWasRun -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ScreenWasRun.
        ''' </summary>
        ''' <param name="RunScreenName"></param>
        ''' <param name="ScreenLevel"></param>
        ''' <param name="ScreenSequence"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function ScreenWasRun(ByVal RunScreenName As String, ByVal ScreenLevel As Integer, ByVal ScreenSequence As Integer) As Boolean

            If Substring(m_strRunFlag, m_intRunScreenSequence, 1) = "Y" Then
                Return True
            Else
                Return False
            End If

        End Function

        ''' --- GetParmValue -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Determines whether Object is a FILE or TEMPORARY.
        ''' </summary>
        ''' <param name="Parm">An Object which to determine its value.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <example>CalledPageSession(RunScreenName, Me.Level + 1, "PARM1") = GetParmValue(Parm1)</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Function GetParmValue(ByRef Parm As Object, Optional ByVal GetValues As Boolean = False) As Object

            Select Case Parm.GetType.ToString
                Case "Core.Windows.UI.Core.Windows.OracleFileObject", "Core.Windows.UI.Core.Windows.SqlFileObject", "Core.Windows.UI.Core.Windows.IfxFileObject"
                    Return CType(Parm, IFileObject).GetInternalValues(True)
                Case "Core.Windows.UI.Core.Windows.CoreCharacter"
                    If GetValues AndAlso CType(Parm, Core.Windows.CoreCharacter).Occurs > 1 Then
                        Return CType(Parm, Core.Windows.CoreCharacter).Values
                    Else
                        Return CType(Parm, Core.Windows.CoreCharacter).Value
                    End If
                Case "Core.Windows.UI.Core.Windows.CoreVarChar"
                    Return CType(Parm, Core.Windows.CoreVarChar).Value
                Case "Core.Windows.UI.Core.Windows.CoreDecimal"
                    Return CType(Parm, Core.Windows.CoreDecimal).Value
                Case "Core.Windows.UI.Core.Windows.CoreInteger"
                    Return CType(Parm, Core.Windows.CoreInteger).Value
                Case "Core.Windows.UI.Core.Windows.CoreDate"
                    Return CType(Parm, Core.Windows.CoreDate).Value
                Case "Core.Framework.Core.Framework.DCharacter"
                    Return CType(Parm, DCharacter).Value
                Case "Core.Framework.Core.Framework.DVarChar"
                    Return CType(Parm, DVarChar).Value
                Case "Core.Framework.Core.Framework.DDecimal"
                    Return CType(Parm, DDecimal).Value
                Case "Core.Framework.Core.Framework.DInteger"
                    Return CType(Parm, DInteger).Value
                Case "Core.Framework.Core.Framework.DDate"
                    Return CType(Parm, DDate).Value
                Case "System.String"
                    Return CType(Parm, String)
            End Select
            Return Nothing
        End Function

        ''' --- SetParmValue -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Sets the value of an object.
        ''' </summary>
        ''' <param name="Parm">An Object which to assign a value to.</param>
        ''' <param name="ReturnValue"></param>
        ''' <remarks>
        ''' <note>This method should only be called from RetrieveParamsReceived.</note>
        ''' </remarks>
        ''' <example>SetParmValue(Parm1, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM1"))</example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Sub SetParmValue(ByRef Parm As Object, ByVal ReturnValue As Object)
            'Note: This method should only be called from RetrieveParamsReceived
            SetParmValue(Parm, ReturnValue, True)
        End Sub

        ''' --- SetParmValue -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Sets the value of an object.
        ''' </summary>
        ''' <param name="Parm">An Object which to assign a value to.</param>
        ''' <param name="ReturnValue"></param>
        ''' <param name="CalledFromRetrieveParamsReceived"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Sub SetParmValue(ByRef Parm As Object, ByVal ReturnValue As Object, ByVal CalledFromRetrieveParamsReceived As Boolean, ByVal ParmSequence As Integer)

            If ReturnValue Is Nothing Then Return

            Select Case Parm.GetType.ToString
                Case "Core.Windows.UI.Core.Windows.OracleFileObject", "Core.Windows.UI.Core.Windows.SqlFileObject", "Core.Windows.UI.Core.Windows.IfxFileObject"
                    With CType(Parm, IFileObject)
                        Dim cnnPreviousConnection As IDbConnection
                        Dim trnPreviousTransaction As IDbTransaction
                        cnnPreviousConnection = .Connection
                        trnPreviousTransaction = .Transaction
                        .SetInternalValues(ReturnValue, True, ParmSequence)
                        .Connection = cnnPreviousConnection
                        .Transaction = trnPreviousTransaction
                    End With
                Case "Core.Windows.UI.Core.Windows.CoreCharacter"
                    With CType(Parm, Core.Windows.CoreCharacter)
                        If CalledFromRetrieveParamsReceived Then
                            .HasReceivedValue = True
                            If Not ReturnValue.GetType.ToString = "System.String[]" Then
                                .InitialValue = CStr(ReturnValue)
                            End If
                        End If
                        If ReturnValue.GetType.ToString = "System.String[]" Then
                            .Values = ReturnValue
                        Else
                            .Value = CStr(ReturnValue)
                        End If
                    End With
                Case "Core.Windows.UI.Core.Windows.CoreVarChar"
                    With CType(Parm, Core.Windows.CoreVarChar)
                        If CalledFromRetrieveParamsReceived Then
                            .HasReceivedValue = True
                            .InitialValue = CStr(ReturnValue)
                        End If
                        .Value = CStr(ReturnValue)
                    End With
                Case "Core.Windows.UI.Core.Windows.CoreDecimal"
                    With CType(Parm, Core.Windows.CoreDecimal)
                        If CalledFromRetrieveParamsReceived Then
                            .HasReceivedValue = True
                            .InitialValue = CDec(ReturnValue)
                        End If
                        .Value = CDec(ReturnValue)
                    End With
                Case "Core.Windows.UI.Core.Windows.CoreInteger"
                    With CType(Parm, Core.Windows.CoreInteger)
                        If CalledFromRetrieveParamsReceived Then
                            .HasReceivedValue = True
                            .InitialValue = CDec(ReturnValue)
                        End If
                        .Value = CDec(ReturnValue)
                    End With
                Case "Core.Windows.UI.Core.Windows.CoreDate"
                    With CType(Parm, Core.Windows.CoreDate)
                        If CalledFromRetrieveParamsReceived Then
                            .HasReceivedValue = True
                            .InitialValue = CDec(ReturnValue)
                        End If
                        .Value = CDec(ReturnValue)
                    End With
            End Select
        End Sub

        ''' --- SetParmValue -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Sets the value of an object.
        ''' </summary>
        ''' <param name="Parm">An Object which to assign a value to.</param>
        ''' <param name="ReturnValue"></param>
        ''' <param name="CalledFromRetrieveParamsReceived"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Sub SetParmValue(ByRef Parm As Object, ByVal ReturnValue As Object, ByVal CalledFromRetrieveParamsReceived As Boolean)

            SetParmValue(Parm, ReturnValue, CalledFromRetrieveParamsReceived, 0)

        End Sub

        ''' --- DisplayMessagesFromRunScreen -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Displays the messages returned from the RunScreen.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub DisplayMessagesFromRunScreen(ByVal Key As String)

            ' Display the messages that may have been created in the RunScreen (Initialize or Exit procedures).
            ' These need to be displayed in the current screen.
            If oMessage.Number > 0 Then

                AddMessage(oMessage)

                ' Determine if one of the messages is an ERROR/SEVERE message.
                If blnPassedMessagesError Then
                    blnPassedMessagesError = False

                    ' Delete the sessions that were created for this run screen.


                    ThrowCustomApplicationException(cAddMessageError)
                Else
                    blnPassedMessagesError = False

                    ' Delete the sessions that were created for this run screen.

                End If
                oMessage = Nothing

            Else
                ' Delete the sessions that were created for this run screen.

            End If

        End Sub

        ''' --- SetRunScreenMemberVariables -------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Sets the m_strRunScreenFolder value and returns the name of the run screen.
        ''' </summary>
        ''' <param name="RunScreenName">The screen to run.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub SetRunScreenMemberVariables(ByRef RunScreenName As String)

            ' Remove/create the folder name for the runscreen.
            If RunScreenName.IndexOf("/") > -1 Then
                Dim intLastIndex As Integer = RunScreenName.LastIndexOf("/")
                m_strRunScreenFolder = RunScreenName.Substring(0, intLastIndex)
                If m_strRunScreenFolder.Substring(0, 1) = "/" Then m_strRunScreenFolder = m_strRunScreenFolder.Substring(1)
                RunScreenName = RunScreenName.Substring(intLastIndex + 1)
            Else
                m_strRunScreenFolder = RunScreenName.Substring(0, Me.RunScreenFolderLength)
            End If

        End Sub


        ''' --- RunScreen ----------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Call a lower-level screen.
        ''' </summary>
        ''' <param name="RunScreen">The ghost screen class to be run.</param>
        ''' <param name="RunScreenMode">The mode for the subscreen.  Select one of the following modes: <br/>
        ''' NoneSelected <br/>
        ''' Find <br/>
        ''' Entry  <br/>
        ''' Select <br/>
        ''' Null <br/>
        ''' Same <br/>
        ''' Ghost<br/>
        ''' </param>
        ''' <param name="Parm1">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm2">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm3">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm4">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm5">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm6">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm7">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm8">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm9">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm10">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm11">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm12">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm13">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm14">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm15">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm16">The File or Tempory class that is passed to the called screen.</param>
        ''' <remarks>
        ''' If no mode is passed in, then the default is Entry if this screen is invoked during the Entry sequence.
        ''' </remarks>
        ''' <example>
        ''' RunScreen(SC0100.GetSC0100(Me.Level + 1),  RunScreenModes.Find, T_EMP_ID) <br/>
        ''' RunScreen(SC0100.GetSC0100(Me.Level + 1), , T_EMP_ID) <br/>
        ''' RunScreen(SC0100.GetSC0100(Me.Level + 1),  RunScreenModes.Same, fleEMPLOYEE) <br/>
        ''' RunScreen(SC0100.GetSC0100(Me.Level + 1),  RunScreenModes.Find, fleEMPLOYEE, T_EMP_ID, T_ADDRESS_ID, flePOSITION) <br/>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        ''' 
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub RunScreen(objRunScreen As BaseClassControl, ByVal RunScreenMode As RunScreenModes)
            Dim arrRunscreen() As Object = Nothing
            RunScreen(objRunScreen, RunScreenMode, arrRunscreen)
        End Sub

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub RunScreen(objRunScreen As BaseClassControl, ByVal blnOverRideView As Boolean, ByVal RunScreenMode As RunScreenModes, ByRef arrRunscreen() As Object)


            Try

                RunScreen(objRunScreen, RunScreenMode, arrRunscreen)

            Catch ex As CustomApplicationException

                If ex.Message = cRunScreenException.ToString Then

                    If blnOverRideView Then
                        blnOverRideRunscreenClear = True

                        If HasGrid Then
                            RaiseShowGrid(False)
                        End If

                        CallDisplayFormatting()

                    End If
                End If

                Throw ex

            Catch ex As Exception

                Throw ex

            End Try


        End Sub

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub RunScreen(RunScreen As BaseClassControl, ByVal RunScreenMode As RunScreenModes, ByRef arrParm() As Object)


            Dim intSequence As Integer
            Dim strSequence As String
            Dim strRunscreenReturnToStop As String = RunscreenReturnToStop + ""
            Dim blnReturnStopScreen As Boolean = ReturnStopScreen

            If m_blnExecutingUpdate Then

                ' Commit the default transaction (TRANS_UPDATE).
                Try
                    TRANS_UPDATE(TransactionMethods.Commit)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
                Try
                    ExecuteNamedTransactions(TransactionMethods.Commit)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
            End If

            If Not Me.UseAcceptProcessing OrElse (Me.UseAcceptProcessing AndAlso m_strControlName.Length > 0) Then
                m_intRunScreenSequence += 1
                intSequence = m_intRunScreenSequence
                strSequence = m_strControlName + intSequence.ToString
            Else
                m_intProcedureRunScreenSequence += 1
                intSequence = m_intProcedureRunScreenSequence
                strSequence = "P" + intSequence.ToString
            End If

            ' The AcceptProcessing version uses a hashtable since we store
            ' the screens that were run on a field by field basis as well
            ' as from a procedural level. This is done for moving to a previous
            ' control.
            ' Example:  Key,        Value
            '          "fldA",      "YY"
            '          "fldB",      "Y"
            '          "Procedure", "Y"

            Dim blnMethodWasExecuted As Boolean
            If Me.UseAcceptProcessing Then
                blnMethodWasExecuted = MethodWasExecuted(m_htRunFlag, intSequence)
            Else
                blnMethodWasExecuted = MethodWasExecuted(m_strRunFlag, intSequence)
            End If

            If Not blnMethodWasExecuted Then
                ' Save the sequence information and set a flag indicating screen was run.
                If Me.UseAcceptProcessing Then
                    SetMethodExecutedFlag(m_htRunFlag, "RUN_FLAG", intSequence)
                Else
                    SetMethodExecutedFlag(m_strRunFlag, "RUN_FLAG", intSequence)
                End If

                RunScreen.Level = Me.Level + 1
                RunScreen.ScreenSequence = strSequence

                ' Save the parameters passed to the RUN SCREEN.
                If Not IsNothing(arrParm) AndAlso arrParm.Length > 0 Then
                    For i As Integer = 0 To arrParm.Length - 1
                        If Not (arrParm(i) Is Nothing) Then
                            Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM" + (i + 1).ToString, strSequence) = GetParmValue(arrParm(i))
                        End If
                    Next
                End If


                ' If we are performing a skip all, don't execute the run screen.
                ' Only call Exit Sub if a screen that was not called before.  For screens 
                ' that have been called, we need to re-run the code after the runscreen call
                ' to retrieve the updated values.
                If IsSkipAll() And Not blnMethodWasExecuted Then
                    Exit Sub
                End If

                ' Track the total sessions, so we can remove these upon returning from the run screen.
                'Session(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString) = Session.Count

                ' Default: E for subscreen invoked during the standard entry procedure, otherwise NULL.
                If RunScreenMode = RunScreenModes.NoneSelected Then
                    If Me.Mode = PageModeTypes.Entry Then
                        RunScreenMode = RunScreenModes.Entry
                    End If
                End If

                If RunScreenMode = RunScreenModes.Same Then
                    If FindMode Then
                        RunScreenMode = RunScreenModes.Find
                    ElseIf EntryMode OrElse CorrectMode Then
                        RunScreenMode = RunScreenModes.Entry
                    Else
                        RunScreenMode = RunScreenModes.NoneSelected
                    End If
                End If

                m_strRunScreen = RunScreen.Name

                'Treating RunScreen as the Ghost Screen, which is used in ReturnAndClose for not throwing an exception
                RunScreen.ScreenType = ScreenTypes.Ghost

                'Session(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_ScreenSequence") = strSequence
                ApplicationState.Current.ScreenLevel = Me.Level + 1
                Try
                    RunScreen.CallInitialize(RunScreenMode)
                Catch ex As CustomApplicationException
                    If ex.Message = cMenuRunScreenException.ToString Then
                        'm_strRunScreen = GlobalSession("RunScreenName")
                        SetRunScreenMemberVariables(m_strRunScreen)
                        ' Remove the value from m_htRunFlag so that we run through 
                        ' the code again on the postback.
                        ClearMethodExecutedFlag(m_htRunFlag, "RUN_FLAG", intSequence)
                    Else
                        ' If a message was thrown on the previous screen, display it in the current screen.
                        DisplayMessagesFromRunScreen(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString)
                    End If

                    If ex.Message <> cReturn.ToString Then
                        If ex.Message = cMenuRunScreenException.ToString Then
                            ThrowCustomApplicationException(cRunScreenException)
                        Else
                            Throw ex
                        End If
                    End If
                Catch ex As Exception
                    ' If a message was thrown on the previous screen, display it in the current screen.
                    DisplayMessagesFromRunScreen(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString)

                    ' Write the exception to the event log and throw an error.
                    ExceptionManager.Publish(ex)
                End Try
                blnMethodWasExecuted = True
            End If

            If blnMethodWasExecuted Then


                ' Reset the m_strRunScreen variable.
                m_strRunScreen = String.Empty

                ' Decrement the ScreenLevel.
                ApplicationState.Current.ScreenLevel = Me.Level

                '' Remove the Mode and ScreenSequence session information for the screen called.
                'If Session(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_ScreenSequence") & "" = strSequence.ToString Then
                '    Session.Remove(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_Mode")
                '    Session.Remove(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_ScreenSequence")
                'End If

                ' Retrieve the parameters back from m_objSession.
                If Not IsNothing(arrParm) AndAlso arrParm.Length > 0 Then
                    For i As Integer = 0 To arrParm.Length - 1
                        If Not (arrParm(i) Is Nothing) Then
                            SetParmValue(arrParm(i), Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM" + (i + 1).ToString, strSequence), False)
                        End If
                    Next
                End If


                ' If a message was thrown on the previous screen, display it in the current screen.
                DisplayMessagesFromRunScreen(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString)

                ' Used to indicate to refresh the values (Used in Validate procedure).
                m_blnReturnedFromRunScreen = True

                strRunscreenReturnToStop = strRunscreenReturnToStop.ToString.Replace(RunScreen.Name, "")
                If blnReturnStopScreen Then
                    Dim blnReturnAndClose As Boolean = True
                    Dim arrStop() As String = StopScreens.Split(",")
                    For i As Integer = 0 To arrStop.Length - 1
                        If arrStop(i) = Me.FormName Then
                            strRunscreenReturnToStop = ""
                            blnReturnAndClose = False
                            Exit For
                        End If
                    Next
                    If blnReturnAndClose Then
                        If Not IsPopup Then
                            strRunscreenReturnToStop = ""
                            blnReturnStopScreen = False
                        End If
                        If strRunscreenReturnToStop.ToString.Length = 0 Then
                            RunscreenReturnToStop = strRunscreenReturnToStop
                            ReturnStopScreen = blnReturnStopScreen
                            ReturnToStop()
                        End If
                    Else
                        blnReturnStopScreen = False
                    End If

                End If

                RunscreenReturnToStop = strRunscreenReturnToStop
                ReturnStopScreen = blnReturnStopScreen

            End If


        End Sub

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub RunScreen(RunScreen As BaseClassControl, Optional ByVal RunScreenMode As RunScreenModes = RunScreenModes.NoneSelected, Optional ByRef Parm1 As Object = Nothing _
            , Optional ByRef Parm2 As Object = Nothing, Optional ByRef Parm3 As Object = Nothing, Optional ByRef Parm4 As Object = Nothing _
            , Optional ByRef Parm5 As Object = Nothing, Optional ByRef Parm6 As Object = Nothing, Optional ByRef Parm7 As Object = Nothing _
            , Optional ByRef Parm8 As Object = Nothing, Optional ByRef Parm9 As Object = Nothing, Optional ByRef Parm10 As Object = Nothing _
            , Optional ByRef Parm11 As Object = Nothing, Optional ByRef Parm12 As Object = Nothing, Optional ByRef Parm13 As Object = Nothing _
            , Optional ByRef Parm14 As Object = Nothing, Optional ByRef Parm15 As Object = Nothing, Optional ByRef Parm16 As Object = Nothing _
            , Optional ByRef Parm17 As Object = Nothing, Optional ByRef Parm18 As Object = Nothing, Optional ByRef Parm19 As Object = Nothing _
            , Optional ByRef Parm20 As Object = Nothing, Optional ByRef Parm21 As Object = Nothing)


            Dim intSequence As Integer
            Dim strSequence As String
            Dim strRunscreenReturnToStop As String = RunscreenReturnToStop
            Dim blnReturnStopScreen As Boolean = ReturnStopScreen

            If m_blnExecutingUpdate Then

                ' Commit the default transaction (TRANS_UPDATE).
                Try
                    TRANS_UPDATE(TransactionMethods.Commit)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
                Try
                    ExecuteNamedTransactions(TransactionMethods.Commit)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
            End If

            If Not Me.UseAcceptProcessing OrElse (Me.UseAcceptProcessing AndAlso m_strControlName.Length > 0) Then
                m_intRunScreenSequence += 1
                intSequence = m_intRunScreenSequence
                strSequence = m_strControlName + intSequence.ToString
            Else
                m_intProcedureRunScreenSequence += 1
                intSequence = m_intProcedureRunScreenSequence
                strSequence = "P" + intSequence.ToString
            End If

            ' The AcceptProcessing version uses a hashtable since we store
            ' the screens that were run on a field by field basis as well
            ' as from a procedural level. This is done for moving to a previous
            ' control.
            ' Example:  Key,        Value
            '          "fldA",      "YY"
            '          "fldB",      "Y"
            '          "Procedure", "Y"

            Dim blnMethodWasExecuted As Boolean
            If Me.UseAcceptProcessing Then
                blnMethodWasExecuted = MethodWasExecuted(m_htRunFlag, intSequence)
            Else
                blnMethodWasExecuted = MethodWasExecuted(m_strRunFlag, intSequence)
            End If

            If Not blnMethodWasExecuted Then
                ' Save the sequence information and set a flag indicating screen was run.
                If Me.UseAcceptProcessing Then
                    SetMethodExecutedFlag(m_htRunFlag, "RUN_FLAG", intSequence)
                Else
                    SetMethodExecutedFlag(m_strRunFlag, "RUN_FLAG", intSequence)
                End If

                ' Save the parameters passed to the RUN SCREEN.
                'If Not (Parm1 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM1", strSequence) = GetParmValue(Parm1)
                'End If
                'If Not (Parm2 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM2", strSequence) = GetParmValue(Parm2)
                'End If
                'If Not (Parm3 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM3", strSequence) = GetParmValue(Parm3)
                'End If
                'If Not (Parm4 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM4", strSequence) = GetParmValue(Parm4)
                'End If
                'If Not (Parm5 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM5", strSequence) = GetParmValue(Parm5)
                'End If
                'If Not (Parm6 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM6", strSequence) = GetParmValue(Parm6)
                'End If
                'If Not (Parm7 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM7", strSequence) = GetParmValue(Parm7)
                'End If
                'If Not (Parm8 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM8", strSequence) = GetParmValue(Parm8)
                'End If
                'If Not (Parm9 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM9", strSequence) = GetParmValue(Parm9)
                'End If
                'If Not (Parm10 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM10", strSequence) = GetParmValue(Parm10)
                'End If
                'If Not (Parm11 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM11", strSequence) = GetParmValue(Parm11)
                'End If
                'If Not (Parm12 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM12", strSequence) = GetParmValue(Parm12)
                'End If
                'If Not (Parm13 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM13", strSequence) = GetParmValue(Parm13)
                'End If
                'If Not (Parm14 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM14", strSequence) = GetParmValue(Parm14)
                'End If
                'If Not (Parm15 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM15", strSequence) = GetParmValue(Parm15)
                'End If
                'If Not (Parm16 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM16", strSequence) = GetParmValue(Parm16)
                'End If
                'If Not (Parm17 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM17", strSequence) = GetParmValue(Parm17)
                'End If
                'If Not (Parm18 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM18", strSequence) = GetParmValue(Parm18)
                'End If
                'If Not (Parm19 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM19", strSequence) = GetParmValue(Parm19)
                'End If
                'If Not (Parm20 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM20", strSequence) = GetParmValue(Parm20)
                'End If
                'If Not (Parm21 Is Nothing) Then
                '    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM21", strSequence) = GetParmValue(Parm21)
                'End If

                ' If we are performing a skip all, don't execute the run screen.
                ' Only call Exit Sub if a screen that was not called before.  For screens 
                ' that have been called, we need to re-run the code after the runscreen call
                ' to retrieve the updated values.
                If IsSkipAll() And Not blnMethodWasExecuted Then
                    Exit Sub
                End If

                ' Track the total sessions, so we can remove these upon returning from the run screen.
                'Session(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString) = Session.Count

                ' Default: E for subscreen invoked during the standard entry procedure, otherwise NULL.
                If RunScreenMode = RunScreenModes.NoneSelected Then
                    If Me.Mode = PageModeTypes.Entry Then
                        RunScreenMode = RunScreenModes.Entry
                    End If
                End If

                If RunScreenMode = RunScreenModes.Same Then
                    If FindMode Then
                        RunScreenMode = RunScreenModes.Find
                    ElseIf EntryMode OrElse CorrectMode Then
                        RunScreenMode = RunScreenModes.Entry
                    Else
                        RunScreenMode = RunScreenModes.NoneSelected
                    End If
                End If

                m_strRunScreen = RunScreen.Name

                'Treating RunScreen as the Ghost Screen, which is used in ReturnAndClose for not throwing an exception
                RunScreen.ScreenType = ScreenTypes.Ghost

                'Session(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_ScreenSequence") = strSequence
                ApplicationState.Current.ScreenLevel = Me.Level + 1
                Try
                    RunScreen.CallInitialize(RunScreenMode)

                Catch ex As CustomApplicationException
                    If ex.Message = cMenuRunScreenException.ToString Then
                        'm_strRunScreen = GlobalSession("RunScreenName")
                        SetRunScreenMemberVariables(m_strRunScreen)
                        ' Remove the value from m_htRunFlag so that we run through 
                        ' the code again on the postback.
                        ClearMethodExecutedFlag(m_htRunFlag, "RUN_FLAG", intSequence)
                    Else
                        ' If a message was thrown on the previous screen, display it in the current screen.
                        DisplayMessagesFromRunScreen(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString)
                    End If

                    If ex.Message <> cReturn.ToString Then
                        If ex.Message = cMenuRunScreenException.ToString Then

                            If blnOverRideRunscreenClearRun Then

                                If HasGrid Then
                                    If IsNothing(PageActionObject) Then RaiseShowGrid(False)
                                    RaisePrepareGridControlsForDisplay(False)
                                End If

                                If Me.Occurrence = 0 Then CallDisplayFormatting()

                                m_strHidRunscreen = "OverRide"
                                blnOverRideRunscreenClearRun = False
                            End If


                            ThrowCustomApplicationException(cRunScreenException)
                        Else
                            Throw ex
                        End If
                    End If
                Catch ex As Exception
                    ' If a message was thrown on the previous screen, display it in the current screen.
                    DisplayMessagesFromRunScreen(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString)

                    ' Write the exception to the event log and throw an error.
                    ExceptionManager.Publish(ex)
                End Try
                blnMethodWasExecuted = True
            End If

            If blnMethodWasExecuted Then


                ' Reset the m_strRunScreen variable.
                m_strRunScreen = String.Empty

                ' Decrement the ScreenLevel.
                ApplicationState.Current.ScreenLevel = Me.Level

                '' Remove the Mode and ScreenSequence session information for the screen called.
                'If Session(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_ScreenSequence") & "" = strSequence.ToString Then
                '    Session.Remove(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_Mode")
                '    Session.Remove(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_ScreenSequence")
                'End If


                ' Retrieve the parameters back from session.
                'If Not (Parm1 Is Nothing) Then
                '    SetParmValue(Parm1, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM1", strSequence))
                'End If
                'If Not (Parm2 Is Nothing) Then
                '    SetParmValue(Parm2, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM2", strSequence))
                'End If
                'If Not (Parm3 Is Nothing) Then
                '    SetParmValue(Parm3, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM3", strSequence))
                'End If
                'If Not (Parm4 Is Nothing) Then
                '    SetParmValue(Parm4, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM4", strSequence))
                'End If
                'If Not (Parm5 Is Nothing) Then
                '    SetParmValue(Parm5, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM5", strSequence))
                'End If
                'If Not (Parm6 Is Nothing) Then
                '    SetParmValue(Parm6, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM6", strSequence))
                'End If
                'If Not (Parm7 Is Nothing) Then
                '    SetParmValue(Parm7, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM7", strSequence))
                'End If
                'If Not (Parm8 Is Nothing) Then
                '    SetParmValue(Parm8, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM8", strSequence))
                'End If
                'If Not (Parm9 Is Nothing) Then
                '    SetParmValue(Parm9, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM9", strSequence))
                'End If
                'If Not (Parm10 Is Nothing) Then
                '    SetParmValue(Parm10, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM10", strSequence))
                'End If
                'If Not (Parm11 Is Nothing) Then
                '    SetParmValue(Parm11, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM11", strSequence))
                'End If
                'If Not (Parm12 Is Nothing) Then
                '    SetParmValue(Parm12, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM12", strSequence))
                'End If
                'If Not (Parm13 Is Nothing) Then
                '    SetParmValue(Parm13, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM13", strSequence))
                'End If
                'If Not (Parm14 Is Nothing) Then
                '    SetParmValue(Parm14, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM14", strSequence))
                'End If
                'If Not (Parm15 Is Nothing) Then
                '    SetParmValue(Parm15, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM15", strSequence))
                'End If
                'If Not (Parm16 Is Nothing) Then
                '    SetParmValue(Parm16, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM16", strSequence))
                'End If
                'If Not (Parm17 Is Nothing) Then
                '    SetParmValue(Parm17, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM17", strSequence))
                'End If
                'If Not (Parm18 Is Nothing) Then
                '    SetParmValue(Parm18, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM18", strSequence))
                'End If
                'If Not (Parm19 Is Nothing) Then
                '    SetParmValue(Parm19, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM19", strSequence))
                'End If
                'If Not (Parm20 Is Nothing) Then
                '    SetParmValue(Parm20, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM20", strSequence))
                'End If
                'If Not (Parm21 Is Nothing) Then
                '    SetParmValue(Parm21, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM21", strSequence))
                'End If

                ' If a message was thrown on the previous screen, display it in the current screen.
                DisplayMessagesFromRunScreen(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString)

                ' Used to indicate to refresh the values (Used in Validate procedure).
                m_blnReturnedFromRunScreen = True

                strRunscreenReturnToStop = strRunscreenReturnToStop.ToString.Replace(RunScreen.Name, "")
                If blnReturnStopScreen Then
                    Dim blnReturnAndClose As Boolean = True
                    Dim arrStop() As String = StopScreens.Split(",")
                    For i As Integer = 0 To arrStop.Length - 1
                        If arrStop(i) = Me.FormName Then
                            strRunscreenReturnToStop = ""
                            blnReturnAndClose = False
                            Exit For
                        End If
                    Next
                    If blnReturnAndClose Then
                        If Not IsPopup Then
                            strRunscreenReturnToStop = ""
                            blnReturnStopScreen = False
                        End If
                        If strRunscreenReturnToStop.ToString.Length = 0 Then
                            RunscreenReturnToStop = strRunscreenReturnToStop
                            ReturnStopScreen = blnReturnStopScreen
                            ReturnToStop()
                        End If
                    Else
                        blnReturnStopScreen = False
                    End If

                End If

                RunscreenReturnToStop = strRunscreenReturnToStop
                ReturnStopScreen = blnReturnStopScreen

            End If


        End Sub

        Protected Sub ResetFlags(Optional ByVal Count As Integer = 1)
            Dim strKey As String
            If m_strControlName.Length > 0 Then
                strKey = m_strControlName
            Else
                strKey = cPROCEDURE
            End If

            If Not m_htRunFlag Is Nothing AndAlso m_htRunFlag.ContainsKey(strKey) Then
                Dim value As String = m_htRunFlag.Item(strKey).ToString
                value = value.Substring(0, value.Length - Count)
                m_htRunFlag.Item(strKey) = value
            End If
            m_intAcceptSequence -= Count
            m_strAcceptFlag = m_strAcceptFlag.Substring(0, m_strAcceptFlag.Length - Count)
        End Sub





        ''' --- RunScreen ----------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Call a lower-level screen.
        ''' </summary>
        ''' <param name="RunScreen">The ghost screen class to be run.</param>
        ''' <param name="RunScreenMode">The mode for the subscreen.  Select one of the following modes: <br/>
        ''' NoneSelected <br/>
        ''' Find <br/>
        ''' Entry  <br/>
        ''' Select <br/>
        ''' Null <br/>
        ''' Same <br/>
        ''' Ghost<br/>
        ''' </param>
        ''' <param name="Parm1">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm2">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm3">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm4">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm5">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm6">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm7">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm8">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm9">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm10">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm11">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm12">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm13">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm14">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm15">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm16">The File or Tempory class that is passed to the called screen.</param>
        ''' <remarks>
        ''' If no mode is passed in, then the default is Entry if this screen is invoked during the Entry sequence.
        ''' </remarks>
        ''' <example>
        ''' RunScreen(SC0100.GetSC0100(Me.Level + 1),  RunScreenModes.Find, T_EMP_ID) <br/>
        ''' RunScreen(SC0100.GetSC0100(Me.Level + 1), , T_EMP_ID) <br/>
        ''' RunScreen(SC0100.GetSC0100(Me.Level + 1),  RunScreenModes.Same, fleEMPLOYEE) <br/>
        ''' RunScreen(SC0100.GetSC0100(Me.Level + 1),  RunScreenModes.Find, fleEMPLOYEE, T_EMP_ID, T_ADDRESS_ID, flePOSITION) <br/>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub RunScreen(ByVal objRunScreen As BaseClassControl, ByVal blnOverRideView As Boolean, Optional ByVal RunScreenMode As RunScreenModes = RunScreenModes.NoneSelected, Optional ByRef Parm1 As Object = Nothing _
            , Optional ByRef Parm2 As Object = Nothing, Optional ByRef Parm3 As Object = Nothing, Optional ByRef Parm4 As Object = Nothing _
            , Optional ByRef Parm5 As Object = Nothing, Optional ByRef Parm6 As Object = Nothing, Optional ByRef Parm7 As Object = Nothing _
            , Optional ByRef Parm8 As Object = Nothing, Optional ByRef Parm9 As Object = Nothing, Optional ByRef Parm10 As Object = Nothing _
            , Optional ByRef Parm11 As Object = Nothing, Optional ByRef Parm12 As Object = Nothing, Optional ByRef Parm13 As Object = Nothing _
            , Optional ByRef Parm14 As Object = Nothing, Optional ByRef Parm15 As Object = Nothing, Optional ByRef Parm16 As Object = Nothing _
            , Optional ByRef Parm17 As Object = Nothing, Optional ByRef Parm18 As Object = Nothing, Optional ByRef Parm19 As Object = Nothing _
            , Optional ByRef Parm20 As Object = Nothing, Optional ByRef Parm21 As Object = Nothing)

            If blnOverRideView Then
                blnOverRideRunscreenClearRun = True
            End If


            RunScreen(objRunScreen, RunScreenMode, Parm1, Parm2, Parm3, Parm4, Parm5, Parm6, Parm7, Parm8, Parm9, Parm10, Parm11, Parm12, Parm13, Parm14, Parm15, Parm16, Parm17, Parm18, Parm19, Parm20, Parm21)





        End Sub

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub RunScreen(ByVal RunScreenName As String, ByVal blnOverRideView As Boolean, ByVal RunScreenMode As RunScreenModes, ByRef Parm1 As Object _
           , Optional ByRef Parm2 As Object = Nothing, Optional ByRef Parm3 As Object = Nothing, Optional ByRef Parm4 As Object = Nothing _
           , Optional ByRef Parm5 As Object = Nothing, Optional ByRef Parm6 As Object = Nothing, Optional ByRef Parm7 As Object = Nothing _
           , Optional ByRef Parm8 As Object = Nothing, Optional ByRef Parm9 As Object = Nothing, Optional ByRef Parm10 As Object = Nothing _
           , Optional ByRef Parm11 As Object = Nothing, Optional ByRef Parm12 As Object = Nothing, Optional ByRef Parm13 As Object = Nothing _
           , Optional ByRef Parm14 As Object = Nothing, Optional ByRef Parm15 As Object = Nothing, Optional ByRef Parm16 As Object = Nothing _
           , Optional ByRef Parm17 As Object = Nothing, Optional ByRef Parm18 As Object = Nothing, Optional ByRef Parm19 As Object = Nothing _
           , Optional ByRef Parm20 As Object = Nothing, Optional ByRef Parm21 As Object = Nothing)


            If blnOverRideView Then
                blnOverRideRunscreenClear = True
            End If

            RunScreen(RunScreenName, RunScreenMode, Parm1, Parm2, Parm3, Parm4, Parm5, Parm6, Parm7, Parm8, Parm9, Parm10, Parm11, Parm12, Parm13, Parm14, Parm15, Parm16, Parm17, Parm18, Parm19, Parm20, Parm21)

        End Sub

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub RunScreen(ByVal Screen As UserControl, ByVal blnOverRideView As Boolean, ByVal RunScreenMode As RunScreenModes)

            Dim arrParm() As Object = Nothing


            If blnOverRideView Then
                blnOverRideRunscreenClear = True
            End If
            RunScreen(Screen, RunScreenMode, arrParm)

        End Sub

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub RunScreen(ByVal RunScreen As Page, ByVal RunScreenMode As RunScreenModes, ByRef arrParm() As Object)


            Dim strRunscreenReturnToStop As String = RunscreenReturnToStop + ""
            Dim blnReturnStopScreen As Boolean = ReturnStopScreen
            Dim blnSkipAll As Boolean = False
            Dim blnForceFunctionKey As Boolean = False

            If m_blnExecutingUpdate Then

                ' Commit the default transaction (TRANS_UPDATE).
                Try
                    TRANS_UPDATE(TransactionMethods.Commit)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
                Try
                    ExecuteNamedTransactions(TransactionMethods.Commit)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
            End If


            'SetRunScreenMemberVariables(RunScreenName)

            Dim intSequence As Integer
            Dim strSequence As String
            If Not Me.UseAcceptProcessing OrElse (Me.UseAcceptProcessing AndAlso m_strControlName.Length > 0) Then
                m_intRunScreenSequence += 1
                intSequence = m_intRunScreenSequence
                strSequence = m_strControlName + intSequence.ToString
            Else
                m_intProcedureRunScreenSequence += 1
                intSequence = m_intProcedureRunScreenSequence
                strSequence = "P" + intSequence.ToString
            End If

            ' The AcceptProcessing version uses a hashtable since we store
            ' the screens that were run on a field by field basis as well
            ' as from a procedural level. This is done for moving to a previous
            ' control.
            ' Example:  Key,        Value
            '          "fldA",      "YY"
            '          "fldB",      "Y"
            '          "Procedure", "Y"

            Dim blnMethodWasExecuted As Boolean
            If Me.UseAcceptProcessing Then
                blnMethodWasExecuted = MethodWasExecuted(m_htRunFlag, intSequence)
            Else
                blnMethodWasExecuted = MethodWasExecuted(m_strRunFlag, intSequence)
            End If

            If m_blnCurrentDesigner Then
                If blnMethodWasExecuted Then
                    blnForceFunctionKey = True
                End If
                blnMethodWasExecuted = False
            End If

            ' If we are performing a skip all, don't execute the run screen.
            ' Only call Exit Sub if a screen that was not called before.  For screens 
            ' that have been called, we need to re-run the code after the runscreen call
            ' to retrieve the updated values.
            If IsSkipAll() And Not blnMethodWasExecuted Then
                blnSkipAll = True
            Else
                ' Added to ensure that if a run screen is called after another run screen,
                ' and a field had the Accept verb, that the field that had the Accept will
                ' be updated on the screen prior to displaying the second run screen.
                If IsFlickerFree Then
                    If Not m_fldAcceptField Is Nothing Then
                        If m_strAcceptField.Length > 0 AndAlso m_strAcceptField.StartsWith(m_fldAcceptField.RenderedID & "|") Then
                            m_strAcceptField &= "|" & RunScreen.Name
                        Else
                            m_strAcceptField = m_fldAcceptField.RenderedID & "|" & RunScreen.Name
                        End If
                    End If
                End If
            End If

            If Not blnMethodWasExecuted Then

                If IsFlickerFree AndAlso Not blnOverRideRunscreenClear AndAlso Not blnSkipAll Then
                    m_strHidRunscreen = "True"
                ElseIf blnOverRideRunscreenClear Then
                    m_strHidRunscreen = "OverRide"
                End If

                If Not blnForceFunctionKey Then
                    ' Save the sequence information and set a flag indicating screen was run.
                    If Me.UseAcceptProcessing Then
                        SetMethodExecutedFlag(m_htRunFlag, "RUN_FLAG", intSequence)
                    Else
                        SetMethodExecutedFlag(m_strRunFlag, "RUN_FLAG", intSequence)
                    End If
                End If

                ' Check if we need to pass all occurrences.
                Dim blnPassOccurrences As Boolean = False
                If PassArraysToScreens.Length > 0 Then
                    Dim arr As Array = PassArraysToScreens.Split(",")
                    For intCount As Integer = 0 To UBound(arr)
                        If arr(intCount) = RunScreen.Name Then
                            blnPassOccurrences = True
                            Exit For
                        End If
                    Next
                End If

                RunScreen.ScreenSequence = strSequence
                RunScreen.Level = Me.Level + 1

                ' Save the parameters passed to the RUN SCREEN.
                If Not IsNothing(arrParm) AndAlso arrParm.Length > 0 Then
                    For i As Integer = 0 To arrParm.Length - 1
                        If Not (arrParm(i) Is Nothing) Then
                            Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM" + (i + 1).ToString, strSequence) = GetParmValue(arrParm(i), blnPassOccurrences)
                        End If
                    Next
                End If


                If blnSkipAll Then Exit Sub

                ' Track the total sessions, so we can remove these upon returning from the run screen.
                'Session(RunScreenName + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString) = Session.Count

                ' Default: E for subscreen invoked during the standard entry procedure, otherwise NULL.
                If RunScreenMode = RunScreenModes.NoneSelected Then
                    ' Added Change and Correct for Slave screens.
                    If Me.Mode = PageModeTypes.Entry Then
                        RunScreenMode = RunScreenModes.Entry
                    ElseIf Me.Mode = PageModeTypes.Change Then
                        RunScreenMode = RunScreenModes.Change
                    ElseIf Me.Mode = PageModeTypes.Correct Then
                        RunScreenMode = RunScreenModes.Correct
                    End If
                End If

                If RunScreenMode = RunScreenModes.Same Then
                    If FindMode Then
                        RunScreenMode = RunScreenModes.Find
                    ElseIf EntryMode OrElse CorrectMode Then
                        RunScreenMode = RunScreenModes.Entry
                    Else
                        RunScreenMode = RunScreenModes.NoneSelected
                    End If
                End If


                'Session(RunScreenName + "_" + (Me.Level + 1).ToString + "_Mode") = RunScreenMode
                'Session(RunScreenName + "_" + (Me.Level + 1).ToString + "_ScreenSequence") = strSequence
                ApplicationState.Current.ScreenLevel = Me.Level + 1
                'If blnIsGhostScreen Then
                '    RunGhostScreen(RunScreenName)
                '    blnMethodWasExecuted = True--
                'Else
                'ThrowCustomApplicationException(cRunScreenException)
                'End If
                RunScreen.Mode = RunScreenMode


                Try
                    CallScreen(RunScreen, True)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try

                blnMethodWasExecuted = True
            End If

            If blnMethodWasExecuted Then

                m_strResponseMessage = String.Empty
                If IsFlickerFree Then
                    m_strHidRunscreen = ""
                End If

                ' Reset the m_strRunScreen variable.
                m_strRunScreen = String.Empty

                ' Decrement the ScreenLevel.
                ApplicationState.Current.ScreenLevel = Me.Level

                ' Remove the Mode and ScreenSequence session information for the screen called.
                'If Session(RunScreenName + "_" + (Me.Level + 1).ToString + "_ScreenSequence") & "" = strSequence.ToString Then
                '    Session.Remove(RunScreenName + "_" + (Me.Level + 1).ToString + "_Mode")
                '    Session.Remove(RunScreenName + "_" + (Me.Level + 1).ToString + "_ScreenSequence")
                'End If


                ' Retrieve the parameters back from m_objSession.
                If Not IsNothing(arrParm) AndAlso arrParm.Length > 0 Then
                    For i As Integer = 0 To arrParm.Length - 1
                        If Not (arrParm(i) Is Nothing) Then
                            SetParmValue(arrParm(i), Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM" + (i + 1).ToString, strSequence))
                        End If
                    Next
                End If


                ' If a message was thrown on the previous screen, display it in the current screen.
                DisplayMessagesFromRunScreen(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString)

                ' Used to indicate to refresh the values (Used in Validate procedure).
                m_blnReturnedFromRunScreen = True

                strRunscreenReturnToStop = strRunscreenReturnToStop.ToString.Replace(RunScreen.Name, "")
                If blnReturnStopScreen Then
                    Trace.Write("In the ReturnStopScreen")
                    Dim blnReturnAndClose As Boolean = True
                    Dim arrStop() As String = StopScreens.Split(",")
                    For i As Integer = 0 To arrStop.Length - 1
                        If arrStop(i) = Me.FormName Then
                            strRunscreenReturnToStop = ""
                            blnReturnAndClose = False
                            Exit For
                        End If
                    Next
                    If blnReturnAndClose Then
                        If Not IsPopup Then
                            strRunscreenReturnToStop = ""
                            blnReturnStopScreen = False
                        End If
                        If strRunscreenReturnToStop.ToString.Length = 0 Then
                            RunscreenReturnToStop = strRunscreenReturnToStop
                            ReturnStopScreen = blnReturnStopScreen
                            ReturnToStop()
                        End If
                    Else
                        blnReturnStopScreen = False
                    End If

                End If

                RunscreenReturnToStop = strRunscreenReturnToStop
                ReturnStopScreen = blnReturnStopScreen
                ApplicationState.Current.CorePage = Me

            End If

        End Sub


        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub RunScreen(ByVal Screen As UserControl, ByVal RunScreenMode As RunScreenModes)
            Dim arrRunscreen() As Object = Nothing
            RunScreen(Screen, RunScreenMode, arrRunscreen)
        End Sub

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub RunScreen(ByVal RunScreen As UserControl, Optional ByVal RunScreenMode As RunScreenModes = RunScreenModes.NoneSelected, Optional ByRef Parm1 As Object = Nothing _
            , Optional ByRef Parm2 As Object = Nothing, Optional ByRef Parm3 As Object = Nothing, Optional ByRef Parm4 As Object = Nothing _
            , Optional ByRef Parm5 As Object = Nothing, Optional ByRef Parm6 As Object = Nothing, Optional ByRef Parm7 As Object = Nothing _
            , Optional ByRef Parm8 As Object = Nothing, Optional ByRef Parm9 As Object = Nothing, Optional ByRef Parm10 As Object = Nothing _
            , Optional ByRef Parm11 As Object = Nothing, Optional ByRef Parm12 As Object = Nothing, Optional ByRef Parm13 As Object = Nothing _
            , Optional ByRef Parm14 As Object = Nothing, Optional ByRef Parm15 As Object = Nothing, Optional ByRef Parm16 As Object = Nothing _
            , Optional ByRef Parm17 As Object = Nothing, Optional ByRef Parm18 As Object = Nothing, Optional ByRef Parm19 As Object = Nothing _
            , Optional ByRef Parm20 As Object = Nothing, Optional ByRef Parm21 As Object = Nothing)

            Dim strRunscreenReturnToStop As String = RunscreenReturnToStop
            Dim blnReturnStopScreen As Boolean = ReturnStopScreen
            Dim blnSkipAll As Boolean = False
            Dim blnForceFunctionKey As Boolean = False

            If m_blnExecutingUpdate Then

                ' Commit the default transaction (TRANS_UPDATE).
                Try
                    TRANS_UPDATE(TransactionMethods.Commit)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
                Try
                    ExecuteNamedTransactions(TransactionMethods.Commit)
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                End Try
            End If


            'SetRunScreenMemberVariables(RunScreenName)

            Dim intSequence As Integer
            Dim strSequence As String
            If Not Me.UseAcceptProcessing OrElse (Me.UseAcceptProcessing AndAlso m_strControlName.Length > 0) Then
                m_intRunScreenSequence += 1
                intSequence = m_intRunScreenSequence
                strSequence = m_strControlName + intSequence.ToString
            Else
                m_intProcedureRunScreenSequence += 1
                intSequence = m_intProcedureRunScreenSequence
                strSequence = "P" + intSequence.ToString
            End If

            ' The AcceptProcessing version uses a hashtable since we store
            ' the screens that were run on a field by field basis as well
            ' as from a procedural level. This is done for moving to a previous
            ' control.
            ' Example:  Key,        Value
            '          "fldA",      "YY"
            '          "fldB",      "Y"
            '          "Procedure", "Y"

            Dim blnMethodWasExecuted As Boolean
            If Me.UseAcceptProcessing Then
                blnMethodWasExecuted = MethodWasExecuted(m_htRunFlag, intSequence)
            Else
                blnMethodWasExecuted = MethodWasExecuted(m_strRunFlag, intSequence)
            End If

            If m_blnCurrentDesigner Then
                If blnMethodWasExecuted Then
                    blnForceFunctionKey = True
                End If
                blnMethodWasExecuted = False
            End If

            ' If we are performing a skip all, don't execute the run screen.
            ' Only call Exit Sub if a screen that was not called before.  For screens 
            ' that have been called, we need to re-run the code after the runscreen call
            ' to retrieve the updated values.
            If IsSkipAll() And Not blnMethodWasExecuted Then
                blnSkipAll = True
            Else
                ' Added to ensure that if a run screen is called after another run screen,
                ' and a field had the Accept verb, that the field that had the Accept will
                ' be updated on the screen prior to displaying the second run screen.
                If IsFlickerFree Then
                    If Not m_fldAcceptField Is Nothing Then
                        If m_strAcceptField.Length > 0 AndAlso m_strAcceptField.StartsWith(m_fldAcceptField.RenderedID & "|") Then
                            m_strAcceptField &= "|" & RunScreen.Name
                        Else
                            m_strAcceptField = m_fldAcceptField.RenderedID & "|" & RunScreen.Name
                        End If
                    End If
                End If
            End If

            If Not blnMethodWasExecuted Then

                If IsFlickerFree AndAlso Not blnOverRideRunscreenClearRun AndAlso Not blnOverRideRunscreenClear AndAlso Not blnSkipAll Then
                    m_strHidRunscreen = "True"
                ElseIf blnOverRideRunscreenClearRun AndAlso Not blnSkipAll Then
                    m_strHidRunscreen = "OverRide"
                End If

                If Not blnForceFunctionKey Then
                    ' Save the sequence information and set a flag indicating screen was run.
                    If Me.UseAcceptProcessing Then
                        SetMethodExecutedFlag(m_htRunFlag, "RUN_FLAG", intSequence)
                    Else
                        SetMethodExecutedFlag(m_strRunFlag, "RUN_FLAG", intSequence)
                    End If
                End If

                ' Check if we need to pass all occurrences.
                Dim blnPassOccurrences As Boolean = False
                If PassArraysToScreens.Length > 0 Then
                    Dim arr As Array = PassArraysToScreens.Split(",")
                    For intCount As Integer = 0 To UBound(arr)
                        If arr(intCount) = RunScreen.Name Then
                            blnPassOccurrences = True
                            Exit For
                        End If
                    Next
                End If

                ' Save the parameters passed to the RUN SCREEN.
                If Not (Parm1 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM1", strSequence) = GetParmValue(Parm1, blnPassOccurrences)
                End If
                If Not (Parm2 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM2", strSequence) = GetParmValue(Parm2, blnPassOccurrences)
                End If
                If Not (Parm3 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM3", strSequence) = GetParmValue(Parm3, blnPassOccurrences)
                End If
                If Not (Parm4 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM4", strSequence) = GetParmValue(Parm4, blnPassOccurrences)
                End If
                If Not (Parm5 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM5", strSequence) = GetParmValue(Parm5, blnPassOccurrences)
                End If
                If Not (Parm6 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM6", strSequence) = GetParmValue(Parm6, blnPassOccurrences)
                End If
                If Not (Parm7 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM7", strSequence) = GetParmValue(Parm7, blnPassOccurrences)
                End If
                If Not (Parm8 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM8", strSequence) = GetParmValue(Parm8, blnPassOccurrences)
                End If
                If Not (Parm9 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM9", strSequence) = GetParmValue(Parm9, blnPassOccurrences)
                End If
                If Not (Parm10 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM10", strSequence) = GetParmValue(Parm10, blnPassOccurrences)
                End If
                If Not (Parm11 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM11", strSequence) = GetParmValue(Parm11, blnPassOccurrences)
                End If
                If Not (Parm12 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM12", strSequence) = GetParmValue(Parm12, blnPassOccurrences)
                End If
                If Not (Parm13 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM13", strSequence) = GetParmValue(Parm13, blnPassOccurrences)
                End If
                If Not (Parm14 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM14", strSequence) = GetParmValue(Parm14, blnPassOccurrences)
                End If
                If Not (Parm15 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM15", strSequence) = GetParmValue(Parm15, blnPassOccurrences)
                End If
                If Not (Parm16 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM16", strSequence) = GetParmValue(Parm16, blnPassOccurrences)
                End If
                If Not (Parm17 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM17", strSequence) = GetParmValue(Parm17, blnPassOccurrences)
                End If
                If Not (Parm18 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM18", strSequence) = GetParmValue(Parm18, blnPassOccurrences)
                End If
                If Not (Parm19 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM19", strSequence) = GetParmValue(Parm19, blnPassOccurrences)
                End If
                If Not (Parm20 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM20", strSequence) = GetParmValue(Parm20, blnPassOccurrences)
                End If
                If Not (Parm21 Is Nothing) Then
                    Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM21", strSequence) = GetParmValue(Parm21, blnPassOccurrences)
                End If

                If blnSkipAll Then Exit Sub

                ' Track the total sessions, so we can remove these upon returning from the run screen.
                'Session(RunScreenName + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString) = Session.Count

                ' Default: E for subscreen invoked during the standard entry procedure, otherwise NULL.
                If RunScreenMode = RunScreenModes.NoneSelected Then
                    ' Added Change and Correct for Slave screens.
                    If Me.Mode = PageModeTypes.Entry Then
                        RunScreenMode = RunScreenModes.Entry
                    ElseIf Me.Mode = PageModeTypes.Change Then
                        RunScreenMode = RunScreenModes.Change
                    ElseIf Me.Mode = PageModeTypes.Correct Then
                        RunScreenMode = RunScreenModes.Correct
                    End If
                End If

                If RunScreenMode = RunScreenModes.Same Then
                    If FindMode Then
                        RunScreenMode = RunScreenModes.Find
                    ElseIf EntryMode OrElse CorrectMode Then
                        RunScreenMode = RunScreenModes.Entry
                    Else
                        RunScreenMode = RunScreenModes.NoneSelected
                    End If
                End If

                m_strRunScreen = RunScreen.Name
                'Session(RunScreenName + "_" + (Me.Level + 1).ToString + "_Mode") = RunScreenMode
                'Session(RunScreenName + "_" + (Me.Level + 1).ToString + "_ScreenSequence") = strSequence
                ApplicationState.Current.ScreenLevel = Me.Level + 1
                'If blnIsGhostScreen Then
                '    RunGhostScreen(RunScreenName)
                '    blnMethodWasExecuted = True
                'Else

                If blnOverRideRunscreenClearRun Then

                    If HasGrid Then
                        If IsNothing(PageActionObject) Then RaiseShowGrid(False)
                        RaisePrepareGridControlsForDisplay(False)
                    End If

                    If Me.Occurrence = 0 Then CallDisplayFormatting()
                End If

                blnOverRideRunscreenClearRun = False


                ThrowCustomApplicationException(cRunScreenException)
                'End If
            End If

            If blnMethodWasExecuted Then

                m_strResponseMessage = String.Empty
                If IsFlickerFree Then
                    m_strHidRunscreen = ""
                End If

                ' Reset the m_strRunScreen variable.
                m_strRunScreen = String.Empty

                ' Decrement the ScreenLevel.
                ApplicationState.Current.ScreenLevel = Me.Level

                '' Remove the Mode and ScreenSequence session information for the screen called.
                'If Session(RunScreenName + "_" + (Me.Level + 1).ToString + "_ScreenSequence") & "" = strSequence.ToString Then
                '    Session.Remove(RunScreenName + "_" + (Me.Level + 1).ToString + "_Mode")
                '    Session.Remove(RunScreenName + "_" + (Me.Level + 1).ToString + "_ScreenSequence")
                'End If

                ' Retrieve the parameters back from session.
                If Not (Parm1 Is Nothing) Then
                    SetParmValue(Parm1, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM1", strSequence))
                End If
                If Not (Parm2 Is Nothing) Then
                    SetParmValue(Parm2, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM2", strSequence))
                End If
                If Not (Parm3 Is Nothing) Then
                    SetParmValue(Parm3, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM3", strSequence))
                End If
                If Not (Parm4 Is Nothing) Then
                    SetParmValue(Parm4, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM4", strSequence))
                End If
                If Not (Parm5 Is Nothing) Then
                    SetParmValue(Parm5, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM5", strSequence))
                End If
                If Not (Parm6 Is Nothing) Then
                    SetParmValue(Parm6, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM6", strSequence))
                End If
                If Not (Parm7 Is Nothing) Then
                    SetParmValue(Parm7, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM7", strSequence))
                End If
                If Not (Parm8 Is Nothing) Then
                    SetParmValue(Parm8, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM8", strSequence))
                End If
                If Not (Parm9 Is Nothing) Then
                    SetParmValue(Parm9, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM9", strSequence))
                End If
                If Not (Parm10 Is Nothing) Then
                    SetParmValue(Parm10, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM10", strSequence))
                End If
                If Not (Parm11 Is Nothing) Then
                    SetParmValue(Parm11, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM11", strSequence))
                End If
                If Not (Parm12 Is Nothing) Then
                    SetParmValue(Parm12, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM12", strSequence))
                End If
                If Not (Parm13 Is Nothing) Then
                    SetParmValue(Parm13, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM13", strSequence))
                End If
                If Not (Parm14 Is Nothing) Then
                    SetParmValue(Parm14, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM14", strSequence))
                End If
                If Not (Parm15 Is Nothing) Then
                    SetParmValue(Parm15, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM15", strSequence))
                End If
                If Not (Parm16 Is Nothing) Then
                    SetParmValue(Parm16, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM16", strSequence))
                End If
                If Not (Parm17 Is Nothing) Then
                    SetParmValue(Parm17, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM17", strSequence))
                End If
                If Not (Parm18 Is Nothing) Then
                    SetParmValue(Parm18, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM18", strSequence))
                End If
                If Not (Parm19 Is Nothing) Then
                    SetParmValue(Parm19, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM19", strSequence))
                End If
                If Not (Parm20 Is Nothing) Then
                    SetParmValue(Parm20, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM20", strSequence))
                End If
                If Not (Parm21 Is Nothing) Then
                    SetParmValue(Parm21, Me.CalledPageSession(RunScreen.Name, Me.Level + 1, "PARM21", strSequence))
                End If

                ' If a message was thrown on the previous screen, display it in the current screen.
                DisplayMessagesFromRunScreen(RunScreen.Name + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString)

                ' Used to indicate to refresh the values (Used in Validate procedure).
                m_blnReturnedFromRunScreen = True

                strRunscreenReturnToStop = strRunscreenReturnToStop.ToString.Replace(RunScreen.Name, "")
                If blnReturnStopScreen Then
                    Trace.Write("In the ReturnStopScreen")
                    Dim blnReturnAndClose As Boolean = True
                    Dim arrStop() As String = StopScreens.Split(",")
                    For i As Integer = 0 To arrStop.Length - 1
                        If arrStop(i) = Me.FormName Then
                            strRunscreenReturnToStop = ""
                            blnReturnAndClose = False
                            Exit For
                        End If
                    Next
                    If blnReturnAndClose Then
                        If Not IsPopup Then
                            strRunscreenReturnToStop = ""
                            blnReturnStopScreen = False
                        End If
                        If strRunscreenReturnToStop.ToString.Length = 0 Then
                            RunscreenReturnToStop = strRunscreenReturnToStop
                            ReturnStopScreen = blnReturnStopScreen
                            ReturnToStop()
                        End If
                    Else
                        blnReturnStopScreen = False
                    End If

                End If

                RunscreenReturnToStop = strRunscreenReturnToStop
                ReturnStopScreen = blnReturnStopScreen

                If m_blnInInitialize Then m_blnRunscreenInInitialize = True

            End If

        End Sub

        ''' --- RunCustomScreen ----------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Call a lower-level screen that does not use supporting Renaissance Architect Framework.
        ''' </summary>
        ''' <param name="RunScreenMode">The mode for the subscreen.  Select one of the following modes: <br/>
        ''' NoneSelected <br/>
        ''' Find <br/>
        ''' Entry  <br/>
        ''' Select <br/>
        ''' Null <br/>
        ''' Same <br/>
        ''' Ghost<br/>
        ''' </param>
        ''' <param name="Parm1">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm2">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm3">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm4">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm5">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm6">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm7">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm8">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm9">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm10">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm11">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm12">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm13">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm14">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm15">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm16">The File or Tempory class that is passed to the called screen.</param>
        ''' <remarks>
        ''' If no mode is passed in, then the default is Entry if this screen is invoked during the Entry sequence.
        ''' </remarks>
        ''' <example>
        ''' RunScreen("SC0100",  RunScreenModes.Find, T_EMP_ID) <br/>
        ''' RunScreen("SC0100", , T_EMP_ID) <br/>
        ''' RunScreen("SC0100",  RunScreenModes.Same, fleEMPLOYEE) <br/>
        ''' RunScreen("SC0100",  RunScreenModes.Find, fleEMPLOYEE, T_EMP_ID, T_ADDRESS_ID, flePOSITION) <br/>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub RunCustomScreen(ByVal RunScreenName As String, Optional ByVal RunScreenMode As RunScreenModes = RunScreenModes.NoneSelected, Optional ByRef Parm1 As Object = Nothing _
        , Optional ByRef Parm2 As Object = Nothing, Optional ByRef Parm3 As Object = Nothing, Optional ByRef Parm4 As Object = Nothing _
        , Optional ByRef Parm5 As Object = Nothing, Optional ByRef Parm6 As Object = Nothing, Optional ByRef Parm7 As Object = Nothing _
        , Optional ByRef Parm8 As Object = Nothing, Optional ByRef Parm9 As Object = Nothing, Optional ByRef Parm10 As Object = Nothing _
        , Optional ByRef Parm11 As Object = Nothing, Optional ByRef Parm12 As Object = Nothing, Optional ByRef Parm13 As Object = Nothing _
        , Optional ByRef Parm14 As Object = Nothing, Optional ByRef Parm15 As Object = Nothing, Optional ByRef Parm16 As Object = Nothing)

            ' If we are performing a skip all, don't execute the run screen.
            If IsSkipAll() Then
                Exit Sub
            End If

            Dim blnIsGhostScreen As Boolean = IsGhostScreen(RunScreenName)

            ' Remove/create the folder name for the runscreen.
            If RunScreenName.IndexOf("/") > -1 Then
                Dim intLastIndex As Integer = RunScreenName.LastIndexOf("/")
                m_strRunScreenFolder = RunScreenName.Substring(0, intLastIndex)
                If m_strRunScreenFolder.Substring(0, 1) = "/" Then m_strRunScreenFolder = m_strRunScreenFolder.Substring(1)
                RunScreenName = RunScreenName.Substring(intLastIndex + 1)
            Else
                m_strRunScreenFolder = RunScreenName.Substring(0, Me.RunScreenFolderLength)
            End If

            Dim intSequence As Integer
            Dim strSequence As String
            If Not Me.UseAcceptProcessing OrElse (Me.UseAcceptProcessing AndAlso m_strControlName.Length > 0) Then
                m_intRunScreenSequence += 1
                intSequence = m_intRunScreenSequence
                strSequence = m_strControlName + intSequence.ToString
            Else
                m_intProcedureRunScreenSequence += 1
                intSequence = m_intProcedureRunScreenSequence
                strSequence = "P" + intSequence.ToString
            End If

            ' The AcceptProcessing version uses a hashtable since we store
            ' the screens that were run on a field by field basis as well
            ' as from a procedural level. This is done for moving to a previous
            ' control.
            ' Example:  Key,        Value
            '          "fldA",      "YY"
            '          "fldB",      "Y"
            '          "Procedure", "Y"

            Dim blnMethodWasExecuted As Boolean
            If Me.UseAcceptProcessing Then
                blnMethodWasExecuted = MethodWasExecuted(m_htRunFlag, intSequence)
            Else
                blnMethodWasExecuted = MethodWasExecuted(m_strRunFlag, intSequence)
            End If

            If Not blnMethodWasExecuted Then
                ' Save the sequence information and set a flag indicating screen was run.
                If Me.UseAcceptProcessing Then
                    SetMethodExecutedFlag(m_htRunFlag, "RUN_FLAG", intSequence)
                Else
                    SetMethodExecutedFlag(m_strRunFlag, "RUN_FLAG", intSequence)
                End If

                ' Save the parameters passed to the RUN SCREEN.
                'If Not (Parm1 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM1", strSequence) = GetParmValue(Parm1)
                'End If
                'If Not (Parm2 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM2", strSequence) = GetParmValue(Parm2)
                'End If
                'If Not (Parm3 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM3", strSequence) = GetParmValue(Parm3)
                'End If
                'If Not (Parm4 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM4", strSequence) = GetParmValue(Parm4)
                'End If
                'If Not (Parm5 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM5", strSequence) = GetParmValue(Parm5)
                'End If
                'If Not (Parm6 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM6", strSequence) = GetParmValue(Parm6)
                'End If
                'If Not (Parm7 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM7", strSequence) = GetParmValue(Parm7)
                'End If
                'If Not (Parm8 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM8", strSequence) = GetParmValue(Parm8)
                'End If
                'If Not (Parm9 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM9", strSequence) = GetParmValue(Parm9)
                'End If
                'If Not (Parm10 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM10", strSequence) = GetParmValue(Parm10)
                'End If
                'If Not (Parm11 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM11", strSequence) = GetParmValue(Parm11)
                'End If
                'If Not (Parm12 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM12", strSequence) = GetParmValue(Parm12)
                'End If
                'If Not (Parm13 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM13", strSequence) = GetParmValue(Parm13)
                'End If
                'If Not (Parm14 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM14", strSequence) = GetParmValue(Parm14)
                'End If
                'If Not (Parm15 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM15", strSequence) = GetParmValue(Parm15)
                'End If
                'If Not (Parm16 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM16", strSequence) = GetParmValue(Parm16)
                'End If

                ' If we are performing a skip all, don't execute the run screen.
                ' Only call Exit Sub if a screen that was not called before.  For screens 
                ' that have been called, we need to re-run the code after the runscreen call
                ' to retrieve the updated values.
                If IsSkipAll() And Not blnMethodWasExecuted Then
                    Exit Sub
                End If

                ' Track the total sessions, so we can remove these upon returning from the run screen.
                'Session(RunScreenName + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString) = Session.Count

                ' Default: E for subscreen invoked during the standard entry procedure, otherwise NULL.
                If RunScreenMode = RunScreenModes.NoneSelected Then
                    ' Added Change and Correct for Slave screens.
                    If Me.Mode = PageModeTypes.Entry Then
                        RunScreenMode = RunScreenModes.Entry
                    ElseIf Me.Mode = PageModeTypes.Change Then
                        RunScreenMode = RunScreenModes.Change
                    ElseIf Me.Mode = PageModeTypes.Correct Then
                        RunScreenMode = RunScreenModes.Correct
                    End If
                End If

                If RunScreenMode = RunScreenModes.Same Then
                    If FindMode Then
                        RunScreenMode = RunScreenModes.Find
                    ElseIf EntryMode OrElse CorrectMode Then
                        RunScreenMode = RunScreenModes.Entry
                    Else
                        RunScreenMode = RunScreenModes.NoneSelected
                    End If
                End If

                m_strRunScreen = RunScreenName
                'Session(RunScreenName + "_" + (Me.Level + 1).ToString + "_Mode") = RunScreenMode
                'Session(RunScreenName + "_" + (Me.Level + 1).ToString + "_ScreenSequence") = strSequence
                ApplicationState.Current.ScreenLevel = Me.Level + 1
                If blnIsGhostScreen Then
                    RunGhostScreen(RunScreenName)
                    blnMethodWasExecuted = True
                Else
                    m_blnRunCustomScreen = True
                    ThrowCustomApplicationException(cRunScreenException)
                End If
            End If

            If blnMethodWasExecuted Then

                ' Reset the m_strRunScreen variable.
                m_strRunScreen = String.Empty

                ' Decrement the ScreenLevel.
                ApplicationState.Current.ScreenLevel = Me.Level

                '' Remove the Mode and ScreenSequence session information for the screen called.
                'Session.Remove(RunScreenName + "_" + (Me.Level + 1).ToString + "_Mode")
                'Session.Remove(RunScreenName + "_" + (Me.Level + 1).ToString + "_ScreenSequence")

                '' Retrieve the parameters back from session.
                'If Not (Parm1 Is Nothing) Then
                '    SetParmValue(Parm1, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM1", strSequence))
                'End If
                'If Not (Parm2 Is Nothing) Then
                '    SetParmValue(Parm2, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM2", strSequence))
                'End If
                'If Not (Parm3 Is Nothing) Then
                '    SetParmValue(Parm3, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM3", strSequence))
                'End If
                'If Not (Parm4 Is Nothing) Then
                '    SetParmValue(Parm4, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM4", strSequence))
                'End If
                'If Not (Parm5 Is Nothing) Then
                '    SetParmValue(Parm5, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM5", strSequence))
                'End If
                'If Not (Parm6 Is Nothing) Then
                '    SetParmValue(Parm6, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM6", strSequence))
                'End If
                'If Not (Parm7 Is Nothing) Then
                '    SetParmValue(Parm7, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM7", strSequence))
                'End If
                'If Not (Parm8 Is Nothing) Then
                '    SetParmValue(Parm8, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM8", strSequence))
                'End If
                'If Not (Parm9 Is Nothing) Then
                '    SetParmValue(Parm9, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM9", strSequence))
                'End If
                'If Not (Parm10 Is Nothing) Then
                '    SetParmValue(Parm10, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM10", strSequence))
                'End If
                'If Not (Parm11 Is Nothing) Then
                '    SetParmValue(Parm11, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM11", strSequence))
                'End If
                'If Not (Parm12 Is Nothing) Then
                '    SetParmValue(Parm12, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM12", strSequence))
                'End If
                'If Not (Parm13 Is Nothing) Then
                '    SetParmValue(Parm13, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM13", strSequence))
                'End If
                'If Not (Parm14 Is Nothing) Then
                '    SetParmValue(Parm14, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM14", strSequence))
                'End If
                'If Not (Parm15 Is Nothing) Then
                '    SetParmValue(Parm15, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM15", strSequence))
                'End If
                'If Not (Parm16 Is Nothing) Then
                '    SetParmValue(Parm16, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM16", strSequence))
                'End If

                ' If a message was thrown on the previous screen, display it in the current screen.
                DisplayMessagesFromRunScreen(RunScreenName + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString)

                ' Used to indicate to refresh the values (Used in Validate procedure).
                m_blnReturnedFromRunScreen = True
            End If

        End Sub

        ''' --- RunReportScreen ----------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Call a report screen.
        ''' </summary>
        ''' <param name="RunScreenName">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="RunScreenMode">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm1">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm2">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm3">The File or Tempory class that is passed to the called screen.</param>
        ''' <param name="Parm4">The File or Tempory class that is passed to the called screen.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <example>
        ''' RunReportScreen("SC0100",  RunScreenModes.Find, T_EMP_ID) <br/>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub RunReportScreen(ByVal RunScreenName As String, ByVal RunScreenMode As RunScreenModes, ByRef Parm1 As Object, ByRef Parm2 As Object,
            ByRef Parm3 As Object, Optional ByRef Parm4 As Object = Nothing)

            ' Remove/create the folder name for the runscreen.
            m_strRunScreenFolder = cREPORT_PAGES

            Dim intSequence As Integer
            Dim strSequence As String

            If Not Me.UseAcceptProcessing OrElse (Me.UseAcceptProcessing AndAlso m_strControlName.Length > 0) Then
                m_intRunScreenSequence += 1
                intSequence = m_intRunScreenSequence
                strSequence = m_strControlName + intSequence.ToString
            Else
                m_intProcedureRunScreenSequence += 1
                intSequence = m_intProcedureRunScreenSequence
                strSequence = "P" + intSequence.ToString
            End If

            Dim blnMethodWasExecuted As Boolean

            If Me.UseAcceptProcessing Then
                blnMethodWasExecuted = MethodWasExecuted(m_htRunFlag, intSequence)
            Else
                blnMethodWasExecuted = MethodWasExecuted(m_strRunFlag, intSequence)
            End If

            ' If we are performing a skip all, don't execute the run screen.
            ' Only call Exit Sub if a screen that was not called before.  For screens 
            ' that have been called, we need to re-run the code after the runscreen call
            ' to retrieve the updated values.
            If IsSkipAll() And Not blnMethodWasExecuted Then
                Exit Sub
            End If

            If Not blnMethodWasExecuted Then
                ' Save the sequence information and set a flag indicating screen was run.
                If Me.UseAcceptProcessing Then
                    SetMethodExecutedFlag(m_htRunFlag, "RUN_FLAG", intSequence)
                Else
                    SetMethodExecutedFlag(m_strRunFlag, "RUN_FLAG", intSequence)
                End If

                ' Save the parameters passed to the RUN SCREEN.
                'If Not (Parm1 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM1", strSequence) = Parm1
                'End If
                'If Not (Parm2 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM2", strSequence) = GetParmValue(Parm2)
                'End If
                'If Not (Parm3 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM3", strSequence) = GetParmValue(Parm3)
                'End If
                'If Not (Parm4 Is Nothing) Then
                '    Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM4", strSequence) = GetParmValue(Parm4)
                'End If

                '' Track the total sessions, so we can remove these upon returning from the run screen.
                'Session(RunScreenName + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString) = Session.Count

                m_strRunScreen = RunScreenName

                'Session(RunScreenName + "_" + (Me.Level + 1).ToString + "_Mode") = RunScreenMode
                'Session(RunScreenName + "_" + (Me.Level + 1).ToString + "_ScreenSequence") = strSequence
                ApplicationState.Current.ScreenLevel = Me.Level + 1

                ThrowCustomApplicationException(cRunScreenException)
            End If

            If blnMethodWasExecuted Then

                ' Reset the m_strRunScreen variable.
                m_strRunScreen = String.Empty

                ' Decrement the ScreenLevel.
                ApplicationState.Current.ScreenLevel = Me.Level

                '' Remove the Mode and ScreenSequence session information for the screen called.
                'Session.Remove(RunScreenName + "_" + (Me.Level + 1).ToString + "_Mode")
                'Session.Remove(RunScreenName + "_" + (Me.Level + 1).ToString + "_ScreenSequence")

                '' Retrieve the parameters back from session.
                'If Not (Parm1 Is Nothing) Then
                '    SetParmValue(Parm1, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM1", strSequence))
                'End If
                'If Not (Parm2 Is Nothing) Then
                '    SetParmValue(Parm2, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM2", strSequence))
                'End If
                'If Not (Parm3 Is Nothing) Then
                '    SetParmValue(Parm3, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM3", strSequence))
                'End If
                'If Not (Parm4 Is Nothing) Then
                '    SetParmValue(Parm4, Me.CalledPageSession(RunScreenName, Me.Level + 1, "PARM4", strSequence))
                'End If

                ' If a message was thrown on the previous screen, display it in the current screen.
                DisplayMessagesFromRunScreen(RunScreenName + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString)

                ' Used to indicate to refresh the values (Used in Validate procedure).
                m_blnReturnedFromRunScreen = True
            End If

        End Sub


        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub RunQTP(ByRef QTP As BaseClassControl, Optional ByRef Parm() As String = Nothing, Optional ByRef chSessionid As Object = Nothing)


            Dim strUserID As String = String.Empty
            Dim dtStartDate As Date
            Dim dtLastAccessTime As Date
            Dim blnIsActive As Boolean
            Dim intNumberedSessionID As Int32

            'UI.SessionInformation.GetSessionInformation(Session.SessionID, strUserID, dtStartDate, dtLastAccessTime, blnIsActive, intNumberedSessionID)
            Select Case chSessionid.GetType.ToString
                Case "Core.Windows.CoreCharacter"
                    chSessionid.Value = CStr(intNumberedSessionID)
                Case Else
                    chSessionid.Value = CInt(intNumberedSessionID)
            End Select


            m_strRunScreenFolder = "QTP"
            m_strRunScreen = "QTP"

            Dim intSequence As Integer
            Dim strSequence As String
            If Not Me.UseAcceptProcessing OrElse (Me.UseAcceptProcessing AndAlso m_strControlName.Length > 0) Then
                m_intRunScreenSequence += 1
                intSequence = m_intRunScreenSequence
                strSequence = m_strControlName + intSequence.ToString
            Else
                m_intProcedureRunScreenSequence += 1
                intSequence = m_intProcedureRunScreenSequence
                strSequence = "P" + intSequence.ToString
            End If

            ' The AcceptProcessing version uses a hashtable since we store
            ' the screens that were run on a field by field basis as well
            ' as from a procedural level. This is done for moving to a previous
            ' control.
            ' Example:  Key,        Value
            '          "fldA",      "YY"
            '          "fldB",      "Y"
            '          "Procedure", "Y"

            Dim blnMethodWasExecuted As Boolean
            If Me.UseAcceptProcessing Then
                blnMethodWasExecuted = MethodWasExecuted(m_htRunFlag, intSequence)
            Else
                blnMethodWasExecuted = MethodWasExecuted(m_strRunFlag, intSequence)
            End If

            If Not blnMethodWasExecuted Then
                If IsFlickerFree AndAlso Not blnOverRideRunscreenClearRun AndAlso Not blnOverRideRunscreenClear Then
                    m_strHidRunscreen = "True"
                ElseIf blnOverRideRunscreenClearRun Then
                    m_strHidRunscreen = "OverRide"
                End If

                ' Save the sequence information and set a flag indicating screen was run.
                If Me.UseAcceptProcessing Then
                    SetMethodExecutedFlag(m_htRunFlag, "RUN_FLAG", intSequence)
                Else
                    SetMethodExecutedFlag(m_strRunFlag, "RUN_FLAG", intSequence)
                End If

                ' Save the parameters passed to the RUN SCREEN.
                'If Not IsNothing(Parm) Then
                '    For i As Integer = 0 To UBound(Parm)
                '        If Not (Parm(i) Is Nothing) Then
                '            Me.CalledPageSession(QTP.Name, Me.Level + 1, "PARM" & (i + 1), strSequence) = GetParmValue(Parm(i))
                '        End If
                '    Next
                'End If

                'Me.CalledPageSession(QTP.Name, Me.Level + 1, "QTP", strSequence) = QTP

                '' Track the total sessions, so we can remove these upon returning from the run screen.
                'Session(QTP.Name + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString) = Session.Count

                '' Default: E for subscreen invoked during the standard entry procedure, otherwise NULL.

                'Session(QTP.Name + "_" + (Me.Level + 1).ToString + "_ScreenSequence") = strSequence
                ApplicationState.Current.ScreenLevel = Me.Level + 1
                'Session("QTPName") = QTP.Name

                ThrowCustomApplicationException(cRunScreenException)

            End If

            If blnMethodWasExecuted Then
                If IsFlickerFree Then
                    m_strHidRunscreen = ""
                End If

                ' Decrement the ScreenLevel.
                ApplicationState.Current.ScreenLevel = Me.Level

                '' Remove the Mode and ScreenSequence session information for the screen called.
                'Session.Remove(QTP.Name + "_" + (Me.Level + 1).ToString + "_Mode")
                'Session.Remove(QTP.Name + "_" + (Me.Level + 1).ToString + "_ScreenSequence")

                ' Retrieve the parameters back from session.
                'If Not IsNothing(Parm) Then
                '    For i As Integer = 0 To UBound(Parm)
                '        If Not (Parm(i) Is Nothing) Then
                '            SetParmValue(Parm(i), Me.CalledPageSession(QTP.Name, Me.Level + 1, "PARM" & (i + 1), strSequence))
                '        End If
                '    Next
                'End If

                ' If a message was thrown on the previous screen, display it in the current screen.
                DisplayMessagesFromRunScreen(QTP.Name + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString)

                ' Used to indicate to refresh the values (Used in Validate procedure).
                m_blnReturnedFromRunScreen = True
            End If

        End Sub

        ''' --- RunQTP ----------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Call a QTP.
        ''' </summary>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub RunQTP(ByVal RunQTPName As String, Optional ByRef Parm() As String = Nothing, Optional ByRef chSessionid As Object = Nothing)


            Dim strUserID As String = String.Empty
            Dim dtStartDate As Date
            Dim dtLastAccessTime As Date
            Dim blnIsActive As Boolean
            Dim intNumberedSessionID As Int32

            'UI.SessionInformation.GetSessionInformation(Session.SessionID, strUserID, dtStartDate, dtLastAccessTime, blnIsActive, intNumberedSessionID)
            Select Case chSessionid.GetType.ToString
                Case "Core.Windows.UI.Core.Windows.CoreCharacter"
                    chSessionid.Value = CStr(intNumberedSessionID)
                Case Else
                    chSessionid.Value = CInt(intNumberedSessionID)
            End Select


            m_strRunScreenFolder = "QTP"
            m_strRunScreen = "QTP"

            Dim intSequence As Integer
            Dim strSequence As String
            If Not Me.UseAcceptProcessing OrElse (Me.UseAcceptProcessing AndAlso m_strControlName.Length > 0) Then
                m_intRunScreenSequence += 1
                intSequence = m_intRunScreenSequence
                strSequence = m_strControlName + intSequence.ToString
            Else
                m_intProcedureRunScreenSequence += 1
                intSequence = m_intProcedureRunScreenSequence
                strSequence = "P" + intSequence.ToString
            End If

            ' The AcceptProcessing version uses a hashtable since we store
            ' the screens that were run on a field by field basis as well
            ' as from a procedural level. This is done for moving to a previous
            ' control.
            ' Example:  Key,        Value
            '          "fldA",      "YY"
            '          "fldB",      "Y"
            '          "Procedure", "Y"

            Dim blnMethodWasExecuted As Boolean
            If Me.UseAcceptProcessing Then
                blnMethodWasExecuted = MethodWasExecuted(m_htRunFlag, intSequence)
            Else
                blnMethodWasExecuted = MethodWasExecuted(m_strRunFlag, intSequence)
            End If

            If Not blnMethodWasExecuted Then
                If IsFlickerFree AndAlso Not blnOverRideRunscreenClearRun AndAlso Not blnOverRideRunscreenClear Then
                    m_strHidRunscreen = "True"
                ElseIf blnOverRideRunscreenClearRun Then
                    m_strHidRunscreen = "OverRide"
                End If
                ' Save the sequence information and set a flag indicating screen was run.
                If Me.UseAcceptProcessing Then
                    SetMethodExecutedFlag(m_htRunFlag, "RUN_FLAG", intSequence)
                Else
                    SetMethodExecutedFlag(m_strRunFlag, "RUN_FLAG", intSequence)
                End If

                ' Save the parameters passed to the RUN SCREEN.
                'If Not IsNothing(Parm) Then
                '    For i As Integer = 0 To UBound(Parm)
                '        If Not (Parm(i) Is Nothing) Then
                '            Me.CalledPageSession(RunQTPName, Me.Level + 1, "PARM" & (i + 1), strSequence) = GetParmValue(Parm(i))
                '        End If
                '    Next
                'End If

                '' Track the total sessions, so we can remove these upon returning from the run screen.
                'Session(RunQTPName + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString) = Session.Count

                '' Default: E for subscreen invoked during the standard entry procedure, otherwise NULL.

                'Session(RunQTPName + "_" + (Me.Level + 1).ToString + "_ScreenSequence") = strSequence
                ApplicationState.Current.ScreenLevel = Me.Level + 1
                'Session("QTPName") = RunQTPName

                ThrowCustomApplicationException(cRunScreenException)

            End If

            If blnMethodWasExecuted Then
                If IsFlickerFree Then
                    m_strHidRunscreen = ""
                End If

                ' Decrement the ScreenLevel.
                ApplicationState.Current.ScreenLevel = Me.Level

                '' Remove the Mode and ScreenSequence session information for the screen called.
                'Session.Remove(RunQTPName + "_" + (Me.Level + 1).ToString + "_Mode")
                'Session.Remove(RunQTPName + "_" + (Me.Level + 1).ToString + "_ScreenSequence")

                '' Retrieve the parameters back from session.
                'If Not IsNothing(Parm) Then
                '    For i As Integer = 0 To UBound(Parm)
                '        If Not (Parm(i) Is Nothing) Then
                '            SetParmValue(Parm(i), Me.CalledPageSession(RunQTPName, Me.Level + 1, "PARM" & (i + 1), strSequence))
                '        End If
                '    Next
                'End If

                ' If a message was thrown on the previous screen, display it in the current screen.
                DisplayMessagesFromRunScreen(RunQTPName + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString)

                ' Used to indicate to refresh the values (Used in Validate procedure).
                m_blnReturnedFromRunScreen = True
            End If

        End Sub

        '<EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)> _
        'Public Sub RunJob(ByVal RunJobName As String)

        '    m_strRunScreenFolder = "JobControl"
        '    m_strRunScreen = "JobControl"

        '    Dim intSequence As Integer
        '    Dim strSequence As String
        '    If Not Me.UseAcceptProcessing OrElse (Me.UseAcceptProcessing AndAlso m_strControlName.Length > 0) Then
        '        m_intRunScreenSequence += 1
        '        intSequence = m_intRunScreenSequence
        '        strSequence = m_strControlName + intSequence.ToString
        '    Else
        '        m_intProcedureRunScreenSequence += 1
        '        intSequence = m_intProcedureRunScreenSequence
        '        strSequence = "P" + intSequence.ToString
        '    End If

        '    ' The AcceptProcessing version uses a hashtable since we store
        '    ' the screens that were run on a field by field basis as well
        '    ' as from a procedural level. This is done for moving to a previous
        '    ' control.
        '    ' Example:  Key,        Value
        '    '          "fldA",      "YY"
        '    '          "fldB",      "Y"
        '    '          "Procedure", "Y"

        '    Dim blnMethodWasExecuted As Boolean
        '    If Me.UseAcceptProcessing Then
        '        blnMethodWasExecuted = MethodWasExecuted(m_htRunFlag, intSequence)
        '    Else
        '        blnMethodWasExecuted = MethodWasExecuted(m_strRunFlag, intSequence)
        '    End If



        '    If Not blnMethodWasExecuted Then

        '        Dim strUserID As String = String.Empty
        '        Dim dtStartDate As Date
        '        Dim dtLastAccessTime As Date
        '        Dim blnIsActive As Boolean
        '        Dim intNumberedSessionID As Int32
        '        Dim dtNow As String ' = Session("dtNow")
        '        If IsNothing(dtNow) OrElse dtNow = "" Then
        '            dtNow = ServerDateTimeValue()
        '        End If
        '        'Session("dtNow") = Nothing

        '        'UI.SessionInformation.GetSessionInformation(Session.SessionID, strUserID, dtStartDate, dtLastAccessTime, blnIsActive, intNumberedSessionID)

        '        'RunJobName = RunJobName.Trim & "_" & Session.SessionID & "_" & UserID & "_" & dtNow

        '        If IsFlickerFree AndAlso Not blnOverRideRunscreenClearRun AndAlso Not blnOverRideRunscreenClear Then
        '            m_strHidRunscreen = "True"
        '        ElseIf blnOverRideRunscreenClearRun Then
        '            m_strHidRunscreen = "OverRide"
        '        End If
        '        ' Save the sequence information and set a flag indicating screen was run.
        '        If Me.UseAcceptProcessing Then
        '            SetMethodExecutedFlag(m_htRunFlag, "RUN_FLAG", intSequence)
        '        Else
        '            SetMethodExecutedFlag(m_strRunFlag, "RUN_FLAG", intSequence)
        '        End If

        '        ' Save the parameters passed to the RUN SCREEN.

        '        'Me.CalledPageSession(m_strRunScreen, Me.Level + 1, "PARM1", strSequence) = RunJobName.Trim
        '        'Me.CalledPageSession(m_strRunScreen, Me.Level + 1, "PARM2", strSequence) = JobScriptPath() & RunJobName.Trim & ".txt"

        '        '' Track the total sessions, so we can remove these upon returning from the run screen.
        '        'Session(m_strRunScreen + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString) = Session.Count

        '        '' Default: E for subscreen invoked during the standard entry procedure, otherwise NULL.

        '        'Session(m_strRunScreen + "_" + (Me.Level + 1).ToString + "_ScreenSequence") = strSequence
        '        ApplicationState.Current.ScreenLevel = Me.Level + 1

        '        'Session(m_strRunScreen + "_" + (Me.Level + 1).ToString + "_Mode") = RunScreenModes.Entry

        '        ThrowCustomApplicationException(cRunScreenException)

        '    End If

        '    If blnMethodWasExecuted Then
        '        If IsFlickerFree Then
        '            m_strHidRunscreen = ""
        '        End If


        '        ' Decrement the ScreenLevel.
        '        ApplicationState.Current.ScreenLevel = Me.Level

        '        '' Remove the Mode and ScreenSequence session information for the screen called.
        '        'Session.Remove(m_strRunScreen + "_" + (Me.Level + 1).ToString + "_Mode")
        '        'Session.Remove(m_strRunScreen + "_" + (Me.Level + 1).ToString + "_ScreenSequence")

        '        ' Retrieve the parameters back from session.


        '        ' If a message was thrown on the previous screen, display it in the current screen.
        '        DisplayMessagesFromRunScreen(m_strRunScreen + "_" + (Me.Level + 1).ToString + "_" + strSequence.ToString)

        '        ' Reset the m_strRunScreen variable.
        '        m_strRunScreen = String.Empty

        '        ' Used to indicate to refresh the values (Used in Validate procedure).
        '        m_blnReturnedFromRunScreen = True
        '    End If

        'End Sub

        ''' --- ServerDateTimeValue ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Returns the current time on the server.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function ServerDateTimeValue() As String

            Return Now.Year.ToString & Now.Month.ToString.PadLeft(2, "0") & Now.Day.ToString.PadLeft(2, "0") & Now.Hour.ToString.PadLeft(2, "0") & Now.Minute.ToString.PadLeft(2, "0") & Now.Second.ToString.PadLeft(2, "0")

        End Function

        ''' --- IsGhostScreen ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Determines if current screen is a Ghost Screen.
        ''' </summary>
        ''' <param name="RunScreenName">A String containing the name of the screen to check.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function IsGhostScreen(ByVal RunScreenName As String) As Boolean

            'If Application.Item("GhostScreens") Is Nothing Then
            '    Return False
            'Else
            '    Return CType(Application.Item("GhostScreens"), ArrayList).Contains(RunScreenName)
            'End If

        End Function

        ''' --- RunGhostScreen -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RunGhostScreen.
        ''' </summary>
        ''' <param name="RunScreenName"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function RunGhostScreen(ByVal RunScreenName As String) As Boolean

        End Function

        ' ''' --- AddGridFields ------------------------------------------------------
        ' ''' <exclude/>
        ' ''' 
        ' ''' <summary>
        ' ''' 	Adds a Field to a Grid which will be displayed on the current screen.
        ' ''' </summary>
        ' ''' <param name="Sender">A DataList containing fields currently in the Grid.</param>
        ' ''' <remarks>
        ' ''' </remarks>
        ' ''' <history>
        ' ''' 	[Campbell]	7/4/2005	Created
        ' ''' </history>
        ' ''' --- End of Comments ----------------------------------------------------
        '<EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)> _
        'Public Overridable Sub AddGridFields(ByVal Sender As Web.UI.DataList)

        'End Sub

        ''' --- RaisePrepareGridToProcess ------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RaisePrepareGridToProcess.
        ''' </summary>
        ''' <param name="CallMainSaveState"></param>
        ''' <param name="CallInFieldSaveState"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RaisePrepareGridToProcess(ByRef CallMainSaveState As Boolean, ByRef CallInFieldSaveState As Boolean)
            'Note: We need to raise an event as Page itself does not know 
            ' about whether there is a grid on the page or not and if there is grid
            ' it does not know the name of the instance of the grid
            '
            ' We added this event primarily to initialize grid every time 
            ' when we call Find. At present Find is a method rather than an event
            '
            ' An event handler for this event, in a DataList sets a flag to 
            ' override Grid Buffer (which is GridDataSource) and use GridDataTable 
            ' which is to be populated through Find/ShowGrid in a Derived Page

            MainSaveState = CallMainSaveState
            InFieldSaveState = CallInFieldSaveState

            If PrepareGridToProcessEvent Is Nothing Then
                Dim dt As DispatcherTimer = New DispatcherTimer
                AddHandler dt.Tick, AddressOf GridToProcess
                dt.Interval = New TimeSpan(0, 0, 0, 0, 400)
                dt.Start()
            Else
                GridToProcess(Nothing, Nothing)
            End If

        End Sub

        Private MainSaveState As Boolean
        Private InFieldSaveState As Boolean

        Public Sub GridToProcess(sender As Object, e As EventArgs)
            Dim dt = TryCast(sender, DispatcherTimer)
            If dt IsNot Nothing Then
                dt.[Stop]()
            End If
            dt = Nothing

            RaiseEvent PrepareGridToProcess(MainSaveState, InFieldSaveState)
        End Sub

        ''' --- RaisePrepareGridControlsForDisplay ---------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RaisePrepareGridControlsForDisplay.
        ''' </summary>
        ''' <param name="KeepCurrentPage"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RaisePrepareGridControlsForDisplay(ByVal KeepCurrentPage As Boolean)
            'Note: 
            '1) We need to raise an event as Page itself does not know 
            '   about whether there is a grid on the page or not and if there is grid
            '   it does not know the name of the instance of the grid
            '
            '   We added this event primarily to initialize grid every time 
            '   when we call Find. At present Find is a method rather than an event
            '
            '   An event handler for this event, in a DataList sets a flag to 
            '   override Grid Buffer (which is GridDataSource) and use GridDataTable 
            '   which is to be populated through Find/ShowGrid in a Derived Page

            '2) There is a condition call to this method
            '   which only expects this method to raise event and do nothing else.
            '   If we ever need to do something other than raising an event we need
            '   "If" condition. To see the call, search for "RaisePrepareGridControlsForDisplay" 
            '
            blnPrepareGrid = True
            RaiseEvent PrepareGridControlsForDisplay(KeepCurrentPage)
        End Sub

        Public Sub ClearSequence()
            m_intRequestSequence = 0
            m_intAcceptSequence = 0
            m_intRequestSequence = 0
            m_intOccurrence = 0
            RaiseClearRequestValues()
            m_blnDisableGridRows = False
            m_intNextAppendInRow = -1
            m_strRequestedControlFocusOverRide = ""
            IsDirty = False
            HasErrorInFind = False
            RequireTerminate = False
            SkipAll = False
        End Sub

        ''' --- RaiseSetOccursWithFileFlags ----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RaiseSetOccursWithFileFlags.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub RaiseSetOccursWithFileFlags()
            RaiseEvent SetOccursWithFileFlags()
        End Sub

        ''' --- SetAccessOk --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SetAccessOk.
        ''' </summary>
        ''' <param name="AccessOk"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Sub SetAccessOk(ByVal AccessOk As Boolean)
            'The ACCESSOK condition relates to a session and not to a specific screen.
            blnAccessOk = AccessOk
        End Sub

        ''' --- PagePreProcess -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of PagePreProcess.
        ''' </summary>
        ''' <param name="e"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Overridable Sub PagePreProcess(ByVal e As PageArgs)
            'Can be overrided by the derived page
        End Sub

        ''' --- CallPagePostProcess ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CallPagePostProcess.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub CallPagePostProcess()
            'Don't remove a position of call to this (CallPagePostProcess) as it might break
            'those derived screens which are using this procedure
            'Here we may need to add some context information so that derived
            'page can differentiate from where CallPagePostProcess is being callled
            m_blnPagePostProcessCalled = True

            Try
                PagePostProcess(Nothing)
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try
        End Sub

        ''' --- PagePostProcess ----------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	This method is used to set the PageTitle.  
        ''' </summary>
        ''' <param name="e"></param>
        ''' <remarks>This method executes prior to saving state and allows the PageTitle to be set based on values in the File or Temporary classes,
        '''     which are not available during the Load event of the page.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Overridable Sub PagePostProcess(ByVal e As PageArgs)
            'Can be overrided by the derived page
        End Sub

        ''' --- CustomToolboxDesigner ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	This method is used to run code specific for the custom Toolbox menu items.  
        ''' </summary>
        ''' <param name="e"></param>
        ''' <param name="sender"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Overridable Sub CustomToolboxDesigner(ByVal sender As Object, ByVal e As System.EventArgs)
            'Can be overrided by the derived page
        End Sub
#End Region

#Region "Events"

        ''' --- InitializeInternalValues -------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of InitializeInternalValues.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event InitializeInternalValues()

        ''' --- ResetInitialValues ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ResetInitialValues.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event ResetInitialValues()

        ''' --- LoadPageState ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of LoadPageState.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event LoadPageState(ByVal Sender As Object, ByVal e As PageStateEventArgs, ByVal blnFromAppend As Boolean)

        ''' --- SavePageState ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SavePageState.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event SavePageState(ByVal Sender As Object, ByVal e As PageStateEventArgs)

        ' Used to determine if any files were altered.  If so, then IsDirty is set to true.
        ''' --- CheckFileStatuses --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CheckFileStatuses.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event CheckFileStatuses(ByRef Altered As Boolean)

        ''' --- LoadValues ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of LoadValues.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event LoadValues()

        ''' --- ClearControls ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ClearControls.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event ClearControls()

        ''' --- ClearRequestValues -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ClearRequestValues.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event ClearRequestValues()

        ''' --- UpdateRequestBuffer ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of UpdateRequestBuffer.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event UpdateRequestBuffer()

        ''' --- BindGridFields -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of BindGridFields.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event BindGridFields(ByVal RowPosition As Integer)

        ''' --- ResetValueChanged --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ResetValueChanged.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event ResetValueChanged(ByVal sender As Windows.UI.Page, ByVal ClearTextValue As Boolean)

        ''' --- GridLoad -----------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Summary of GridLoad.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Event GridLoad(ByVal Sender As Object, ByVal EventArgs As Object)

        ''' --- ControlsLoad -------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Summary of ControlsLoad.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Event ControlsLoad(ByVal Sender As Object, ByVal EventArgs As Object)

        ''' --- ProcessGridRecords -------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Summary of ProcessGridRecords.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Event ProcessGridRecords()

        ''' --- DeleteGridRecords --------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Summary of DeleteGridRecords.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Event DeleteGridRecords()

        ''' --- ShowGridEvent ------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Summary of ShowGridEvent.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Event ShowGridEvent(ByVal NoRecordsFound As Boolean, ByVal IsLoaded As Boolean)

        ''' --- PrepareGridToProcess -----------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Summary of PrepareGridToProcess.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Event PrepareGridToProcess(ByRef CallMainSaveState As Boolean, ByRef CallInFieldSaveState As Boolean)

        ''' --- PrepareGridControlsForDisplay --------------------------------------
        ''' 
        ''' <summary>
        ''' 	Summary of PrepareGridControlsForDisplay.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Event PrepareGridControlsForDisplay(ByVal KeepCurrentPage As Boolean)

        ''' --- PrepareGridForFind -------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Summary of PrepareGridForFind.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Event PrepareGridForFind()

        ''' --- SetOccursWithFileFlags ---------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Summary of SetOccursWithFileFlags.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Event SetOccursWithFileFlags()

        ''' --- GenerateComboValues ------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GenerateComboValues.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event GenerateComboValues(ByVal ComboValuesTable As DataTable)

        ''' --- GetUpdatedComboItems -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetUpdatedComboItems.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event GetUpdatedComboItems(ByVal ComboColumnNames As ArrayList, ByVal ComboColumnValues As ArrayList)

        ''' --- GetDropDownItemsDB -----------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetDropDownItemsDB.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Event GetDropDownItemsDB()



#End Region








        ''' --- ResetVariables -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ResetVariables.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function ResetVariables()
            If m_intPageActionType = PageActionType.ToolbarClick Then
                Select Case m_intToolbarAction
                    Case ToolbarIcons.Submit
                        'Reset RecordNumber, PageNumber and PageSetNumber. Last two properties are used for Grid Page
                        CurrentPageSetNumber = 0
                        CurrentPageNumber = 0
                        CurrentRecordNumber = 0
                        Me.IsAppendFromEntry = False
                        Me.IsAppendFromGrid = False
                        Me.TotalRecordsProcessed = 0
                        intTotalRecordsFound = 0
                        intTotalSkippedRecords = 0
                End Select
            End If
            Return Nothing
        End Function

        ''' --- SetFocusField -----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SetFocusField.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub SetFocusField(ByVal FieldName As String)
            m_strRequestedControlFocusOverRide = FieldName
        End Sub

        ''' --- ResetGridVariables -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ResetGridVariables.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function ResetGridVariables()
            'Mainly gets called from toolbar
            Me.NavigationRecordCount = 0
            Me.CurrentRecordNumber = 0
            Me.GridRecordNumber = 0
            Me.CurrentPageSetNumber = 0
            Me.CurrentPageNumber = 0
            Me.TotalRecordsProcessed = 0
            Me.TotalGridRecords = 0
            TotalPages = 0
            intTotalRecordsFound = 0
            intTotalSkippedRecords = 0
            If Me.ToolbarAction <> ToolbarIcons.Add Then
                Me.IsAppendFromEntry = False
            End If
            intRecordsForLoop = 0
            Return Nothing
        End Function

        ''' --- Render -------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of Render.
        ''' </summary>
        ''' <param name="writer"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Sub Render(ByVal writer As System.Web.UI.HtmlTextWriter)

            If Not m_blnCloseWindow Then
                Dim intcount As Integer
                Dim arrMultiLine() As String
                ' Check if the textbox is a multiline, if so set focus to the next field

                If m_blnImmediateTerminateAppend OrElse m_blnSkipAllAndTerminateAppend Then
                    m_strRequestedControlFocus = String.Empty
                End If

                Dim blnReplaceContent As Boolean = False
                ' If the form opens in Change or Correct mode and there is no field selected to receive focus,
                ' then get the first control from the Element list.
                If (Mode = PageModeTypes.Change OrElse Mode = PageModeTypes.Correct) AndAlso Not m_strRequestedControlFocus Is Nothing _
                AndAlso m_strRequestedControlFocus = "" AndAlso ControlList.ElementList.Length > 0 Then
                    m_strRequestedControlFocus = Me.ControlList.ElementList.Split(",")(0).Replace("'", "")
                    blnReplaceContent = True ' Ensure that we update RequestedControlFocus on the page.  This ensures that the field gets focus.
                End If
                'RegisterHiddenFields(("RequestedControlFocus"), m_strRequestedControlFocus, blnReplaceContent)
            End If

            'We have specifically overrided Render method to register arTabOrder which gets
            'populated in PreRender event of Core Controls
            'RegisterHiddenFields("RequestedControlFocusOverRide", m_strRequestedControlFocusOverRide)
            'RegisterHiddenFields("AccessKeys", m_strActionDropdowns)

            'Me.ClientScript.RegisterArrayDeclaration("arTabOrder", "''")
            With Me.m_strInitScript
                .Append("arTabOrder=new Array(")
                .Append(ControlList.ElementList())
                .Append(");")
            End With

            If IsFlickerFree Then
                'RegisterHiddenFields("ReplaceContent", m_strReplaceContent)
                'RegisterHiddenFields("hidIsRunscreen", m_strHidRunscreen)
                'RegisterHiddenFields("FlickerFree", "True")
            End If



            'Generate a script for Combo Box Items
            'Me.ClientScript.RegisterClientScriptBlock(Me.GetType(), "ComboValues", GenerateComboScript())

            'Generate FunctionKeysScript
            'If Not Me.Page.IsFlickerFree OrElse Not Me.IsPostBack Then Me.ClientScript.RegisterClientScriptBlock(Me.GetType(), "CheckFunctionKeys", GetFunctionKeysScript)

            'Rendering the page
            'MyBase.Render(writer)

            'Release the combobox items table
            If Not m_tblColumnsTable Is Nothing Then
                m_tblColumnsTable.Dispose()
                m_tblColumnsTable = Nothing
            End If

            'Release the combobox items collection
            If Not m_colUserComboValues Is Nothing Then
                m_colUserComboValues.Clear()
                m_colUserComboValues = Nothing
            End If


        End Sub

        ''' --- RaiseLoadPageState -------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RaiseLoadPageState.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Function RaiseResetInitialValues() As Boolean
            CoreWebTrace("RaiseResetInitialValues", "Start RaiseResetInitialValues")
            RaiseEvent ResetInitialValues()
            Return True
            CoreWebTrace("RaiseResetInitialValues", "End RaiseResetInitialValues")
        End Function

        ''' --- RaiseLoadPageState -------------------------------------------------
        ''' <exclude />
        ''' <summary>
        '''     Summary of RaiseLoadPageState.
        ''' </summary>
        ''' <param name="IsInField"></param>
        ''' <param name="IncludeObjectState"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        '''     [Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(EditorBrowsableState.Advanced)>
        Protected Function RaiseLoadPageState(IsInField As Boolean, IncludeObjectState As ObjectState,
                                              Optional ByVal blnFromAppend As Boolean = False) As Boolean
            m_intPath = Session("Path")
            'Note: We are retrieving state only if we have persisted it
            '      We added this code to handle Run Screen from Initialize and similar methods
            CoreWebTrace("LoadPageState",
                         "Start RaiseLoadPageState-" + IsInField.ToString + "-" + IncludeObjectState.ToString)
            If Me.IsStateAvailable(IsInField) Then
                RaiseEvent _
                    LoadPageState(Me, New PageStateEventArgs(IIf(IsInField, "_InField_", "_"), IncludeObjectState),
                                  blnFromAppend)
                m_clearRequestInitValues = False
                Return True
            Else
                Return False
            End If
            CoreWebTrace("LoadPageState",
                         "End RaiseLoadPageState-" + IsInField.ToString + "-" + IncludeObjectState.ToString)
        End Function

        ''' --- RaiseCheckFileStatuses ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	This is used to determine if any files were altered.
        ''' </summary>
        ''' <remarks>If any files were altered this sets the IsDirty flag on the page 
        ''' indicating data has changed.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub RaiseCheckFileStatuses()
            Dim blnIsDirty As Boolean
            RaiseEvent CheckFileStatuses(blnIsDirty)
            IsDirty = blnIsDirty
        End Sub

        ''' --- BindFields ---------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Used to bind fields to non-grid field objects.
        ''' </summary>
        ''' <remarks>Should be overridden in derived page.
        ''' <para>
        '''     <note>In Derived page, BindFields should only contain non-grid fields,
        '''     Grid Fields should be bound in GetGridFieldObject.</note>
        ''' </para>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Overridable Sub BindFields()
            'Should be overridden in derived page
            'Note: In Derived page, BindFields should only contain non-grid fields,
            '      Grid Fields should be bound in GetGridFieldObject
        End Sub

        ''' --- For ----------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Repeats a group of statements a specified number of times.
        ''' </summary>
        ''' <param name="OccursTimes">An integer value indicating the number of times to repeat the group of statements.</param>
        ''' <remarks>
        ''' </remarks>
        ''' <example>
        ''' Do While Me.For(10) <br/>
        '''     If T_TEMP.Value = 5 Then <br/>
        '''         Me.Break: Exit Do <br/>
        '''     End If <br/>
        ''' Loop
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function [For](ByVal OccursTimes As Integer) As Boolean
            'Note: in case of calls to nested For call NestedFor with ID starting with "For"
            Return NestedFor("InterFor1", OccursTimes)
        End Function

        ''' --- For ----------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Repeats a group of statements a specified number of times.
        ''' </summary>
        ''' <param name="FileObject">The File class that controls the number of iterations based on the occurrence.</param>
        ''' <param name="SkipError">A boolean value indicating to continue if an error occurs.</param>
        ''' <remarks>
        ''' This method is used during the Find sequence to ensure that if no record is found for the current iteration that matches the retrieval criteria, 
        ''' continue looping until no more records exists.
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function [For](ByVal FileObject As BaseFileObject, ByVal SkipError As Boolean) As Boolean
            With FileObject
                If Not SkipError Then
                    m_blnErrorInLastRecord = False
                    m_intRecordsToFillInFindOrDetailFind = -1
                    m_blnSkipRecordsWithError = False
                    .SkipRecordsWithError = False
                Else
                    .m_intRecordsToFillInFindOrDetailFind = m_intRecordsToFillInFindOrDetailFind
                    .SkipRecordsWithError = True
                    m_blnSkipRecordsWithError = True
                    PaginationType = PaginationTypes.FirstNextOnly
                End If

                If .For(Me.m_blnInFindOrDetailFind, m_blnErrorInLastRecord) Then
                    Return True
                Else
                    m_blnSkipRecordsWithError = False
                    m_blnErrorInLastRecord = False
                    m_intRecordsToFillInFindOrDetailFind = -1
                    Return False
                End If
            End With
        End Function



        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As OracleFileObject) As Boolean
            Return GetData(FileObject, String.Empty, String.Empty, String.Empty, GetDataOptions.None, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="GetDataBehaviour"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As OracleFileObject, ByVal GetDataBehaviour As GetDataOptions) As Boolean
            Return GetData(FileObject, String.Empty, String.Empty, String.Empty, GetDataBehaviour, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="WhereClause"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As OracleFileObject, ByVal WhereClause As String) As Boolean
            Return GetData(FileObject, WhereClause, String.Empty, String.Empty, GetDataOptions.None, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="WhereClause"></param>
        ''' <param name="OrderByClause"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As OracleFileObject,
            ByVal WhereClause As String,
            ByVal OrderByClause As String) As Boolean
            'Return FileObject.GetData(WhereClause, OrderByClause)
            Return GetData(FileObject, WhereClause, OrderByClause, String.Empty, GetDataOptions.None, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="WhereClause"></param>
        ''' <param name="GetDataBehaviour"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As OracleFileObject,
            ByVal WhereClause As String,
            ByVal GetDataBehaviour As GetDataOptions) As Boolean
            'Return FileObject.GetData(WhereClause, GetDataBehaviour)
            Return GetData(FileObject, WhereClause, String.Empty, String.Empty, GetDataBehaviour, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="WhereClause"></param>
        ''' <param name="OrderByClause"></param>
        ''' <param name="GetDataBehaviour"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As OracleFileObject,
            ByVal WhereClause As String,
            ByVal OrderByClause As String,
            ByVal GetDataBehaviour As GetDataOptions) As Boolean
            'Return FileObject.GetData(WhereClause, OrderByClause, GetDataBehaviour)
            Return GetData(FileObject, WhereClause, OrderByClause, String.Empty, GetDataBehaviour, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="IsOverrided"></param>
        ''' <param name="OverrideSQL"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As OracleFileObject,
            ByVal IsOverrided As Boolean,
            ByVal OverrideSQL As String) As Boolean
            'Return FileObject.GetData(IsOverrided, OverrideSQL)
            Return GetData(FileObject, String.Empty, String.Empty, OverrideSQL, GetDataOptions.None, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Retrieve data from the database.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="IsOverrided"></param>
        ''' <param name="OverrideSQL"></param>
        ''' <param name="GetDataBehaviour"></param>
        ''' <remarks>Use this method if you ever need to pass a complete SQL statement with GetDataBehaviour.
        ''' <para>
        '''     <list type="numbered">
        '''         <item>Don't use this construct to generate Overrided SQL Statement internally.
        '''             i.e. Use this method if you ever need to pass GetDataBehaviour 
        '''             other than GetDataBehaviour.CreateSubSelect.</item>
        '''         <item>To pass GetDataBehaviour.CreateSubSelect use another method, if you need  
        '''             to pass Where Clause and Order By clause along with Auto Overrided SQL 
        '''             e.g. GetData(WhereClause, OrderByClause,  GetDataOptions.CreateSubSelect)
        '''             <para>
        '''                 If you pass OverrideSQL along with GetDataBehaviour =  GetDataOptions.CreateSubSelect
        '''                 this method will use passed OverrideSQL, completely ignoring the  GetDataOptions.CreateSubSelect
        '''             </para></item>
        '''         <item>The first parameter "IsOverrided" is added to add overloaded method Passing it as false has NO impact,
        '''             i.e. whether you pass True or False this function will treat it as True.</item>
        '''     </list>
        ''' </para>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As OracleFileObject,
            ByVal IsOverrided As Boolean,
            ByVal OverrideSQL As String,
            ByVal GetDataBehaviour As GetDataOptions) As Boolean

            Return GetData(FileObject, String.Empty, String.Empty, OverrideSQL, GetDataBehaviour, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="WhereClause"></param>
        ''' <param name="OrderByClause"></param>
        ''' <param name="OverrideSQL"></param>
        ''' <param name="GetDataBehaviour"></param>
        ''' <param name="RecordsToFill"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Overridable Function GetData(ByRef FileObject As OracleFileObject,
                    ByVal WhereClause As String,
                    ByVal OrderByClause As String,
                    ByVal OverrideSQL As String,
                    ByVal GetDataBehaviour As GetDataOptions,
                    ByRef RecordsToFill As Integer) As Boolean





            Dim blnReturnValue As Boolean
            Dim strFileName As String

            m_intGetSequence += 1

            ' Get the file name (either Alias name or Base name).
            If FileObject.AliasName.TrimEnd.Length > 0 Then
                strFileName = FileObject.AliasName
            Else
                strFileName = FileObject.BaseName
            End If


            strFileName &= m_intGetSequence.ToString

            Dim blnMethodWasExecuted As Boolean

            If Me.UseAcceptProcessing Then
                blnMethodWasExecuted = MethodWasExecuted(m_htGetFlag, m_intGetSequence)
            Else
                blnMethodWasExecuted = MethodWasExecuted(m_strGetFlag, m_intGetSequence)
            End If

            If Not blnMethodWasExecuted Then


                blnReturnValue = FileObject.GetData(WhereClause, OrderByClause, OverrideSQL, GetDataBehaviour, RecordsToFill)

                'Me.InternalPageState(FileObject.AliasName + FileObject.BaseName + "_GetData") = FileObject.GetInternalValues()

                ' Save the sequence information and set a flag indicating ACCEPT was run.
                If Me.UseAcceptProcessing Then
                    SetMethodExecutedFlag(m_htGetFlag, "GET_FLAG", m_intGetSequence)
                Else
                    SetMethodExecutedFlag(m_strGetFlag, "GET_FLAG", m_intGetSequence)
                End If

            Else

                'FileObject.SetInternalValues(CType(Me.InternalPageState(FileObject.AliasName + FileObject.BaseName + "_GetData"), Hashtable))


                blnAccessOk = FileObject.Exists



                blnReturnValue = True
            End If


            Return blnReturnValue



        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As SqlFileObject) As Boolean
            Return GetData(FileObject, String.Empty, String.Empty, String.Empty, GetDataOptions.None, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="GetDataBehaviour"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As SqlFileObject, ByVal GetDataBehaviour As GetDataOptions) As Boolean
            Return GetData(FileObject, String.Empty, String.Empty, String.Empty, GetDataBehaviour, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="WhereClause"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As SqlFileObject, ByVal WhereClause As String) As Boolean
            Return GetData(FileObject, WhereClause, String.Empty, String.Empty, GetDataOptions.None, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="WhereClause"></param>
        ''' <param name="OrderByClause"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As SqlFileObject,
            ByVal WhereClause As String,
            ByVal OrderByClause As String) As Boolean
            'Return FileObject.GetData(WhereClause, OrderByClause)
            Return GetData(FileObject, WhereClause, OrderByClause, String.Empty, GetDataOptions.None, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="WhereClause"></param>
        ''' <param name="GetDataBehaviour"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As SqlFileObject,
            ByVal WhereClause As String,
            ByVal GetDataBehaviour As GetDataOptions) As Boolean
            'Return FileObject.GetData(WhereClause, GetDataBehaviour)
            Return GetData(FileObject, WhereClause, String.Empty, String.Empty, GetDataBehaviour, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="WhereClause"></param>
        ''' <param name="OrderByClause"></param>
        ''' <param name="GetDataBehaviour"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As SqlFileObject,
            ByVal WhereClause As String,
            ByVal OrderByClause As String,
            ByVal GetDataBehaviour As GetDataOptions) As Boolean
            'Return FileObject.GetData(WhereClause, OrderByClause, GetDataBehaviour)
            Return GetData(FileObject, WhereClause, OrderByClause, String.Empty, GetDataBehaviour, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="IsOverrided"></param>
        ''' <param name="OverrideSQL"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As SqlFileObject,
            ByVal IsOverrided As Boolean,
            ByVal OverrideSQL As String) As Boolean
            'Return FileObject.GetData(IsOverrided, OverrideSQL)
            Return GetData(FileObject, String.Empty, String.Empty, OverrideSQL, GetDataOptions.None, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Retrieve data from the database.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="IsOverrided"></param>
        ''' <param name="OverrideSQL"></param>
        ''' <param name="GetDataBehaviour"></param>
        ''' <remarks>Use this method if you ever need to pass a complete SQL statement with GetDataBehaviour.
        ''' <para>
        '''     <list type="numbered">
        '''         <item>Don't use this construct to generate Overrided SQL Statement internally.
        '''             i.e. Use this method if you ever need to pass GetDataBehaviour 
        '''             other than GetDataBehaviour.CreateSubSelect.</item>
        '''         <item>To pass GetDataBehaviour.CreateSubSelect use another method, if you need  
        '''             to pass Where Clause and Order By clause along with Auto Overrided SQL 
        '''             e.g. GetData(WhereClause, OrderByClause,  GetDataOptions.CreateSubSelect)
        '''             <para>
        '''                 If you pass OverrideSQL along with GetDataBehaviour =  GetDataOptions.CreateSubSelect
        '''                 this method will use passed OverrideSQL, completely ignoring the  GetDataOptions.CreateSubSelect
        '''             </para></item>
        '''         <item>The first parameter "IsOverrided" is added to add overloaded method Passing it as false has NO impact,
        '''             i.e. whether you pass True or False this function will treat it as True.</item>
        '''     </list>
        ''' </para>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetData(ByRef FileObject As SqlFileObject,
            ByVal IsOverrided As Boolean,
            ByVal OverrideSQL As String,
            ByVal GetDataBehaviour As GetDataOptions) As Boolean

            Return GetData(FileObject, String.Empty, String.Empty, OverrideSQL, GetDataBehaviour, m_intRecordsToFillInFindOrDetailFind)
        End Function

        ''' --- GetData ------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetData.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="WhereClause"></param>
        ''' <param name="OrderByClause"></param>
        ''' <param name="OverrideSQL"></param>
        ''' <param name="GetDataBehaviour"></param>
        ''' <param name="RecordsToFill"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Overridable Function GetData(ByRef FileObject As SqlFileObject,
                    ByVal WhereClause As String,
                    ByVal OrderByClause As String,
                    ByVal OverrideSQL As String,
                    ByVal GetDataBehaviour As GetDataOptions,
                    ByRef RecordsToFill As Integer) As Boolean





            Dim blnReturnValue As Boolean
            Dim strFileName As String

            m_intGetSequence += 1

            ' Get the file name (either Alias name or Base name).
            If FileObject.AliasName.TrimEnd.Length > 0 Then
                strFileName = FileObject.AliasName
            Else
                strFileName = FileObject.BaseName
            End If


            strFileName &= m_intGetSequence.ToString

            Dim blnMethodWasExecuted As Boolean

            If Me.UseAcceptProcessing Then
                blnMethodWasExecuted = MethodWasExecuted(m_htGetFlag, m_intGetSequence)
            Else
                blnMethodWasExecuted = MethodWasExecuted(m_strGetFlag, m_intGetSequence)
            End If

            If Not blnMethodWasExecuted OrElse blnFieldDiff Then


                blnReturnValue = FileObject.GetData(WhereClause, OrderByClause, OverrideSQL, GetDataBehaviour, RecordsToFill)

                'Me.InternalPageState(FileObject.AliasName + FileObject.BaseName + "_GetData_" & m_intGetSequence.ToString) = FileObject.GetInternalValues()
                'Me.InternalPageState(FileObject.AliasName + FileObject.BaseName + "_GetData") = FileObject.GetInternalValues()

                ' Save the sequence information and set a flag indicating ACCEPT was run.
                If Me.UseAcceptProcessing Then
                    SetMethodExecutedFlag(m_htGetFlag, "GET_FLAG", m_intGetSequence)
                Else
                    SetMethodExecutedFlag(m_strGetFlag, "GET_FLAG", m_intGetSequence)
                End If

            Else

                'FileObject.SetInternalValues(CType(Me.InternalPageState(FileObject.AliasName + FileObject.BaseName + "_GetData_" & m_intGetSequence.ToString), Hashtable))


                blnAccessOk = FileObject.Exists



                blnReturnValue = True
            End If


            Return blnReturnValue



        End Function

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Overridable Function WhileRetrieving(ByRef FileObject As SqlFileObject, Optional ByVal WhereClause As String = "", Optional ByVal OrderByClause As String = "", Optional ByVal Sequential As Boolean = False, Optional ByVal Backward As Boolean = False, Optional ByVal IsOptional As Boolean = False) As Boolean





            Dim blnReturnValue As Boolean
            Dim strFileName As String

            m_intGetSequence += 1

            ' Get the file name (either Alias name or Base name).
            If FileObject.AliasName.TrimEnd.Length > 0 Then
                strFileName = FileObject.AliasName
            Else
                strFileName = FileObject.BaseName
            End If


            strFileName &= m_intGetSequence.ToString

            Dim blnMethodWasExecuted As Boolean

            If Me.UseAcceptProcessing Then
                blnMethodWasExecuted = MethodWasExecuted(m_htGetFlag, m_intGetSequence)
            Else
                blnMethodWasExecuted = MethodWasExecuted(m_strGetFlag, m_intGetSequence)
            End If

            If Not blnMethodWasExecuted Then

                blnReturnValue = FileObject.WhileRetrieving(WhereClause, OrderByClause, Sequential, Backward, IsOptional)

                'Me.InternalPageState(FileObject.AliasName + FileObject.BaseName + "_GetData_" & m_intGetSequence.ToString) = FileObject.GetInternalValues()
                'Me.InternalPageState(FileObject.AliasName + FileObject.BaseName + "_GetData") = FileObject.GetInternalValues()


                ' Save the sequence information and set a flag indicating ACCEPT was run.
                If Me.UseAcceptProcessing Then
                    SetMethodExecutedFlag(m_htGetFlag, "GET_FLAG", m_intGetSequence)
                Else
                    SetMethodExecutedFlag(m_strGetFlag, "GET_FLAG", m_intGetSequence)
                End If


            Else


                'FileObject.SetInternalValues(CType(Me.InternalPageState(FileObject.AliasName + FileObject.BaseName + "_GetData_" & m_intGetSequence.ToString), Hashtable))
                blnReturnValue = Not FileObject.GetStringValue("ROW_ID").Trim = ""


            End If


            Return blnReturnValue



        End Function



        ''' --- ForMissing ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ForMissing.
        ''' </summary>
        ''' <param name="FileObject"></param>
        ''' <param name="SkipError"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function ForMissing(ByVal FileObject As BaseFileObject, ByVal SkipError As Boolean) As Boolean
            With FileObject
                If Not SkipError Then
                    m_blnErrorInLastRecord = False
                    m_intRecordsToFillInFindOrDetailFind = -1
                    .SkipRecordsWithError = False
                Else
                    .m_intRecordsToFillInFindOrDetailFind = m_intRecordsToFillInFindOrDetailFind
                    .SkipRecordsWithError = True
                    m_blnSkipRecordsWithError = True
                    PaginationType = PaginationTypes.FirstNextOnly
                End If

                If .ForMissing(Me.m_blnInFindOrDetailFind, m_blnErrorInLastRecord) Then
                    Return True
                Else
                    m_blnSkipRecordsWithError = False
                    m_blnErrorInLastRecord = False
                    m_intRecordsToFillInFindOrDetailFind = -1
                    Return False
                End If
            End With
        End Function

        ''' --- NestedFor ----------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Repeats a group of statements within another repeating control structure.
        ''' </summary>
        ''' <param name="ForID">A string value generated by the Renaissance Architect PreCompiler to uniquely identify this control structure.</param>
        ''' <param name="OccursTimes">An integer value indicating the number of times to repeat the group of statements.</param>
        ''' <remarks>
        ''' The NestedFor method is used to handle For controls structures being called within For control structures.  The RenaissanceArchitect PreCompiler 
        ''' will generate a unique ForID parameter.  This function ensures that the Occurrence is reset properly upon completion or breaking out of this control structure.
        ''' </remarks>
        ''' <example>
        ''' Do While Me.NestedFor("1", 10) <br/>
        '''     If T_TEMP.Value = 5 Then <br/>
        '''         Me.Break: Exit Do <br/>
        '''     End If <br/>
        ''' Loop
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function NestedFor(ByVal ForID As String, ByVal OccursTimes As Integer) As Boolean
            'Note: in case of calls to nested For call NestedFor with ID starting with "For"

            'Notes:
            'The behaviour of For function has following differences from the Legacy App:
            '1.	It will produce unexpected results if it has direct or indirect nested For/WhileRetrieve (discussed in WhileRetrieve of BaseFileObject).
            '2. Whenever there is "Break" inside the For loop it is necessary to 
            '   Reset m_blnSaveOccurence through Break
            '3. OccursTimes is assumed to be One based, however m_intOccurrence
            '   which is used to loop through all occurrence is zero based
            '4. To access the global Occurrence use Occurrence Property which is one based

            m_strPreviousFor = ForID

            If m_hstNestedForInfo Is Nothing Then m_hstNestedForInfo = New Hashtable

            'If m_hstNestedForInfo contains the passed ForID,
            'Move to the next Record using the Occurrence
            'Otherwise see Else part for comments
            If m_hstNestedForInfo.Contains(ForID) Then
                ' Reached at either Last Value in FileObject i.e. EOF or 
                ' upto Occurs then Reset OccursTimes and Position in an Array
                If (m_intOccurrence + 1) >= OccursTimes Then 'm_intOccurrence is zero based and OccursTimes is one based
                    'we need to reset some variables inside the Break method
                    'so that subsequent FOR Statements (if any) can start 
                    'from First Value
                    Break(ForID) 'We are using Break to reset these variables

                    'Return False so that we can exit from the Do While Loop in derived Page
                    Return False
                Else
                    'Move to next Occurrence and bind Grid Fields if screen has grid
                    SetOccurrence(m_intOccurrence + 1)
                End If
            Else
                'If m_hstNestedForInfo doesn't contain the passed ForID
                'Create a new instance of ForInfo using the current occurrence and CurrentRow
                'and add it to the m_hstNestedForInfo
                m_hstNestedForInfo.Add(ForID, New ForInfo(m_intOccurrence, m_intOccurrence))
                m_strLastForID = ForID

                'Increment the m_intLastForIDNumber which denotes the ID number for inner most For
                m_intLastForIDNumber += 1
                If m_intLastForIDNumber = 0 Then
                    'If this is the first (outer most) For
                    'Create the m_sorNestedForIDs
                    m_sorNestedForIDs = New SortedList

                    'Update m_sorNestedForIDs with the ForID, which is used 
                    'to determine For in Break (w/o parameters) method
                    m_sorNestedForIDs.Add(m_intLastForIDNumber, ForID)
                End If

                'Start from the first Value i.e. 0
                SetOccurrence(0)

                m_strPreviousFor = ""

            End If

            'Return True to continue looping through all records in a file in derived Page
            Return True

        End Function

        ''' --- Break --------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Breaks out of executing a group of statements during a For loop.
        ''' </summary>
        ''' <remarks>
        ''' Use the Break verb to break out of executing a group of statements when a condition is met.  
        ''' <note>
        ''' Always use the break verb followed by the Exit Do verb as specified in the example.  
        ''' </note>
        ''' </remarks>
        ''' <example>
        ''' Do While Me.NestedFor(10) <br/>
        '''     If T_TEMP.Value = 5 Then <br/>
        '''         Me.Break: Exit Do <br/>
        '''     End If <br/>
        ''' Loop
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Sub Break()
            'This function can be called from the derived page whenever there is a Break inside the For loop

            'If "For" and "Break" method is used properly, m_strLastForID should always have
            'the value set during a Call to "For" or "ForMissing"
            Me.Break(Me.m_strLastForID)
        End Sub

        ''' --- Break --------------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Breaks out of executing a group of statements during a NestedFor loop.
        ''' </summary>
        ''' <remarks>
        ''' Use the Break verb to break out of executing a group of statements when a condition is met.  
        ''' <note>
        ''' Always use the break verb followed by the Exit Do verb as specified in the example.  
        ''' </note>
        ''' </remarks>
        ''' <example>
        ''' Do While Me.NestedFor("1", 10) <br/>
        '''     If T_TEMP.Value = 5 Then <br/>
        '''         Me.Break("1"): Exit Do <br/>
        '''     End If <br/>
        ''' Loop <br/>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Private Sub Break(ByVal ForID As String)
            'This function should not be called from outside the Base Page

            If Not m_hstNestedForInfo.Contains(ForID) Then
                'To avoid Error exit
                Exit Sub
            End If

            Dim objForInfo As ForInfo

            'Get the ForInfo for the passed "ForID"
            objForInfo = CType(m_hstNestedForInfo(ForID), ForInfo)

            'Reset Main Occurrence on the Page to Previous Value and if applicable, bind Grid Fields
            Me.SetOccurrence(objForInfo.PreviousOccurrence)

            'Release the reference to ForInfo
            objForInfo = Nothing

            'Remove the ForInfo object from NestedForInfo hash table
            m_hstNestedForInfo.Remove(ForID)

            'Reduce the LastForIDNumber by one
            m_intLastForIDNumber -= 1

            'If there is no nested For left, 
            'remove the reference to m_sorNestedForIDs and m_strLastForID 
            'otherwise get the m_strLastForID from the m_sorNestedForIDs
            If m_intLastForIDNumber = -1 Then
                m_sorNestedForIDs = Nothing
                m_strLastForID = Nothing

                'Note: m_intLastForIDNumber and m_hstNestedForInfo should work hand-in-hand,
                'if m_intLastForIDNumber becomes negative, ideally m_hstNestedForInfo should not contain any item
                'however to release the reference we are clearing and than releasing the m_hstNestedForInfo
                m_hstNestedForInfo.Clear()
                m_hstNestedForInfo = Nothing
            Else
                m_strLastForID = CStr(m_sorNestedForIDs.Item(m_intLastForIDNumber))
            End If

            m_strPreviousFor = ""

        End Sub

        ''' --- GetPreviousPath ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetPreviousPath.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function GetPreviousPath() As Integer
            Dim strPath As String
            strPath = m_intPath
            If strPath Is Nothing OrElse strPath = String.Empty Then
                Return 0
            End If
            Return CInt(strPath)
        End Function

        ''' --- RegisterStateFlag --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of RegisterStateFlag.
        ''' </summary>
        ''' <param name="IsInField"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function RegisterStateFlag(ByVal IsInField As Boolean)
            If IsInField Then
                blnIsInFieldState = True
            Else
                blnIsMainState = True
            End If
            Return Nothing
        End Function

        ''' --- IsStateAvailable ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsStateAvailable.
        ''' </summary>
        ''' <param name="IsInField"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function IsStateAvailable(ByVal IsInField As Boolean) As Boolean
            If IsInField Then
                Return blnIsInFieldState
            Else
                Return blnIsMainState
            End If
        End Function

        ''' --- SetOccurrence ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SetOccurrence.
        ''' </summary>
        ''' <param name="NewOccurrence"></param>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Function SetOccurrence(ByVal NewOccurrence As Integer, Optional ByVal ByPassBinding As Boolean = False)
            'Note: This function should not be called from outside the Framework
            ' m_intLastBoundRow is specially added to handle "For" in the user 
            ' defined Designer which doesn't have any "Accept", however still access
            ' the grid fields by changing record buffer and calling "Display" on Grid fields.
            If NewOccurrence >= 0 AndAlso (Me.m_intOccurrence <> NewOccurrence OrElse Me.m_intLastBoundRow <> NewOccurrence) Then
                Me.m_intOccurrence = NewOccurrence

                'Setting m_blnBindGridFields flag to "False" limits the use of Grid Fields
                'directly or indirectly inside the "For"/"ForMissing" method in
                '"Find, PostFind, DetailFind and DetailPostfind" methods i.e. Grid Fields will not be accessible inside the
                '"For"/"ForMissing" loop in "Find, PostFind, DetailFind and DetailPostfind" methods
                'This behaviour is by design
                If Not ByPassBinding AndAlso Me.m_blnBindGridFields Then
                    Me.m_intLastBoundRow = NewOccurrence
                    Me.RaiseBindGridFields(NewOccurrence)
                End If
            End If
            Return Nothing
        End Function

        ''' --- CheckLookupOnSameFile ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CheckLookupOnSameFile.
        ''' </summary>
        ''' <param name="FileName"></param>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Function SetLookupNotOnFileName(ByVal FileName As String)
            'Note: This function should not be called from outside the Framework
            If m_blnExecutingLookupNotOn Then
                m_strLookupNotOnFileName = FileName
            End If
            Return Nothing
        End Function

        ''' --- CheckLookupOnSameFile ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CheckLookupOnSameFile.
        ''' </summary>
        ''' <param name="FileName"></param>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Function CheckLookupOnSameFile(ByVal FileName As String)
            'Note: This function should not be called from outside the Framework
            If m_blnExecutingLookupNotOn AndAlso Not m_blnLookupOnSameFile AndAlso m_strLookupNotOnFileName = FileName Then
                m_blnLookupOnSameFile = True
            End If
            Return Nothing
        End Function

        ''' --- DisplayPleaseWait --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of DisplayPleaseWait.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub DisplayPleaseWait()

            'If Request.QueryString("redirectPage") Is Nothing OrElse Request.QueryString("redirectPage").Length = 0 Then

            '    Dim stbPleaseWaitURL As System.Text.StringBuilder

            '    stbPleaseWaitURL = New System.Text.StringBuilder
            '    stbPleaseWaitURL.Append("http://")
            '    stbPleaseWaitURL.Append(Request.Url.Host)
            '    stbPleaseWaitURL.Append(Request.ApplicationPath)
            '    stbPleaseWaitURL.Append(m_strPleaseWaitPage)
            '    stbPleaseWaitURL.Append(Request.Url.Query)
            '    stbPleaseWaitURL.Append("&redirectPage=")
            '    stbPleaseWaitURL.Append(Request.Url.Host)
            '    stbPleaseWaitURL.Append(Request.Url.AbsolutePath)

            '    Response.Redirect(stbPleaseWaitURL.ToString())
            'End If
        End Sub

        ''' --- GetDictionaryItem --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetDictionaryItem.
        ''' </summary>
        ''' <param name="FieldId"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetDictionaryItem(ByVal FieldId As String) As CoreDictionaryItem
            Return GetDictionaryItem(ApplicationState.Current.Language, FieldId)
        End Function

        ''' --- LoadDictionaries ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of LoadDictionaries.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Shared Sub LoadDictionaries()
            'Read the Dictionary File paths from the Config File
            Dim nvcDictionarySettings As NameValueCollection = CType(System.Configuration.ConfigurationManager.GetSection("coreAppSettings/Dictionaries"), NameValueCollection)

            With nvcDictionarySettings
                'Declare a loca variable to hold multiple Dictionaries
                Dim objDictionaries(.Count - 1) As CoreDictionary

                '
                colDictionaryKeys = New HybridDictionary
                For i As Integer = 0 To .Count - 1
                    colDictionaryKeys.Item(nvcDictionarySettings.Keys.Item(i)) = i
                    'We are not checking whether Dictionary File is exist or not
                    'So Path Provided in Web.Confi for Dictionary File should point to
                    'a valid Dictionary File

                    If File.Exists(nvcDictionarySettings.Item(i)) Then
                        objDictionaries(i) = New CoreDictionary(nvcDictionarySettings.Item(i))
                    Else
                        objDictionaries(i) = New CoreDictionary(System.IO.Path.GetDirectoryName(Process.GetCurrentProcess().MainModule.FileName) + nvcDictionarySettings.Item(i))
                    End If


                Next

                dicCoreDictionary = objDictionaries
            End With
        End Sub

        ''' --- GetDictionaryItem --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetDictionaryItem.
        ''' </summary>
        ''' <param name="Language"></param>
        ''' <param name="FieldId"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Shared Function GetDictionaryItem(ByVal Language As String, ByVal FieldId As String) As CoreDictionaryItem
            If dicCoreDictionary Is Nothing Then
                LoadDictionaries()
            End If

            If colDictionaryKeys.Contains(Language) Then
                Return dicCoreDictionary(CInt(colDictionaryKeys.Item(Language))).GetDictionaryItem(FieldId)
            Else
                ' There is no dictionary for the passed Language
                Return Nothing
            End If
        End Function

        ''' --- GetDictionaryHashTable ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetDictionaryHashTable.
        ''' </summary>
        ''' <param name="FieldId"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetDictionaryHashTable(ByVal FieldId As String) As Hashtable
            If ApplicationState.Current.Language = Nothing Then
                SetGlobalizationManager()
            End If
            Return GetDictionaryHashTable(ApplicationState.Current.Language, FieldId)
        End Function

        ''' --- GetDictionaryHashTable ---------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetDictionaryHashTable.
        ''' </summary>
        ''' <param name="Language"></param>
        ''' <param name="FieldId"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetDictionaryHashTable(ByVal Language As String, ByVal FieldId As String) As Hashtable
            If dicCoreDictionary Is Nothing Then
                LoadDictionaries()
            End If

            If colDictionaryKeys.Contains(Language.ToLower) Then
                Return dicCoreDictionary(CInt(colDictionaryKeys.Item(Language.ToLower))).GetDictionaryHashTable(FieldId)
            Else
                Return dicCoreDictionary(CInt(colDictionaryKeys.Item(colDictionaryKeys.Keys(0).ToLower))).GetDictionaryHashTable(FieldId)
            End If
        End Function

        ''' --- GetFindEntryMode ---------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetFindEntryMode.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub GetFindEntryMode()

            Dim strCurrentMode As String '= Me.ViewState("CurrentMode") & ""
            If strCurrentMode = "F" Then
                m_blnFindMode = True
            ElseIf strCurrentMode = "E" Then
                m_blnEntryMode = True
            End If

        End Sub

        ''' --- IsInEntry ----------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of IsInEntry.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Friend Function IsInEntry() As Boolean
            ' This function returns whether page is in entry mode or not.  This is only to be used
            ' by the controls so that we can determine whether to disable certain fields based on OMIT, DISPLAY, etc.
            Return Me.Mode = PageModeTypes.Entry OrElse Me.Mode = PageModeTypes.Correct OrElse ((Me.ScreenType = ScreenTypes.Composite OrElse Me.ScreenType = ScreenTypes.Grid) AndAlso Me.Mode = PageModeTypes.Change AndAlso Me.IsAppend)
        End Function

        ''' --- CallRetrieveParamsReceived -----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CallRetrieveParamsReceived.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub CallRetrieveParamsReceived()
            'Retrieve Passed Parameters only if it is new Request


            Try
                Me.RetrieveParamsReceived()
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try

        End Sub


        ''' --- CallCloseTransactionObjects ----------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of CallCloseTransactionObjects.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub CallCloseTransactionObjects()

            Try
                Me.CloseTransactionObjects()
            Catch ex As CustomApplicationException
                Throw ex
            Catch ex As Exception
                ExceptionManager.Publish(ex)
                Throw ex
            End Try
        End Sub

        ''' --- GetToolTip ---------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of GetToolTip.
        ''' </summary>
        ''' <param name="ToolTipID"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetToolTip(ByVal ToolTipID As String) As String
            Return Me.GlobalizationManager.GetString(ToolTipID, Globalization.Core.Globalization.ResourceTypes.Message)
        End Function

        ''' --- SetTableColumns ----------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of SetTableColumns.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Overridable Sub SetTableColumns()
            'Should be overrided in derived page to set Column Names used for each File Object
        End Sub

        ''' --- AuditStatus --------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Returns an "N", "D", or "C" value indicating the status of the current record.
        ''' </summary>
        ''' <param name="File">The File class for which to check the status.</param>
        ''' <remarks>
        ''' The AuditStatus method returns an "N" for a new record, "D" for a record marked for deletion, and a "C" for a changed record.
        ''' </remarks>
        ''' <example>
        ''' T_AUDIT_STATUS.Value = AuditStatus(fleEMPLOYEE)
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function AuditStatus(ByRef File As IFileObject) As String

            Return File.AuditStatus()

        End Function

        ''' --- CheckDatabase --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	CheckDatabase
        ''' </summary>
        ''' <param name="Sql"></param>
        ''' <remarks>
        ''' 
        ''' </remarks>
        ''' <example>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function CheckDatabase(ByVal Sql As StringBuilder, ByVal File As BaseFileObject) As Boolean

            Dim blnReturnValue As Boolean = True

            ' If m_blnLookupOnSameFile is true, then add the ROWID portion of the code
            ' to exclude the current record.
            If m_blnLookupOnSameFile AndAlso Not File.NewRecord Then
                Sql.Append(" AND ").Append(File.ElementOwner("ROWID")).Append(" <> ").Append(StringToField(File.RecordLocation))
            End If


            ' Fetch the result.
            If File.GetType().ToString().IndexOf("SqlFileObject") = -1 Then
                Dim rdr As OracleDataReader = Nothing
                Try
                    rdr = DataAccess.Oracle.OracleHelper.ExecuteReader(GetConnectionString, CommandType.Text, Sql.ToString)
                    blnReturnValue = Not rdr.Read
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                Finally
                    If Not rdr Is Nothing Then
                        If Not rdr.IsClosed Then
                            rdr.Close()
                        End If
                        rdr.Dispose()
                    End If
                End Try
            Else
                Dim rdr As SqlClient.SqlDataReader = Nothing
                Try
                    rdr = DataAccess.SqlServer.SqlHelper.ExecuteReader(GetSqlConnectionString, CommandType.Text, Sql.ToString)
                    blnReturnValue = Not rdr.Read
                Catch ex As CustomApplicationException
                    Throw ex
                Catch ex As Exception
                    ExceptionManager.Publish(ex)
                    Throw ex
                Finally
                    If Not rdr Is Nothing Then
                        If Not rdr.IsClosed Then
                            rdr.Close()
                        End If
                        rdr.Dispose()
                    End If
                End Try
            End If

            FileForRecordStatus = File

            Return blnReturnValue

        End Function
        ''' --- LookupNotOn --------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Returns True if the item has not been entered during the current Append/Entry sequence.
        ''' </summary>
        ''' <param name="File">The File class associated to the current field class.</param>
        ''' <param name="FieldName">The field to check for the current value.</param>
        ''' <param name="Value">The value to check for.</param>
        ''' <remarks>
        ''' The LookupNotOn method is called from the LookupNotOn event for grid screens to check
        ''' that the value entered in the current row is not found in any of the previously entered rows.
        ''' <note>
        ''' If this value has already been entered (ie. the LookupNotOn fails), then an error will be raised
        ''' instead of returning False.
        ''' </note>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function LookupNotOn(ByVal Sql As StringBuilder, ByVal File As BaseFileObject, ByVal FieldName As String, ByVal Value As String) As Boolean

            Dim blnReturnValue As Boolean = CheckDatabase(Sql, File)

            If blnReturnValue Then
                Dim intOccurrence As Integer
                blnReturnValue = File.LookupNotOn(FieldName, Value, intOccurrence)
                If Not blnReturnValue Then

                    If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                        ErrorMessage("C'est la mme cl / index que l'occurrence ({0})", intOccurrence.ToString) 'IM.SameKeyIndex
                    Else
                        ErrorMessage("This is the same key/index as occurrence ({0})", intOccurrence.ToString) 'IM.SameKeyIndex
                    End If
                End If
            End If
            Return blnReturnValue

        End Function

        ''' --- LookupNotOn --------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Returns True if the item has not been entered during the current Append/Entry sequence.
        ''' </summary>
        ''' <param name="File">The File class associated to the current field class.</param>
        ''' <param name="FieldName">The field to check for the current value.</param>
        ''' <param name="Value">The value to check for.</param>
        ''' <remarks>
        ''' The LookupNotOn method is called from the LookupNotOn event for grid screens to check
        ''' that the value entered in the current row is not found in any of the previously entered rows.
        ''' <note>
        ''' If this value has already been entered (ie. the LookupNotOn fails), then an error will be raised
        ''' instead of returning False.
        ''' </note>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function LookupNotOn(ByVal File As BaseFileObject, ByVal FieldName As String, ByVal Value As String) As Boolean
            Dim intOccurrence As Integer
            Dim blnReturnValue As Boolean = File.LookupNotOn(FieldName, Value, intOccurrence)
            If Not blnReturnValue Then
                If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                    ErrorMessage("C'est la mme cl / index que l'occurrence ({0})", intOccurrence.ToString) 'IM.SameKeyIndex
                Else
                    ErrorMessage("This is the same key/index as occurrence ({0})", intOccurrence.ToString) 'IM.SameKeyIndex
                End If
            End If
            Return blnReturnValue
        End Function


        ''' --- LookupNotOn --------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Returns True if the item has not been entered during the current Append/Entry sequence.
        ''' </summary>
        ''' <param name="File">The File class associated to the current field class.</param>
        ''' <param name="FieldNames">An array of fields to check for the current values.</param>
        ''' <param name="Values">An array of values to check for.</param>
        ''' <remarks>
        ''' The LookupNotOn method is called from the LookupNotOn event for grid screens to check
        ''' that the value entered in the current row is not found in any of the previously entered rows.
        ''' <note>
        ''' If this value has already been entered (ie. the LookupNotOn fails), then an error will be raised
        ''' instead of returning False.
        ''' </note>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function LookupNotOn(ByVal Sql As StringBuilder, ByVal File As BaseFileObject, ByVal FieldNames As String(), ByVal Values As Object()) As Boolean

            Dim blnReturnValue As Boolean = CheckDatabase(Sql, File)

            If blnReturnValue Then
                Dim intOccurrence As Integer
                blnReturnValue = File.LookupNotOn(FieldNames, Values, intOccurrence)
                If Not blnReturnValue Then
                    If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                        ErrorMessage("C'est la mme cl / index que l'occurrence ({0})", (intOccurrence + 1).ToString) 'IM.SameKeyIndex
                    Else
                        ErrorMessage("This is the same key/index as occurrence ({0})", (intOccurrence + 1).ToString) 'IM.SameKeyIndex
                    End If
                End If
            End If
            Return blnReturnValue

        End Function

        ''' --- LookupNotOn --------------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Returns True if the item has not been entered during the current Append/Entry sequence.
        ''' </summary>
        ''' <param name="File">The File class associated to the current field class.</param>
        ''' <param name="FieldNames">An array of fields to check for the current values.</param>
        ''' <param name="Values">An array of values to check for.</param>
        ''' <remarks>
        ''' The LookupNotOn method is called from the LookupNotOn event for grid screens to check
        ''' that the value entered in the current row is not found in any of the previously entered rows.
        ''' <note>
        ''' If this value has already been entered (ie. the LookupNotOn fails), then an error will be raised
        ''' instead of returning False.
        ''' </note>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function LookupNotOn(ByVal File As BaseFileObject, ByVal FieldNames As String(), ByVal Values As Object()) As Boolean
            Dim intOccurrence As Integer
            Dim blnReturnValue As Boolean = File.LookupNotOn(FieldNames, Values, intOccurrence)
            If Not blnReturnValue Then
                If Thread.CurrentThread.CurrentCulture.ToString.StartsWith("fr") Then
                    ErrorMessage("C'est la mme cl / index que l'occurrence ({0})", (intOccurrence + 1).ToString) 'IM.SameKeyIndex
                Else
                    ErrorMessage("This is the same key/index as occurrence ({0})", (intOccurrence + 1).ToString) 'IM.SameKeyIndex
                End If
            End If
            Return blnReturnValue
        End Function

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' GetDefaultDateFormat returns "DateFormat" set in "AppSettings" section of web.config.
        ''' If not set in web.config, the default is "YYYYMMDD"
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Shared Function GetDefaultDateFormat() As String
            If m_strDefaultDateFormat Is Nothing Then
                m_strDefaultDateFormat = ApplicationState.Current.DateFormat
                'if not defined in Application collection, looking into AppSettings
                If m_strDefaultDateFormat Is Nothing Then m_strDefaultDateFormat = System.Configuration.ConfigurationManager.AppSettings("DateFormat")
                ' NOTE: This is for the purposes of the user entering a date using this format.  We will always
                '       internally (FIELDVALUE, etc.) treat this date in the format YYYYMMDD when manipulating it.
                ' Set the default date format based on the dictionary.  If not set, we will use YYYYMMDD.
                If m_strDefaultDateFormat Is Nothing Then m_strDefaultDateFormat = ""
            End If
            Return m_strDefaultDateFormat
        End Function



        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' IsNullSeparator returns "NullSeparator" set in "AppSettings" section of web.config.
        ''' If not set in web.config, it returns False.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Shared Function IsNullSeparator() As Boolean
            If m_strNullSeparator Is Nothing Then
                m_strNullSeparator = System.Configuration.ConfigurationManager.AppSettings("Default Null Separator")

                'if not defined in Application collection, looking into AppSettings
                If m_strNullSeparator Is Nothing Then m_strNullSeparator = System.Configuration.ConfigurationManager.AppSettings("NullSeparator")
                ' Set the default date Separator based on the dictionary.  If not set, the default is "/".
                If m_strNullSeparator Is Nothing OrElse m_strNullSeparator.Length = 0 Then m_strNullSeparator = "False"
            End If
            Return (m_strNullSeparator = "True")
        End Function

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' Initial Dialog Properties to specified Properties used to open Dialog Window
        ''' GetInitialDialogProperties returns "InitialDialogProperties" set in "AppSettings" section of web.config.
        ''' If not specified in web.config, the InitialDialogProperties for a Dialog Window is passed.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Friend Shared Function GetInitialDialogProperties() As String
            If m_strInitialDialogProperties Is Nothing Then
                m_strInitialDialogProperties = System.Configuration.ConfigurationManager.AppSettings("InitialDialogProperties")
                If m_strInitialDialogProperties = Nothing OrElse m_strInitialDialogProperties.Trim.Length = 0 Then m_strInitialDialogProperties = "dialogheight: 750px; dialogwidth: 1000px; center: yes; resizable: yes; status: no;"

                ReadScreenProperties()
            End If

            Return m_strInitialDialogProperties
        End Function

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' Summary of GetScreenDialogProperties.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function GetScreenDialogProperties(ByVal ScreenName As String) As String
            Dim strTempProperties As String
            strTempProperties = GetInitialDialogProperties.ToLower

            If (Not m_htScreenProperties.Contains(ScreenName)) Then
                If strTempProperties.Length > 0 Then
                    Return strTempProperties
                Else
                    Return Nothing
                End If
            End If
            Dim strScreenProperties As String() = CType(m_htScreenProperties(ScreenName), String())
            Dim intStart, intEnd As Integer
            Dim strTempProperty As String
            Dim blnRemoveCenter As Boolean


            strTempProperty = strScreenProperties(ScreenProperties.Top)
            If IsNumeric(strTempProperty) Then
                strTempProperty = strTempProperty + "px"
            End If

            If (Not strTempProperty Is Nothing) AndAlso strTempProperty.Trim <> String.Empty Then
                intStart = strTempProperties.IndexOf("dialogtop:")
                If intStart >= 0 Then
                    intEnd = strTempProperties.IndexOf(";", intStart)
                    strTempProperties = strTempProperties.Substring(0, intStart) + " dialogtop: " + strTempProperty + "; " + strTempProperties.Substring(intEnd + 1)
                Else
                    strTempProperties = strTempProperties + " dialogtop: " + strTempProperty + ";"
                End If
                blnRemoveCenter = True
            End If

            strTempProperty = strScreenProperties(ScreenProperties.Left)
            If IsNumeric(strTempProperty) Then
                strTempProperty = strTempProperty + "px"
            End If
            If (Not strTempProperty Is Nothing) AndAlso strTempProperty.Trim <> String.Empty Then
                intStart = strTempProperties.IndexOf("dialogleft:")
                If intStart >= 0 Then
                    intEnd = strTempProperties.IndexOf(";", intStart)
                    strTempProperties = strTempProperties.Substring(0, intStart) + " dialogleft: " + strTempProperty + "; " + strTempProperties.Substring(intEnd + 1)
                Else
                    strTempProperties = strTempProperties + " dialogleft: " + strTempProperty + ";"
                End If
                blnRemoveCenter = True
            End If

            If blnRemoveCenter Then
                'If screen has overrided "Top" or "Left" property, remove "center" from dialog property
                'center: yes;
                intStart = strTempProperties.IndexOf("center:")
                If intStart >= 0 Then
                    intEnd = strTempProperties.IndexOf(";", intStart)
                    strTempProperties = strTempProperties.Substring(0, intStart) + " center: no; " + strTempProperties.Substring(intEnd + 1)
                Else
                    strTempProperties = strTempProperties + " center: no;"
                End If

            End If

            strTempProperty = strScreenProperties(ScreenProperties.Height)
            If IsNumeric(strTempProperty) Then
                strTempProperty = strTempProperty + "px"
            End If
            If (Not strTempProperty Is Nothing) AndAlso strTempProperty.Trim <> String.Empty Then
                intStart = strTempProperties.IndexOf("dialogheight:")
                If intStart >= 0 Then
                    intEnd = strTempProperties.IndexOf(";", intStart)
                    strTempProperties = strTempProperties.Substring(0, intStart) + " dialogheight: " + strTempProperty + "; " + strTempProperties.Substring(intEnd + 1)
                Else
                    strTempProperties = strTempProperties + " dialogheight: " + strTempProperty + ";"
                End If
            End If

            strTempProperty = strScreenProperties(ScreenProperties.Width)
            If IsNumeric(strTempProperty) Then
                strTempProperty = strTempProperty + "px"
            End If
            If (Not strTempProperty Is Nothing) AndAlso strTempProperty.Trim <> String.Empty Then
                intStart = strTempProperties.IndexOf("dialogwidth:")
                If intStart >= 0 Then
                    intEnd = strTempProperties.IndexOf(";", intStart)
                    strTempProperties = strTempProperties.Substring(0, intStart) + " dialogwidth: " + strTempProperty + "; " + strTempProperties.Substring(intEnd + 1)
                Else
                    strTempProperties = strTempProperties + " dialogwidth: " + strTempProperty + ";"
                End If
            End If

            Return strTempProperties
        End Function

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' Summary of GetScreenDialogProperties.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Shared Sub ReadScreenProperties()
            m_htScreenProperties = New Hashtable
            Dim strScreenPropertiesFileName As String = System.Configuration.ConfigurationManager.AppSettings("ScreenProperties")

            'Note: Using XmlTextReader, instead of XMLDocument to make the loading faster 
            'At present its not strictly observing the Encoding specifiec in the XML File,
            'XmlTextReader always the default Encoding which is Windows-1252
            Dim objScreenPropertiesXML As XmlTextReader = Nothing
            If (strScreenPropertiesFileName Is Nothing OrElse strScreenPropertiesFileName.Trim.Equals(String.Empty)) Then
                Return
            Else
                If File.Exists(strScreenPropertiesFileName) Then
                    Try
                        objScreenPropertiesXML = New XmlTextReader(strScreenPropertiesFileName)
                        With objScreenPropertiesXML
                            Dim strScreenName As String

                            While .Read
                                Select Case .NodeType
                                    Case XmlNodeType.Element
                                        If .Name.ToUpper.Equals("SCREEN") Then
                                            Dim strScreenProperties(3) As String
                                            strScreenName = String.Empty

                                            While .MoveToNextAttribute()
                                                Select Case .Name.ToUpper
                                                    Case "NAME"
                                                        strScreenName = .Value
                                                    Case "TOP"
                                                        strScreenProperties(ScreenProperties.Top) = .Value
                                                    Case "LEFT"
                                                        strScreenProperties(ScreenProperties.Left) = .Value
                                                    Case "HEIGHT"
                                                        strScreenProperties(ScreenProperties.Height) = .Value
                                                    Case "WIDTH"
                                                        strScreenProperties(ScreenProperties.Width) = .Value
                                                End Select
                                            End While

                                            m_htScreenProperties(strScreenName) = strScreenProperties
                                        End If
                                End Select
                            End While
                        End With
                    Catch ex As Exception
                        Throw ex
                    Finally
                        objScreenPropertiesXML.Close()
                        objScreenPropertiesXML = Nothing
                    End Try
                Else
                    'TODO: to be replaced with Exception Code that can display localized error message
                    Throw New CustomApplicationException("Screen Properties File Not found!")
                End If
            End If
        End Sub

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' Summary of ReadParmPrompts.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Sub ReadParmPrompts()
            m_htParmPrompts = New Hashtable
            Dim strParmPromptsFileName As String = System.Configuration.ConfigurationManager.AppSettings("ParmPrompts")
            Dim intOccurs As Integer = 2
            'Note: Using XmlTextReader, instead of XMLDocument to make the loading faster 
            'At present its not strictly observing the Encoding specifiec in the XML File,
            'XmlTextReader always the default Encoding which is Windows-1252
            Dim objParmPromptXML As XmlTextReader = Nothing
            If (strParmPromptsFileName Is Nothing OrElse strParmPromptsFileName.Trim.Equals(String.Empty)) Then
                Return
            Else
                If File.Exists(strParmPromptsFileName) Then
                    Try
                        objParmPromptXML = New XmlTextReader(strParmPromptsFileName)
                        With objParmPromptXML
                            Dim strJobName As String

                            While .Read
                                Select Case .NodeType
                                    Case XmlNodeType.Element
                                        If .Name.ToUpper.Equals("SCREEN") Then
                                            Dim strParmPrompts(6) As String
                                            strJobName = String.Empty

                                            While .MoveToNextAttribute()
                                                Select Case .Name.ToUpper
                                                    Case "JOB"
                                                        strJobName = .Value
                                                    Case "FIELD"
                                                        strParmPrompts(ParmPrompts.Field) = .Value
                                                    Case "TYPE"
                                                        strParmPrompts(ParmPrompts.Type) = .Value
                                                    Case "SIZE"
                                                        strParmPrompts(ParmPrompts.Size) = .Value
                                                    Case "LABEL"
                                                        strParmPrompts(ParmPrompts.Label) = .Value
                                                    Case "CHOOSE"
                                                        strParmPrompts(ParmPrompts.Prompt) = .Value
                                                    Case "VALUES"
                                                        strParmPrompts(ParmPrompts.Values) = .Value
                                                    Case "SHIFT"
                                                        strParmPrompts(ParmPrompts.ShiftType) = .Value
                                                End Select
                                            End While

                                            If m_htParmPrompts.Contains(strJobName) Then
                                                m_htParmPrompts(strJobName & "~occurs" & intOccurs & "~") = strParmPrompts
                                                intOccurs = intOccurs + 1
                                            Else
                                                m_htParmPrompts(strJobName) = strParmPrompts
                                                intOccurs = 2
                                            End If

                                        End If
                                End Select
                            End While
                        End With
                    Catch ex As Exception
                        Throw ex
                    Finally
                        objParmPromptXML.Close()
                        objParmPromptXML = Nothing
                    End Try

                End If
            End If

            'Session("m_htParmPrompts") = m_htParmPrompts
        End Sub


        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' Setting this property to True invokes designer on hilighted Grid row.
        ''' UseEnterKeyToSelectRow returns "UseEnterKeyToSelectRow" set in "AppSettings" section of web.config.
        ''' If not defined, the default value is "False" in which case, "Enter" key traverse through the enabled Fields on the screen.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	9/14/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Shared Function UseEnterKeyToSelectRow() As Boolean
            If m_triUseEnterKeyToSelectRow = Microsoft.VisualBasic.TriState.UseDefault Then
                Dim strUseEnterKeyToSelectRow As String = System.Configuration.ConfigurationManager.AppSettings("UseEnterKeyToSelectRow")
                If (Not strUseEnterKeyToSelectRow Is Nothing) AndAlso strUseEnterKeyToSelectRow.ToUpper = "TRUE" Then
                    m_triUseEnterKeyToSelectRow = Microsoft.VisualBasic.TriState.True
                Else
                    m_triUseEnterKeyToSelectRow = Microsoft.VisualBasic.TriState.False
                End If
            End If
            Return (m_triUseEnterKeyToSelectRow = Microsoft.VisualBasic.TriState.True)
        End Function

        ''' -----------------------------------------------------------------------------
        ''' <exclude/>
        '''
        ''' <summary>
        ''' SetFunctionKeyForDesigner is an internal method.
        ''' </summary>
        ''' <param name="FunctionKey"></param>
        ''' <param name="CodeToExecute"></param>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Function SetFunctionKeyForDesigner(ByVal FunctionKey As Integer, ByVal CodeToExecute As String) As Boolean
            If CodeToExecute.Trim.Length = 0 Then
                m_strFunctionKeys(FunctionKey) = String.Empty
            Else
                m_strFunctionKeys(FunctionKey) = "D" + CodeToExecute
            End If
        End Function

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' SetFunctionKeyForDesigner is an internal method. It is not meant to be used in your code.
        ''' </summary>
        ''' <param name="OldFunctionKey"></param>
        ''' <param name="NewFunctionKey"></param>
        ''' <param name="CodeToExecute"></param>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Friend Function SetFunctionKeyForDesigner(ByVal OldFunctionKey As Integer, ByVal NewFunctionKey As Integer, ByVal CodeToExecute As String) As Boolean
            m_strFunctionKeys(OldFunctionKey) = String.Empty
            SetFunctionKeyForDesigner(NewFunctionKey, CodeToExecute)
        End Function

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' Writes client-side code for a particular Function Key.
        ''' </summary>
        ''' <param name="FunctionKey"></param>
        ''' <param name="FunctionKeysScript"></param>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private Function GetCodeForFunctionKey(ByVal FunctionKey As Integer, ByVal FunctionKeysScript As StringBuilder) As String
            With FunctionKeysScript
                Select Case m_strFunctionKeys(FunctionKey)
                    Case Nothing
                        .Append("event.keyCode=0;").Append(vbNewLine)
                        .Append("event.returnValue=false;").Append(vbNewLine)
                        .Append("event.cancelBubble=true;").Append(vbNewLine)
                    Case String.Empty
                        .Append("event.keyCode=0;").Append(vbNewLine)
                        .Append("event.returnValue=false;").Append(vbNewLine)
                        .Append("event.cancelBubble=true;").Append(vbNewLine)
                    Case Else
                        If m_strFunctionKeys(FunctionKey).StartsWith("D") Then
                            .Append("Pageunload()").Append(vbNewLine)
                            .Append("__doPostBack('").Append(m_strFunctionKeys(FunctionKey).Substring(1)).Append("','');").Append(vbNewLine)
                        ElseIf m_strFunctionKeys(FunctionKey).StartsWith("P") Then
                            'If more than one character, unlike legacy we overwrite whole of the active Field
                            .Append("if(document.activeElement == null){").Append(vbNewLine)
                            'Ignore the function Key
                            .Append("}else{").Append(vbNewLine)
                            .Append("   if(document.activeElement.tagName.toUpperCase()=='INPUT' || document.activeElement.tagName.toUpperCase()=='TEXTAREA'){").Append(vbNewLine)
                            .Append("       PasteContent('").Append(m_strFunctionKeys(FunctionKey).Substring(1)).Append("');").Append(vbNewLine)
                            .Append("       event.keyCode=9;").Append(vbNewLine)
                            .Append("   }").Append(vbNewLine)
                            .Append("}").Append(vbNewLine)
                        Else
                            'This shouldn't be the case
                        End If
                End Select
            End With
            Return Nothing
        End Function

        ''' -----------------------------------------------------------------------------
        ''' <summary>
        ''' GetFunctionKeysScript is being used internally, and is not meant to be used in your code.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[mayur]	8/19/2005	Created
        ''' </history>
        ''' -----------------------------------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Function GetFunctionKeysScript() As String
            Dim strFunctionKeysScript As New StringBuilder("<script defer id=""scriptCheckFunctionKeys"" Language=""javascript"">")
            With strFunctionKeysScript
                .Append(vbNewLine)
                .Append("function CheckFunctionKeys(event){")
                .Append("      switch (event.keyCode) {").Append(vbNewLine)
                For i As Integer = 0 To 11
                    .Append("         case cF").Append(i.ToString + 1).Append(":").Append(vbNewLine)
                    GetCodeForFunctionKey(i, strFunctionKeysScript)
                    .Append("            break;").Append(vbNewLine)
                Next
                .Append("      }").Append(vbNewLine)
                .Append("}").Append(vbNewLine)
                .Append("</script> ").Append(vbNewLine)
                Return .ToString
            End With
        End Function



        ''' --- GetWhereClauseString --------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Generates a string value containing a SQL WHERE clause.
        ''' </summary>
        ''' <param name="Field1">The first field in the SQL statement.</param>
        ''' <param name="Operator">The Operator value.</param>
        ''' <param name="Field2">The second field in the SQL statement</param>
        ''' <param name="AddWhere">Indicates that this is the first field in the WHERE clause and the keyword WHERE is to be appended.  This is passed in using a variable.</param>
        ''' <remarks>
        ''' Returns a formatted SQL WHERE CLAUSE by concatenating the parameters Field1, Operator and Field2 for date fields to ensure that 
        ''' fields with a NULL are also returned if necessary.
        ''' </remarks>
        ''' <example>
        ''' 1. GetWhereClauseString("EMPLOYEE.START_DATE", "=", 0, True) will return 
        '''         " WHERE EMPLOYEE.START_DATE IS NULL" <br/>
        ''' 2. GetWhereClauseString("EMPLOYEE.START_DATE", "<", 19991231, True) will return 
        '''         " WHERE (EMPLOYEE.START_DATE IS NULL OR TO_NUMBER(TO_CHAR(EMPLOYEE.START_DATE,'YYYYMMDD')) < 19991231)" <br/>
        ''' 3. GetWhereClauseString(19991231, "&gt;", "EMPLOYEE.START_DATE", True) will return 
        '''         " WHERE (19991231 &gt; (TO_NUMBER(TO_CHAR(EMPLOYEE.START_DATE,'YYYYMMDD')) OR EMPLOYEE.START_DATE IS NULL)" <br/>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	6/16/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function GetWhereClauseString(ByVal Field1 As String, ByVal [Operator] As String, ByVal Field2 As String, ByRef AddWhere As Boolean) As String

            Dim sb As StringBuilder = New StringBuilder(String.Empty)

            If AddWhere Then
                sb.Append(" WHERE ")
            Else
                sb.Append(" AND ")
            End If

            sb.Append(GetWhereClauseString(Field1, [Operator], Field2))

            Return sb.ToString

        End Function

        ''' --- GetWhereClauseString --------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Generates a string value containing a SQL WHERE clause.
        ''' </summary>
        ''' <param name="Field1">The first field in the SQL statement.</param>
        ''' <param name="Operator">The Operator value.</param>
        ''' <param name="Field2">The second field in the SQL statement</param>
        ''' <remarks>
        ''' Returns a formatted SQL WHERE CLAUSE by concatenating the parameters Field1, Operator and Field2 for date fields to ensure that 
        ''' fields with a NULL are also returned if necessary.
        ''' </remarks>
        ''' <example>
        ''' 1. GetWhereClauseString("EMPLOYEE.START_DATE", "=", 0, True) will return 
        '''         " WHERE EMPLOYEE.START_DATE IS NULL" <br/>
        ''' 2. GetWhereClauseString("EMPLOYEE.START_DATE", "<", 19991231, True) will return 
        '''         " WHERE (EMPLOYEE.START_DATE IS NULL OR TO_NUMBER(TO_CHAR(EMPLOYEE.START_DATE,'YYYYMMDD')) < 19991231)" <br/>
        ''' 3. GetWhereClauseString(19991231, "&gt;", "EMPLOYEE.START_DATE", True) will return 
        '''         " WHERE (19991231 &gt; (TO_NUMBER(TO_CHAR(EMPLOYEE.START_DATE,'YYYYMMDD')) OR EMPLOYEE.START_DATE IS NULL)" <br/>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	6/16/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function GetWhereClauseString(ByVal Field1 As String, ByVal [Operator] As String, ByVal Field2 As String) As String

            Dim sb As StringBuilder = New StringBuilder(String.Empty)

            sb.Append("(")
            sb.Append((Field1)).Append(" ").Append([Operator]).Append(" ").Append((Field2))

            If [Operator].Trim.Equals("=") Then
                sb.Append(" OR ( ").Append(Field1).Append(" IS NULL ").Append(" AND ").Append(Field2).Append(" IS NULL )")
            ElseIf [Operator].Trim.Equals("<") Then
                sb.Append(" OR ( ").Append(Field1).Append(" IS NULL ").Append(" AND ").Append(Field2).Append(" IS NOT NULL )")
            ElseIf [Operator].Trim.Equals(">") Then
                sb.Append(" OR ( ").Append(Field1).Append(" IS NOT NULL ").Append(" AND ").Append(Field2).Append(" IS NULL )")
            ElseIf [Operator].Trim.Equals("<>") Then
                sb.Append(" OR (( ").Append(Field1).Append(" IS NOT NULL ").Append(" AND ").Append(Field2).Append(" IS NULL ) ")
                sb.Append(" OR ( ").Append(Field1).Append(" IS NULL ").Append(" AND ").Append(Field2).Append(" IS NOT NULL ))")
            End If

            sb.Append(")")
            Return sb.ToString

        End Function

        ''' --- GetWhereClauseString --------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Generates a string value containing a SQL WHERE clause.
        ''' </summary>
        ''' <param name="Field1">The first field in the SQL statement.</param>
        ''' <param name="Operator">The Operator value.</param>
        ''' <param name="Field2">The second field in the SQL statement</param>
        ''' <param name="AddWhere">Indicates that this is the first field in the WHERE clause and the keyword WHERE is to be appended.  This is passed in using a variable.</param>
        ''' <remarks>
        ''' Returns a formatted SQL WHERE CLAUSE by concatenating the parameters Field1, Operator and Field2 for date fields to ensure that 
        ''' fields with a NULL are also returned if necessary.
        ''' </remarks>
        ''' <example>
        ''' 1. GetWhereClauseString("EMPLOYEE.START_DATE", "=", 0, True) will return 
        '''         " WHERE EMPLOYEE.START_DATE IS NULL" <br/>
        ''' 2. GetWhereClauseString("EMPLOYEE.START_DATE", "<", 19991231, True) will return 
        '''         " WHERE (EMPLOYEE.START_DATE IS NULL OR TO_NUMBER(TO_CHAR(EMPLOYEE.START_DATE,'YYYYMMDD')) < 19991231)" <br/>
        ''' 3. GetWhereClauseString(19991231, "&gt;", "EMPLOYEE.START_DATE", True) will return 
        '''         " WHERE (19991231 &gt; (TO_NUMBER(TO_CHAR(EMPLOYEE.START_DATE,'YYYYMMDD')) OR EMPLOYEE.START_DATE IS NULL)" <br/>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	6/16/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function GetWhereClauseString(ByVal Field1 As String, ByVal [Operator] As String, ByVal Field2 As Object, ByRef AddWhere As Boolean) As String
            Return GetWhereClauseString(Field1, [Operator], CDec(Field2), AddWhere)
        End Function
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function GetWhereClauseString(ByVal Field1 As String, ByVal [Operator] As String, ByVal Field2 As Decimal, ByRef AddWhere As Boolean) As String

            Dim sb As StringBuilder = New StringBuilder(String.Empty)

            If AddWhere Then
                sb.Append(" WHERE ")
            Else
                sb.Append(" AND ")
            End If

            sb.Append(GetWhereClauseString(Field1, [Operator], Field2))

            Return sb.ToString

        End Function

        ''' --- GetWhereClauseString --------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Generates a string value containing a SQL WHERE clause.
        ''' </summary>
        ''' <param name="Field1">The first field in the SQL statement.</param>
        ''' <param name="Operator">The Operator value.</param>
        ''' <param name="Field2">The second field in the SQL statement</param>
        ''' <remarks>
        ''' Returns a formatted SQL WHERE CLAUSE by concatenating the parameters Field1, Operator and Field2 for date fields to ensure that 
        ''' fields with a NULL are also returned if necessary.
        ''' </remarks>
        ''' <example>
        ''' 1. GetWhereClauseString("EMPLOYEE.START_DATE", "=", 0, True) will return 
        '''         " WHERE EMPLOYEE.START_DATE IS NULL" <br/>
        ''' 2. GetWhereClauseString("EMPLOYEE.START_DATE", "<", 19991231, True) will return 
        '''         " WHERE (EMPLOYEE.START_DATE IS NULL OR TO_NUMBER(TO_CHAR(EMPLOYEE.START_DATE,'YYYYMMDD')) < 19991231)" <br/>
        ''' 3. GetWhereClauseString(19991231, "&gt;", "EMPLOYEE.START_DATE", True) will return 
        '''         " WHERE (19991231 &gt; (TO_NUMBER(TO_CHAR(EMPLOYEE.START_DATE,'YYYYMMDD')) OR EMPLOYEE.START_DATE IS NULL)" <br/>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	6/16/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function GetWhereClauseString(ByVal Field1 As String, ByVal [Operator] As String, ByVal Field2 As Object) As String
            Return GetWhereClauseString(Field1, [Operator], CDec(Field2))
        End Function
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function GetWhereClauseString(ByVal Field1 As String, ByVal [Operator] As String, ByVal Field2 As Decimal) As String

            Dim sb As StringBuilder = New StringBuilder(String.Empty)

            If Field2 = 0 Then
                If [Operator].Trim.Equals("=") Then
                    sb.Append(Field1).Append(" IS NULL ")
                ElseIf [Operator].Trim.Equals("<>") OrElse [Operator].Trim.Equals("!=") Then
                    sb.Append(Field1).Append(" IS NOT NULL ")
                Else
                    If [Operator].Trim.IndexOf("=") > -1 Then
                        sb.Append("(").Append(Field1).Append(" IS NULL OR ").Append(AddDateFunction(Field1)).Append(" ").Append([Operator]).Append(" 0)")
                    Else
                        sb.Append(AddDateFunction(Field1)).Append(" ").Append([Operator]).Append(" 0")
                    End If
                End If
            Else
                If [Operator].IndexOf("<") > -1 Then
                    sb.Append("(").Append(Field1).Append(" IS NULL OR ").Append(AddDateFunction(Field1)).Append(" ").Append([Operator]).Append(" ").Append(Field2).Append(")")
                Else
                    sb.Append(AddDateFunction(Field1)).Append(" ").Append([Operator]).Append(" ").Append(Field2)
                End If
            End If

            Return sb.ToString

        End Function

        ''' --- GetWhereClauseString --------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Generates a string value containing a SQL WHERE clause.
        ''' </summary>
        ''' <param name="Field1">The first field in the SQL statement.</param>
        ''' <param name="Operator">The Operator value.</param>
        ''' <param name="Field2">The second field in the SQL statement</param>
        ''' <param name="AddWhere">Indicates that this is the first field in the WHERE clause and the keyword WHERE is to be appended.  This is passed in using a variable.</param>
        ''' <remarks>
        ''' Returns a formatted SQL WHERE CLAUSE by concatenating the parameters Field1, Operator and Field2 for date fields to ensure that 
        ''' fields with a NULL are also returned if necessary.
        ''' </remarks>
        ''' <example>
        ''' 1. GetWhereClauseString("EMPLOYEE.START_DATE", "=", 0, True) will return 
        '''         " WHERE EMPLOYEE.START_DATE IS NULL" <br/>
        ''' 2. GetWhereClauseString("EMPLOYEE.START_DATE", "<", 19991231, True) will return 
        '''         " WHERE (EMPLOYEE.START_DATE IS NULL OR TO_NUMBER(TO_CHAR(EMPLOYEE.START_DATE,'YYYYMMDD')) < 19991231)" <br/>
        ''' 3. GetWhereClauseString(19991231, "&gt;", "EMPLOYEE.START_DATE", True) will return 
        '''         " WHERE (19991231 &gt; (TO_NUMBER(TO_CHAR(EMPLOYEE.START_DATE,'YYYYMMDD')) OR EMPLOYEE.START_DATE IS NULL)" <br/>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	6/16/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function GetWhereClauseString(ByVal Field1 As Object, ByVal [Operator] As String, ByVal Field2 As String, ByRef AddWhere As Boolean) As String
            Return GetWhereClauseString(CDec(Field1), [Operator], Field2, AddWhere)
        End Function
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function GetWhereClauseString(ByVal Field1 As Decimal, ByVal [Operator] As String, ByVal Field2 As String, ByRef AddWhere As Boolean) As String

            Dim sb As StringBuilder = New StringBuilder(String.Empty)

            If AddWhere Then
                sb.Append(" WHERE ")
            Else
                sb.Append(" AND ")
            End If

            sb.Append(GetWhereClauseString(Field1, [Operator], Field2))

            Return sb.ToString

        End Function

        ''' --- GetWhereClauseString --------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Generates a string value containing a SQL WHERE clause.
        ''' </summary>
        ''' <param name="Field1">The first field in the SQL statement.</param>
        ''' <param name="Operator">The Operator value.</param>
        ''' <param name="Field2">The second field in the SQL statement</param>
        ''' <remarks>
        ''' Returns a formatted SQL WHERE CLAUSE by concatenating the parameters Field1, Operator and Field2 for date fields to ensure that 
        ''' fields with a NULL are also returned if necessary.
        ''' </remarks>
        ''' <example>
        ''' 1. GetWhereClauseString("EMPLOYEE.START_DATE", "=", 0, True) will return 
        '''         " WHERE EMPLOYEE.START_DATE IS NULL" <br/>
        ''' 2. GetWhereClauseString("EMPLOYEE.START_DATE", "<", 19991231, True) will return 
        '''         " WHERE (EMPLOYEE.START_DATE IS NULL OR TO_NUMBER(TO_CHAR(EMPLOYEE.START_DATE,'YYYYMMDD')) < 19991231)" <br/>
        ''' 3. GetWhereClauseString(19991231, "&gt;", "EMPLOYEE.START_DATE", True) will return 
        '''         " WHERE (19991231 &gt; (TO_NUMBER(TO_CHAR(EMPLOYEE.START_DATE,'YYYYMMDD')) OR EMPLOYEE.START_DATE IS NULL)" <br/>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	6/16/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function GetWhereClauseString(ByVal Field1 As Object, ByVal [Operator] As String, ByVal Field2 As String) As String
            Return GetWhereClauseString(CDec(Field1), [Operator], Field2)
        End Function
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Protected Function GetWhereClauseString(ByVal Field1 As Decimal, ByVal [Operator] As String, ByVal Field2 As String) As String

            Dim sb As StringBuilder = New StringBuilder(String.Empty)

            If Field1 = 0 Then
                If [Operator].Trim.Equals("=") Then
                    sb.Append(Field2).Append(" IS NULL ")
                Else
                    If [Operator].Trim.IndexOf("=") > -1 Then
                        sb.Append("(").Append(Field2).Append(" IS NULL OR 0 ").Append([Operator]).Append(" ").Append(AddDateFunction(Field2)).Append(")")
                    Else
                        sb.Append("0 ").Append([Operator]).Append(" ").Append(AddDateFunction(Field2))
                    End If
                End If
            Else
                If [Operator].IndexOf(">") > -1 Then
                    sb.Append("(").Append(Field2).Append(" IS NULL OR ").Append(Field1).Append(" ").Append([Operator]).Append(" ").Append(AddDateFunction(Field2)).Append(")")
                Else
                    sb.Append(Field1).Append(" ").Append([Operator]).Append(" ").Append(AddDateFunction(Field2))
                End If
            End If

            Return sb.ToString

        End Function

        ''' --- AddDateFunction --------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Wraps the date field within the appropriate date function code.
        ''' </summary>
        ''' <param name="Field">The field to add the function around.</param>
        ''' <remarks>
        ''' Returns a string with the date function.
        ''' </remarks>
        ''' <example>
        ''' 1. AddDateFunction("EMPLOYEE.START_DATE") will return 
        '''         " TO_NUMBER(TO_CHAR(EMPLOYEE.START_DATE, 'YYYYMMDD'))" <br/>
        ''' </example>
        ''' <history>
        ''' 	[Campbell]	6/16/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Protected Function AddDateFunction(ByVal Field As String) As String

            Dim sb As StringBuilder = New StringBuilder(255)

            If System.Configuration.ConfigurationManager.AppSettings("AuthenticationDatabase") Is Nothing OrElse
                        System.Configuration.ConfigurationManager.AppSettings("AuthenticationDatabase").ToString.Equals(cORACLE) Then
                Return sb.Append("TO_NUMBER(TO_CHAR(").Append(Field).Append(", 'YYYYMMDD'))").ToString
            Else
                Return sb.Append("CONVERT(INTEGER, CONVERT(CHAR(8), ").Append(Field).Append(", 112))").ToString
            End If

        End Function

        ''' --- GetWhereCondition --------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Generates a string value containing a SQL WHERE clause.
        ''' </summary>
        ''' <param name="FieldName">The name of the field in the SQL statement.</param>
        ''' <param name="Value">The value to assign to the field.</param>
        ''' <param name="blnAddWhere">Indicates that this is the first field in the WHERE clause and the keyword WHERE is to be appended.</param>
        ''' <remarks>
        ''' Returns a formatted SQL Where Condition by concatenating the parameters FieldName and Value.
        ''' This function will return nothing if the passed Value is a null date (01/01/0001). 
        ''' or space.  
        ''' </remarks>
        ''' <example>
        ''' </example>
        ''' <note>This function should only be used in the Find procedure.
        ''' </note>
        ''' <history>
        ''' 	[Campbell]	6/16/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function GetWhereCondition(ByVal FieldName As String, ByVal Value As DateTime, ByRef blnAddWhere As Boolean) As String

            Dim strReturnValue As StringBuilder = New StringBuilder("")

            Try
                If Value <> cNullDate Then
                    Dim d As OldCoreDate = New OldCoreDate(Value)

                    If blnAddWhere = True Then
                        strReturnValue.Append(" WHERE ")
                        strReturnValue.Append(" CorePackage.CORE_TONUM(")
                        strReturnValue.Append(FieldName)
                        strReturnValue.Append(" )")
                        blnAddWhere = False
                    Else
                        strReturnValue.Append(" AND ")
                        strReturnValue.Append(" CorePackage.CORE_TONUM(")
                        strReturnValue.Append(FieldName)
                        strReturnValue.Append(" )")
                    End If

                    strReturnValue.Append(" = ")
                    strReturnValue.Append(d.Value)

                End If

                Return strReturnValue.ToString

            Catch ex As Exception

                ' Write the exception to the event log and throw an error.
                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function GetWhereCondition(ByVal FieldName As String, ByVal Value As DateTime) As String

            Dim strReturnValue As StringBuilder = New StringBuilder("")

            Try
                If Value <> cNullDate Then
                    Dim d As OldCoreDate = New OldCoreDate(Value)


                    strReturnValue.Append(" AND ")
                    strReturnValue.Append(" CorePackage.CORE_TONUM(")
                    strReturnValue.Append(FieldName)
                    strReturnValue.Append(" )")


                    strReturnValue.Append(" = ")
                    strReturnValue.Append(d.Value)

                End If

                Return strReturnValue.ToString

            Catch ex As Exception

                ' Write the exception to the event log and throw an error.
                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function

        ''' --- GetWhereCondition --------------------------------------------------
        ''' 
        ''' <summary>
        ''' 	Generates a string value containing a SQL WHERE clause.
        ''' </summary>
        ''' <param name="FieldName">The name of the field in the SQL statement.</param>
        ''' <param name="Value">The value to assign to the field.</param>
        ''' <param name="blnAddWhere">Indicates that this is the first field in the WHERE clause and the keyword WHERE is to be appended.  This is passed in using a variable.</param>
        ''' <param name="IsBlankLiteral">Set this to True if we are passing a blank value (constant).</param>
        ''' <remarks>
        ''' Returns a formatted SQL Where Condition by concatenating the parameters FieldName and Value and substituting the
        ''' wildcard character (@) and creating a LIKE clause.  This function will return nothing if the passed Value is blank unless IsBlankLiteral is set to true.
        ''' or space.  
        ''' </remarks>
        ''' <example>
        ''' 1. GetWhereCondition("RegionCode", "AABB", blnAddWhere) will return 
        '''         " WHERE RegionCode = 'AABB'" <br/>
        ''' 2. GetWhereCondition("RegionCode", "AABB") will return 
        '''         " AND RegionCode = 'AABB'" <br/>
        ''' 3. GetWhereCondition("RegionCode", "@") will return 
        '''         " AND RegionCode LIKE '%'" <br/>
        ''' 4. GetWhereCondition("RegionCode", "%", blnAddWhere) will return 
        '''         " WHERE RegionCode LIKE '%'" <br/>
        ''' 5. GetWhereCondition("RegionCode", " ", blnAddWhere, True) will return 
        '''         " WHERE RegionCode = ' ' Or RegionCode IS NULL"
        ''' </example>
        ''' <note>This function should only be used in the Find procedure.
        ''' </note>
        ''' <history>
        ''' 	[Campbell]	6/16/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function GetWhereCondition(ByVal FieldName As String, ByVal Value As Object, ByRef blnAddWhere As Boolean, ByVal IsBlankLiteral As Boolean) As String
            Return GetWhereCondition(FieldName, Value.ToString, blnAddWhere, IsBlankLiteral, False)
        End Function

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function GetWhereCondition(ByVal FieldName As String, ByVal Value As Object, ByRef blnAddWhere As Boolean) As String
            Return GetWhereCondition(FieldName, Value.ToString, blnAddWhere, False, False)
        End Function

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function GetWhereCondition(ByVal FieldName As String, ByVal Value As String, ByRef blnAddWhere As Boolean) As String
            Return GetWhereCondition(FieldName, Value.ToString, blnAddWhere, False, False)
        End Function

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function GetWhereCondition(ByVal FieldName As String, ByVal Value As Object, ByRef blnAddWhere As Boolean, ByVal IsBlankLiteral As Boolean, ByVal IsGeneric As Boolean) As String
            Return GetWhereCondition(FieldName, Value.ToString, blnAddWhere, IsBlankLiteral, IsGeneric)
        End Function

        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function GetWhereCondition(ByVal FieldName As String, ByVal Value As String, ByRef blnAddWhere As Boolean, ByVal IsBlankLiteral As Boolean) As String
            Return GetWhereCondition(FieldName, Value.ToString, blnAddWhere, IsBlankLiteral, False)
        End Function


        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Always)>
        Public Function GetWhereCondition(ByVal FieldName As String, ByVal Value As String, ByRef blnAddWhere As Boolean, ByVal IsBlankLiteral As Boolean, ByVal IsGeneric As Boolean) As String

            Dim strReturnValue As StringBuilder = New StringBuilder("")

            Try


                Const WILD_CARD As String = "%"


                If Value.Trim.Length > 0 Then
                    If blnAddWhere = True Then
                        strReturnValue.Append(" WHERE ")
                        strReturnValue.Append(FieldName)
                        blnAddWhere = False
                    Else
                        strReturnValue.Append(" AND ")
                        strReturnValue.Append(FieldName)
                    End If

                    If m_strGenericRetrievalCharacter.Length = 0 Then m_strGenericRetrievalCharacter = "@"

                    'If more than two @ were entered in a row, append value to strReturnValue as is
                    If (Value.IndexOf("@@@") = -1) Then
                        If Value.EndsWith(m_strGenericRetrievalCharacter + m_strGenericRetrievalCharacter) Then
                            'e.g. If the user enters M@@, all data records will be retrieved where the index begins with letter M to the highest value (that is the last segment value).
                            Value = Value.Replace(m_strGenericRetrievalCharacter, String.Empty)
                            If Value.Equals(String.Empty) Then
                                'In case user type one or more "@" (or character set as GenericRetrievalCharacter)
                                strReturnValue.Append(" LIKE '").Append(WILD_CARD).Append("'")
                            Else
                                strReturnValue.Append(" >= ")
                                strReturnValue.Append(StringToField(Value.Trim))
                            End If
                        ElseIf Value.IndexOf(m_strGenericRetrievalCharacter) >= 0 Then
                            Value = Replace(Value, m_strGenericRetrievalCharacter, WILD_CARD)
                            strReturnValue.Append(" Like ")
                            strReturnValue.Append(StringToField(Value.Trim))
                        Else
                            strReturnValue.Append(" = ")
                            strReturnValue.Append(StringToField(Value))
                        End If
                    Else
                        strReturnValue.Append(" = ")
                        strReturnValue.Append(StringToField(Value))
                    End If
                ElseIf Not m_blnIsRunningSelectProcessing Then
                    '--------------- 
                    'Changed to " " as literal string while calling "GetWhereCondition" from "Find" procedure
                    'where as in similar case when called from "SelectProcessing", whole condition will be ignored
                    'September 12, 2005 11:23
                    '--------------- 
                    If blnAddWhere = True Then
                        strReturnValue.Append(" WHERE (")
                        strReturnValue.Append(FieldName)
                        blnAddWhere = False
                    Else
                        strReturnValue.Append(" AND (")
                        strReturnValue.Append(FieldName)
                    End If
                    strReturnValue.Append(" = ")
                    strReturnValue.Append(StringToField(Value))
                    strReturnValue.Append(" OR ")
                    strReturnValue.Append(FieldName)
                    strReturnValue.Append(" IS NULL)")
                End If

                Return strReturnValue.ToString

            Catch ex As Exception

                ' Write the exception to the event log and throw an error.
                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function

        Public Function JobScriptPath() As String

            Try

                If m_strJobScriptPath = "" Then
                    m_strJobScriptPath = System.Configuration.ConfigurationManager.AppSettings("JobScriptPath") & "\"
                End If

                Return m_strJobScriptPath

            Catch ex As Exception

                ' Write the exception to the event log and throw an error.
                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function

        Public Sub StartJobScript()
            Try
                m_blnStartJobScript = True
            Catch ex As Exception

            End Try
        End Sub

        Public Sub EndJobScript()
            Try
                m_blnStartJobScript = False
                m_blnAppendJobScript = False

            Catch ex As Exception

            End Try
        End Sub


        Public Function WriteToJobScript(ByVal ScriptName As String, ByVal strName As String, ByVal Type As JobScriptType, ByVal ParamArray arrValue() As String) As Boolean

            Try

                Dim strValue As String = String.Empty
                Dim strSequence As String
                Dim intSequence As Integer


                Dim strUserID As String = String.Empty
                Dim dtStartDate As Date
                Dim dtLastAccessTime As Date
                Dim blnIsActive As Boolean
                Dim intNumberedSessionID As Int32 = Process.GetCurrentProcess().Id
                Dim strParm As String = String.Empty


                'm_htParmPrompts = Session("m_htParmPrompts")
                If IsNothing(m_htParmPrompts) Then ReadParmPrompts()

                If m_htParmPrompts.Contains(strName) AndAlso arrValue.Length = 1 Then

                    Dim JOB As New CoreCharacter("JOB", 20, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM1 As New CoreCharacter("PARM1", 200, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM2 As New CoreCharacter("PARM2", 200, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM3 As New CoreCharacter("PARM3", 200, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM4 As New CoreCharacter("PARM4", 200, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM5 As New CoreCharacter("PARM5", 200, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM6 As New CoreCharacter("PARM6", 200, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM7 As New CoreCharacter("PARM7", 200, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM8 As New CoreCharacter("PARM8", 200, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM9 As New CoreCharacter("PARM9", 200, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM10 As New CoreCharacter("PARM10", 200, Me, ResetTypes.ResetAtStartup, "")

                    Dim PARM1TYPE As New CoreCharacter("PARM1TYPE", 300, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM2TYPE As New CoreCharacter("PARM2TYPE", 300, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM3TYPE As New CoreCharacter("PARM3TYPE", 300, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM4TYPE As New CoreCharacter("PARM4TYPE", 300, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM5TYPE As New CoreCharacter("PARM5TYPE", 300, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM6TYPE As New CoreCharacter("PARM6TYPE", 300, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM7TYPE As New CoreCharacter("PARM7TYPE", 300, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM8TYPE As New CoreCharacter("PARM8TYPE", 300, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM9TYPE As New CoreCharacter("PARM9TYPE", 300, Me, ResetTypes.ResetAtStartup, "")
                    Dim PARM10TYPE As New CoreCharacter("PARM10TYPE", 300, Me, ResetTypes.ResetAtStartup, "")

                    JOB.Value = strName


                    Dim chooseFlag As String = String.Empty
                    PARM1TYPE.Value = m_htParmPrompts(strName)(1).ToString.Trim & "~" & m_htParmPrompts(strName)(2).ToString.Trim & "~" & m_htParmPrompts(strName)(3).ToString.Trim & "~" & m_htParmPrompts(strName)(4).ToString.Trim & "~" & m_htParmPrompts(strName)(5).ToString.Trim & "~" & m_htParmPrompts(strName)(6).ToString.Trim

                    If m_htParmPrompts.Contains(strName & "~occurs2~") Then
                        PARM2TYPE.Value = m_htParmPrompts(strName & "~occurs2~")(1).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs2~")(2).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs2~")(3).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs2~")(4).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs2~")(5).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs2~")(6).ToString.Trim
                    End If
                    If m_htParmPrompts.Contains(strName & "~occurs3~") Then
                        PARM3TYPE.Value = m_htParmPrompts(strName & "~occurs3~")(1).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs3~")(2).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs3~")(3).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs3~")(4).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs3~")(5).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs3~")(6).ToString.Trim
                    End If
                    If m_htParmPrompts.Contains(strName & "~occurs4~") Then
                        PARM4TYPE.Value = m_htParmPrompts(strName & "~occurs4~")(1).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs4~")(2).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs4~")(3).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs4~")(4).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs4~")(5).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs4~")(6).ToString.Trim
                    End If
                    If m_htParmPrompts.Contains(strName & "~occurs5~") Then
                        PARM5TYPE.Value = m_htParmPrompts(strName & "~occurs5~")(1).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs5~")(2).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs5~")(3).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs5~")(4).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs5~")(5).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs5~")(6).ToString.Trim
                    End If
                    If m_htParmPrompts.Contains(strName & "~occurs6~") Then
                        PARM6TYPE.Value = m_htParmPrompts(strName & "~occurs6~")(1).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs6~")(2).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs6~")(3).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs6~")(4).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs6~")(5).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs6~")(6).ToString.Trim
                    End If
                    If m_htParmPrompts.Contains(strName & "~occurs7~") Then
                        PARM7TYPE.Value = m_htParmPrompts(strName & "~occurs7~")(1).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs7~")(2).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs7~")(3).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs7~")(4).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs7~")(5).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs7~")(6).ToString.Trim
                    End If
                    If m_htParmPrompts.Contains(strName & "~occurs8~") Then
                        PARM8TYPE.Value = m_htParmPrompts(strName & "~occurs8~")(1).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs8~")(2).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs8~")(3).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs8~")(4).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs8~")(5).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs8~")(6).ToString.Trim
                    End If
                    If m_htParmPrompts.Contains(strName & "~occurs9~") Then
                        PARM9TYPE.Value = m_htParmPrompts(strName & "~occurs9~")(1).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs9~")(2).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs9~")(3).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs9~")(4).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs9~")(5).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs9~")(6).ToString.Trim
                    End If
                    If m_htParmPrompts.Contains(strName & "~occurs10~") Then
                        PARM10TYPE.Value = m_htParmPrompts(strName & "~occurs10~")(1).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs10~")(2).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs10~")(3).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs10~")(4).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs10~")(5).ToString.Trim & "~" & m_htParmPrompts(strName & "~occurs10~")(6).ToString.Trim
                    End If


                    'RunScreen("JobControl/ParameterScreen", RunScreenModes.Entry, JOB, PARM1, PARM2, PARM3, PARM4, PARM5, PARM6, PARM7, PARM8, PARM9, PARM10, PARM1TYPE, PARM2TYPE, PARM3TYPE, PARM4TYPE, PARM5TYPE, PARM6TYPE, PARM7TYPE, PARM8TYPE, PARM9TYPE, PARM10TYPE)


                    strParm = arrValue(0) & AddQuotes(PARM1.Value.Trim, PARM1TYPE.Value.Split("~")(0), PARM1TYPE.Value.Split("~")(3))
                    If PARM2TYPE.Value.Trim.Length > 0 Then
                        strParm = strParm & "," & AddQuotes(PARM2.Value.Trim, PARM2TYPE.Value.Split("~")(0), PARM2TYPE.Value.Split("~")(3))
                    End If
                    If PARM3TYPE.Value.Trim.Length > 0 Then
                        strParm = strParm & "," & AddQuotes(PARM3.Value.Trim, PARM3TYPE.Value.Split("~")(0), PARM3TYPE.Value.Split("~")(3))
                    End If
                    If PARM4TYPE.Value.Trim.Length > 0 Then
                        strParm = strParm & "," & AddQuotes(PARM4.Value.Trim, PARM4TYPE.Value.Split("~")(0), PARM4TYPE.Value.Split("~")(3))
                    End If
                    If PARM5TYPE.Value.Trim.Length > 0 Then
                        strParm = strParm & "," & AddQuotes(PARM5.Value.Trim, PARM5TYPE.Value.Split("~")(0), PARM5TYPE.Value.Split("~")(3))
                    End If
                    If PARM6TYPE.Value.Trim.Length > 0 Then
                        strParm = strParm & "," & AddQuotes(PARM6.Value.Trim, PARM6TYPE.Value.Split("~")(0), PARM6TYPE.Value.Split("~")(3))
                    End If
                    If PARM7TYPE.Value.Trim.Length > 0 Then
                        strParm = strParm & "," & AddQuotes(PARM7.Value.Trim, PARM7TYPE.Value.Split("~")(0), PARM7TYPE.Value.Split("~")(3))
                    End If
                    If PARM8TYPE.Value.Trim.Length > 0 Then
                        strParm = strParm & "," & AddQuotes(PARM8.Value.Trim, PARM8TYPE.Value.Split("~")(0), PARM8TYPE.Value.Split("~")(3))
                    End If
                    If PARM9TYPE.Value.Trim.Length > 0 Then
                        strParm = strParm & "," & AddQuotes(PARM9.Value.Trim, PARM9TYPE.Value.Split("~")(0), PARM8TYPE.Value.Split("~")(3))
                    End If
                    If PARM10TYPE.Value.Trim.Length > 0 Then
                        strParm = strParm & "," & AddQuotes(PARM10.Value.Trim, PARM10TYPE.Value.Split("~")(0), PARM10TYPE.Value.Split("~")(3))
                    End If

                End If

                If m_blnStartJobScript Then

                    strName = strName.TrimEnd

                    If Not Me.UseAcceptProcessing OrElse (Me.UseAcceptProcessing AndAlso m_strControlName.Length > 0) Then
                        m_intRunScreenSequence += 1
                        intSequence = m_intRunScreenSequence
                        strSequence = m_strControlName + intSequence.ToString
                    Else
                        m_intProcedureRunScreenSequence += 1
                        intSequence = m_intProcedureRunScreenSequence
                        strSequence = "P" + intSequence.ToString
                    End If


                    Dim blnMethodWasExecuted As Boolean
                    If Me.UseAcceptProcessing Then
                        blnMethodWasExecuted = MethodWasExecuted(m_htRunFlag, intSequence)
                    Else
                        blnMethodWasExecuted = MethodWasExecuted(m_strRunFlag, intSequence)
                    End If

                    If Not blnMethodWasExecuted Then

                        ' Save the sequence information and set a flag indicating screen was run.
                        If Me.UseAcceptProcessing Then
                            SetMethodExecutedFlag(m_htRunFlag, "RUN_FLAG", intSequence)
                        Else
                            SetMethodExecutedFlag(m_strRunFlag, "RUN_FLAG", intSequence)
                        End If

                        If strParm.Length > 0 Then
                            strValue = strParm
                        Else
                            For i As Integer = 0 To arrValue.Length - 1
                                strValue = strValue & arrValue(i) & "~"
                            Next
                            strValue = strValue.Substring(0, strValue.Length - 1)
                        End If

                        Dim dtNow As String = String.Empty

                        If IsNothing(ApplicationState.Current.dtNow) OrElse ApplicationState.Current.dtNow = "" Then
                            dtNow = ServerDateTimeValue()
                            ApplicationState.Current.dtNow = dtNow
                        Else
                            dtNow = ApplicationState.Current.dtNow
                        End If

                        Dim strJobScriptPath As String = JobScriptPath()
                        If Not Directory.Exists(strJobScriptPath) Then Directory.CreateDirectory(strJobScriptPath)
                        Dim sw As StreamWriter = New StreamWriter(strJobScriptPath & ScriptName & "_" & intNumberedSessionID & "_" & UserID() & "_" & dtNow & ".txt", m_blnAppendJobScript)
                        m_blnAppendJobScript = True

                        sw.Write("USER, " & UserID() & vbNewLine)

                        Select Case Type
                            Case JobScriptType.Keep
                                sw.Write("KEEP" & vbNewLine)
                            Case JobScriptType.QTP
                                sw.Write("QTP~" & strName & "~" & strValue & vbNewLine)
                            Case JobScriptType.QUIZ
                                sw.Write("QUIZ~" & strName & "~" & strValue & vbNewLine)
                            Case JobScriptType.Screen
                                sw.Write("SCREEN~" & strName & "~" & vbNewLine)
                            Case JobScriptType.Job
                                m_strJobParams = strName & "~" & strValue.Substring(arrValue(0).Length)
                                sw.Write(strName & "~" & strValue & vbNewLine)
                            Case JobScriptType.SetSystemval
                                sw.Write("SetSystemval, " & strValue & vbNewLine)
                        End Select

                        sw.Close()


                    End If
                    Return True


                End If

                Return False

            Catch ex As CustomApplicationException

                Throw ex

            Catch ex As Exception

                ' Write the exception to the event log and throw an error.
                ExceptionManager.Publish(ex)
                Throw ex

            End Try

        End Function


        ' NOTE: This function also exists in MenuOptionWeb.vb.  If you update this function, also update the 
        '       the one there.
        Private Function AddQuotes(ByVal value As String, ByVal dataType As String, ByVal isChoose As String) As String

            If isChoose = "Y" Then
                If dataType = "CHR" Then
                    If value.IndexOf(",") > -1 Then
                        Dim ar() As String = value.Split(",")
                        For i As Integer = 0 To ar.Length - 1
                            ar(i) = StringToField(ar(i))
                        Next
                        value = Join(ar, CORE_DELIMITER)
                    Else
                        'If GetSystemVal("CHOOSE") = "Y" Then
                        '    DeleteSystemVal("CHOOSE")
                        'Else
                        value = StringToField(value)
                        'End If
                    End If
                Else
                    value = value.Replace(",", CORE_DELIMITER)
                End If
            End If

            Return value

        End Function

    End Class

#Region " ControlListManager "

    'This is used to Maintain TabOrder
    ''' ----------------------------------------------------------------------------
    ''' 
    ''' Class	: ControlListManager
    ''' 
    ''' ----------------------------------------------------------------------------
    ''' <exclude/>
    ''' 
    ''' <summary>
    ''' 	Summary of ControlListManager.
    ''' </summary>
    ''' <remarks>
    ''' </remarks>
    ''' <history>
    ''' 	[Campbell]	7/4/2005	Created
    ''' </history>
    ''' --- End of Comments ----------------------------------------------------
    <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
    Public Class ControlListManager

        ''' --- m_dtbElements ------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of m_dtbElements.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Private m_dtbElements As New DataTable

        ''' --- New ----------------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of New.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Sub New()
            Dim dclTemp As DataColumn

            ' Create new DataColumn, set DataType, ColumnName and add to DataTable.    
            dclTemp = New DataColumn
            dclTemp.DataType = System.Type.GetType("System.Int32")
            dclTemp.ColumnName = "TabOrder"
            dclTemp.ReadOnly = False
            dclTemp.Unique = False
            ' Add the Column to the DataColumnCollection.
            m_dtbElements.Columns.Add(dclTemp)

            ' Create second column.
            dclTemp = New DataColumn
            dclTemp.DataType = System.Type.GetType("System.String")
            dclTemp.ColumnName = "ControlID"
            dclTemp.AutoIncrement = False
            dclTemp.ReadOnly = False
            dclTemp.Unique = False
            ' Add the column to the table.
            m_dtbElements.Columns.Add(dclTemp)
        End Sub

        ''' --- Add --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of Add.
        ''' </summary>
        ''' <param name="NewElement"></param>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public Sub Add(ByVal NewElement As Object)

            Dim myDataRow As DataRow

            myDataRow = m_dtbElements.NewRow()
            myDataRow("TabOrder") = NewElement.TabIndex
            myDataRow("ControlID") = NewElement.RenderedID
            m_dtbElements.Rows.Add(myDataRow)
        End Sub

        ''' --- ElementList --------------------------------------------------------
        ''' <exclude/>
        ''' 
        ''' <summary>
        ''' 	Summary of ElementList.
        ''' </summary>
        ''' <remarks>
        ''' </remarks>
        ''' <history>
        ''' 	[Campbell]	7/4/2005	Created
        ''' </history>
        ''' --- End of Comments ----------------------------------------------------
        <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
        Public ReadOnly Property ElementList() As String
            Get
                Dim dvwTemp As DataView
                Dim strElementList As String = String.Empty

                dvwTemp = m_dtbElements.DefaultView
                dvwTemp.Sort = "TabOrder"

                Dim iCounter As Integer = 0
                For iCounter = 0 To dvwTemp.Count - 1
                    If Not dvwTemp.Item(iCounter).Row("ControlID").ToString.StartsWith("fnc") Then
                        strElementList += "'" + dvwTemp.Item(iCounter).Row("ControlID") + "',"
                    End If
                Next

                Return (strElementList.TrimEnd(","))
            End Get
        End Property

    End Class

#End Region

    ''' ----------------------------------------------------------------------------
    ''' 
    ''' Class	: PageArgs
    ''' 
    ''' ----------------------------------------------------------------------------
    ''' <exclude/>
    ''' 
    ''' <summary>
    ''' 	Summary of PageArgs.
    ''' </summary>
    ''' <remarks>
    ''' </remarks>
    ''' <history>
    ''' 	[Campbell]	7/4/2005	Created
    ''' </history>
    ''' --- End of Comments ----------------------------------------------------
    <EditorBrowsable(System.ComponentModel.EditorBrowsableState.Advanced)>
    Public Class PageArgs
        Inherits EventArgs

    End Class

End Namespace