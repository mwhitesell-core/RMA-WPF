*   MOD CHECK DIGIT REQUIRES THE FOLLOWING VARIABLES:

*		DUMMY		PIC 9(3).    
*		REM-EVEN	PIC V9999.
*		MAX-NBR-DIGITS	PIC 99		VALUE 7.
*		SS1		PIC 99		COMP.
*		WS-VAL-TOTAL	PIC 9(7).

    MOVE PAT-OHIP-NBR		TO WS-NBR-TO-B-VAL.
    MOVE ZERO			TO WS-VAL-TOTAL.

    PERFORM XX2-ODD-EVEN	THRU XX2-99-EXIT
				VARYING SS1 FROM 1 BY 1
				UNTIL SS1 > MAX-NBR-DIGITS.

XX1-10-TOTAL-LOOP.

    SUBTRACT 10			FROM WS-VAL-TOTAL
				GIVING WS-VAL-TOTAL.

    IF WS-VAL-TOTAL > 9
    THEN
	GO TO XX1-10-TOTAL-LOOP.
*   (ELSE)
*   ENDIF

    SUBTRACT WS-VAL-TOTAL	FROM 10
				GIVING WS-VAL-TOTAL.

    IF WS-VAL-TOTAL = 10
    THEN
	MOVE ZERO		TO WS-VAL-TOTAL.
*   (ELSE)
*   ENDIF

    IF WS-VAL-TOTAL NOT = WS-NBR-TO-B-VAL-1-8 (8)
    THEN
	MOVE 99			TO ERR-IND
	PERFORM ZA0-COMMON-ERROR
				THRU ZA0-99-EXIT
	MOVE 'N'		TO FLAG-VALID-OHIP-OR-CHART
    ELSE
	MOVE 'Y'		TO FLAG-VALID-OHIP-OR-CHART.
*   ENDIF

XX1-99-EXIT.
    EXIT.



XX2-ODD-EVEN.

    DIVIDE 2			INTO SS1
				GIVING DUMMY
				REMAINDER REM-EVEN.

    IF REM-EVEN = ZERO
    THEN
	MOVE WS-NBR-TO-B-VAL-1-8 (SS1)
				TO WS-SUM-1-2 (SS1)
   ELSE
	ADD WS-NBR-TO-B-VAL-1-8 (SS1)
	    WS-NBR-TO-B-VAL-1-8 (SS1)
				GIVING WS-SUM-1-2 (SS1).
*   ENDIF

    ADD WS-SUM-1 ( SS1 , 1 )
	WS-SUM-1 ( SS1 , 2 )
	WS-VAL-TOTAL
				GIVING WS-VAL-TOTAL.

XX2-99-EXIT.
    EXIT.
