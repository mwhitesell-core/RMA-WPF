;-------------------------------------------------------------------
;CORE SOFTWARE CORP. (R) 32-bit PowerHouse Preprocessor for 80x86
;CORE Migration PREP Version 4.1.3.
;Copyright (C) CORE SOFTWARE CORP. 1997-1999. Patent Pending.
;All rights reserved.
;-------------------------------------------------------------------
;
BEGINMODULE SUSPEND_AGENT_DETAIL.QTS
COMMENT "PURPOSE: REPORT AGENT 6 or 9 suspend claims  "
COMMENT "first pass of 2 programs"
COMMENT "DATE:  WHO:  MODIFICATION"
COMMENT "2011/apr/07    M.C.  ORIGINAL"
COMMENT "2011/jul/20    MC1  include new fields as dr name, cpso#, referring dr name, chart #   "
COMMENT "include f020 & f020-extra in the access statement"
COMMENT "include diagnostic & oma description"
COMMENT "2017/Apr/06    MC2             include clmhdr-pat-ohip-id-or-chart in the subfile for debugging purpose"
COMMENT "to tell why patient information is blank for the report (suspend_agent_detail.txt)"
COMMENT "which is generated from suspend_agent_detail.qzs"
CAN CLEAR
SET PROCESS NOLIMIT
SET LOCK RECORD UPDATE
REQUEST EXTRACT_SUSPEND_DETAIL
COMMENT "2011/07/20 - MC1"
ACCESS F002-SUSPEND-HDR LINK CLMHDR-PAT-OHIP-ID-OR-CHART TO KEY-PAT-MSTR OF F010-PAT-MSTR OPT LINK CLMHDR-DOC-OHIP-NBR, CLMHDR-ACCOUNTING-NBR TO CLMDTL-DOC-OHIP-NBR, CLMDTL-ACCOUNTING-NBR OF F002-SUSPEND-DTL LINK CLMDTL-OMA-CD TO FEE-OMA-CD OF F040-OMA-FEE-MSTR OPT LINK ASCII(CLMDTL-DIAG-CD,3) TO DIAG-CD OF F091-DIAG-CODES-MSTR OPT LINK CLMHDR-DOC-NBR TO DOC-NBR OF F020-DOCTOR-MSTR OPT LINK CLMHDR-DOC-NBR TO DOC-NBR OF F020-DOCTOR-EXTRA OPT
COMMENT "2011/07/20 - end"
SEL IF CLMHDR-AGENT-CD = 6 OR CLMHDR-AGENT-CD = 9
SORTED ON CLMHDR-DOC-OHIP-NBR ON CLMHDR-ACCOUNTING-NBR
DEF X-TYPE ZONED*1 = 1
TEMP X-SEQ ZONED*2
ITEM X-SEQ = X-SEQ + 1 RESET AT CLMHDR-ACCOUNTING-NBR
DEF X-LINE CHAR*70 = CLMDTL-OMA-CD + CLMDTL-OMA-SUFF + '     ' + ASCII(CLMDTL-NBR-SERV,2) + '     ' + ASCII(CLMDTL-DIAG-CD,3) + '     ' + CLMDTL-SV-DATE[1:4] + '/' + CLMDTL-SV-DATE[5:2] + '/' + CLMDTL-SV-DATE[7:2]
DEF X-LINE-OMA CHAR*70 = CLMDTL-OMA-CD + ' : ' + FEE-DESC
DEF X-LINE-DIAG CHAR*70 = DIAG-CD + ' : ' + DIAG-CD-DESC
COMMENT "2011/07/20 - MC1"
DEF X-CHART-KEY CHAR*11 = PAT-CHART-NBR IF PAT-CHART-NBR[1:1] = 'M' ELSE PAT-CHART-NBR-2 IF PAT-CHART-NBR-2[1:1] = 'K' ELSE PAT-CHART-NBR-3 IF PAT-CHART-NBR-3[1:1] = 'H' ELSE PAT-CHART-NBR-5 IF PAT-CHART-NBR-5[1:1] = 'J' ELSE PAT-CHART-NBR-4 IF PAT-CHART-NBR-4 <> KEY-PAT-MSTR[6:10]
COMMENT "2011/07/20 - end"
COMMENT "MC2"
COMMENT "MC2 - end"
COMMENT "2011/07/20 - MC1"
SUBFILE SUSP_AGENT_DTL KEEP INCLUDE CLMHDR-DOC-OHIP-NBR OF F002-SUSPEND-HDR , CLMHDR-ACCOUNTING-NBR OF F002-SUSPEND-HDR , CLMHDR-CLINIC-NBR-1-2 OF F002-SUSPEND-HDR , CLMHDR-DOC-NBR OF F002-SUSPEND-HDR , CLMHDR-DOC-SPEC-CD OF F002-SUSPEND-HDR , CLMHDR-REFER-DOC-NBR OF F002-SUSPEND-HDR , CLMHDR-LOC OF F002-SUSPEND-HDR , CLMHDR-AGENT-CD OF F002-SUSPEND-HDR , CLMHDR-I-O-PAT-IND OF F002-SUSPEND-HDR , CLMHDR-DOC-DEPT OF F002-SUSPEND-HDR , CLMHDR-DATE-ADMIT OF F002-SUSPEND-HDR , CLMHDR-CONFIDENTIAL-FLAG OF F002-SUSPEND-HDR , CLMHDR-PAT-OHIP-ID-OR-CHART OF F002-SUSPEND-HDR , PAT-SURNAME OF F010-PAT-MSTR , PAT-GIVEN-NAME OF F010-PAT-MSTR , PAT-HEALTH-NBR OF F010-PAT-MSTR , PAT-VERSION-CD OF F010-PAT-MSTR , PAT-OHIP-MMYY OF F010-PAT-MSTR , PAT-BIRTH-DATE OF F010-PAT-MSTR , PAT-SEX OF F010-PAT-MSTR , SUBSCR-ADDR1 OF F010-PAT-MSTR , SUBSCR-ADDR2 OF F010-PAT-MSTR , SUBSCR-ADDR3 OF F010-PAT-MSTR , SUBSCR-POSTAL-CD OF F010-PAT-MSTR , SUBSCR-PROV-CD OF F010-PAT-MSTR , PAT-PHONE-NBR OF F010-PAT-MSTR , X-TYPE , X-SEQ , X-LINE , DOC-NAME OF F020-DOCTOR-MSTR , CPSO-NBR OF F020-DOCTOR-EXTRA , X-CHART-KEY
COMMENT "2011/07/20 - end"
COMMENT "2011/07/26 - MC1 - oma desc "
COMMENT "MC2"
COMMENT "MC2 - end"
SUBFILE SUSP_AGENT_DTL ALIAS SUSP_OMA_DESC APPEND INCLUDE CLMHDR-DOC-OHIP-NBR OF F002-SUSPEND-HDR , CLMHDR-ACCOUNTING-NBR OF F002-SUSPEND-HDR , CLMHDR-CLINIC-NBR-1-2 OF F002-SUSPEND-HDR , CLMHDR-DOC-NBR OF F002-SUSPEND-HDR , CLMHDR-DOC-SPEC-CD OF F002-SUSPEND-HDR , CLMHDR-REFER-DOC-NBR OF F002-SUSPEND-HDR , CLMHDR-LOC OF F002-SUSPEND-HDR , CLMHDR-AGENT-CD OF F002-SUSPEND-HDR , CLMHDR-I-O-PAT-IND OF F002-SUSPEND-HDR , CLMHDR-DOC-DEPT OF F002-SUSPEND-HDR , CLMHDR-DATE-ADMIT OF F002-SUSPEND-HDR , CLMHDR-CONFIDENTIAL-FLAG OF F002-SUSPEND-HDR , CLMHDR-PAT-OHIP-ID-OR-CHART OF F002-SUSPEND-HDR , PAT-SURNAME OF F010-PAT-MSTR , PAT-GIVEN-NAME OF F010-PAT-MSTR , PAT-HEALTH-NBR OF F010-PAT-MSTR , PAT-VERSION-CD OF F010-PAT-MSTR , PAT-OHIP-MMYY OF F010-PAT-MSTR , PAT-BIRTH-DATE OF F010-PAT-MSTR , PAT-SEX OF F010-PAT-MSTR , SUBSCR-ADDR1 OF F010-PAT-MSTR , SUBSCR-ADDR2 OF F010-PAT-MSTR , SUBSCR-ADDR3 OF F010-PAT-MSTR , SUBSCR-POSTAL-CD OF F010-PAT-MSTR , SUBSCR-PROV-CD OF F010-PAT-MSTR , PAT-PHONE-NBR OF F010-PAT-MSTR , X-TYPE , X-SEQ , X-LINE-OMA , DOC-NAME OF F020-DOCTOR-MSTR , CPSO-NBR OF F020-DOCTOR-EXTRA , X-CHART-KEY
ITEM X-TYPE OF SUSP_OMA_DESC FINAL 3
COMMENT "MC2"
COMMENT "MC2 - end"
SUBFILE SUSP_AGENT_DTL ALIAS SUSP_DIAG_DESC APPEND IF CLMDTL-DIAG-CD OF F002-SUSPEND-DTL <> 0 INCLUDE CLMHDR-DOC-OHIP-NBR OF F002-SUSPEND-HDR , CLMHDR-ACCOUNTING-NBR OF F002-SUSPEND-HDR , CLMHDR-CLINIC-NBR-1-2 OF F002-SUSPEND-HDR , CLMHDR-DOC-NBR OF F002-SUSPEND-HDR , CLMHDR-DOC-SPEC-CD OF F002-SUSPEND-HDR , CLMHDR-REFER-DOC-NBR OF F002-SUSPEND-HDR , CLMHDR-LOC OF F002-SUSPEND-HDR , CLMHDR-AGENT-CD OF F002-SUSPEND-HDR , CLMHDR-I-O-PAT-IND OF F002-SUSPEND-HDR , CLMHDR-DOC-DEPT OF F002-SUSPEND-HDR , CLMHDR-DATE-ADMIT OF F002-SUSPEND-HDR , CLMHDR-CONFIDENTIAL-FLAG OF F002-SUSPEND-HDR , CLMHDR-PAT-OHIP-ID-OR-CHART OF F002-SUSPEND-HDR , PAT-SURNAME OF F010-PAT-MSTR , PAT-GIVEN-NAME OF F010-PAT-MSTR , PAT-HEALTH-NBR OF F010-PAT-MSTR , PAT-VERSION-CD OF F010-PAT-MSTR , PAT-OHIP-MMYY OF F010-PAT-MSTR , PAT-BIRTH-DATE OF F010-PAT-MSTR , PAT-SEX OF F010-PAT-MSTR , SUBSCR-ADDR1 OF F010-PAT-MSTR , SUBSCR-ADDR2 OF F010-PAT-MSTR , SUBSCR-ADDR3 OF F010-PAT-MSTR , SUBSCR-POSTAL-CD OF F010-PAT-MSTR , SUBSCR-PROV-CD OF F010-PAT-MSTR , PAT-PHONE-NBR OF F010-PAT-MSTR , X-TYPE , X-SEQ , X-LINE-DIAG , DOC-NAME OF F020-DOCTOR-MSTR , CPSO-NBR OF F020-DOCTOR-EXTRA , X-CHART-KEY
ITEM X-TYPE OF SUSP_DIAG_DESC FINAL 4
REQUEST EXTRACT_SUSPEND_DESC
COMMENT "2011/07/20 - MC1"
ACCESS F002-SUSPEND-HDR LINK CLMHDR-PAT-OHIP-ID-OR-CHART TO KEY-PAT-MSTR OF F010-PAT-MSTR OPT LINK CLMHDR-DOC-OHIP-NBR, CLMHDR-ACCOUNTING-NBR TO CLMDTL-DOC-OHIP-NBR, CLMDTL-ACCOUNTING-NBR OF F002-SUSPEND-DESC LINK CLMHDR-DOC-NBR TO DOC-NBR OF F020-DOCTOR-MSTR OPT LINK CLMHDR-DOC-NBR TO DOC-NBR OF F020-DOCTOR-EXTRA OPT
COMMENT "2011/07/20 - end"
SEL IF CLMHDR-AGENT-CD = 6 OR CLMHDR-AGENT-CD = 9
SORTED ON CLMHDR-DOC-OHIP-NBR ON CLMHDR-ACCOUNTING-NBR
DEF X-TYPE ZONED*1 = 2
DEF X-SEQ ZONED*2 = CLMDTL-LINE-NO
DEF X-LINE CHAR*70 = CLMDTL-SUSPEND-DESC
COMMENT "2011/07/20 - MC1"
DEF X-CHART-KEY CHAR*11 = PAT-CHART-NBR IF PAT-CHART-NBR[1:1] = 'M' ELSE PAT-CHART-NBR-2 IF PAT-CHART-NBR-2[1:1] = 'K' ELSE PAT-CHART-NBR-3 IF PAT-CHART-NBR-3[1:1] = 'H' ELSE PAT-CHART-NBR-5 IF PAT-CHART-NBR-5[1:1] = 'J' ELSE PAT-CHART-NBR-4 IF PAT-CHART-NBR-4 <> KEY-PAT-MSTR[6:10]
COMMENT "2011/07/20 - end"
COMMENT "MC2"
COMMENT "MC2 - end"
COMMENT "2011/07/20 - MC1"
SUBFILE SUSP_AGENT_DTL ALIAS SUSP_AGENT_DESC APPEND INCLUDE CLMHDR-DOC-OHIP-NBR , CLMHDR-ACCOUNTING-NBR , CLMHDR-CLINIC-NBR-1-2 , CLMHDR-DOC-NBR , CLMHDR-DOC-SPEC-CD , CLMHDR-REFER-DOC-NBR , CLMHDR-LOC , CLMHDR-AGENT-CD , CLMHDR-I-O-PAT-IND , CLMHDR-DOC-DEPT , CLMHDR-DATE-ADMIT , CLMHDR-CONFIDENTIAL-FLAG , CLMHDR-PAT-OHIP-ID-OR-CHART OF F002-SUSPEND-HDR , PAT-SURNAME , PAT-GIVEN-NAME , PAT-HEALTH-NBR , PAT-VERSION-CD , PAT-OHIP-MMYY , PAT-BIRTH-DATE , PAT-SEX , SUBSCR-ADDR1 , SUBSCR-ADDR2 , SUBSCR-ADDR3 , SUBSCR-POSTAL-CD , SUBSCR-PROV-CD , PAT-PHONE-NBR , X-TYPE , X-SEQ , X-LINE , DOC-NAME , CPSO-NBR , X-CHART-KEY
COMMENT "2011/07/20 - end"
BUILD $OBJ/SUSPEND_AGENT_DETAIL
ENDMODULE SUSPEND_AGENT_DETAIL.QTS
