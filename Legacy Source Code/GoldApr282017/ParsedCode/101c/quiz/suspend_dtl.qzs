;PURPOSE: REPORT DETAIL OF DISKETTE IF NO HARD COPY SEND

;DATE:		WHO:		MODIFICATION
;97/03/21	YASEMIN		ORIGINAL
;97/06/08	yas		sort by DOC/CLI/SPE/ACC#
;02/04/02	yas	        add clinic 85(represents payroll B)
;02/08/23	yas	        add clinic 95(represents oncology clinic)
;03/08/23       yasmin          add clinic 91,92,93,94,96                    
;03/dec/17      A.A.            alpha doctor nbr
;2004/mar/03    yasmin          add clinic 43 and 84                         
;2004/03/23	M.C.		housekeeping - delete unneccessary codes
;2004/jun/07    yasemin         add new afp clinic 31-59
;2004/oct/22    yasemin         add new afp clinic  46 
;2005/feb/08    yasemin         add new clinic 86 
;2007/apr/15    yasemin         add new clinics 71-75
;2007/Nov/      yasemin         add new clinic 87      
;2008/Apr       yasemin         add new clinic 37
;2008/Oct       yasemin         add new clinic 88
;2009/Apr       yasemin         add new clinic 89
;2009/Jun       yasemin         add new clinic 79
;2009/Jun       yasemin         add new clinic 78
;2010/Feb       yasemin         add new clinic 66
;2010/04/14	yasemin		change sort order from clmdtl-accounting-nbr to clmhdr-pat-acronym 
;2010/04/21     MC1		include  clmhdr-apt-acronym & clmdtl-accounting-nbr in the sort for 
;				uniqueness in case there are duplicate pat-acronym
;2011/Jan/12    yasemin         add new clinic 23
;2012/Jan/23    yasemin         add new clinic 24
;2012/Jun/08    yasemin         add new clinic 25
;2012/Oct/09    MC2		Yasemin would like to include the clinis status to match with the screen d705.qks
;				include f020-doctor-extra in the access statement in order to show the clinic status
;2014/Apr/03    yasemin         add new clinic 69
;2014/May/06    yasemin         add new clinic 68
;2014/Oct/17    yasemin         add new clinic 30
;2015/Mar/10    yasemin         add new clinic 26
;2016/Apr/13    MC3             correct programming so that do not need to hardcode each new clinic

can clear
set rep nolimit
set rep page length 62
set rep page width 132
set rep dev disc name suspdtl
set formfee
set noclose

access f002-suspend-dtl                            &
  link (clmdtl-batch-nbr[3:3])                     &
    to doc-nbr of f020-doctor-mstr opt             &
  link (clmdtl-batch-nbr[3:3])                     &
    to doc-nbr of f020-doctor-extra  opt           &
  link clmdtl-doc-ohip-nbr, clmdtl-accounting-nbr  &
   to clmhdr-doc-ohip-nbr, clmhdr-accounting-nbr  &
                             of f002-suspend-hdr opt


sort on doc-nbr                &
     on clmhdr-clinic-nbr-1-2  &
     on clmhdr-doc-spec-cd     &
     on clmhdr-pat-acronym     &
     on clmdtl-accounting-nbr  

def x-name cha*25 = pack(doc-name+" "+doc-inits)

def x-prov cha*2 =    clmhdr-health-care-prov         &
                   if clmhdr-health-care-prov ne "ON" &
                 else " "

def x-mr cha*1 = clmhdr-manual-review if clmhdr-manual-review = "Y" 

def x-confidential cha*1 =    clmhdr-confidential-flag         &
                           if clmhdr-confidential-flag = "Y"

; 2012/10/09 - MC2
def x-clinic-status char*5 = ascii(doc-clinic-nbr) + '(' + doc-clinic-nbr-status + ')' &
			if doc-clinic-nbr <> 0 and doc-clinic-nbr-status <> ' '	       &
		else    ascii(doc-clinic-nbr)					       &
			if doc-clinic-nbr <> 0 and doc-clinic-nbr-status  = ' '        &
		else    ascii(doc-clinic-nbr,2)

def x-clinic-status-2 char*5 = ascii(doc-clinic-nbr-2) + '(' + doc-clinic-nbr-2-status + ')' 	&
			if doc-clinic-nbr-2 <> 0 and doc-clinic-nbr-2-status <> ' '	       	&
		else    ascii(doc-clinic-nbr-2)					       		&
			if doc-clinic-nbr-2 <> 0 and doc-clinic-nbr-2-status  = ' ' 		&
		else    ascii(doc-clinic-nbr-2,2)

def x-clinic-status-3 char*5 = ascii(doc-clinic-nbr-3) + '(' + doc-clinic-nbr-3-status + ')' 	&
			if doc-clinic-nbr-3 <> 0 and doc-clinic-nbr-3-status <> ' '	       	&
		else    ascii(doc-clinic-nbr-3)					       		&
			if doc-clinic-nbr-3 <> 0 and doc-clinic-nbr-3-status  = ' ' 		&
		else    ascii(doc-clinic-nbr-3,2)

def x-clinic-status-4 char*5 = ascii(doc-clinic-nbr-4) + '(' + doc-clinic-nbr-4-status + ')' 	&
			if doc-clinic-nbr-4 <> 0 and doc-clinic-nbr-4-status <> ' '	       	&
		else    ascii(doc-clinic-nbr-4)					       		&
			if doc-clinic-nbr-4 <> 0 and doc-clinic-nbr-4-status  = ' ' 		&
		else    ascii(doc-clinic-nbr-4,2)

def x-clinic-status-5 char*5 = ascii(doc-clinic-nbr-5) + '(' + doc-clinic-nbr-5-status + ')' 	&
			if doc-clinic-nbr-5 <> 0 and doc-clinic-nbr-5-status <> ' '	       	&
		else    ascii(doc-clinic-nbr-5)					       		&
			if doc-clinic-nbr-5 <> 0 and doc-clinic-nbr-5-status  = ' ' 		&
		else    ascii(doc-clinic-nbr-5,2)

def x-clinic-status-6 char*5 = ascii(doc-clinic-nbr-6) + '(' + doc-clinic-nbr-6-status + ')' 	&
			if doc-clinic-nbr-6 <> 0 and doc-clinic-nbr-6-status <> ' '	       	&
		else    ascii(doc-clinic-nbr-6)					       		&
			if doc-clinic-nbr-6 <> 0 and doc-clinic-nbr-6-status  = ' ' 		&
		else    ascii(doc-clinic-nbr-6,2)

def x-all-clinic-status char*35 =				   	 &
	pack(x-clinic-status  )  + ' ' + pack(x-clinic-status-2) + ' ' + &
	pack(x-clinic-status-3)  + ' ' + pack(x-clinic-status-4) + ' ' + &
	pack(x-clinic-status-5)  + ' ' + pack(x-clinic-status-6) 

; 2012/10/09 - end

page heading                   &
skip 1  tab 1 	sysdate        &
        tab 20  "VIEW SUSPEND DETAIL" &
        tab 100 "PAGE: "       &
        tab 110 syspage        &
skip 2  tab 1	"ACCT NBR"     &
        tab 11  "PATIENT"      &
	tab 23  "OMA CD"       &
        tab 30  "SVCS"         &
        tab 36  "SV DATE"      &
        tab 48  "DIAG"         &
        tab 57  "AMOUNT"       &
        tab 66  "REFER#"       &
        tab 75  "LOC "         &
        tab 82  "I/O"          &
        tab 88  "ADMIT "       &
        tab 98  "PROV"         &
        tab 107 "MR"           &
        tab 110 "CONF"         &
        tab 125 "DOC#"         &
skip 1  tab 1	"========"     &
        tab 11  "======="      &
	tab 23  "======"       &
        tab 30  "===="         &
        tab 36  "==========="  &
        tab 48  "===="         &
        tab 57  "======"       &
        tab 66  "======"       &
        tab 75  "===="         &
        tab 82  "==="          &
        tab 88  "=========="   &
        tab 98  "===="         &
        tab 107 "=="           &
        tab 110 "===="         &
        tab 125 "===="         &
skip 2

heading at doc-nbr           skip page  &
tab 1 clmdtl-doc-ohip-nbr pic "^^^^^^"  &
tab 10 doc-dept fill "0"                &
tab 13 "/"                              &
tab 15 doc-nbr                          &
tab 22 x-name                           &
tab 50 "SPECIALY: "                     &
tab 60 doc-spec-cd                      &
tab 64 doc-spec-cd-2                    &
tab 68 doc-spec-cd-3                    &
tab 72 "CLINICS: "                      &
; 2012/10/09 - MC2
;tab 81 doc-clinic-nbr                   &
;tab 85 doc-clinic-nbr-2                 &
;tab 89 doc-clinic-nbr-3                 &
;tab 93 doc-clinic-nbr-4                 &
;tab 97 doc-clinic-nbr-5                 &
;tab 101 doc-clinic-nbr-6                &
 tab 81 x-all-clinic-status		 &
; 2012/10/09 - end
skip 2


report                           skip 2   &
tab 1	clmdtl-accounting-nbr print at clmdtl-accounting-nbr &
tab 11 	clmhdr-pat-acronym                  &
tab 23 	clmdtl-oma-cd                       &
tab 27  clmdtl-oma-suff                     &
tab 31	clmdtl-nbr-serv  pic "^^" fill "0"  &
tab 36	clmdtl-sv-date   pic "^^^^/^^/^^"   &
tab 48	clmdtl-diag-cd-alpha pic "^^^"      &
tab 54	clmdtl-fee-ohip pic "^^,^^^.^^"     &
tab 66	clmhdr-refer-doc-nbr pic "^^^^^^" fill "0" &
tab 75	clmhdr-loc                          &
tab 83	clmhdr-i-o-pat-ind                  &
tab 88	clmhdr-date-admit pic "^^^^/^^/^^"  &
tab 99	x-prov                              &
tab 107 x-mr                                &
tab 112 x-confidential                      &
tab 125 clmdtl-doc-ohip-nbr pic "^^^^^^"    &
skip 1

footing at clmhdr-doc-spec-cd                       &
skip 1 tab 54  "---------"                          &
skip 1 tab 1   "NO. SVCS:"                          &
       tab 12  clmdtl-nbr-serv sub pic "^^^^"       &
       tab 19  "NO. CLMS:"                          &
       tab 27  count at clmdtl-accounting-nbr       &
       tab 53  clmdtl-fee-ohip sub pic "^^^,^^^.^^" &
       tab 66  "(Doctor specialty total)"           &
skip 1 tab 54  "========="                          &
       tab 67  "Clinic:"                            &
       tab 75  clmhdr-clinic-nbr-1-2                &
       tab 80  "Specialty:"                          &
       tab 91  clmhdr-doc-spec-cd                   &
skip 4

footing at clmhdr-clinic-nbr-1-2                    &
skip 1 tab 54  "---------"                          &
skip 1 tab 1   "NO. SVCS:"                          &
       tab 12  clmdtl-nbr-serv sub pic "^^^^"       &
       tab 19  "NO. CLMS:"                          &
       tab 27  count at clmdtl-accounting-nbr       &
       tab 53  clmdtl-fee-ohip sub pic "^^^,^^^.^^" &
       tab 66  "(Doctor clinic total)"              &
skip 1 tab 54  "========="                          &
       tab 67  "Clinic:"                            &
       tab 75  clmhdr-clinic-nbr-1-2                &
       tab 80  "Specialty:"                         &
       tab 91  clmhdr-doc-spec-cd                   &
skip 4

build $pb_obj/suspend_dtl1

access *suspdtl

set nohead
set formfeed

; MC3
page  heading                                            &
        tab 1  "Clinic"                                  &
        tab 15 "Services"                                &
        tab 30 "Claims"                                  &
        tab 52 "Amount"                                  &
skip 2  tab 1  "======"                                  &
        tab 15 "========"                                &
        tab 30 "======"                                  &
        tab 52 "======"                                  &
skip 2

report                                                   &
        tab 2  clmhdr-clinic-nbr-1-2                     &
        tab 17 x-svc      pic "^^^^^^"         		 &
        tab 30 x-clm      pic "^^^^^^"                   &
        tab 45 x-amt      pic "^^,^^^,^^^.^^"   	 &
skip 2

final footing                                            &
skip 1  tab 1  "TOTALS"                                  &
        tab 17 x-svc   subt         pic "^^^^^^"         &
        tab 30 x-clm   subt         pic "^^^^^^"         &
        tab 45 x-amt   subt         pic "^^^^^^,^^^.^^"  &
skip 1  tab 17  "======"                                 &
        tab 30  "======"                                 &
        tab 45  "============="                          &
skip 2
; MC3 - end

build $pb_obj/suspend_dtl2
