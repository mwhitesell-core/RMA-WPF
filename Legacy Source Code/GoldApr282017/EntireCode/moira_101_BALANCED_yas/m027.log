/alpha/rmabill/rmabill101/dvlp/moira
Tue May  3 12:36:45 EDT 2016
 + + + Sourced in /alpha/rmabill/rmabill101/dvlp/moira + + +
;Compiling program [/alpha/rmabill/rmabill101/dvlp/moira/m027.qks]
Q D E S I G N   (7.33.E)
Copyright 1996 COGNOS INCORPORATED
Licensed PH-DEVELOPMENT for customer: 0057360001 DYAD Systems Inc. UNIX

> ;#> program-id.     m027.qks
> ;    program purpose : entry of a doctor's contacts including their own address/phone etc
> ;
> ;    modification historY
> ;        date   who     description
> ; 2005/jan/19   b.e.	- original
> ; 2005/mar/17   M.C.    - include web user name
> ; 2006/apr/04   M.C.	- if user update contacts-surname for doctor type in f027, also update doc-name in f020
> ;			- include f020-doctor-mstr
> ; 2006/aug/08   M.C.    - define & pass x-doc-ohip-nbr when calling to m028
> ; 2006/oct/19   M.C.	- extend the size of x-contacts-name from 40 to 60
> ; 2006/oct/23   M.C.	- Upshift x-contacts-name
> ; 2006/oct/26   M.C.	- passing f027-contacts-mstr when calling m028
> ; 2016/Apr/18   MC1	- do not update  f020-doctor-mstr here so that it forces the update in the higher screen,
> ;			  this will update audit file correctly in the higher screen
> 
> can clear
> ; 2006/06/06 - MC
> ;screen $pb_obj/m027 receiving x-doc-nbr, x-doc-name
> screen $pb_obj/m027 receiving f020-doctor-mstr, x-doc-nbr, x-doc-name
> ; 2006/06/06 - end
> 
> ; 2006/08/08 - MC
> temp x-doc-ohip-nbr zoned*6 unsigned
> ; 2006/08/08 - end
> 
> temp x-doc-nbr char*3
> temp x-contacts-type char*1
> temp x-doc-name char*30
> ;temp x-contacts-name char*40
> temp x-contacts-name char*60
> 
> ; 2006/04/04 - MC
> ;file f020-doctor-mstr designer
> ;  access viaindex doc-nbr using x-doc-nbr
> ; 2006/04/04 - end
> 
> ; 2006/06/06 - MC
> file f020-doctor-mstr master
> ; 2006/06/06 - end
> 
> file f027-contacts-mstr occurs 4
Item DOC-NBR initialized (fixed) to DOC-NBR OF F020-DOCTOR-MSTR.
>   access viaindex  contacts-key  using filler , x-doc-nbr
> item filler initial " "
> item doc-nbr initial x-doc-nbr
> 
> 
> title "Contacts for: "              at 1,30
> align (,,50)
> field x-doc-name  display  predisplay
> 
> title "Type"			at 3,3
> skip
> align (1,,5) (,9,22)
> cluster occurs with f027-contacts-mstr
> field contacts-type of f027-contacts-mstr 	required nochange	&
>       lookup noton f027-contacts-mstr 				 	&
> 	    via filler, 						&
> 		doc-nbr,  						&
> 		contacts-type                     			&
> 	  using filler of f027-contacts-mstr, 				&
> 		doc-nbr of f027-contacts-mstr,				&
> 		contacts-type  of f027-contacts-mstr
> field contacts-surname     	label "Surname    :"
> skip
> align        (,9,22) (,54,61) (,69,74)
> field contacts-given-names 	label "Given Names:"
> field contacts-inits 	   	label "Inits:"
> field contacts-sex	   	label "Sex:"
> skip
> align        (,9,22) (,54,74)
> field contacts-title	 	label "Title      :"
> field billing-entry-flag 	label "Billing data entry?"
> ; 2005/03/17 - -MC
> field logon-username 		label "Web username:"
> ; 2005/03/17 - end
> skip 1
> 
> procedure designer more
> begin
> ; MC1
> ;;  let x-doc-nbr = doc-nbr of f027-contacts-mstr
> ; MC1 - end
> 
> ; 2006/08/08 - MC
>   let x-doc-ohip-nbr = doc-ohip-nbr of f020-doctor-mstr
> ; 2006/08/08 - end
>   let x-contacts-type = contacts-type
>   let x-contacts-name =  upshift( truncate(lj(contacts-surname))                &
>                          + ","                                           &
>                          + truncate(lj(contacts-given-names)))
>   run screen $pb_obj/m028 passing x-doc-nbr,            &
> ; 2006/08/08 - MC - add in the passing parameter
> 				  x-doc-ohip-nbr,	&
> ; 2006/08/08 - end
>                                   x-contacts-type,      &
> ; 2006/10/26 - MC
> ;                                  x-contacts-name       mode same
>                                   x-contacts-name,      &
>                            f027-contacts-mstr           mode same
> ; 2006/10/26 - end
> end
> 
> 
> 
> ; 2006/04/04 - MC
> procedure preupdate
> begin
>   if alteredrecord
>     then begin
>       for f027-contacts-mstr
>        begin
> 	let x-contacts-name = contacts-surname + ',' +	&
>   			      contacts-inits
>     	if     x-doc-name <> x-contacts-name		&
>       	   and contacts-type = 'D'
>     	then  begin
>            let doc-name = contacts-surname
>            let doc-inits= contacts-inits
>            let doc-name-soundex = soundex(doc-name)
> ; MC1 - do not update here
> ;	   put f020-doctor-mstr
> ; MC1 - end
> 	   end
> 	end
>      end
> end
> ;2006/04/04 - end
> 
> PROCEDURE UPDATE
>   BEGIN
>     FOR F027-CONTACTS-MSTR
>       BEGIN
>         PUT F027-CONTACTS-MSTR
>         END
> ; MC1 - do not update here
> ;    PUT F020-DOCTOR-MSTR
> ; MC1 - end
>     END
> 
> build detail list
*W* Update on linked screen may bypass PREUPDATE/UPDATE/POSTUPDATE procedures.
> PROCEDURE APPEND
>   BEGIN
>     ACCEPT CONTACTS-TYPE OF F027-CONTACTS-MSTR
>     ACCEPT CONTACTS-SURNAME OF F027-CONTACTS-MSTR
>     ACCEPT CONTACTS-GIVEN-NAMES OF F027-CONTACTS-MSTR
>     ACCEPT CONTACTS-INITS OF F027-CONTACTS-MSTR
>     ACCEPT CONTACTS-SEX OF F027-CONTACTS-MSTR
>     ACCEPT CONTACTS-TITLE OF F027-CONTACTS-MSTR
>     ACCEPT BILLING-ENTRY-FLAG OF F027-CONTACTS-MSTR
>     ACCEPT LOGON-USERNAME OF F027-CONTACTS-MSTR
>     END
> PROCEDURE ENTRY
>   BEGIN
>     DISPLAY X-DOC-NAME
>     FOR F027-CONTACTS-MSTR
>       BEGIN
>         PERFORM APPEND
>         END
>     END
> PROCEDURE PATH
>   BEGIN
>     LET PATH = 1
>     END
> PROCEDURE FIND
>   BEGIN
>     FOR MISSING F027-CONTACTS-MSTR
>       BEGIN
>         GET F027-CONTACTS-MSTR VIAINDEX CONTACTS-KEY USING FILLER OF &
>               F027-CONTACTS-MSTR , X-DOC-NBR
>         END
>     END
> PROCEDURE DELETE
>   BEGIN
>     DELETE F027-CONTACTS-MSTR
>     END
> ALLDONE
MODE:x ACTION:xxxxxxxxx      Contacts for:       xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 
  Type
01  x   Surname    : xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        Given Names: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  Inits: xxx     Sex: x
        Title      : xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  Billing data entry? x
        Web username:xxxxxxxxxxxxxxxxxxxx
 
02  x   Surname    : xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        Given Names: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  Inits: xxx     Sex: x
        Title      : xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  Billing data entry? x
        Web username:xxxxxxxxxxxxxxxxxxxx
 
03  x   Surname    : xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        Given Names: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  Inits: xxx     Sex: x
        Title      : xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  Billing data entry? x
        Web username:xxxxxxxxxxxxxxxxxxxx
 
04  x   Surname    : xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        Given Names: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  Inits: xxx     Sex: x
        Title      : xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  Billing data entry? x
        Web username:xxxxxxxxxxxxxxxxxxxx
 
0 ERRORS  1 WARNINGS. Delete old screen /alpha/rmabill/rmabill101/obj/m027.qkc?
> 
Tue May  3 12:36:46 EDT 2016
