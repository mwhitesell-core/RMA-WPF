/alpha/rmabill/rmabill101/dvlp/moira
Tue Mar 22 13:29:17 EST 2016
 + + + Sourced in /alpha/rmabill/rmabill101/dvlp/moira + + +
;Compiling program [/alpha/rmabill/rmabill101/dvlp/moira/d119.qks]
Q D E S I G N   (7.33.E)
Copyright 1996 COGNOS INCORPORATED
Licensed PH-DEVELOPMENT for customer: 0057360001 DYAD Systems Inc. UNIX

> ;#> PROGRAM-ID.     D119.QKS
> ;
> ;       ((C)) Dyad Technologies
> ;
> ;    PURPOSE: Query/modifications to Physician YTD Audit/Statements File
> ;
> ;    MODIFICATION HISTORY
> ;        DATE    SAF #  WHO      DESCRIPTION
> ;     93/NOV/31  ____   B.E.     - original
> ;     95/NOV/08  ----   M.C.     - COMMENT W-EP-NBR-FROM & W-EP-NBR-TO
> ;   1999/Jun/07         S.B.     - Altered the call to scrtitle.use and
> ;                                  stdhilite.use to be called from $use
> ;                                  instead of src.
> ;                                - Removed the call to secfile.use because
> ;                                  it was not doing anything.
> ; 2003/nov/05 b.e.	- alpha doctor nbr
> ; 2006/apr/10 b.e.      - allow for 9 digit amt-mtd and amt-ytd
> ; 2011/may/04 MC1	- do not allow delete
> ; 2012/Nov/21 MC2	- Allow entry  because dr 15C did not create records in 94 screen for ep nbr 201204
> ; 2014/Aug/13 MC3       - add f119-doctor-ytd-audit to capture before change records
> ;                       - save f119-doctor-ytd-audit records in f119-doctor-ytd-audit in postfind in case
> ;                         user may change the records
> 
> can clear
> screen $pb_obj/d119.qkc on line 6 for 18 message on line 24             &
> ; 2011/05/04 - add activities
> ; 2012/11/21 - MC2 - allow add
> ;	activities find, change					&
> 	activities entry, find, change				&
> ; 2012/11/21 - end
> ; 2011/05/04 - end
>         receiving w-doc-nbr,                                    &
>                   constants-mstr-rec-6, f020-doctor-mstr
> 
> file f020-doctor-mstr     master
> file constants-mstr-rec-6 master
> 
> temp w-doc-nbr char*3
> temp x-srch-code char*6
> 
> description of screen                                                    &
> "                                                                      " &
> "       This screen allows a User to query the Physician  YTD  Audit/  " &
> "       History File.                                                  " &
> "                                                                      "
> 
> ;use $pb_src/secfile.use   nol nod
> 
> file  f119-doctor-ytd  primary  occurs 15
Item DOC-NBR initialized (fixed) to DOC-NBR OF F020-DOCTOR-MSTR.
Item DOC-OHIP-NBR initialized (fixed) to DOC-OHIP-NBR OF F020-DOCTOR-MSTR.
Item FILLER initialized (fixed) to FILLER OF CONSTANTS-MSTR-REC-6.
>         access  viaindex f119-doctor-ytd-seq  using w-doc-nbr
> select if rec-type        = "A"
> item      rec-type initial  "A"
> 
> file f190-comp-codes      reference
>      access viaindex comp-code using comp-code of f119-doctor-ytd
> 
> ; MC3
> file f119-doctor-ytd-audit designer  occurs with f119-doctor-ytd
> 
> use $use/savef119audit_var.use
> temp a-doc-nbr				char*3                  occurs with f119-doctor-ytd
> temp a-doc-ohip-nbr			zoned*6 unsigned        occurs with f119-doctor-ytd
> temp a-comp-code			char*6                  occurs with f119-doctor-ytd
> temp a-process-seq      		zoned*2 unsigned        occurs with f119-doctor-ytd
> temp a-comp-code-group			char*1		 	occurs with f119-doctor-ytd
> temp a-rec-type  	 		char*1			occurs with f119-doctor-ytd
> temp a-amt-mtd                  	zoned*9 numeric         occurs with f119-doctor-ytd
> temp a-amt-ytd          		zoned*9 numeric         occurs with f119-doctor-ytd
> 
> 
> ; MC3 - end
> 
> define x-screen-name char*55 = "Earnings - YTD History File"
> use $use/scrtitle.use  nol nod
> use $use/stdhilite.use nol nod
> 
> skip to 2
> skip
> title &
> "    -------COMP---------- GROUP STMNT  ---------AMOUNT----------               " &
>         at ,1
> skip
> title &
> "   --CODE/DESCRIPTION---- CODE   SEQ             MTD         YTD                " &
>         at ,1
> 
> ;         1         2         3         4         5         6         7         8
> ;....v....0....v....0....v....0....v....0....v....0....v....0....v....0....v....0
> ;01 XXXXXX-xxxxxxxxxxxxxxx  X      99   9,999,999.99- 9,999,999.99-
> align (1,,4) (,10,11) (,,28) (,,35) (,,40) (,,54)
> cluster occurs with f119-doctor-ytd
> field comp-code         of f119-doctor-ytd                      &
>       lookup on f190-comp-codes                                 &
>       message "Error -  Invalid COMPENSATION Code."
> field desc-short        of f190-comp-codes label "-" display
> 
> field comp-code-group   of f119-doctor-ytd
> field process-seq       of f119-doctor-ytd
> 
> field amt-mtd           of f119-doctor-ytd
> field amt-ytd           of f119-doctor-ytd
> 
> procedure input comp-code
> begin
>   if fieldtext = "."
>   then begin
>     let x-srch-code = " "
>     run screen $pb_obj/sy033.qkc clear lines 13 to 23 passing x-srch-code mode f
>     if x-srch-code ne " "
>     then let fieldtext = x-srch-code
>     else error "Error - A Compensation Code is required."
>   end
> end
> 
> 
> procedure process comp-code
> begin
>   display desc-short      of f190-comp-codes
>   let     process-seq     of f119-doctor-ytd = reporting-seq    of f190-comp-codes
>   display process-seq     of f119-doctor-ytd
>   let comp-code-group     of f119-doctor-ytd = comp-code-group  of f190-comp-codes
>   display comp-code-group of f119-doctor-ytd
> end
> 
> ;MC3
> use $use/savef119audit.use
> procedure internal savef119audit
> begin
>    let a-doc-nbr			 = doc-nbr	 		 of  f119-doctor-ytd
>    let a-doc-ohip-nbr		         = doc-ohip-nbr			 of  f119-doctor-ytd
>    let a-comp-code                       = comp-code 			 of  f119-doctor-ytd
>    let a-process-seq                     = process-seq			 of  f119-doctor-ytd
>    let a-comp-code-group 		 = comp-code-group		 of  f119-doctor-ytd
>    let a-rec-type                        = rec-type			 of  f119-doctor-ytd
>    let a-amt-mtd                         = amt-mtd 			 of  f119-doctor-ytd
>    let a-amt-ytd                         = amt-ytd			 of  f119-doctor-ytd
> end
> 
> 
> use $use/createf119audit.use
> procedure internal createf119audit
> begin
>    let doc-nbr	 		 	 of  f119-doctor-ytd-audit = a-doc-nbr
>    let doc-ohip-nbr			 of  f119-doctor-ytd-audit = a-doc-ohip-nbr
>    let comp-code       		 	 of  f119-doctor-ytd-audit = a-comp-code
>    let process-seq 		 	 of  f119-doctor-ytd-audit = a-process-seq
>    let comp-code-group  	 	 of  f119-doctor-ytd-audit = a-comp-code-group
>    let rec-type      	         	 of  f119-doctor-ytd-audit = a-rec-type
>    let amt-mtd                     	 of  f119-doctor-ytd-audit = a-amt-mtd
>    let amt-ytd         		     	 of  f119-doctor-ytd-audit = a-amt-ytd
> end
> 
> procedure internal createf119audit_Add
> begin
>    let doc-nbr	 		 	 of  f119-doctor-ytd-audit = doc-nbr		 of  f119-doctor-ytd
>    let doc-ohip-nbr			 of  f119-doctor-ytd-audit = doc-ohip-nbr	 of  f119-doctor-ytd
>    let comp-code       		 	 of  f119-doctor-ytd-audit = comp-code           of  f119-doctor-ytd
>    let process-seq		 	 of  f119-doctor-ytd-audit = process-seq	 of  f119-doctor-ytd
>    let comp-code-group 	 		 of  f119-doctor-ytd-audit = comp-code-group	 of  f119-doctor-ytd
>    let rec-type      	         	 of  f119-doctor-ytd-audit = rec-type 		 of  f119-doctor-ytd
>    let amt-mtd                     	 of  f119-doctor-ytd-audit = amt-mtd		 of  f119-doctor-ytd
>    let amt-ytd         		     	 of  f119-doctor-ytd-audit = amt-ytd  		 of  f119-doctor-ytd
> end
> 
> 
> procedure postfind
> begin
>    for f119-doctor-ytd
>    begin
>      do savef119audit
>    end
> end
> 
> ;MC3 - end
> 
> procedure preupdate
> begin
>   let rec-type = "A"
> 
> ; MC3
>    For f119-doctor-ytd
>    begin
>    if newrecord of f119-doctor-ytd
>    then begin
>         do createf119audit_add
>         let last-mod-flag of f119-doctor-ytd-audit = 'A'
>         let last-mod-date of f119-doctor-ytd-audit = sysdate
>         let last-mod-time of f119-doctor-ytd-audit = systime / 10000
>         let last-mod-user-id of f119-doctor-ytd-audit = trun(logonid) + '-d119-A'
>         put f119-doctor-ytd-audit
>         end
>    else
>    if changemode and deletedrecord of f119-doctor-ytd
>    then begin
>         do createf119audit
>         let last-mod-flag of f119-doctor-ytd-audit = 'D'
>         let last-mod-date of f119-doctor-ytd-audit = sysdate
>         let last-mod-time of f119-doctor-ytd-audit = systime / 10000
>         let last-mod-user-id of f119-doctor-ytd-audit = trun(logonid) + '-d119-D'
>         put f119-doctor-ytd-audit
>         end
>    else
>    if changemode and alteredrecord of f119-doctor-ytd
>    then begin
> ;      create before change audit record
>         do createf119audit
>         let last-mod-flag of f119-doctor-ytd-audit = 'C'
>         let last-mod-date of f119-doctor-ytd-audit = sysdate
>         let last-mod-time of f119-doctor-ytd-audit = systime / 10000
>         let last-mod-user-id of f119-doctor-ytd-audit = trun(logonid) + '-d119-1'
>         put f119-doctor-ytd-audit reset
> ;      create after  change audit record
>         do createf119audit_add
>         let last-mod-flag of f119-doctor-ytd-audit = 'C'
>         let last-mod-date of f119-doctor-ytd-audit = sysdate
>         let last-mod-time of f119-doctor-ytd-audit = systime / 10000
>         let last-mod-user-id of f119-doctor-ytd-audit = trun(logonid) + '-d119-2'
>         put f119-doctor-ytd-audit
>         end
>    end
> ; MC3 - end
> 
> end
> 
> build detail list
*W* Update on linked screen may bypass PREUPDATE/UPDATE/POSTUPDATE procedures.
> PROCEDURE APPEND
>   BEGIN
>     ACCEPT COMP-CODE OF F119-DOCTOR-YTD
>     DISPLAY DESC-SHORT OF F190-COMP-CODES
>     ACCEPT COMP-CODE-GROUP OF F119-DOCTOR-YTD
>     ACCEPT PROCESS-SEQ OF F119-DOCTOR-YTD
>     ACCEPT AMT-MTD OF F119-DOCTOR-YTD
>     ACCEPT AMT-YTD OF F119-DOCTOR-YTD
>     END
> PROCEDURE ENTRY
>   BEGIN
>     FOR F119-DOCTOR-YTD
>       BEGIN
>         PERFORM APPEND
>         END
>     END
> PROCEDURE PATH
>   BEGIN
>     LET PATH = 1
>     END
> PROCEDURE FIND
>   BEGIN
>     FOR MISSING F119-DOCTOR-YTD
>       BEGIN
>         GET F119-DOCTOR-YTD VIAINDEX F119-DOCTOR-YTD-SEQ USING &
>               W-DOC-NBR
>         END
>     END
> PROCEDURE UPDATE
>   BEGIN
>     FOR F119-DOCTOR-YTD
>       BEGIN
>         PUT F119-DOCTOR-YTD
>         END
>     PUT F020-DOCTOR-MSTR
>     PUT CONSTANTS-MSTR-REC-6
>     END
> PROCEDURE DELETE
>   BEGIN
>     DELETE F119-DOCTOR-YTD
>     END
> ALLDONE
MODE:x ACTION:xxxxxxxxx  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    -------COMP---------- GROUP STMNT  ---------AMOUNT----------
   --CODE/DESCRIPTION---- CODE   SEQ             MTD         YTD
01 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
02 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
03 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
04 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
05 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
06 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
07 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
08 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
09 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
10 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
11 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
12 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
13 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
14 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
15 xxxxxx-xxxxxxxxxxxxxxx  x      xx   xxxxxxxxxxxxx xxxxxxxxxxxxx
 
 
 
 
 
0 ERRORS  1 WARNINGS. Delete old screen /alpha/rmabill/rmabill101/obj/d119.qkc?
> 
Tue Mar 22 13:29:19 EST 2016
