/alpha/rmabill/rmabill101/dvlp/moira
Mon Mar 20 12:31:46 EST 2017
 + + + Sourced in /alpha/rmabill/rmabill101/dvlp/moira + + +
;Compiling program [/alpha/rmabill/rmabill101/dvlp/moira/m040_dtl.qks]
Q D E S I G N   (7.33.E)
Copyright 1996 COGNOS INCORPORATED
Licensed PH-DEVELOPMENT for customer: 0057360001 DYAD Systems Inc. UNIX

> ;#>  PROGRAM-ID.      M040_DTL.QKS
> ;
> ;              ((C)) DYAD INFOSYS LTD
> ;
> ;       PROGRAM PURPOSE : OMA CD /DEPT detail maintenance
> ;                         this program is called from m100.qks
> ;
> ;       MODIFICATION HISTORY
> ;    DATE          WHO           DESCRIPTION
> ;  2015/Mar/17    M.C.     original
> ;  2017/Feb/13	  MC1	   include doc-nbr in the file as suggested by Brad
> 
> 
> screen $obj/m040_dtl
> 
> file   f040-dtl  occurs 20
> 
> file   f040-oma-fee-mstr reference
> 	access viaindex fee-oma-cd using fee-oma-cd of f040-dtl
> 
> file   f070-dept-mstr reference
> 	access viaindex dept-nbr using dept-nbr of f040-dtl
> 
> ; MC1
> file   f020-doctor-mstr reference
>         access viaindex doc-nbr using doc-nbr of f040-dtl
> ; MC1 - end
> 
> ; MC1
> ;title "OMA CD / DEPT  detail maintenance" at 2,30
> ;title "OMA CD   DEPT   DATA ENTRY" at 3,4
> title "OMA CD / DEPT / DOC  detail maintenance" at 2,30
> title "OMA CD   DEPT  DOC  DATA ENTRY" at 3,4
> 
> ; MC1
> ;align (1,,5) (,,14) (,,25)
> align (1,,5) (,,14) (,,19) (,,28)
> ; MC1 - end
> 
> cluster occurs with f040-dtl
> FIELD FEE-OMA-CD OF F040-DTL REQUIRED NOCHANGE upshift		&
> 	lookup on f040-oma-fee-mstr
> 
> FIELD DEPT-NBR OF F040-DTL ID SAME REQUIRED NOCHANGE	&
> ; MC1
> ;	lookup on f070-dept-mstr,			&
> 	lookup on f070-dept-mstr
> ;	       NOTON F040-DTL 				&
> ;	VIA FEE-OMA-CD , DEPT-NBR 			&
> ;	USING FEE-OMA-CD OF F040-DTL, DEPT-NBR OF F040-DTL
> ; MC1 - end
> 
> ; MC1
> FIELD doc-nbr OF F040-DTL ID SAME REQUIRED NOCHANGE	&
> 	lookup noton f040-dtl				&
> 	VIA FEE-OMA-CD , DEPT-NBR, DOC-NBR 		&
> 	USING FEE-OMA-CD OF F040-DTL, DEPT-NBR OF F040-DTL,  DOC-NBR OF F040-DTL
> ; MC1 - end
> 
> FIELD DATA-ENTRY-FLAG OF F040-DTL  required
> 
> ; MC1
> procedure edit doc-nbr
> begin
>     if fieldtext <> '   ' and fieldtext <> '000'
>     then begin
> 	get f020-doctor-mstr optional
>         if not accessok
>         then
>  	    error "Doctor nbr does not exist in doctor mstr"
>         else
> 	    if doc-dept  <> dept-nbr
>             then
> 	 	error "Dept is not the same as doctor's dept"
>         end
> end
> ; MC1 - end
> 
> build detail list
> PROCEDURE APPEND
>   BEGIN
>     ACCEPT FEE-OMA-CD OF F040-DTL
>     ACCEPT DEPT-NBR OF F040-DTL
>     ACCEPT DOC-NBR OF F040-DTL
>     ACCEPT DATA-ENTRY-FLAG OF F040-DTL
>     END
> PROCEDURE ENTRY
>   BEGIN
>     FOR F040-DTL
>       BEGIN
>         PERFORM APPEND
>         END
>     END
> PROCEDURE PATH
>   BEGIN
>     REQUEST FEE-OMA-CD OF F040-DTL
>     IF PROMPTOK
>       THEN REQUEST DEPT-NBR OF F040-DTL
>     IF PROMPTOK
>       THEN REQUEST DOC-NBR OF F040-DTL
>     IF PROMPTOK
>       THEN LET PATH = 1
>     IF PATH = 0
>       THEN BEGIN
>         REQUEST FEE-OMA-CD OF F040-DTL
>         IF PROMPTOK
>           THEN REQUEST DEPT-NBR OF F040-DTL
>         IF PROMPTOK
>           THEN LET PATH = 2
>         END
>     IF PATH = 0
>       THEN BEGIN
>         REQUEST FEE-OMA-CD OF F040-DTL
>         IF PROMPTOK
>           THEN LET PATH = 3
>         END
>     IF PATH = 0
>       THEN BEGIN
>         LET PATH = 4
>         END
>     END
> PROCEDURE FIND
>   BEGIN
>     FOR MISSING F040-DTL
>       BEGIN
>         IF PATH = 1
>           THEN GET F040-DTL VIA FEE-OMA-CD , DEPT-NBR , DOC-NBR
>         IF PATH = 2
>           THEN GET F040-DTL VIA FEE-OMA-CD , DEPT-NBR
>         IF PATH = 3
>           THEN GET F040-DTL VIA FEE-OMA-CD
>         IF PATH = 4
>           THEN GET F040-DTL SEQUENTIAL
>         END
>     END
> PROCEDURE UPDATE
>   BEGIN
>     FOR F040-DTL
>       BEGIN
>         PUT F040-DTL
>         END
>     END
> PROCEDURE DELETE
>   BEGIN
>     DELETE F040-DTL
>     END
> ALLDONE
MODE:x ACTION:xxxxxxxxx
                             OMA CD / DEPT / DOC  detail maintenance
   OMA CD   DEPT  DOC  DATA ENTRY
01  xxxx     xx   xxx      x
02  xxxx     xx   xxx      x
03  xxxx     xx   xxx      x
04  xxxx     xx   xxx      x
05  xxxx     xx   xxx      x
06  xxxx     xx   xxx      x
07  xxxx     xx   xxx      x
08  xxxx     xx   xxx      x
09  xxxx     xx   xxx      x
10  xxxx     xx   xxx      x
11  xxxx     xx   xxx      x
12  xxxx     xx   xxx      x
13  xxxx     xx   xxx      x
14  xxxx     xx   xxx      x
15  xxxx     xx   xxx      x
16  xxxx     xx   xxx      x
17  xxxx     xx   xxx      x
18  xxxx     xx   xxx      x
19  xxxx     xx   xxx      x
20  xxxx     xx   xxx      x
0 ERRORS  0 WARNINGS. Delete old screen 
/alpha/rmabill/rmabill101/obj/m040_dtl.qkc?
Mon Mar 20 12:31:47 EST 2017
