/alpha/rmabill/rmabill101/dvlp/moira
Thu Sep 17 16:11:04 EDT 2015
 + + + Sourced in /alpha/rmabill/rmabill101/dvlp/moira + + +
;Compiling program [/alpha/rmabill/rmabill101/dvlp/moira/r128a_test.qts]
Q T P   (7.33.E)
Copyright 1996 COGNOS INCORPORATED
Licensed PH-RUNTIME for customer: 5139390001 C.O.T.A UNIX

> ;#> PROGRAM-ID.     r128a.qts
> ;
> ;       ((C)) Dyad Infosys LTD
> ;
> ;    PURPOSE: first pass for inactive doctors that do not have earnings for 3 most recent months
> ;
> ;             STAGE 1 - create subfile of values from f119-doctor-ytd-history
> ;
> ;    MODIFICATION HISTORY
> ;        DATE    SAF #  WHO      DESCRIPTION
> ;   2014/Jul/16  ____   M.C.     - original
> ;				 - Doctor terminated and do not notify RMA.  This is especially a problem
> ;				   with the non-GFT physicians
> ;   2015/Jun/18		MC1	 - change the selection criteria as requested by Brad
> ;				 - select on "no activity" - if BILL and AFPIN and AFPOUT <= 0 for the
> ;				   current EP and 2 previous EP's for all dept and pay code
> ;				 - only doctors with claims balance due <> 0
> cancel clear
> 
> run u128_inactive_doctors
> 
> set default
WORKSPACE and STACKSIZE can't be reset within a QTP run.
> set process nolimit
> set lock record update
> 
> global temp w-current-ep-nbr            numeric
> global temp w-last-3-ep-nbr	 	numeric
> 
> ;-------------------------------------------------------------------------------
> request get_constants_values_ep_nbr          		&
>                 on edit        errors report 		&
>                 on calculation errors report
> 
> access constants-mstr-rec-6
> 
> choose const-rec-nbr 6
*W* Item (CONST-REC-NBR) is stored by the file system as a character type.
Choose viaindex CONSTANTS-MSTR-REC-6.
> 
> def ep-mm =   mod(current-ep-nbr,100)
> 
> item w-current-ep-nbr  = current-ep-nbr
> item w-last-3-ep-nbr   = current-ep-nbr -  3    if ep-mm >= 4	&
> 		else     current-ep-nbr - 90    if ep-mm <= 3
> 
> ;-------------------------------------------------------------------------------
> request access_f119_hist                     		&
>                 on edit        errors report 		&
>                 on calculation errors report
> 
> access f119-doctor-ytd-history				&
> 	link doc-nbr					&
> 	 to  doc-nbr of f020-doctor-mstr
> 
> choose doc-nbr, ep-nbr (w-last-3-ep-nbr to w-current-ep-nbr), rec-type 'A'
*W* Item (EP-NBR) is stored by the file system as a character type.
Choose viaindex F119-DOCTOR-YTD-HISTORY.
> 
> sort on doc-nbr on ep-nbr
> 
> sel f119-doctor-ytd-history if                    	&
> ; MC1
> ;	(comp-code = 'TOTINC'  and amt-mtd <= 0)	&
> ;     or (comp-code = 'INCEXP'  and amt-mtd <= 0)	&
> ;     or (comp-code = 'PAYEFT'  and amt-mtd <= 0)	&
> ;     or (comp-code = 'ADVOUT'  and amt-mtd >  0)
> 	(comp-code = 'BILL'                    )	&
>      or (comp-code = 'AFPIN'                   )	&
>      or (comp-code = 'AFPOUT'                  )
> 
> ;sel f020-doctor-mstr if					&
> ;	(doc-dept = 14 or doc-dept =15)  		&
> ;     and doc-ep-pay-code = '2'
> 
> temp x-bill
> item x-bill = x-bill + 1            			&
> 	if comp-code = 'BILL' and amt-mtd > 0		&
> ;	at ep-nbr					&
> 	reset at doc-nbr
> 
> temp x-afpin
> item x-afpin = x-afpin + 1             			&
> 	if comp-code = 'AFPIN' and amt-mtd >  0		&
> ;	at ep-nbr					&
> 	reset at doc-nbr
> 
> temp x-afpout
> item x-afpout = x-afpout + 1              		&
> 	if comp-code = 'AFPOUT' and amt-mtd >  0	&
> ;	at ep-nbr					&
> 	reset at doc-nbr
> 
> def x-bill-afpin-afpout = x-bill + x-afpin + x-afpout
> 
> ;subfile r128a       keep include			&
> subfile r128a_test       keep at doc-nbr include	&
> ; MC1 - end
>      doc-nbr of f119-doctor-ytd-history, 		&
>      doc-dept, doc-name,                 		&
>      doc-date-fac-start, doc-date-fac-term,		&
>      doc-ep-pay-code,					&
> ; MC1
> ;     ep-nbr of f119-doctor-ytd-history, 		&
> ;     comp-code, amt-mtd,  amt-ytd
> 	x-bill, x-afpin, x-afpout, x-bill-afpin-afpout
> ; MC1 - end
Thu Sep 17 16:11:09 EDT 2015
