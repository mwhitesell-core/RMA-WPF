* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page   1
*                      newu701.cbl
* Directives File: /usr/opt/mfcobol4.0/cobol.dir
* Accepted - SHOW-DIR
* Accepted - SOURCEFORMAT"FREE"
* Accepted - SPZERO
* Accepted - TIME
* Accepted - TRUNC
* Accepted - LIST
* Accepted - RESEQ
* End Of Directives File: /usr/opt/mfcobol4.0/cobol.dir
* Options: int(newu701.int) verbose nolist endp list(newu701.lst)
identification division.
program-id.    newu701.
author.        dyad technologies.
installation.  rma.
date-written.  90/06/15.
date-compiled. 26-Apr-17 12:50.
security.
*
*
*  REMARKS:   - OHIP DISKETTE UPLOAD INTO SUSPENSE FILES
*             - CREATE SUSPENSE HEADER, DETAIL, AND ADDRESS RECORDS
*               FROM THE DISKETTES. VALIDATE EACH FIELD.
*
*
*  REV 91/04/23 (M.C.)  - SMS  138
*                       - SET 'CLMHDR-PAT-KEY-DATA' TO HEALTH-NBR IF
*                         PRESENT;OTHERWISE, USE OHIP NBR.
*
*  REV 91/09/11 (B.M.L.) - CHANGED PROGRAM TO IGNORE BLANK OR ZERO OHIP
*                          EDIT CHECKS NOW WORK ON HEALTH INSTEAD.
*
*  REV 91/09/18 (M.C.)  - INVALID DIGIT ON BATCH-SPECIALTY BECAUSE
*                         MOVE '???' TO NUMERIC FIELD, CORRECTION MADE
*                         ON PAGE 26 (FB0-BUILD-SUSP-HDR-REC)
*
*  REV 92/09/25 (M.C.)  - PDR 558
*                       - SELECT ONLY THE ACTIVE DOCTOR, AND IF THE
*                         DOCTOR HAS MORE THAN 1 ACTIVE NUMBER, USER
*                         SHOULD ENTER THE NUMBER THEY WANT
*
*  REV 93/06/16 (A.G.K.) - MODIFY THE INPUT FILE DEFINITION FOR THE NEW
*                          OHIP LAYOUT
*
*  REV 93/07/13 (M.C.)  - SMS 142
*                       - MODIFY THE INPUT FILE TO THE SAME AS CURRENT
*                         OHIP LAYOUT (79 CHARS)
*                       - MODIFY THE NECESSARY CHANGES TO THE FILES
*                       - EXTEND 12 CHARS IN F002-SUSPEND-ADDRESS FILE
*
*  REV 93/11/16 (M.C.)  - PDR 591
*                       - MODIFY THE VALIDATION ON REFERRING DOC NBR
*
*  REV 96/07/30 (M.C.)  - PDR 649
*                       - INCLUDE 'I' AND 'O' AS PART OF HDR-I-O-IND
*                         WHEN EDITING
*###  CHECK OUT SETTING OF DETAIL-WRITTEN
*###  CHECK THAT FEE- VARIABLES ARE IN THE HOLD AREA
*  REV 97/09/10 (B.E.)  - EDIT SERVICE DATE NOT LESS THAN ADMIT DATE
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page   2
*                      newu701.cbl
*                         ENSURE THAT IF 'OP'/'MR' (OVERRIDE PRICE) IS SPECIFIED
*                        OR INCOMING FEES ARE ALREADY PRICED THEN SKIP
*                        RMA PRICING (INCLUDING ADD ONS)
*  REV 97/10/01 (B.E.)  - ADD ABILITY TO PROCESS MULTIPLE CLINICS WITHIN
*                         A SINGLE BATCH.
*  REV 97/11/01 (B.E.)  - ADD USER SELECTION PARAMETER TO ALLOW
*                         DEFAULTING OF CLINIC NBR IF NOT SPECIFIED
*                         WITHIN THE BATCH
*
*  REV 97/11/11 (B.E.)  - CLINIC DEFAULT WAS 2215 WHICH THEN OVERRODE
*                         WHAT WAS IN BATCH. CHANGE LOGIC TO USE USER
*                         SELECTION CLINIC NBR ONLY IF INCOMING BATCH'S
*                         CLINIC NBR IS ZERO OR BLANK.
*  REV 97/11/14 (B.E.)  - PROGRAM LOGIC TAKEN FROM D001 ALLOWED ONLY 8
*                         DETAIL RECORDS. 'OCCURS' CHANGED FROM 8 TO 40.
*                         TO ALLOW WEB INPUT OF UP TO 40 LINES
*                         (ARBRITRARY DECISION TO THIS NUMBER)
*       97/12/10 (B.E.) - BUG FIXED. LENGTH OF HOLD-OMA-REC CHANGED AND
*                         ASSOCIATED SORT-REC NOT INCREASED TO LARGE
*                         ENOUGH VALUE - CHANGED TO LENGTH OF 250.
*
*       98/03/18 (B.E.) - ADDED DEFAULTING OF BATCH LOCATION AND I/O INDIATOR
*                         SO THAT RMA OPERATORS CAN INPUT THESE FILES
*                         INTO THE 'HEB' RECORD IF PROCESSING A NON-
*                         RMA-ALTERED SUBMISSION DISKETTE.

*       98/03/31 (M.C.) - SOME DOCTOR DISKETTES DO NOT HAVE 'HER' RECORD
*                         (HEADER 2), IF OPERATOR WANTS TO DEFAULT TO
*                         AGENT 0 AND TAPE-SUBMIT-IND = 'Y', SET IN
*                         HEADER 1 SUBROUTINE.  FOR OTHER DISKETTES
*                         THAT HAVE HEADER 2 RECORD, SET AGENT AND
*                         TAPE-SUBMIT-IND FROM HEADER 2 RECORD.
*
*       98/04/06 (M.C.) - MOVE SPACES TO HEADER-REC IN FB0 SUBROUTINE
*                       - FIX MINOR PROBLEM (2 DIGITS TO CLINIC NBR)
*                       - CHANGE PGM NAME U701 TO NEWU701 IN SCREEN
*                         SECTION
*       1999/mar/2 B.E. - added logic at 2nd test section of code to only requir
*                         diagnosic code if oma-suffix is "A" or "M"
*     1999/May/06 S.B.  - Marked by 'S.B.' (brought from 102)
*                       - Put in check against the Referring physician
*                       being the same sas the Billing doctor.
*                       - Put in check for missing Referring physician.
*                       - Added a check to insure that Service dates are
*                       after Run dates.
*                       - Added a check to make sure that the correct
*                       specialty for the doctor is used.
*                       - Added a check to make sure that each claim
*                       has a detail record.
*                       - Changed the err-msg to occur 50 times to
*                       reflect the new error messages possible.
*                       - Changed the claim value being put out on
*                       error 50 from unpriced-clmhdr-claim to
*                       clmhdr-accounting-nbr to show the correct
*                       claim for the error.
*                       - Added a reset for the ctr-hdr2-rec and
*                       ctr-addr-rec counters to prevent a missing
*                       detail from appearing on the first
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page   3
*                      newu701.cbl
*                       batch record after a previous batch that
*                       had any detail records in it.
* 2000/feb/08 B.A. - added 'confidentiality flag' field to tape in file in
*                    anticipation of this value being passed from Web site
*                  - code to process this field to be added later
* 2000/feb/29 B.A. - added logic to only allow a 'Y' or ' ' in the confid
*                    flag field
* 2000/mar/02 B.E. - pricing algorithm (ye0) used hard coded '7' for original
*                    restriction of 8 detail lines.  Changed code to have
*                    maximun allowed detail lines (40) set into variable
*                    "ss-max-nbr-oma-det-rec-allow" and use this
*                    variable in pricing algorthim.
* 2000/mar/13 B.E. - if incoming patient's phone number is only 7 digits long
*                    then default the area code stored in copy book code.
*
* 2000/mar/20 M.C. - open f030-location-mstr, retrieve hospital nbr and i/o ind
*                    from locations mstr by loc-code.
*                    If the original doctor ohip nbr is the same as referring
*                    doctor ohip nbr, print error.
*                    If diskette price is different than the way rma prices,
*                    print error
* 2000/mar/29 M.C. - If the incoming I/O ind is different than RMA i/o ind,
*                    print error
* 2000/apr/05 M.C. - If the input file comes with amount and the oma code
*                    suffix is either 'B' or 'C' (ie anesthesia), do not change
*                    nbr of svc (ie basic + time), but do for web
* 2000/apr/10 M.C. - Change the pricing algorithm correctly for add on codes
*                    (ie suffix = 'B' or 'C')
*                    suffix is either 'B' or 'C' (ie anesthesia), do not change
* 2000/apr/14 M.C. - Yas requested this verion not to check price difference
* 2000/apr/28 B.A. - Added additional checks for confidential flag at dtl level
* 2000/jun/05 B.E. - correct pricing of tech portion of fee
* 2000/jun/30 B.E. - keep BI and OP flags by moving them into consecutives
*                    services area
* 2000/jul/31 B.E. - when determining current vs previous rates use the
*                    effective date in the oma code's f040 record rather
*                    than effective date in constants master
* 2000/aug/03 B.E. - pricing modified to take into consideration that
*                    oma fees now 9(4).999 rather than 9(5).99
* 00/sep/08 B.E. - modified to keep original sequence details when writing
*                  claim details to suspend dtl file
* 00/sep/10 B.E. - rtn yz0-reset-verify-prices that resets prices to incoming
*                  values moved from this pgm into ya0- copybook so that
*                  that calcuation of 'tech' amounts can be made on
*                  new priced amounts or the incoming amounts depending
*                  upon whether they are reset or not
*                - set clmhdr-nbr-suspend-desc-recs to zero
* 00/sep/14 B.E. - comment out error message is hospital number is missing.
*                  Since the location code is now used to derive the hospital
*                  number it is no longer a problem of the incoming
*                  hospital number is missing/wrong
* 00/oct/02 B.E. - ctr-tot-dollars-claim was used to sum OHIP detail amts
*                  and update header's oma/ohip $ amounts. Pgm changed to
*                  reprice diskette uploads and save 'rma' prices in oma
*                  amt and diskette's original price in ohip amt. Therefore
*                  setup 2 separate ctr-tot.. fields to keep oma / ohip
*                  running claim totals to update header
*                - renamed 'override' flag as 'retain incoming' price
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page   4
*                      newu701.cbl
*                  flag to make it easier to distinguish between OP override
*                  price logic
* 00/oct/26 B.E. - allow operator to override the current system date. This
*                  options is only used in test when running the "master
*                  test claims batch" which are "old" dates that will
*                  be greater than 6 months from the real system date
*                  and will thus give errors (state dates). We want the
*                  'master test claims" to price the same time after time
*                  so allow operator to set system back (this date is
*                  usually set based upon the current pricing old/new
*                  date of 2000/04/01)
*                - if any dates wrong move 8 "?" rather than 6 to date field
*
* 00/nov/27 M.C. - for clinic 61-65 only, if referring doc nbr is same as orig
*                  doc nbr, do not print error 47; if referring doc nbr is blank
*                  set the same as orig doc nbr.  Yas requested the changes.
* 01/feb/06 B.E. - change to pricing routine to price loc G420 / oma code
*                  G259 at 85%
* 01/feb/07 M.C. - save RMB ohip nbr if exists
* 01/feb/12 M.C. - when edit RMB registration nbr, the size has changed;
*                  please refer to MOH technical specification book.
* 01/feb/28 M.C. - if agent cd = 6 or 9, set clmhdr-status and clmdtl-status
*                  equal to 'I'gnore
* 01/mar/08 M.C. - if service date is greater than the admit date, instead of
*                  putting ????/??/?? in the service date field, put ????/??/??
*                  in the admit date
* 01/mar/27 B.E. - tech/prof rules of DU/PF icc codes changed to
*                  substitute "B" or "C" suffix for "A" if tech/prof
*                  only pricing, or to split into two separate lines
*                  if tech and prof fees involved.
* 01/apr/23 B.E. - 'fee' amount for PERCENTAGE addon's now divided by 100 as
*                  read in from f040 into hold variables that allow a
*                  4 decimal percentage
* 01/sep/28 B.E. - added create-error-file (an 88 flag) that controls the output
*                  of files and the errors that are generated. If the program
*                  is run 'print only' then the defaults are set to NOT upload
*                  the claims into the SUSPENSE files but to write them to
*                  the output 'priced' file. Also ALL errors are surpressed
*                  so that although the edits are performed the error message
*                  is bypassed and the claim is priced regardless. Subsequent
*                  changes should allow the program to be called and ONLY edit
*                  applied. The output file would then be a collection of
*                  errors.
* 01/oct/03 B.E. - added clinic-nbr to diskout (priced) file
* 02/mar/25 B.E. - added PAYROLL-FLAG to HEB record (unpriced-bathdr-rec)
* 02/apr/23 M.C. - move  PAYROLL-FLAG to clmhdr-hosp, according to Brad, they
*                  are no longer used the hospital code
* 02/may/03 M.C. - temporary edit check against staled svc date (< 20010901)
*                - Yas want to set payroll-flag to 'B' if incoming clinic from H
*                  otherwise set to 'A'
* 02/may/27 M.C. - reinstate the staled svc date check
* 02/jun/12 M.C. - if billing special premiums K994 to K997 and facility number
*                  error needs facility number
* 02/aug/12 M.C. - if billing special premiums K990 to K997 and facility number
*                  error needs facility number
* 02/aug/21 M.C. - if clinic = 80 or 95, bypass the edit check against svc date
* 03/jun/11 M.C. - if billing special premiums K990 to K997 and location code do
*                  error wrong location needs to end with 112
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page   5
*                      newu701.cbl
* 03/oct/22 M.C. - error if clinic nbr is not valid for the doctor
* 03/dec/08 M.C. - alpha doc nbr
* 04/jan/20 M.C. - add location code 153 or 400 or 250 or 422 when checking OMA
*                  with location code 112
* 04/apr/07 M.C. - error if admit date is prior to birth date
* 04/sep/27 M.C. - add location code 401 when checking OMA cd K990 to K997
*                  with location code 112
* 05/mar/03 M.C. - error if doctor specialty = 07 and patient age < 60
*                  or doctor specialty = 07 and oma codes = A775 or W775 or C775
*                  and patient age < 75
* 05/may/04 M.C. - edit check to make sure birth date < service date
*                - if clinic 61 to 65, must be certain location code; otherwise
* 05/may/09 M.C. - If location = G420 and oma code = G259 and R761, add manual r
*                  "REFER TO ADJUDICATION" on description record
*                  add open/close of f002-suspend-desc file
* 05/jun/23 M.C. - manitoba should have 9 digits instead of 6
*                  change province from NF to NL
* 05/aug/09 M.C. - set clmhdr-tape-submit-ind to blank for all conditions before
*                  suspend header record
* 05/aug/17 M.C. - change description from "REFER TO ADJUDICATION"  to
*                  "G259 BILLED AT 85%"
*                - xx3-write-susp-desc subroutine is created
* 05/oct/31 M.C. - If oma code = 'E420', then error - check pricing
*                  if doc nbr = '049' and oma cd = 'Z425', then error - take out
*                  if oma code is A073 or A074..etc (45 codes altogether) and di
*                  (26 altogether) and E078 is not on the same claim , error - c
*                  if oma code is A073 or A074..etc (45 codes altogether) and di
*                  (26 altogether) and E078 is on the same claim , error - check
* 05/dec/14 M.C. - add oma code 'A340', 'A341', 'A343' and 'A348' to the list ab
* 06/feb/15 M.C. - YAS requested to change from 40 to 60 detail record allowance
*                  change  maximun allowed detail lines (60) set into variable
*                    "ss-max-nbr-oma-det-rec-allow" and use this
*                    variable in pricing algorthim.

* 06/dec/12 M.C. - Yas requested to more edit checks in the program
*                - If billing code is C122 and the admit date is 1 day or more f
*                  then report on ru701 (newu701) with message "Check C122".
*                - If billing code is C123 and the admit date is 2 days or more
*                  then report on ru701 (newu701) with message "Check C123".
*                - If billing code is C124 and the admit date is less than 3 day
*                  then report on ru701 (newu701) with message "Check C124".

* 07/jan/25 M.C. - Yas requested to fine tuned the recent edit checks
*                - If billing code is C122 and the service date < 1 or >= 2 days
*                  then report on ru701 (newu701) with message "Check C122".
*                - If billing code is C123 and the service date < 2 or >= 3 days
*                  then report on ru701 (newu701) with message "Check C123".
*                - If billing code is C124 and the service date <= 1 day from th
*                  then report on ru701 (newu701) with message "Check C124".
* 07/aug/16 M.C. - for clinic 71-75 only, if referring doc nbr is same as orig
*                  doc nbr, do not print error 47; if referring doc nbr is blank
*                  set the same as orig doc nbr.  Yas requested the changes.
* 07/oct/24 M.C. - add location code 055 when checking OMA cd K990 to K997
*                  with location code 112
* 07/oct/24 M.C. - add location code 326 when checking OMA cd K990 to K997
*                  with location code 112
* 07/nov/27 M.C. - do the same check for clinic 71 to 75 as
*                   if clinic 61 to 65, must be certain location code; otherwise
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page   6
*                      newu701.cbl
* 08/jan/03 Y.B. - add location code 122 when checking OMA cd K990 to K997
*                  with location code 112
* 08/jan/09 M.C. - allow diagnostic 299, 313, 315, 765 & 902 with oma code E078A
* 08/jan/17 M.C. - include oma cd A262 to check with E078 premium
* 08/feb/19 M.C. - add location code 344 when checking OMA cd K990 to K997
*                  with location code 112
* 08/feb/28 M.C. - add location code 111 & 354  when checking OMA cd K990 to K99
*                  with location code 112
* 08/mar/18 M.C. - add location code 333 when checking OMA cd K990 to K997
*                  with location code 112
* 08/Apr/23 M.C. - add more edit check for messages 69 to 84
* 08/Apr/29 M.C. - if claims have 'A---A' code and 'G---A' code and one of the f
*                  K991A, K993A, K995A, K997A, U991A, U993A, u995A, U997A, then
*                  create  'Pay visit premium based on "A---A" code' to 2 descri
*                  and set clmhdr-manual-review  to 'Y'
* 08/Jul/23 Yas  - mod mess "If the code is E021 and the services is not equal t
* 08/mar/18 M.C. - add location code 777 when checking OMA cd K990 to K997
*                  with location code 112
* 09/may/06 MC1  - do the same addition edit checks as d001.cbl
*                - add 6 new edits and modify one existing edit for E021C in hb0
*                - modify to include in $use/d001_newu701_oma_code_edit.rtn
* 09/may/27 MC3  - modify the edit with exception of C101 when oma code is C990
*                  in  $use/d001_newu701_oma_code_edit.rtn
* 10/mar/31 MC4  - more edit checks as requested by Yasemin for message 91 to 10
* 10/may/18 MC5  - more edit checks as requested by Yasemin for message 97 & 98
* 10/may/19 MC6  - add a new sequential work file ru701-work-file, add message 1
* 10/aug/12 MC7  - add a new index to f002-suspend-hdr, set values to suspend-hd
* 10/sep/21 MC8  - modify for error 97 to include agent 9
* 10/sep/23 MC9 - for error 89 - include the check for same service date
* 10/Oct/04 MC10 - Linda OHara requested to disable the edit check if
*                  AxxxA is billed plus GxxxA plus one of the follwing :U991, U9
*                  K993, K995 & K997. IF condition is true, claim is flagged or
*                  'Pay visit premium based on AxxxA code'
* 10/dec/08 MC11 - modify for error 97 to check H1xx or H055 or H065
* 11/jan/26 MC12 - change the stale date to be 6 months plus 20 days per Yasemin
* 11/Mar/31 MC13 - modify edits for error 69, 80, 81, 85, 93, 97, 103, 65, 88 an
* 11/May/02 MC14 - modify edits for error 115 in copybook  pricing_variables_hol
* 11/May/18 MC15 - modify edits for error 80, 103 & remove the edit for error 10
*                - transfer all oma codes variables to copybook "d001_newu701_om
*                - transfer all oma codes variables reset to copybook "d001_newu
*                - add the new subroutine xx1a-reset-oma-flag to call "d001_newu
*                  in xx0-process-hold-dtls.
*                - include f201*slr/fd , open & close file to check against SLI
*                - add subroutine ha12-check-for-sli-oma to be called in ha0-pro
*                - add error 118 & 119 for sli edit check
* 11/Jun/13 MC16 - transfer the two subroutines ha12-check-for-sli-oma & hb0-bui
*                  into new copybook $use/newu701_oscar_dtl_edit_check.rtn so th
*                  it can be called in both newu701.cbl & u701oscar.cbl
*                - transfer all error-messages into copybook $use/newu701_oscar_
* 11/Jul/07 MC17 - include clinic 66 as part of clinic 60's check where is appli
* 11/Aug/22 MC18 - modify error 84 from 'A007 only allowed for specialty 00' to
*                  in $use/newu701_oscar_error_messages.ws & $use/newu701_oscar_
*                  and recompile newu701.cbl & u701oscar.cbl
* 11/nov/22 be2  - fix pricing with respect to min-fee pricing of OMA amount
* 11/Nov/23 MC19 - modify edit 1, 5, 12, 13, 21, 29, 32, 34, 40, 45, 49, 50 plus
* 12/Apr/23 MC20 - reset field value when processing a new batch, change from sp
* 12/Jul/04 MC21 - modify edit for error 69 to remove E022C check temporary
*                  in  $use/newu701_oscar_dtl_edit_check.rtn
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page   7
*                      newu701.cbl
* 12/Jul/12 MC22 - modify $use/pricing_logic.rtn to process yio before yf0 subro
* 12/Oct/22 MC23 - since pricing for E676B is now correct, user requested to rem
*                  in  $use/newu701_oscar_dtl_edit_check.rtn & $use/d001_newu701
* 12/Nov/05 MC24 - allow to process agent 6, correct codes accordingly, only ver
* 13/Apr/11 MC25 - modify edit 1, 5, 12, 17 plus add new edits 66 to 69 for erro
*                - add edits 66 - 69 in $use/newu701_oscar_dtl_edit_check.rtn,
*                - modify  in  $use/d001_newu701_oma_code_edit.rtn & la5-oma-cod
*                - modify  in  $use/d001_newu701_oma_code_variables.ws, $use/d00
*                  $use/newu701_oscar_error_messages.ws, $use/newu701_oscar_dtl_
* 13/Jun/17 MC26 - set referring doctor nbr to be the same as billing doctor nbr
*                  oma code = 'GnnnA' with fee-phy-ind = 'Y' in  $use/newu701_os
*                - remove/comment out edit 69 which is same as edit 39 which was
* 13/Jul/09 MC27 - Brad requested to add an edit check to make sure the service
*                - Linda O requested to allow 7 mth for svc date billing instead
*                - make changes in the copybook in $use/newu701_oscar_dtl_edit_c
*                  and add new error in $use/newu701_oscar_error_messages.ws
* 13/Jul/30      - UNDO MC27 -  to add an edit check to make sure the service da
*                - make changes in the copybook in $use/newu701_oscar_dtl_edit_c
*                  and remove new error in $use/newu701_oscar_error_messages.ws
* 13/Oct/15 MC28 - include the check of oma code 'J'nnn and 'X'nnn with 'G'nnn f
*                  Linda O'Hara said no need to check on suffix as J & X codes a
* 13/Dec/05 MC29 - if none of oma code detail requires referring doctor(ref-phy-
*                  referring doctor exists, then blank it out to reduce reject f
* 14/Feb/25 MC30 - modify edit 12 to exclude check of Z316 (error 80)  $use/newu
* 14/Apr/01 MC31 - if incoming clinic nbr is wrong for the doctor, zero out clmh
* 14/Apr/23 MC32 - modify the criteria check for error 62 to exclude clinic 75 a
*                  modify $use/newu701_oscar_error_messages.ws for error 62
* 14/May/21 MC33 - if incoming prov is '.' or '..', assume it is 'ON' to clmhdr-
*                - if incoming prov is invalid,     assume it is 'ON' to clmhdr-
* 14/Jun/05 MC34 - remove the edit check for err-ind = 94, modify$use/d001_newu7
*                  & modify $use/newu701_oscar_dtl_edit_check.rtn to comment out
* 14/Sep/08 MC35 - to add an edit check for terminated doctor (error 128)
*                - make changes in the copybook in $use/newu701_oscar_dtl_edit_c
*                  and add new error 128  in $use/newu701_oscar_error_messages.w
* 14/Dec/04 MC36 - include province 'NU'
* 14/Dec/13 b.e. - Yas requested to change 120 detail record allowance to 135.
* (1387)           Found variable (ss-max-nbr-oma-det-rec-allow) set as 70 not 1
*                  And also updated  hold-oma-rec occurs to 135 in 'pricing_vari
*                  to keep it in sync (it was not 70 but 90???)
* 15/Jan/20 MC37 - change ss-max-nbr-oma-det-rec-allow to 90 from 70 because hol
*                - add new error 129 for fatal error due to record misalign - it
*                - check the rec type for 1st 3 bytes instead of the third byte
* 15/Mar/05 MC38 - add error "LOCATION Code not currently active for data entry"
*                  in $use/newu701_oscar_error_messages.ws, the same check as in
* 15/Apr/09 MC39 - modify the edit 36 for error 65 in $use/newu701_oscar_dtl_edi
* 15/Jul/27 MC40 - modify the edit 12 for error 130 in $use/newu701_oscar_dtl_ed
* 15/Jul/30 MC41 - add display statements to debug the write to suspend-hdr with
* 16/May/03 MC42 - Yasemin requested to allow 231 days for  svc date billing bef
*                - make changes in the copybook in $use/newu701_oscar_dtl_edit_c
*                  and add new error in $use/newu701_oscar_error_messages.ws
* 17/Feb/09 MC43 - modify edit 12,17,29,49,50 and add new edit 69 to 79 for erro
*                - add edits 69 to 79 in $use/newu701_oscar_dtl_edit_check.rtn,
*                - modify  in  $use/d001_newu701_oma_code_edit.rtn & la5-oma-cod
*                - modify  in  $use/d001_newu701_oma_code_variables.ws, $use/d00
*                  $use/newu701_oscar_error_messages.ws, $use/newu701_oscar_dtl_
*                  and add new error 131 to 138 in $use/newu701_oscar_error_mess
* 17/Mar/09 MC44 - when determining current vs previous rates for OMA fee specif
*                  use the effective date in record 2 of constants master
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page   8
*                      newu701.cbl
*                  undo change be2 which made OMA pricing = OHIP pricing as we n
* 17/Apr/26 MC45 - add edit 82 - Process as bill direct, or change clinic to pro

environment division.
input-output section.
file-control.

copy "f002_suspend_hdr.slr".
* file: "f002_suspend_hdr.slr".

select suspend-hdr
    assign to disk   "f002_suspend_hdr"
    organization is indexed
    access mode  is dynamic
        lock mode is manual
*
    status       is status-cobol-suspend-hdr
    record key   is suspend-hdr-id
* 2010/aug/11 - MC - add new index
    alternate record key is suspend-hdr-acr.
* 2010/aug/11 - end


copy "f002_suspend_dtl.slr".
* file "f002_suspend_dtl.slr".

select suspend-dtl
    assign to disk "f002_suspend_dtl"
    organization is indexed
    access mode  is dynamic
        lock mode is manual
*
    status       is status-cobol-suspend-dtl
    record key   is suspend-dtl-id of suspend-dtl with duplicates.


copy "f002_suspend_address.slr".
* file: f002_suspend_address.slr

select suspend-address
    assign to disk "f002_suspend_address"
    organization is indexed
    access mode  is dynamic
        lock mode is manual
*
    status       is status-cobol-suspend-addr
    record key   is suspend-addr-id.

* 2005/05/09 - add description file
copy "f002_suspend_desc.slr".
* file "f002_suspend_desc.slr".

select suspend-desc
    assign to disk "f002_suspend_desc"
    organization is indexed
    access mode  is dynamic
        lock mode is manual
*
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page   9
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f00)
    status       is status-cobol-suspend-desc
* 2005/05/09 - MC - according to PH, the key is unique
*    record key   is suspend-dtl-id of suspend-desc with duplicates.
    record key   is suspend-dtl-id of suspend-desc.
* 2005/05/09 - end
* 2005/05/09 - end

copy "f020_doctor_mstr.slr".
    select doc-mstr
*mf     assign index to "f020_doctor_mstr"
*mf     assign data  to "f020_doctor_mstr"
        assign to disk "$pb_data/f020_doctor_mstr"
        organization is indexed
        access mode  is dynamic
*mf added lock mode so that files aren't open exclusively
        lock mode is manual

        record key   is doc-nbr of doc-mstr-rec

*mf added two  alternative keys below
        alternate key is doc-name-soundex
         with duplicates
        alternate key is doc-ohip-nbr of doc-mstr
         with duplicates
              status  is status-cobol-doc-mstr.
*       infos status  is status-doc-mstr.
*       eof-flag     is eof-doc-mstr
*

copy "f030_locations_mstr.slr".
    select loc-mstr
*       assign index to "f030_locations_mstr"
*               contiguous
*       assign data  to "f030_locations_mstr"
        assign  to disk "$pb_data/f030_locations_mstr"
        organization is indexed
        access mode  is dynamic
*mf added lock mode so that files aren't open exclusively
        lock mode is manual
        record key   is loc-nbr
*       infos status is status-loc-mstr.
        status is status-cobol-loc-mstr.

copy "f040_oma_fee_mstr.slr".
    select oma-fee-mstr
*mf     assign index to "f040_oma_fee_mstr"
*mf     assign data  to "f040_oma_fee_mstr"
        assign to disk "$pb_data/f040_oma_fee_mstr"
        organization is indexed
        access mode  is dynamic
*mf added lock mode so that files aren't open exclusively
        lock mode is manual
        record key   is fee-oma-cd
*mf     infos status is status-oma-mstr.
*       eof-flag     is eof-oma-mstr
        status is status-cobol-oma-mstr.

copy "f090_constants_mstr.slr".
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  10
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f09)
select iconst-mstr
assign to disk "$pb_data/f090_constants_mstr"
organization is indexed
access mode  is dynamic
*mf added lock mode so that files aren't open exclusively
lock mode is manual
record key   is iconst-clinic-nbr-1-2
*       eof-flag     is eof-iconst-mstr
status is status-cobol-iconst-mstr.

copy "f091_diagnostic_codes.slr".
    select diag-mstr
*mf     assign index to "f091_diag_codes_mstr"
*mf     assign data  to "f091_diag_codes_mstr"
        assign to disk "$pb_data/f091_diag_codes_mstr"
        organization is indexed
        access mode  is dynamic
*mf added lock mode so that files aren't open exclusively
        lock mode is manual

        record key   is diag-cd
              status is status-cobol-diag-mstr.
*mf     infos status is status-diag-mstr.
*       eof-flag     is eof-diag-mstr
*

* 2011/05/18 - MC15
copy "f201_sli_oma_code_suff.slr".
    select sli-oma-code-suff-mstr
        assign to disk "$pb_data/f201_sli_oma_code_suff"
        organization is indexed
        access mode  is dynamic
*mf added lock mode so that files aren't open exclusively
        lock mode is manual
        record key   is sli-oma-code-suff
        status is status-cobol-sli-oma-mstr.
*
* 2011/05/18 - end


select unpriced-claims-file
    assign to       "submit_disk_susp.in"
    organization is sequential
    access mode  is sequential
    status       is status-cobol-unpriced-claims.

select priced-claims-file
    assign to       "submit_disk_susp.out"
    organization is sequential
    access mode  is sequential
    status       is status-cobol-priced-claims.

* 2010/05/19 - MC6
select ru701-work-file
    assign to       "ru701_work_file"
    organization is sequential
    access mode  is sequential
    status       is status-cobol-ru701-work-file.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  11
*                      newu701.cbl                                   )
* 2010/05/19 - end

*2002/04/22 - MC - comment out
*select error-claims-file
*    assign to       "submit_disk_susp.err"
*    organization is sequential
*    access mode  is sequential
*    status       is status-cobol-error-claims.
*2002/04/22 - end


select report-file
    assign to        printer audit-file
    Status       is  status-report.


data division.
file section.

*COPY "F002_SUBMIT_DISKETTE_COMMON.FD".

* MODIFICATION HISTORY
*  97/JUN/21 B.E.       -ADDED OP_OVERRIDE_PRICE_IND
*                        AND   BI_BILATERAL_IND
*  97/SEP/25 B.E.       -ADDED CLINIC-NBR-1-2
*  98/MAR/18 B.E.       -ADDED TAPEOUT-DEFAULT-BATCH-LOCATION. IF PROCESSING
*                        AN 'UNALTERED' OHIP SUBMISSION DISKETTE
*                        THEN NO RMA LOCATION HAS BEEN INCLUDED
*                        ON EACH DETAIL RECORD. ALLOW RMA OPERATOR
*                        TO EDIT DISKETTE FILE AND MANUALLY ADD
*                        LOCATION TO 'HEB' BATCH HEADER RECORD.
*2002/mar/25 B.E.       - added PAYROLL-FLAG to HEB record (unpriced-bathdr-rec)
*
fd  unpriced-claims-file
*mf    recording mode is data-sensitive
    data records are unpriced-claims-record.

01  unpriced-claims-record.
    05  unpriced-trans-id                        pic xx.
    05  unpriced-input-rec-type                  pic x.
    05  unpriced-bathdr-rec.
* (y2k additional field)
        10  unpriced-release-id                  pic x(3).

        10  unpriced-moh-code                    pic x.
        10  unpriced-bathdr-batch-nbr.
* (y2k)
*           15  unpriced-bathdr-batch-nbr-date   pic 9(6).
            15  unpriced-bathdr-batch-nbr-date   pic 9(8).
            15  unpriced-bathdr-batch-nbr-seq    pic 9(4).
        10  unpriced-bathdr-opr-nbr              pic x(6).
        10  unpriced-bathdr-fac-no               pic x(4).
        10  unpriced-bathdr-prov-ohip-no         pic 9(6).
        10  unpriced-bathdr-spec-cd              pic 9(2).
*       10  FILLER                              PIC X(40).
* (y2k)
*       10  filler                              pic x(35).
*       10  filler                              pic x(30).
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  12
*                      newu701.cbl                                   )
*       (2002/mar/25 added payroll flag - "A" regular 22 payroll
*                                       - "B" ICU payroll)
        10  filler                              pic x(29).
        10  unpriced-payroll-flag               pic x(1).
        10  unpriced-default-batch-i-o-ind      pic x(1).
        10  unpriced-default-batch-loc          pic x(4).
        10  unpriced-bathdr-clinic-1-2          pic 99.
        10  unpriced-bathdr-dept                pic 99.
*!        10  unpriced-bathdr-doc-nbr             pic 9(3).
        10  unpriced-bathdr-doc-nbr             pic x(3).

    05  unpriced-clmhdr1-rec redefines unpriced-bathdr-rec.

        10  unpriced-clmhdr-health-nbr           pic x(10).
        10  unpriced-clmhdr-version-cd           pic x(2).
        10  unpriced-clmhdr-birth-date.
* (y2k)
*           15  unpriced-clmhdr-birth-date-yy    pic 99.
            15  unpriced-clmhdr-birth-date-yy    pic 9(4).
            15  unpriced-clmhdr-birth-date-mm    pic 99.
            15  unpriced-clmhdr-birth-date-dd    pic 99.
        10  unpriced-clmhdr-claim.
*!            15  unpriced-clmhdr-doc-nbr          pic 9(3).
            15  unpriced-clmhdr-doc-nbr          pic x(3).
            15  unpriced-clmhdr-wk               pic xx.
            15  unpriced-clmhdr-day              pic x.
            15  unpriced-clmhdr-claim-nbr        pic xx.
        10  unpriced-clmhdr-pay-pgm              pic x(3).
        10  unpriced-clmhdr-payee                pic x.
        10  unpriced-clmhdr-ref-doc-nbr          pic 9(6).
        10  unpriced-clmhdr-hosp-nbr             pic x(4).
        10  unpriced-clmhdr-admit-date.
* (y2k)
*           15  unpriced-clmhdr-admit-date-yy    pic xx.
            15  unpriced-clmhdr-admit-date-yy    pic x(4).
            15  unpriced-clmhdr-admit-date-mm    pic xx.
            15  unpriced-clmhdr-admit-date-dd    pic xx.
        10  unpriced-clmhdr-ref-lab-no           pic 9(4).
        10  unpriced-clmhdr-man-review           pic x.
* (y2k additional field)
        10  unpriced-moh-location-code          pic 9(4).
        10  unpriced-reserved-for-ooc           pic x(11).
*       10  filler                              pic x(25).
        10  filler                              pic x(06).

*       (FILLER ADDED TO ACCOMODATE A 'BAD' INPUT FILE THAT
*        HAD 81 BYTES IN IT)
*mf        10  filler                              pic x(40).

    05  unpriced-clmhdr2-rec redefines unpriced-bathdr-rec.

        10  unpriced-clmhdr-pat-ohip-nbr         pic x(12).
        10  unpriced-clmhdr-pat-surname          pic x(9).
        10  unpriced-clmhdr-given-name           pic x(5).
        10  unpriced-clmhdr-sex                  pic 9.
        10  unpriced-clmhdr-prov-cd              pic x(2).

* *1999/dec/30 B.E. added new field in anticipation of this value
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  13
*                      newu701.cbl                                   )
*                   being passed from Web site)
*       10  filler                              pic x(31).
        10  filler                              pic x(30).
        10  unpriced-confidentiality-flag        pic x(1).

        10  unpriced-clmhdr-loc-code             pic x(4).
        10  unpriced-clmhdr-agent-cd             pic x.
        10  unpriced-clmhdr-i-o-ind              pic x.

* (2000/mar/15 B.E. - added redefine of phone nbr field)
        10  unpriced-clmhdr-phone-no.
            15 unpriced-clmhdr-phone-no-1-7     pic x(07).
            15 unpriced-clmhdr-phone-no-8-10    pic x(03).
        10  unpriced-clmhdr-phone-no-r redefines unpriced-clmhdr-phone-no.
            15 unpriced-clmhdr-phone-no-1-3     pic x(03).
            15 unpriced-clmhdr-phone-no-4-10    pic x(07).


*       (FILLER ADDED TO ACCOMODATE A 'BAD' INPUT FILE THAT
*        HAD 81 BYTES IN IT)
*mf        10  filler                              pic x(40).


    05  unpriced-item-rec redefines unpriced-bathdr-rec.

        10  unpriced-itm1-oma-svc-cd.
            15  unpriced-itm1-oma-svc-code       pic x(4).
            15  unpriced-itm1-oma-svc-suff       pic x.
        10  filler                              pic x(2).
        10  unpriced-itm1-oma-amt-billed         pic 9(4)v99.
        10  unpriced-itm1-nbr-serv               pic 99.
        10  unpriced-itm1-svc-date.
* (y2k)
*           15  unpriced-itm1-svc-date-yy        pic 99.
            15  unpriced-itm1-svc-date-yy        pic 9(4).
            15  unpriced-itm1-svc-date-mm        pic 99.
            15  unpriced-itm1-svc-date-dd        pic 99.
        10  unpriced-itm1-diag-cd                pic x(3).
        10  filler-diag                         pic x(1).
*++ W A R N I N G +++++++ W A R N I N G ++++++++ W A R N I N G +++++
* (y2k)
*
*    (this following reserved field should be 10 digits but
*     we have used 2 bytes for price override and bilateral so the
*     space is not there to reserve the full 10 bytes. Thus the 9
*     byte filler is used which may lead to future problems. If this
*     occ field is eventually used, then the record length will have
*     to be increased and two separate definitions/pgms will
*     be needed to process 'normal' format diskettes vs the 'rma web' diskette
*       10  unpriced-reserved-for-ooc           pic x(10).
        10  unpriced-reserved-for-ooc           pic x(09).
*++ W A R N I N G +++++++ W A R N I N G ++++++++ W A R N I N G +++++
*       10  FILLER                              PIC X(13).
*       10  filler                              pic x(11).
        10  unpriced-itm1-override-price         pic x(1).
        10  unpriced-itm1-bilateral              pic x(1).

        10  unpriced-itm2-oma-svc-cd.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  14
*                      newu701.cbl                                   )
            15  unpriced-itm2-oma-svc-code       pic x(4).
            15  unpriced-itm2-oma-svc-suff       pic x.
        10  filler                              pic x(2).
        10  unpriced-itm2-oma-amt-billed         pic 9(4)v99.
        10  unpriced-itm2-nbr-serv               pic 99.
        10  unpriced-itm2-svc-date.
* (y2k)
*           15  unpriced-itm2-svc-date-yy        pic 99.
            15  unpriced-itm2-svc-date-yy        pic 9(4).
            15  unpriced-itm2-svc-date-mm        pic 99.
            15  unpriced-itm2-svc-date-dd        pic 99.
        10  unpriced-itm2-diag-cd                pic x(4).
*++ W A R N I N G +++++++ W A R N I N G ++++++++ W A R N I N G +++++
*
*    (this following reserved field should be 10 digits but
*     we have used 2 bytes for price override and bilateral so the
*     space is not there to reserve the full 10 bytes. Thus the 9
*     byte filler is used which may lead to future problems. If this
*     occ field is eventually used, then the record length will have
*     to be increased and two separate definitions/pgms will
*     be needed to process 'normal' format diskettes vs the 'rma web' diskette
*       10  unpriced-reserved-for-ooc           pic x(10).
        10  unpriced-reserved-for-ooc           pic x(09).
*++ W A R N I N G +++++++ W A R N I N G ++++++++ W A R N I N G +++++
*       10  FILLER                              PIC X(13).
*       10  filler                              pic x(11).
        10  unpriced-itm2-override-price         pic x(1).
        10  unpriced-itm2-bilateral              pic x(1).
*       (FILLER ADDED TO ACCOMODATE A 'BAD' INPUT FILE THAT
*        HAD 81 BYTES IN IT)
*mf        10  filler                              pic x(40).

    05  unpriced-pat-addr-rec redefines unpriced-bathdr-rec.

        10  unpriced-pat-addr-1                  pic x(25).
        10  unpriced-pat-addr-2                  pic x(25).
        10  unpriced-pat-addr-3                  pic x(18).
        10  unpriced-pat-addr-post-cd.
            15  unpriced-pat-addr-post-cd1       pic x.
            15  unpriced-pat-addr-post-cd2       pic 9.
            15  unpriced-pat-addr-post-cd3       pic x.
            15  unpriced-pat-addr-post-cd4       pic 9.
            15  unpriced-pat-addr-post-cd5       pic x.
            15  unpriced-pat-addr-post-cd6       pic 9.
        10  filler                              pic x(2).
*       (FILLER ADDED TO ACCOMODATE A 'BAD' INPUT FILE THAT
*        HAD 81 BYTES IN IT)
*mf        10  filler                              pic x(40).

    05  unpriced-trailer-rec redefines unpriced-bathdr-rec.

        10  unpriced-trailer-clmhdr1-cnt         pic 9(4).
        10  unpriced-trailer-clmhdr2-cnt         pic 9(4).
        10  unpriced-trailer-itm-cnt             pic 9(5).
        10  unpriced-trailer-pat-addr-cnt        pic 9(4).
        10  filler                              pic x(59).
*       (FILLER ADDED TO ACCOMODATE A 'BAD' INPUT FILE THAT
*        HAD 81 BYTES IN IT)
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  15
*                      newu701.cbl                                   )
*mf        10  filler                              pic x(40).

    05  unpriced-cr                              pic x.
fd  priced-claims-file
*   RECORDING MODE IS DATA-SENSITIVE
*     (2001/oct/03 B.E. added new clinic-nbr field)
**    record contains 59  characters
    record contains 61  characters
    data records are diskout-output-rec.

01  diskout-output-rec.
*           (2001/oct/03 B.E. added new clinic-nbr field)
        10  diskout-clmhdr-clinic-nbr           pic x(2).

        10  diskout-clmhdr-claim                pic x(8).
        10  diskout-oma-svc-cd.
            15  diskout-oma-svc-code            pic x(4).
            15  diskout-oma-svc-suff            pic x.
        10  diskout-ohip-amt-billed             pic 9(4)v99.

        10  diskout-svc-date.
* (y2k)
*           15  diskout-svc-date-yy             pic 99.
            15  diskout-svc-date-yy             pic 9(4).
            15  diskout-svc-date-mm             pic 99.
            15  diskout-svc-date-dd             pic 99.
        10  diskout-nbr-serv                    pic 99.
        10  diskout-oma-amt-billed              pic 9(4)v99.
        10  diskout-priced-tech                 pic 9(4)v99.
        10  diskout-basic-tech                  pic 9(4)v99.
        10  diskout-basic-prof                  pic 9(4)v99.
        10  diskout-basic-fee                   pic 9(4)v99.
        10  diskout-cr                          pic x.
        10  diskout-lf                          pic x.

* 2010/05/19 - MC6
fd  ru701-work-file
    record contains 174 characters
    data records are diskout-output-rec.

01  ru701-work-rec.
    05  ru701-sort-key.
        10  ru701-doc-nbr                       pic x(3).
        10  ru701-clinic-nbr                    pic x(2).
        10  ru701-doc-spec-cd                   pic 9(2).
        10  ru701-pat-acronym                   pic x(9).
        10  ru701-accounting-nbr                pic x(8).
        10  ru701-orig-rec-no                   pic 9(5).
        10  ru701-acronym-flag                  pic x.
        10  ru701-page-area                     pic x.
        10  ru701-acronym                       pic x(9).
        10  ru701-line-no                       pic 99.
    05  ru701-print-line                        pic x(132).
* 2010/05/19 - end

copy "f002_suspend_hdr.fd".
* file: f002_suspend_hdr.fd

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  16
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f00)
*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
*  yy/mm/dd  whom  why
*  --------  ----  ---
*
*  90/sep/27 B.E.  - added redefine for clmhdr-claim-source-cd
*  98/dec/01 D.B.  - y2k
*  99/jan/15 B.E.  - correct record length, alignment cosmetics
*  99/jan/25 B.E.  - add 2bytes to reference field to allow 4 digit year
*  00/jan/06 B.A.  - add 1 byte confidential claim flag
*  00/sep/14 B.E.  - add clmhdr-nbr-suspend-desc-recs that counts the
*                    number of description records associated with hdr
*  00/sep/21 B.E.  - add clmhdr-adj-cd-sub-type to indicate "W"eb or
*                    "D"iskette source of claim
*  02/oct/24 M.C.  - there are two "clmhdr-adj-cd-sub-type" defined, substitute
*                    the second one with filler
*  03/oct/20 b.e.  - alpha doctor nbr
*  10/aug/11 M.C.  - add a new index suspend-hdr-acr.
*  11/jun/15 MC1   - include the field size clmhdr-patient-surname from x(9) to
*
*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

fd suspend-hdr
*      record   contains 278 characters.
*     record  contains 280 characters.
*!     record  contains 281 characters.
*     record  contains 279 characters.
*     record  contains 301 characters.
     record  contains 317 characters.

01  suspend-hdr-rec.

    05  clmhdr-claim-id.
*!       10  clmhdr-batch-nbr                    pic 9(9).
       10  clmhdr-batch-nbr                    pic x(8).
       10  clmhdr-batch-nbr-r1 redefines clmhdr-batch-nbr.
           15  clmhdr-clinic-nbr-1-2           pic 99.
*!           15  clmhdr-doc-nbr                  pic 9(4).
           15  clmhdr-doc-nbr                  pic x(3).
           15  clmhdr-week                     pic 99.
           15  clmhdr-day                      pic 9.
       10  clmhdr-claim-nbr                    pic 9(2).
       10  clmhdr-zeroed-oma-suff-adj.
           15  clmhdr-adj-oma-cd               pic x999.
           15  clmhdr-adj-oma-suff             pic x.
           15  clmhdr-adj-adj-nbr              pic 9.
    05  clmhdr-batch-type                      pic x.
    05  clmhdr-adj-cd-sub-type                 pic x.
    05  clmhdr-claim-source-cd    redefines clmhdr-adj-cd-sub-type
                                               pic x.
    05  clmhdr-doc-nbr-ohip                    pic 9(6).
    05  clmhdr-doc-nbr-ohip-alpha redefines
        clmhdr-doc-nbr-ohip                    pic x(6).
    05  clmhdr-doc-spec-cd                     pic 9(2).
    05  clmhdr-doc-spec-cd-alpha redefines
        clmhdr-doc-spec-cd                     pic x(2).
    05  clmhdr-refer-doc-nbr                   pic 9(6).
    05  clmhdr-refer-doc-nbr-alpha redefines
        clmhdr-refer-doc-nbr                   pic x(6).
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  17
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f00)
    05  clmhdr-diag-cd                         pic 9(3).
    05  clmhdr-diag-cd-alpha redefines
        clmhdr-diag-cd                         pic x(3).
    05  clmhdr-loc                             pic x999.
    05  clmhdr-hosp                            pic x.
    05  clmhdr-agent-cd                        pic x.
    05  clmhdr-adj-cd                          pic x.
    05  clmhdr-tape-submit-ind                 pic x.
    05  clmhdr-i-o-pat-ind                     pic x.
    05  clmhdr-pat-ohip-id-or-chart.
        10  clmhdr-pat-key-type                pic a.
        10  clmhdr-pat-key-data.
            15  clmhdr-pat-key-ohip            pic x(8).
            15  filler                         pic x(7).
    05  clmhdr-pat-acronym.
        10  clmhdr-pat-acronym6                pic x(6).
        10  clmhdr-pat-acronym3                pic x(3).
    05  clmhdr-reference.
        10  clmhdr-ref1                        pic x.
        10  clmhdr-ref2                        pic x.
        10  clmhdr-ref3                        pic x.
        10  clmhdr-ref4                        pic x.
        10  clmhdr-ref5                        pic x.
        10  clmhdr-ref6                        pic x.
        10  clmhdr-ref7                        pic x.
        10  clmhdr-ref8                        pic x.
        10  clmhdr-ref9                        pic x.
        10  clmhdr-ref10                       pic x.
        10  clmhdr-ref11                       pic x.
    05  clmhdr-date-admit.
        10  clmhdr-date-admit-yy               pic x(4).
        10  clmhdr-date-admit-yy-r redefines
            clmhdr-date-admit-yy.
            15 clmhdr-date-admit-yy-12         pic 99.
            15 clmhdr-date-admit-yy-34         pic 99.
        10  clmhdr-date-admit-mm               pic 99.
        10  clmhdr-date-admit-dd               pic 99.
    05  clmhdr-doc-dept                        pic 99.
    05  clmhdr-date-cash-tape-payment          pic x(8).
    05  clmhdr-direct-bills-clm-info  redefines clmhdr-date-cash-tape-payment.
        10  clmhdr-msg-nbr                     pic xx.
        10  clmhdr-reprint-flag                pic x.
        10  clmhdr-sub-nbr                     pic x.
        10  clmhdr-auto-logout                 pic x.
        10  clmhdr-fee-complex                 pic x.
        10  filler                             pic x(2).
    05  clmhdr-curr-payment                    pic s9(5)v99.
    05  clmhdr-date-period-end.
        10  clmhdr-period-end-yy               pic 9(4).
        10  clmhdr-period-end-mm               pic 99.
        10  clmhdr-period-end-dd               pic 99.
    05  clmhdr-cycle-nbr                       pic 99.
    05  clmhdr-date-sys                        pic x(8).
    05  clmhdr-amt-tech-billed                 pic s9(4)v99.
    05  clmhdr-amt-tech-paid                   pic s9(4)v99.
    05  clmhdr-tot-claim-ar-oma                pic s9(5)v99.
    05  clmhdr-tot-claim-ar-ohip               pic s9(5)v99.
    05  clmhdr-manual-tape-payments            pic s9(5)v99.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  18
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f00)
    05  clmhdr-status-ohip                     pic xx.
*!  05  clmhdr-orig-batch-id                   pic x(11).
    05  clmhdr-orig-batch-id                   pic x(10).
    05  clmhdr-status                          pic x.

*   ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
*            dyad  extensions to ohip standard format

    05  clmhdr-health-care-nbr                  pic x(12).
    05  clmhdr-health-care-ver                  pic x(02).
    05  clmhdr-health-care-prov                 pic x(02).
    05  clmhdr-relationship                     pic x(01).
*   for new ohip format, relationship is not used, hence manual
*   review is used here.
    05  clmhdr-manual-review redefines clmhdr-relationship   pic x(01).
*   05  clmhdr-patient-surname                  pic x(09).
    05  clmhdr-patient-surname                  pic x(25).
    05  clmhdr-subscr-initials                  pic x(03).
    05  clmhdr-wcb-claim-nbr                    pic x(09).
    05  clmhdr-wcb-accident-date              pic x(08).
    05  clmhdr-wcb-employer-name-addr         pic x(40).
    05  clmhdr-wcb-employer-postal-cd         pic x(06).

*       (00/02/08 B.A.)
    05  clmhdr-confidential-flag              pic x(1).
*       (00/sep/14 B.E.)
    05  clmhdr-nbr-suspend-desc-recs          pic 9(2).
* 2002/10/24 -- MC
*    05  clmhdr-adj-cd-sub-type               pic x(1).
    05  filler                                pic x(1).
* 2002/10/24 - end

    05  suspend-hdr-id.
        10  clmhdr-doc-pract-nbr              pic 9(6).
        10  clmhdr-accounting-nbr             pic x(8).

* 2010/08/11 - MC - add new index
    05  suspend-hdr-acr.
        10  susp-hdr-doc-nbr                    pic x(3).
        10  susp-hdr-clinic-nbr                 pic 99.
*        10  susp-hdr-acronym                   pic x(9).
        10  susp-hdr-acronym.
            15  susp-hdr-acronym-1-6            pic x(6).
            15  susp-hdr-acronym-7-9            pic x(3).
        10  susp-hdr-accounting-nbr             pic x(8).
* 2010/08/11 - end

copy "f002_suspend_dtl.fd".
* file: f002_suspend_dtl.fd

* 98/dec/01 D.B. - y2k
* 00/sep/05 B.E. - added redefine of clmdtl-consecutive-sv-dateS
* 03/oct/20 b.e. - alpha doctor nbr

fd   suspend-dtl
* y2k  record contains 89 characters .
*!       record contains 93 characters .
       record contains 92 characters .
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  19
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f00)

01  suspend-dtl-rec.

    05  clmdtl-id.
*!        10  clmdtl-batch-nbr                    pic 9(9).
        10  clmdtl-batch-nbr                    pic x(8).
        10  clmdtl-claim-nbr                    pic 9(2).
        10  clmdtl-oma-cd                       pic xxxx.
        10  clmdtl-oma-suff                     pic x.
        10  clmdtl-adj-nbr                      pic 9.
    05  clmdtl-det-rec.
        10  clmdtl-rev-group-cd                 pic xxx.
        10  clmdtl-agent-cd                     pic 9.
        10  clmdtl-adj-cd                       pic x.
        10  clmdtl-nbr-serv                     pic 99.
        10  clmdtl-nbr-serv-alpha redefines clmdtl-nbr-serv pic xx.
        10  clmdtl-sv-date.
* y2k         15  clmdtl-sv-yy                    pic 99.
            15  clmdtl-sv-yy                    pic 9999.
            15  clmdtl-sv-mm                    pic 99.
            15  clmdtl-sv-dd                    pic 99.
        10  clmdtl-consec-dates.
            15  clmdtl-consecutive-sv-date  occurs 3 times.
*mf                                              pic 999.
*                                             pic x(3).
*                   (00/sep/05 B.E. added redefine )
                20  clmdtl-sv-nbr               pic 9.
                20  clmdtl-sv-day               pic xx.

        10  clmdtl-amt-tech-billed              pic s9(4)v99.
        10  clmdtl-fee-oma                      pic s9(5)v99.
        10  clmdtl-fee-oma-alpha redefines clmdtl-fee-oma pic x(7).
        10  clmdtl-fee-ohip                     pic s9(5)v99.
        10  clmdtl-fee-ohip-alpha redefines clmdtl-fee-ohip pic x(7).
* Y2k   10  clmdtl-date-period-end              pic x(6).
        10  clmdtl-date-period-end              pic x(8).
        10  clmdtl-cycle-nbr                    pic 999.
        10  clmdtl-diag-cd                      pic 999.
        10  clmdtl-diag-cd-alpha
                redefines clmdtl-diag-cd        pic xxx.
        10  clmdtl-diag-cd-local                pic 999.
        10  clmdtl-diag-cd-local-alpha
                  redefines clmdtl-diag-cd-local  pic xxx.

    05  clmdtl-status                           pic x.
    05  suspend-dtl-id.
        10  clmdtl-doc-pract-nbr                pic 9(6).
        10  clmdtl-accounting-nbr              pic x(8).


copy "f002_suspend_address.fd".
* file: f002_suspend_address.fd

* 98/dec/01 D.B.        - y2k
* 20011/mar/20 brad1 - increase sizes to fit oscar

fd  suspend-address
* y2k record contains 126 characters .
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  20
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f00)
*brad1      record contains 128 characters .
*brad add 46 (16 surname + 20 first name + 10 phone nbr)
*brad2 add 3 more for postal code going from 6 to 9
*       record contains 174 characters.
      record contains 177 characters.
*mf      feedback is feedback-suspend-addr.

01  suspend-address-rec.

    05  addr-address-line-1                   pic x(25).
    05  addr-address-line-2                   pic x(25).
    05  addr-address-line-3                   pic x(25).
*brad1  05  addr-postal-code                      pic x(6).
    05  addr-postal-code                      pic x(9).

*   brad1
*    05  addr-surname                         pic x(9).
    05  addr-surname                          pic x(25).
*    05  addr-first-name                      pic x(5).
    05  addr-first-name                       pic x(25).

    05  addr-birth-date.
* y2k
*       10  addr-birth-yy                     pic 99.
        10  addr-birth-yy                     pic 9(4).
        10  addr-birth-mm                     pic 99.
        10  addr-birth-dd                     pic 99.
    05  addr-sex                              pic x.
* brad1
*    05  addr-phone-no                         pic x(10).
    05  addr-phone-no                         pic x(20).

    05  suspend-addr-id.
        10  addr-doc-pract-nbr                pic 9(6).
        10  addr-accounting-nbr               pic x(8).


* 2005/05/09 - add description file
copy "f002_suspend_desc.fd".
* file: f002_suspend_desc.fd

*  00/sep/14 B.E. - original

fd   suspend-desc
       record contains 87 characters .

01  suspend-desc-rec.

    05  clmdtl-suspend-desc                     pic x(70).
    05  clmdtl-status                           pic x.

    05  suspend-dtl-id.
        10  clmdtl-doc-pract-nbr                pic 9(6).
        10  clmdtl-accounting-nbr               pic x(8).
        10  clmdtl-line-no                      pic 99.

* 2005/05/09 - end

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  21
*                      newu701.cbl                                   )
* COPY "F020_DOCTOR_MSTR_OHIP.FD".
copy "f020_doctor_mstr.fd".
* sms 137  bml  05-dec-90  increase fields by 2
* sms 139  mc   10-jun-92  add 5 clinic nbr and 2 spec codes in
*                          reserved for nip
*          mc   24-nov-93  include brad's fields of earning subsystem
*          mc   12-feb-94  include doc-ep-pay-code and doc-ep-pay-sub-code
*          db   03-jun-98  Year 2000
*          mc   16-jul-02  add 5 additional batch nbr for each additional
*                          clinic
*          mc   23-sep-02  rename the second occurrence of group-regular-service
*                          to group-over-serviced
*          be   05-nov-03  alpha doctor nbr
*          mc   03-mar-04  reuse filler x(4) for doc-afp-paym-group from filler2
*          be   06-apr-17  - increase to 800 when $1M payroll figures changed th

fd  doc-mstr
*       block  contains 680 characters
*       record contains 680 characters.
*       block  contains 695 characters
*       record contains 695 characters.
        block  contains 800 characters
        record contains 800 characters.

01 doc-mstr-rec.
*    05  doc-nbr                                        pic 9(3).
    05  doc-nbr                                 pic x(3).
    05  doc-dept                                pic 99.
    05  doc-ohip-nbr                            pic 9(6).
    05  doc-pract-nbr redefines doc-ohip-nbr    pic 9(6).
    05  doc-sin-nbr.
        10  doc-sin-123                         pic 999.
        10  doc-sin-456                         pic 999.
        10  doc-sin-789                         pic 999.
    05  doc-clinic-nbr                          pic 99.
    05  doc-spec-cd                             pic 99.
    05  doc-hosp-nbr                            pic x999.
    05  doc-name                                pic x(24).
    05  doc-name-soundex                        pic x(4).

    05  doc-inits.
        10  doc-init1                           pic x.
        10  doc-init2                           pic x.
        10  doc-init3                           pic x.
    05  doc-address-office.
        10  doc-addr-office-1                   pic x(24).
        10  doc-addr-office-2                   pic x(24).
        10  doc-addr-office-3                   pic x(24).
    05  doc-addr-office-r  redefines  doc-address-office.
        10  doc-addr-office  occurs 3 times     pic x(24).
    05  doc-addr-office-pc.
        10  doc-addr-office-pc-123.
            15  doc-addr-office-pc1             pic a.
            15  doc-addr-office-pc2             pic 9.
            15  doc-addr-office-pc3             pic a.
        10  doc-addr-office-pc-456.
            15  doc-addr-office-pc4             pic 9.
            15  doc-addr-office-pc5             pic a.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  22
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f02)
            15  doc-addr-office-pc6             pic 9.
    05  doc-address-home.
        10  doc-addr-home-1                     pic x(24).
        10  doc-addr-home-2                     pic x(24).
        10  doc-addr-home-3                     pic x(24).
    05  doc-addr-home-r  redefines doc-address-home.
        10  doc-addr-home  occurs 3 times       pic x(24).
    05  doc-addr-home-pc.
        10  doc-addr-home-pc-123.
            15  doc-addr-home-pc1               pic a.
            15  doc-addr-home-pc2               pic 9.
            15  doc-addr-home-pc3               pic a.
        10  doc-addr-home-pc-456.
            15  doc-addr-home-pc4               pic 9.
            15  doc-addr-home-pc5               pic a.
            15  doc-addr-home-pc6               pic 9.
    05  doc-full-part-ind                       pic x.
    05  doc-class-code redefines doc-full-part-ind pic x.
    05  doc-bank-info.
        10  doc-bank-nbr                        pic 9(4).
        10  doc-bank-branch                     pic 9(5).
        10  doc-bank-acct                       pic x(12).
*   05  doc-tax-info.
*       10  doc-billing-percent                 pic 9v99.
*       10  doc-misc-percent                    pic 9v99.
*       10  doc-tax-percent                     pic 9v99.
*       10  doc-billing-percent                 pic 9v9999.
*       10  doc-misc-percent                    pic 9v9999.
*       10  doc-tax-percent                     pic 9v9999.
*       10  doc-pay-code                        pic x.
    05  doc-fac-dates.
        10  doc-date-fac-start.
* y2k       15  doc-date-fac-start-yy           pic 99.
            15  doc-date-fac-start-yy           pic 9999.
            15  doc-date-fac-start-mm           pic 99.
            15  doc-date-fac-start-dd           pic 99.
        10  doc-date-fac-term.
* y2k       15  doc-date-fac-term-yy            pic 99.
            15  doc-date-fac-term-yy            pic 9999.
            15  doc-date-fac-term-mm            pic 99.
            15  doc-date-fac-term-dd            pic 99.
    05    doc-fac-dates-r redefines doc-fac-dates.
        10  doc-date-fac occurs 2 times.
* y2k       15  doc-date-fac-yy                 pic 99.
            15  doc-date-fac-yy                 pic 9999.
            15  doc-date-fac-mm                 pic 99.
            15  doc-date-fac-dd                 pic 99.
    05  doc-annual-ceiling-info.
*        10  doc-ytdgua                          pic s9(7)v99 comp.
        10  doc-ytdgua                          pic s9(7)v99.
*        10  doc-ytdgub                          pic s9(7)v99 comp.
        10  doc-ytdgub                          pic s9(7)v99.
*        10  doc-ytdguc                          pic s9(7)v99 comp.
        10  doc-ytdguc                          pic s9(7)v99.
*        10  doc-ytdgud                          pic s9(7)v99 comp.
        10  doc-ytdgud                          pic s9(7)v99.
*        10  doc-ytdcea                          pic s9(7)v99 comp.
        10  doc-ytdcea                          pic s9(7)v99.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  23
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f02)
*        10  doc-ytdcex                          pic s9(7)v99 comp.
        10  doc-ytdcex                          pic s9(7)v99.
*        10  doc-ytdear                          pic s9(7)v99 comp.
        10  doc-ytdear                          pic s9(7)v99.
*        10  doc-ytdinc                          pic s9(7)v99 comp.
        10  doc-ytdinc                          pic s9(7)v99.
*        10  doc-ytdeft                          pic s9(7)v99 comp.
        10  doc-ytdeft                          pic s9(7)v99.
*        10  doc-totinc-g                        pic s9(7)v99 comp.
        10  doc-totinc-g                        pic s9(7)v99.
* y2k
*       10  doc-ep-date-deposit                 pic 9(4) comp.
        10  doc-ep-date-deposit                 pic 9(8).
*        10  doc-totinc                          pic s9(7)v99 comp.
        10  doc-totinc                          pic s9(7)v99.
*        10  doc-ep-ceiexp                       pic s9(7)v99 comp.
        10  doc-ep-ceiexp                       pic s9(7)v99.
*        10  doc-adjcea                          pic s9(7)v99 comp.
        10  doc-adjcea                          pic s9(7)v99.
*        10  doc-adjcex                          pic s9(7)v99 comp.
        10  doc-adjcex                          pic s9(7)v99.
*        10  doc-ceicea                          pic s9(7)v99 comp.
        10  doc-ceicea                          pic s9(7)v99.
*        10  doc-ceicex                          pic s9(7)v99 comp.
        10  doc-ceicex                          pic s9(7)v99.
        10  ceicea-prt-format                   pic x(13).
        10  ceicex-prt-format                   pic x(13).
        10  ytdcea-prt-format                   pic x(13).
        10  ytdcex-prt-format                   pic x(13).
        10  doc-clinic-nbr-2                    pic 99.
        10  doc-clinic-nbr-3                    pic 99.
        10  doc-clinic-nbr-4                    pic 99.
        10  doc-clinic-nbr-5                    pic 99.
        10  doc-clinic-nbr-6                    pic 99.
        10  doc-spec-cd-2                       pic 99.
        10  doc-spec-cd-3                       pic 99.
*        10  doc-ytdinc-g                        pic s9(7)v99 comp.
        10  doc-ytdinc-g                        pic s9(7)v99.
    05  doc-locations.
        10  doc-loc-1                           pic x999.
        10  doc-loc-2                           pic x999.
        10  doc-loc-3                           pic x999.
        10  doc-loc-4                           pic x999.
        10  doc-loc-5                           pic x999.
        10  doc-loc-6                           pic x999.
        10  doc-loc-7                           pic x999.
        10  doc-loc-8                           pic x999.
        10  doc-loc-9                           pic x999.
        10  doc-loc-10                          pic x999.
        10  doc-loc-11                          pic x999.
        10  doc-loc-12                          pic x999.
        10  doc-loc-13                          pic x999.
        10  doc-loc-14                          pic x999.
        10  doc-loc-15                          pic x999.
        10  doc-loc-16                          pic x999.
        10  doc-loc-17                          pic x999.
        10  doc-loc-18                          pic x999.
        10  doc-loc-19                          pic x999.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  24
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f02)
        10  doc-loc-20                          pic x999.
        10  doc-loc-21                          pic x999.
        10  doc-loc-22                          pic x999.
        10  doc-loc-23                          pic x999.
        10  doc-loc-24                          pic x999.
        10  doc-loc-25                          pic x999.
        10  doc-loc-26                          pic x999.
        10  doc-loc-27                          pic x999.
        10  doc-loc-28                          pic x999.
        10  doc-loc-29                          pic x999.
        10  doc-loc-30                          pic x999.
    05  doc-locations-r  redefines  doc-locations.
        10  doc-loc     occurs 30 times         pic x999.
*
    05  doc-rma-expense-percent-misc            pic 9(5)v9(4) comp.
* 2004/03/03 - MC
*   05  filler2                                 pic x(8).
    05  doc-afp-paym-group                      pic x(4).
    05  filler2                                 pic x(4).
* 2004/030/03 - end
    05  doc-ind-pays-gst                        pic x.
    05  doc-nx-avail-batch                      pic 999.
* 2002/07/16 - MC - add 5 more next batch nbr for each clinic
    05  doc-nx-avail-batch-2                    pic 999.
    05  doc-nx-avail-batch-3                    pic 999.
    05  doc-nx-avail-batch-4                    pic 999.
    05  doc-nx-avail-batch-5                    pic 999.
    05  doc-nx-avail-batch-6                    pic 999.
** 2002/07/16 - end
*    05  doc-yrly-ceiling-computed               pic 9(7)v99 comp.
    05  doc-yrly-ceiling-computed               pic 9(7)v99.
*    05  doc-yrly-expense-computed               pic 9(7)v99 comp.
    05  doc-yrly-expense-computed               pic 9(7)v99.
    05  doc-rma-expense-percent-reg             pic 9(5)v9(4) comp.
    05  doc-sub-specialty                       pic x(15).
*    05  doc-payeft                              pic s9(7)v99 comp.
    05  doc-payeft                              pic s9(7)v99.
*    05  doc-ytdded                              pic s9(7)v99 comp.
    05  doc-ytdded                              pic s9(7)v99.
    05  doc-dept-expense-percent-misc           pic 9(5)v9(4) comp.
    05  doc-dept-expense-percent-reg            pic 9(5)v9(4) comp.
    05  doc-ep-ped                              pic s9(9) comp.
    05  doc-ep-pay-code                         pic x.
    05  doc-ep-pay-sub-code                     pic x.
    05  filler3                                 pic x(1).
    05  doc-ind-holdback-active                 pic x(1).
    05  group-regular-service                   pic x(4).
* 2002/09/23 - MC
*    05  group-regular-service                  pic x(4).
    05  group-over-serviced                     pic x(4).
* 2002/09/23 - end
    05  doc-specialties                         pic x(90).


*2000/03/20 - MC - include locations mstr
copy "f030_locations_mstr.fd".

* 1999/Apr/01 B.E. - added loc-ministry-loc-code and filler, adjusted rec length
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  25
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f03)
* 1999/apr/27 B.E. - added loc-hospital-code field as contingency field in case
*                    it's needed as the current claim rec hospital field is
*                    only 1 character long and is now too small.
* 2001/Jan/26 A.A  - added loc-payroll-flag and decreased the filler to 14 char.
*                    This field used to HSC ONLY
* 2001/may/03 B.E. - redefined card-colour field to indicate it's real purpose
*                    of specifying in/out patient indicator
*                  - added 'active for entry' field
* 2006/apr/03 M.C. - include service location indicator (SLI)

fd  loc-mstr
*       index block contains 512 characters
*       data  block contains 37 characters
*             block contains 37 characters
*       record      contains 37 characters.
              block contains 60 characters
        record      contains 60 characters.

01 loc-mstr-rec.
    05  loc-nbr                         pic x999.
    05  loc-nbr-r     redefines loc-nbr         pic x(4).

    05  loc-clinic-nbr                  pic 9(4).
    05  loc-hospital-nbr                pic 9(4).
    05  loc-hospital-code               pic x(4).

    05  loc-card-colour                 pic x(1).
    05  loc-in-out-ind redefines loc-card-colour
                                        pic x(1).

    05  loc-name                        pic x(24).
    05  loc-ministry-loc-code           pic 9(4).

    05  loc-payroll-flag                pic x(1).
    05  loc-active-for-entry            pic x(1).
* 2006/04/03 - MC
*   05  filler-reserved-for-nip         pic x(13).
    05  loc-service-location-indicator  pic x(4).
    05  filler-reserved-for-nip         pic x(9).
* 2006/04/03 - end


copy "f040_oma_fee_mstr.fd".
* 98/dec/01 D.B.  - y2k
* 99/apr/28 B.E.  - split page (999) into page-alpha (xx) + page-numeric (999)
* 99/nov/30 B.E.  - correction to 'fee-page' definition in redefines
* 00/jul/31 B.E.  - fees changed from 9(5)v99 to 9(4)v999.
* 00/aug/01 B.E.  - added addition length to record for future expansion
*                 - add fee-active-for-entry y/n (1 byte)
*                 - add fee-min, fee-max (current/previous and oma/ohip)
*                                                        2*2*2*7 = 56 bytes)
*                 - add filler for growth -11 flags + 2  nbrs = 11*28 = 39 bytes
* 00/sep/05 B.E.  - add 'fee-global-addon-cd-exclusion-flag'
*
fd  oma-fee-mstr
*       block       contains 247 characters
*       record      contains 247 characters  .
        block       contains 315 characters
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  26
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f04)
        record      contains 315 characters  .
*       feedback is feedback-oma-fee-mstr.

* insert this warning message from "f000_duplicate_fd_warning.fd
*----------------  note  -----------------------
*-- any changes to this fd must also be made  --
*-- to the corresponding "..._d001_..." fd    --
*-- and visa versa                            --
*----------------  note  -----------------------
01 fee-mstr-rec.
    05  fee-oma-cd.
        10  fee-oma-cd-ltr1                     pic x.
        10  filler                              pic 999.
    05  fee-special-m-suffix-ind                pic x.

    05  fee-effective-date.
* y2k   10  fee-date-yy                         pic 99.
        10  fee-date-yy                         pic 9999.
        10  fee-date-mm                         pic 99.
        10  fee-date-dd                         pic 99.
* 00/aug/01 B.E.
    05  fee-active-for-entry                    pic x(1).


    05  fee-desc                                pic x(48).
    05  fee-current-prev-years.
*           (CURRENT rates)
*           (00/aug/01 B.E. - fees changed from 2 to 3 decimals)
        10  fee-curr-a-fee-1                    pic s9(4)v999
                                        sign is leading .
        10  fee-curr-h-fee-1                    pic s9(4)v999
                                        sign is leading .
        10  fee-curr-a-fee-2                    pic s9(4)v999
                                        sign is leading .
        10  fee-curr-h-fee-2                    pic s9(4)v999
                                        sign is leading .
*           (00/aug/01 B.E.)
        10  fee-curr-a-min              pic s9(4)v999
                                        sign is leading .
        10  fee-curr-h-min              pic s9(4)v999
                                        sign is leading .
        10  fee-curr-a-max              pic s9(4)v999
                                        sign is leading .
        10  fee-curr-h-max              pic s9(4)v999
                                        sign is leading .

        10  fee-curr-a-anae                     pic 99.
        10  fee-curr-h-anae                     pic 99.
        10  fee-curr-a-asst                     pic 99.
        10  fee-curr-h-asst                     pic 99.

        10  fee-curr-add-on-codes.
            15  fee-curr-add-on-cd              pic x999    occurs 10 times.
        10  fee-curr-oma-ind-card-reqs.
            15  fee-curr-oma-ind-card-required  pic x       occurs  3 times.
* 99/apr/28
*       10  fee-curr-page                       pic 999.
        10  fee-curr-page.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  27
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f04)
            15 fee-curr-page-alpha              pic x(2).
            15 fee-curr-page-numeric            pic 999.

        10  fee-curr-add-on-perc-flat-ind       pic x.

*           (PREVIOUS rates)
*           (00/aug/01 B.E. - fees changed from 2 to 3 decimals)
        10  fee-prev-a-fee-1                    pic s9(4)v999
                                        sign is leading .
        10  fee-prev-h-fee-1                    pic s9(4)v999
                                        sign is leading .
        10  fee-prev-a-fee-2                    pic s9(4)v999
                                        sign is leading .
        10  fee-prev-h-fee-2                    pic s9(4)v999
                                        sign is leading .
*           (00/aug/01 B.E.)
        10  fee-prev-a-min              pic s9(4)v999
                                        sign is leading .
        10  fee-prev-h-min              pic s9(4)v999
                                        sign is leading .
        10  fee-prev-a-max              pic s9(4)v999
                                        sign is leading .
        10  fee-prev-h-max              pic s9(4)v999
                                        sign is leading .
        10  fee-prev-a-anae                     pic 99.
        10  fee-prev-h-anae                     pic 99.
        10  fee-prev-a-asst                     pic 99.
        10  fee-prev-h-asst                     pic 99.

        10  fee-prev-add-on-codes.
            15  fee-prev-add-on-cd              pic x999        occurs 10 times.
        10  fee-prev-oma-ind-card-reqs.
            15  fee-prev-oma-ind-card-required  pic x           occurs  3 times.
*       10  fee-prev-page                       pic 999.
        10  fee-prev-page.
            15 fee-prev-page-alpha              pic x(2).
            15 fee-prev-page-numeric            pic 999.
        10  fee-prev-add-on-perc-flat-ind       pic x.
    05  fee-current-prev-year-r redefines fee-current-prev-years.
* ---------------------- n o t e -------------------------
* ----- set up the following subscripts when using this file
* ----- set subscript  'curr' to 1  and  'prev' 2
        10  fee-years occurs 2 times.
* ----- set subscript  'oma' to 1  and  'ohip' to 2

            15  fee-1           occurs 2 times
*                                                       pic s9(5)v99
                                        pic s9(4)v999
                                        sign is leading.
            15  fee-2           occurs 2 times
*                                                       pic s9(5)v99
                                        pic s9(4)v999
                                        sign is leading.
*               (00/aug/01 B.E.)

*                 - fee-min, fee-max used only if "P" percentage based fee
            15  fee-min         occurs 2 times
                                        pic s9(4)v999
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  28
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f04)
                                        sign is leading.
            15  fee-max         occurs 2 times
                                        pic s9(4)v999
                                        sign is leading.

            15  fee-anae        occurs 2 times
                                                pic 99.
            15  fee-asst        occurs 2 times
                                                pic 99.
            15  fee-add-on-codes.
                20  fee-add-on-cd               pic x999        occurs 10 times.
            15  fee-oma-ind-card-requireds.
                20  fee-oma-ind-card-required   pic x           occurs  3 times.
*y2k
*           15  fee-page                        pic 999.
            15  fee-page-alpha-numeric.
                20 fee-page-alpha               pic x(2).
                20 fee-page                     pic 9(3).

            15  fee-add-on-perc-or-flat-ind     pic x.

*       internal computer code (icc) -- used to perform price reductions
    05  fee-icc-code.
        10  fee-icc-sec                         pic xx.
        10  fee-icc-cat                         pic  9.
        10  fee-icc-grp                         pic 99.
        10  fee-icc-reduc-ind                   pic  9.
*       (diag ind = 'y' --> batch claim header diag cd must not = zero)
    05  fee-diag-ind                            pic x.
    05  fee-phy-ind                             pic x.
    05  fee-tech-ind                            pic x.
    05  fee-hosp-nbr-ind                        pic x.
    05  fee-i-o-ind                             pic x.
    05  fee-admit-ind                           pic x.
    05  fee-spec-fr                             pic 99.
    05  fee-spec-to                             pic 99.

*          (00/aug/01 B.E. filler for growth)
*           05  filler                                  pic x(39).
*       (00/sep/05 B.E.)
    05  fee-global-addon-cd-exclusion           pic x(01).
    05  filler                                  pic x(38).


copy "f090_constants_mstr.fd".
* 99/Jan/29     MC      - change iconst-clinic-nbr from numeric to character
* 03/nov/05 b.e. - alpha doctor nbr
* 06/nov/08     MC      - include iconst-clinic-pay-batch-nbr

fd  iconst-mstr
*       index block contains   2 characters
              block contains 384 characters
        record      contains 384 characters  .
*       feedback is feedback-iconst-mstr.

01 iconst-mstr-rec.
    05  iconst-clinic-nbr-1-2                   pic   99.
*    05  iconst-clinic-nbr                      pic  9(4).
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  29
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f09)
    05  iconst-clinic-nbr                       pic  x(4).
    05  iconst-clinic-name                      pic x(20).
    05  iconst-clinic-cycle-nbr                 pic   99.
    05  iconst-date-period-end.
* y2k   10  iconst-date-period-end-yy           pic   99.
        10  iconst-date-period-end-yy           pic   9999.
        10  iconst-date-period-end-mm           pic   99.
        10  iconst-date-period-end-dd           pic   99.
    05  iconst-clinic-addr.
        10  iconst-clinic-addr-l1               pic  x(25).
        10  iconst-clinic-addr-l2               pic  x(25).
        10  iconst-clinic-addr-l3               pic  x(25).
    05  iconst-clinic-addr-r redefines iconst-clinic-addr.
        10  iconst-clinic-addr                  pic x(25)   occurs  3  times.
    05  iconst-clinic-card-colour               pic    x.
    05  iconst-clinic-over-lim1                 pic 99v99.
    05  iconst-clinic-under-lim2                pic 99v99.
    05  iconst-clinic-under-lim3                pic 99v99.
    05  iconst-clinic-over-lim4                 pic 99v99.

*!    05  iconst-clinic-batch-nbr                 pic 9(6).
    05  iconst-clinic-batch-nbr                 pic x(6).

    05  iconst-reduction-factor                 pic 99v99.
    05  iconst-overpay-factor                   pic 99v99.
* 2006/11/08
*   05  filler                                  pic x(242).
    05  filler                                  pic x(106).
    05  iconst-clinic-pay-batch-nbr             pic x(6).
    05  filler                                  pic x(130).
* 2006/11/08 - end

copy "f090_const_mstr_rec_2.ws".
* 98/dec/01 D.B.        - y2k
* 2017/Apr/11   MC1 - include current and previous OMA rate

01  constants-mstr-rec-2.
*
*       use subscripts    ss-yr-nbr    (curr = 1;prev = 2)
*                     and ss-rate-type (ohip = 1;oma = 2)
*
    05  const-rec-2-rec-nbr                     pic 99.
    05  const-info.
        10  const-info-curr-prev occurs 2 times.
            15  const-effective-date.
* y2k
*               20  const-yy                    pic 99.
                20  const-yy                    pic 9(4).
                20  const-mm                    pic 99.
                20  const-dd                    pic 99.
            15  const-bilateral                 pic 99v99.
            15  const-ic                        pic 99v99.
            15  const-sr                        pic 99v99.
            15  const-wcb                       pic 999v9(5).
            15  const-ohip-oma-rates occurs 2 times.
                20  const-asst                  pic 99v99.
                20  const-reg                   pic 99v99.
                20  const-cert                  pic 99v99.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  30
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f09)
    05  const-info-r redefines const-info.
        10  const-info-curr-prev-r.
            15  const-effective-date-curr.
* y2k
*               20  const-yy-curr               pic 99.
                20  const-yy-curr               pic 9999.
                20  const-mm-curr               pic 99.
                20  const-dd-curr               pic 99.
            15  const-bilateral-curr            pic 99v99.
            15  const-ic-curr                   pic 99v99.
            15  const-sr-curr                   pic 99v99.
            15  const-wcb-curr                  pic 999v9(5).
            15  const-ohip-oma-rates-curr.
                20  const-asst-h-curr           pic 99v99.
                20  const-reg-h-curr            pic 99v99.
                20  const-cert-h-curr           pic 99v99.
                20  const-asst-a-curr           pic 99v99.
                20  const-reg-a-curr            pic 99v99.
                20  const-cert-a-curr           pic 99v99.
            15  const-effective-date-prev.
* y2k           20  const-yy-prev               pic 99.
                20  const-yy-prev               pic 9999.
                20  const-mm-prev               pic 99.
                20  const-dd-prev               pic 99.
            15  const-bilateral-prev            pic 99v99.
            15  const-ic-prev                   pic 99v99.
            15  const-sr-prev                   pic 99v99.
            15  const-wcb-prev                  pic 999v9(5).
            15  const-ohip-oma-rates-prev.
                20  const-asst-h-prev           pic 99v99.
                20  const-reg-h-prev            pic 99v99.
                20  const-cert-h-prev           pic 99v99.
                20  const-asst-a-prev           pic 99v99.
                20  const-reg-a-prev            pic 99v99.
                20  const-cert-a-prev           pic 99v99.
    05  const-max-nbr-rates                     pic 99.
    05  const-groups.
        10  const-group-rates occurs 19 times.
            15  const-section-group.
                20  const-section               pic xx.
                20  const-group                 pic 99.
            15  const-rates-curr-prev occurs 2 times pic 99v99.
    05  const-group-r redefines const-groups.
        10  const-group-rates-r.
            15  const-sect-1                    pic xx.
            15  const-group-1                   pic 99.
            15  const-curr-1                    pic 99v99.
            15  const-prev-1                    pic 99v99.
            15  const-sect-2                    pic xx.
            15  const-group-2                   pic 99.
            15  const-curr-2                    pic 99v99.
            15  const-prev-2                    pic 99v99.
            15  const-sect-3                    pic xx.
            15  const-group-3                   pic 99.
            15  const-curr-3                    pic 99v99.
            15  const-prev-3                    pic 99v99.
            15  const-sect-4                    pic xx.
            15  const-group-4                   pic 99.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  31
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f09)
            15  const-curr-4                    pic 99v99.
            15  const-prev-4                    pic 99v99.
            15  const-sect-5                    pic xx.
            15  const-group-5                   pic 99.
            15  const-curr-5                    pic 99v99.
            15  const-prev-5                    pic 99v99.
            15  const-sect-6                    pic xx.
            15  const-group-6                   pic 99.
            15  const-curr-6                    pic 99v99.
            15  const-prev-6                    pic 99v99.
            15  const-sect-7                    pic xx.
            15  const-group-7                   pic 99.
            15  const-curr-7                    pic 99v99.
            15  const-prev-7                    pic 99v99.
            15  const-sect-8                    pic xx.
            15  const-group-8                   pic 99.
            15  const-curr-8                    pic 99v99.
            15  const-prev-8                    pic 99v99.
            15  const-sect-9                    pic xx.
            15  const-group-9                   pic 99.
            15  const-curr-9                    pic 99v99.
            15  const-prev-9                    pic 99v99.
            15  const-sect-10                   pic xx.
            15  const-group-10                  pic 99.
            15  const-curr-10                   pic 99v99.
            15  const-prev-10                   pic 99v99.
            15  const-sect-11                   pic xx.
            15  const-group-11                  pic 99.
            15  const-curr-11                   pic 99v99.
            15  const-prev-11                   pic 99v99.
            15  const-sect-12                   pic xx.
            15  const-group-12                  pic 99.
            15  const-curr-12                   pic 99v99.
            15  const-prev-12                   pic 99v99.
            15  const-sect-13                   pic xx.
            15  const-group-13                  pic 99.
            15  const-curr-13                   pic 99v99.
            15  const-prev-13                   pic 99v99.
            15  const-sect-14                   pic xx.
            15  const-group-14                  pic 99.
            15  const-curr-14                   pic 99v99.
            15  const-prev-14                   pic 99v99.
            15  const-sect-15                   pic xx.
            15  const-group-15                  pic 99.
            15  const-curr-15                   pic 99v99.
            15  const-prev-15                   pic 99v99.
            15  const-sect-16                   pic xx.
            15  const-group-16                  pic 99.
            15  const-curr-16                   pic 99v99.
            15  const-prev-16                   pic 99v99.
            15  const-sect-17                   pic xx.
            15  const-group-17                  pic 99.
            15  const-curr-17                   pic 99v99.
            15  const-prev-17                   pic 99v99.
            15  const-sect-18                   pic xx.
            15  const-group-18                  pic 99.
            15  const-curr-18                   pic 99v99.
            15  const-prev-18                   pic 99v99.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  32
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f09)
            15  const-sect-19                   pic xx.
            15  const-group-19                  pic 99.
            15  const-curr-19                   pic 99v99.
            15  const-prev-19                   pic 99v99.
* MC1
*   05  filler                                  pic x(48).
    05  const-oma-curr                          pic 99v99.
    05  const-oma-prev                          pic 99v99.
    05  filler                                  pic x(40).
* MC1 - end

copy "f091_diagnostic_codes.fd".
fd  diag-mstr
*       index block contains  3  characters
*       data  block contains 123  characters
              block contains 123  characters
        record      contains 123  characters.

01  diag-rec.
    05  diag-cd                         pic xxx.
    05  diag-cd-desc                    pic x(120).


* 2011/05/18 - MC15
copy "f201_sli_oma_code_suff.fd".
* 2011/may/17 M.C. - this is for d001 & newu701 edit for SLI

fd  sli-oma-code-suff-mstr
        block  contains 10 characters
        record contains 10 characters.

01  sli-oma-code-suff-rec.
    05  sli-oma-code-suff.
        10  sli-oma-code                        pic x(4).
        10  sli-oma-suff                        pic x(1).
        10  sli-code                            pic x(4).
    05  sli-admit-ind                           pic x(1).


* 2011/05/18 - end

fd  report-file
    record contains 132 characters.

01  rpt-line                    pic x(132).
working-storage section.

* 2010/03/31 - MC4 - include site_id.ws
copy "site_id.ws".
77 site-id                                      pic x(3) values "RMA".
* 2010/03/31 - end

************************************************************************
*   (variables below are needed by ya0- pricing copybook logic but
*    are only referenced within d001 so they are dummied up here so that
*    this pgm will compile)
77  password-input                              pic x(3).
77  password-special-privledges                 pic x(3)  value "xxx".
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  33
*                      newu701.cbl                                   )
77  confirm                                     pic x   value space.
77  scr-hold-oma-cd                             pic x   value space.
77  scr-hold-oma-suff                           pic x   value space.
77  scr-hold-sv-date-yy-12                      pic x   value space.
77  scr-hold-sv-date-yy-34                      pic x   value space.
77  scr-hold-sv-date-mm                         pic x   value space.
77  scr-hold-sv-date-dd                         pic x   value space.
77  scr-hold-sv-nbr-0                           pic x   value space.
77  scr-hold-fee-oma                            pic x   value space.
77  scr-hold-fee-ohip                           pic x   value space.
77  scr-acpt-det-desc                           pic x   value space.
77  scr-last-claim                              pic x   value space.
77  pline                                       pic 9   value zero.
************************************************************************


*mf 77 ws-1-null                                pic x(1) value "<000>".
*mf 77 ws-4-nulls                               pic x(4) value "<000><000><000><
77 ws-1-null                                    pic x(1) value x"00".
77 ws-4-nulls                                   pic x(4) value x"00000000".

77  ws-warning-literal                          pic x(14) value "* Warning * -".
77  ws-error-literal                            pic x(14) value "**ERROR** - ".

01  temp-phone-nbr.
   05 temp-phone-nbr-justified-left.
      10 temp-phone-nbr-1-7                     pic 9(7).
      10 temp-phone-nbr-8-10                    pic 9(3).
   05 temp-phone-nbr-justified-right redefines temp-phone-nbr-justified-left.
      10 temp-phone-nbr-1-3                     pic 9(3).
      10 temp-phone-nbr-4-10                    pic 9(7).

01  batch-rec.
  05  batch-dist-cd                             pic x.
  05  batch-identifier                          pic x(10).
  05  batch-group-nbr                           pic x(4).
  05  batch-provider-nbr                        pic 9(6).
  05  batch-specialty                           pic 9(2).
  05  batch-pay-type                            pic 9.

* ('dummy' field added to allow compile of common code shared between
*  this pgm and d001)
01 nbr-of-services                              pic 99.

01  header-rec.
  05  hdr-ohip-nbr.
      10  nf-ohip-nbr                           pic x(12).
*2001/02/12 - MC - change the size of the ohip nbr for various provinces
*     10  ab-ns-ohip-nbr redefines nf-ohip-nbr.
*         15  ab-ns-11-digits                   pic x(11).
*         15  ab-ns-last-digits                 pic x.
*     10  bc-ohip-nbr redefines nf-ohip-nbr.
*         15  bc-10-digits                      pic x(10).
*         15  bc-last-digits                    pic xx.
      10  bc-ns-ohip-nbr redefines nf-ohip-nbr.
          15  bc-ns-10-digits                   pic x(10).
          15  bc-ns-last-digits                 pic xx.
*     10  nb-pe-sk-yt-ohip-nbr  redefines nf-ohip-nbr.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  34
*                      newu701.cbl                                   )
*         15  nb-pe-sk-yt-9-digits              pic x(9).
*         15  nb-pe-sk-yt-last-digits           pic xxx.
      10  ab-nb-sk-yt-ohip-nbr  redefines nf-ohip-nbr.
          15  ab-nb-sk-yt-9-digits              pic x(9).
          15  ab-nb-sk-yt-last-digits           pic xxx.
      10  pe-ohip-nbr redefines nf-ohip-nbr.
          15  pe-8-digits                       pic x(8).
          15  pe-last-digits                    pic x(4).
*** end
      10  nt-ohip-nbr redefines nf-ohip-nbr.
          15  nt-first-digit                    pic x.
          15  nt-7-digits                       pic x(7).
          15  nt-last-digits                    pic x(4).
      10  mb-ohip-nbr redefines nf-ohip-nbr.
* 2005/06/23 - MC - Manitoba should have 9 digits
*         15  mb-6-digits                       pic x(6).
*         15  mb-last-digits                    pic x(6).
          15  mb-9-digits                       pic x(9).
          15  mb-last-digits                    pic x(3).
* 2005/06/23 - end

  05  hdr-surname                               pic x(9).
  05  hdr-first-name                            pic x(5).

  05  hdr-birth-date-long.
*  Birth Date split up into yymm and dd
* (y2k)
*   10  hdr-birth-date                          pic 9(4).
    10  hdr-birth-date                          pic 9(6).
    10  hdr-birth-date-dd                       pic 9(2).
  05  hdr-sex                                   pic x.
  05  hdr-accounting-nbr                        pic x(8).
  05  hdr-refer-pract-nbr                       pic 9(6).
  05  hdr-hosp-nbr                              pic x(4).
  05  hdr-i-o-ind                               pic x.
  05  hdr-admit-date.
* (y2k)
*   15  hdr-admit-yy                            pic xx.
    15  hdr-admit-yy                            pic x(4).
    15  hdr-admit-mm                            pic 99.
    15  hdr-admit-dd                            pic 99.
  05  hdr-manual-review                         pic x(1).
  05  hdr-health-care-nbr                       pic x(12).
  05  hdr-health-care-ver                       pic x(02).
  05  hdr-health-care-prov                      pic x(02).
  05  hdr-relationship                          pic x(01).
  05  hdr-patient-surname                       pic x(09).
  05  hdr-subscr-initials                       pic x(03).
  05  hdr-agent-cd                              pic x(01).

* 2003/06/11 - MC
*  05  hdr-loc-code                              pic x(04).
  05  hdr-loc-code.
      10 hdr-loc-alpha                           pic x.
      10 hdr-loc-nbr                             pic x(03).
* 2003/06/11 - end

* 2013/04/17 - MC24
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  35
*                      newu701.cbl                                   )
  05  hdr-direct-key.
      10 hdr-surname-3                          pic x(3).
      10 hdr-birthdate-yymm                     pic 9(4).
      10 hdr-birthdate-dd                       pic 9(2).
* 2013/04/17 - end

*     DATA STORED IN WORKING-STORAGE FROM FILES THAT SHARE I-O BUFFER AREAS.

*   (THE FOLLOWING 'DOC' FIELDS WERE CLONED FROM D001 WHEN THE D001 PRICING
*    CODE WAS MERGED INTO U701. THESE VALUES ARE *NOT* USED IN THIS PGM
*    AND THE PRICING CODE HAS BEEN CHANGED WERE APPROPRIATE)
01  ws-doc-mstr-rec-data.
    05  ws-doc-nx-batch-nbr                     pic  999.
    05  ws-doc-dept                             pic   99.
    05  ws-doc-ohip-nbr                         pic 9(6).
    05  ws-doc-spec-cd                          pic   99.
    05  ws-doc-locations.
        10  ws-doc-loc  occurs 30               pic x999.

01    detail-rec.
  05  dtl-oma-cd                                pic x(4).
  05  dtl-oma-suff                              pic x(1).
  05  dtl-fee-billed                            pic 9999v99.
  05  dtl-nbr-of-serv                           pic 99.
  05  dtl-serv-date.
* (y2k)
*       10  dtl-serv-date-yy                    pic 99.
        10  dtl-serv-date-yy                    pic 9(4).
        10  dtl-serv-date-mm                    pic 99.
        10  dtl-serv-date-dd                    pic 99.
  05  dtl-diag-code                             pic x(3).

01  trailer-rec.
  05  trl-h-count                               pic 9(4).
  05  trl-r-count                               pic 9(4).
  05  trl-t-count                               pic 9(4).
  05  trl-a-count                               pic 9(4).
  05  trl-b-count                               pic 9(4).

77  audit-file                                  pic x(9) value "ru701".
77  suspend-dtl-occur                           pic 9(7).
77  ws-carriage-ctrl                            pic 9(02) value 0.
77  ctr-lines-printed                           pic 9(03) value 99.
77  max-lines-per-page                          pic 9(03) value 60.
77  ws-rpt-page-nbr                             pic 9(03) value 0.
77  ws-agent-default-reply                      pic x(01) value spaces.
*!77  ws-doc-nbr                                  pic 9(3)  value 0.
77  ws-doc-nbr                                  pic x(3)  value spaces.
*77  WS-DEFAULT-CLINIC-NBR                       PIC 9(4)  VALUE 0.
77  ws-default-clinic-nbr                       pic 9(2)  value 0.
77  ws-default-batch-location                   pic x(4)  value " ".
77  ws-default-batch-i-o-ind                    pic x(1)  value " ".

*2002/04/24 -  MC
77  ws-default-payroll-flag                     pic x.
*20002/04/24 - end

77  flag-zero-fee                               pic x.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  36
*                      newu701.cbl                                   )
77  feedback-iconst-mstr                        pic x(4).
77  ws-tot-serv                                 pic 999   value 0.
77  ws-special-add-on-cd-entered                pic x.

* 2011/05/18 - MC15
copy "d001_newu701_oma_code_variables.ws".

*d001_newu701_oma_code_variables.ws - to be used d001 & newu701 & u701oscar

* 2005/11/01 - MC
77  ws-e078-premium                             pic x.
* 2005/11/01 - end

* 2008/04/28 - MC
77  ws-e020                                     pic x.
77  ws-e719                                     pic x.
77  ws-e720                                     pic x.
77  ws-e717                                     pic x.
77  ws-e702                                     pic x.
77  ws-g123                                     pic x.
77  ws-g223                                     pic x.
77  ws-g265                                     pic x.
77  ws-g385                                     pic x.
77  ws-g281                                     pic x.
77  ws-e793                                     pic x.
77  ws-e022-e017-e016                           pic x.
77  ws-z570                                     pic x.
77  ws-z571                                     pic x.
77  ws-z555-z580                                pic x.
77  ws-z515-z760                                pic x.
77  ws-g228                                     pic x.
77  ws-g231                                     pic x.
77  ws-g264                                     pic x.
77  ws-g384                                     pic x.
77  ws-g381                                     pic x.
77  ws-r905-s800                                pic x.
77  ws-annna                                    pic x.
77  ws-gnnna                                    pic x.
77  ws-k991-u997                                pic x.
* 2008/04/28 - end

* 2009/05/06 - MC1
77  ws-c998                                     pic x.
77  ws-c999                                     pic x.
77  ws-e798                                     pic x.
77  ws-z400                                     pic x.
77  ws-g400-other-codes                         pic x.
77  ws-e409-e410                                pic x.
77  ws-c990-to-c997                             pic x.
* for edit 76 & 77 - ws-cnnn
77  ws-cnnn                                     pic x.
77  ws-e450                                     pic x.
77  ws-j315                                     pic x.
* 2009/05/06 -end

* 2010/03/31 - MC4
77  ws-c985                                     pic x.
77  ws-g222                                     pic x.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  37
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
77  ws-g248-g062                                pic x.
77  ws-a770-a775                                pic x.
77  ws-X9nn                                     pic x.
77  ws-h112-h113                                pic x.
77  ws-hnnn                                     pic x.
77  ws-g489-s323                                pic x.
77  ws-g222-z805                                pic x.
77  ws-p014-p016                                pic x.
77  ws-g221                                     pic x.
77  ws-g220                                     pic x.
77  ws-s322-a198                                pic x.
77  ws-a765-c765                                pic x.
77  ws-g521-g395                                pic x.
77  ws-h104-h124                                pic x.
77  ws-g345-g339                                pic x.
77  ws-g431-g479                                pic x.
77  ws-gnnn                                     pic x.
77  ws-annn                                     pic x.
* 2010/03/31 - end

* 2011/03/31 - MC13
77  ws-c983                                     pic x.
77  ws-j025                                     pic x.
77  ws-j021                                     pic x.
77  ws-j022                                     pic x.
77  ws-z608                                     pic x.
77  ws-z611-z602                                pic x.
77  ws-z403                                     pic x.
77  ws-z408                                     pic x.
77  ws-a195                                     pic x.
77  ws-k002                                     pic x.
77  ws-c122-c143                                pic x.
77  ws-e083                                     pic x.
77  ws-c122-c982                                pic x.
77  ws-g489-g376                                pic x.
* 2011/03/31 - end

* 2011/11/23 - MC19+MC22 -add for new edits 52 to 63
77  ws-a197-a198                                pic x.
77  ws-k189                                     pic x.
77  ws-a190-a795                                pic x.
77  ws-k960                                     pic x.
77  ws-k990                                     pic x.
77  ws-k961                                     pic x.
77  ws-k992                                     pic x.
77  ws-k962                                     pic x.
77  ws-k994                                     pic x.
77  ws-k963                                     pic x.
77  ws-k998                                     pic x.
77  ws-k964                                     pic x.
77  ws-k996                                     pic x.
77  ws-c960                                     pic x.
77  ws-c990                                     pic x.
77  ws-c961                                     pic x.
77  ws-c992                                     pic x.
77  ws-c962                                     pic x.
77  ws-c994                                     pic x.
77  ws-c963                                     pic x.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  38
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
77  ws-c986                                     pic x.
77  ws-c964                                     pic x.
77  ws-c996                                     pic x.
* 2011/11/23 - end

* 2011/12/05 - MC22+MC19 - add for new edit 64
77  ws-e676                                     pic x.
* 2011/12/05 - end

* 2013/04/10 - MC28 - add for edit 5 & 68
77  ws-a120                                     pic x.
77  ws-z491-to-z499                             pic x.
* add  for edit 67
77  ws-g556                                     pic x.
77  ws-g400-g620                                pic x.
* 2013/04/10 - end

* MC46+MC43+MC48 add for edit 17
77  ws-g325                                     pic x.
* add for edit 18
77  ws-cnnn-c101                                pic x.
* add for edit 69
77  ws-e402-e403                                pic x.
77  ws-g247                                     pic x.
* add for edit 72
77  ws-e797                                     pic x.
77  ws-z491-z580                                pic x.
* add for edit 73
77  ws-e414                                     pic x.
* add for edit 76
77  ws-p030                                     pic x.
* add for edit 77
77  ws-a895                                     pic x.
77  ws-wnnn                                     pic x.
77  ws-knnn                                     pic x.
* add for edit 78
77  ws-z512                                     pic x.
77  ws-z514                                     pic x.
* add for edit 79
77  ws-z580                                     pic x.
* add for edit 80
77  ws-total-nbr-svc                            pic 99.
77  ws-edit-80                                  pic x.
* add for edit 81
77  ws-a075                                     pic x.
* MC46+MC43+MC48 - end

77  ws-pricing-nbr-serv                         pic 999.
77  ws-highest-grp-tot                          pic s9(5)v99.
77  ws-highest-grp-nbr                          pic 99.
77  flag-new-sec                                pic x.
77  flag-z-highest-grp                          pic x.
*
*  SUBSCRIPTS
*
77  rate-found-ss                               pic 99  comp  value 0.
77  subs                                        pic 99  comp  value 0.
77  ss                                          pic 99  comp  value 0.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  39
*                      newu701.cbl                                   )
77  sub                                         pic 99  comp  value 0.
77  ss1                                         pic 99  comp  value 0.
77  ss2                                         pic 99  comp  value 0.
77  ss-basic-times                              pic 99  comp  value 0.
77  ss-basic-times-desc-rec                     pic 99  comp  value 0.
77  ss-from-plus-one                            pic 99  comp  value 0.
77  ss-const                                    pic 99  comp  value 0.
77  subs-table-addr                             pic 99  comp  value 0.
77  i                                           pic 99  comp  value 0.
77  ss-from                                     pic 99  comp  value 0.
77  ss-to                                       pic 99  comp  value 0.
77  ss-sec                                      pic 99  comp  value 0.
77  ss-grp                                      pic 99  comp  value 0.
77  ss-grp-tot                                  pic 99  comp  value 0.
77  ss-clmhdr                                   pic 99  comp  value 0.
77  ss-tech-prof-suff                           pic 99  comp  value 0.
77  ss-clmdtl-oma                               pic 99  comp  value 0.
77  ss-clmdtl-next-avail-dtl                    pic 99  comp  value 0.
77  ss-clmdtl-new-dtl                           pic 99  comp  value 0.
77  ss-clmdtl-tech-prof-suff                    pic 99  comp  value 0.
77  ss-hold-clmdtl-oma                          pic 99  comp  value 0.
77  ss-price                                    pic 99  comp  value 0.
77  ss-write-dtl                                pic 99  comp  value 0.
77  ss-clmdtl-desc                              pic 99  comp  value 0.
77  ss-conseq-dd                                pic 99  comp  value 0.
77  ss-ind                                      pic 99  comp  value 0.
77  ss-plus-one                                 pic 99  comp  value 0.
77  ss-x                                        pic 99  comp  value 0.
77  ss-suffix                                   pic 99  comp  value 0.
*       (SUBSCRIPTS FOR HOLD-OMA-RECORDS TABLE)
*       (moved to pricing hold.ws copybook)

77  ws-hold-wcb-rate                            pic 999v9(5).
77  ws-reduc-rate98                             pic 99v99.
77  ws-reduc-rate99                             pic 99v99.
77  ws-reduc-rate                               pic 99v99.
77  ws-search-clinic-nbr-1-2                    pic 99  comp  value 0.
*   ('CURR'ENT AND 'PREV'IOUS USED IN SELECTING THE APPROPRIATE OMA YEAR'S FEES
*    'OMA' AND 'OHIP' TO SELECT THE APPROPRIATE FEE TYPE)
77  curr                                        pic 9   comp    value 1.
77  prev                                        pic 9   comp    value 2.
77  oma                                         pic 9   comp    value 1.
77  ohip                                        pic 9   comp    value 2.
77  ss-curr-prev                                pic 99  comp  value 0.

77  space-char                                  pic x(01) value " ".
77  carriage-return                             pic x(01) value x"0D".
77  line-feed                                   pic x(01) value x"0A".
77  ws-hold-temp-1                              pic s9(7)v99.
77  ws-hold-temp-2                              pic 99.
77  ws-hold-temp-3                              pic s9(9).

01  bt-clinic-nbr-1-2                           pic 99  value zero.
01  subs-hosp                                   pic 99  comp  value 0.

01  ws-date-yymmdd.
* (y2k)
*   05 ws-date-yy                               pic 99.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  40
*                      newu701.cbl                                   )
    05 ws-date-yy                               pic 9(4).
    05 ws-date-mm                               pic 99.
    05 ws-date-dd                               pic 99.

01  ws-nbr-10                                   pic x(10).

* 2005/03/03 - MC
01  ws-birth-date                               pic 9(8).
01  ws-sv-date                                  pic 9(8).
* 2005/03/03 - end

* 2010/09/23 - MC9
01  ws-sv-date-c1                               pic 9(8).
01  ws-sv-date-c2                               pic 9(8).
* 2010/09/23 - end

*01  hold-suspend-hdr-rec                        pic x(265).
01  hold-suspend-hdr-rec                        pic x(278).

*     DATA STORED IN WORKING-STORAGE FOR CONSTANTS MASTER CLINIC REC SINCE
*     FD AREA IS RE-USED FOR CONSTANTS MASTER PRICING RECS.

01  ws-iconst-mstr-rec-data.
    05  ws-iconst-clinic-nbr-1-2                pic   99.
    05  ws-iconst-clinic-nbr                    pic 9(4).
    05  ws-iconst-clinic-cycle-nbr              pic   99.
* (y2k)
*   05  ws-iconst-date-period-end               pic 9(6).
    05  ws-iconst-date-period-end               pic 9(8).
    05  ws-iconst-clinic-card-colour            pic    x.

01  audit-line.
    05  filler                                  pic x(10) value spaces.
    05  audit-title                             pic x(36).
    05  audit-value                             pic zz,zzz.
    05  filler                                  pic x(05) value spaces.
    05  audit-value-2                           pic zz,zzz.
    05  filler                                  pic x(05) value spaces.
    05  audit-value-3                           pic zz,zzz.
    05  filler                                  pic x(05) value spaces.
    05  audit-value-4                           pic zz,zzz.
    05  filler                                  pic x(05) value spaces.
    05  audit-value-5                           pic zzz,zzz.99 blank when zero.

01  status-values.
  02 status-infos.
    05  status-unpriced-claims                  pic x(11)  value zero.
    05  status-priced-claims-file               pic x(11)  value zero.
    05  status-iconst-mstr                      pic x(11)  value zero.
    05  status-doc-mstr                         pic x(11)  value zero.
    05  status-oma-mstr                         pic x(11)  value zero.
    05  status-suspend-hdr                      pic x(11)  value zero.
    05  status-suspend-dtl                      pic x(11)  value zero.
* 2005/08/17 - MC
    05  status-suspend-desc                     pic x(11)  value zero.
* 2005/08/17 - end
    05  status-suspend-addr                     pic x(11)  value zero.
    05  status-diag-mstr                        pic x(11)  value zero.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  41
*                      newu701.cbl                                   )
    05  status-file                             pic x(11).
  02 status-cobol.
    05  status-cobol-unpriced-claims            pic x(02)  value zero.
    05  status-cobol-priced-claims              pic x(02)  value zero.
    05  status-cobol-doc-mstr                   pic x(02)  value zero.
    05  status-cobol-oma-mstr                   pic x(02)  value zero.
    05  status-cobol-iconst-mstr                pic x(02)  value zero.
    05  status-cobol-suspend-hdr                pic x(02)  value zero.
    05  status-cobol-suspend-dtl                pic x(02)  value zero.
* 2005/08/17 - MC
    05  status-cobol-suspend-desc               pic x(02)  value zero.
* 2005/08/17 - end
    05  status-cobol-suspend-addr               pic x(02)  value zero.
    05  status-cobol-diag-mstr                  pic x(02)  value zero.
    05  status-report                           pic x(02)  value zero.
    05  status-cobol-loc-mstr                   pic x(02)  value zero.
    05  status-cobol-error-claims               pic x(02)  value zero.
* 2010/05/19 - MC6 -  include ru701-work-file
    05  status-cobol-ru701-work-file            pic x(02)  value zero.
* 2010/05/19 - end
* 2011/05/18 - MC15
    05  status-cobol-sli-oma-mstr               pic x(02)  value zero.
* 2011/05/18 - end

01  feedback-values.
    05  feedback-doc-mstr                       pic x(04)  value zero.
    05  feedback-oma-fee-mstr                   pic x(04)  value zero.
    05  feedback-suspend-hdr                    pic x(04)  value zero.
    05  feedback-suspend-dtl                    pic x(04)  value zero.
    05  feedback-suspend-addr                   pic x(04)  value zero.
    05  feedback-diag-mstr                      pic x(04)  value zero.

01  flag-adjudication-required                  pic x.
    88 adjudication-desc-required               value "Y".

01  ic-flag                                     pic x  value "N".
    88  ic-entered                              value "Y".
    88  ic-not-entered                          value "N".

01  flag                                        pic x.
    88 ok                                       value "Y".
    88 not-ok                                   value "N".

01  eof-input-file-flag                         pic x   value "N".
    88 eof-input-file                           value "Y".

01  fatal-error-flag                            pic x   value spaces.
    88 fatal-error                              value "Y".

01  flag-lock                                   pic x.
    88 rec-locked                               value "Y".
    88 rec-not-locked                           value "N".

01  flag-ohip-vs-chart                          pic x.
    88  qhip                                    value "O".
    88  chart                                   value "C".
    88  direct                                  value "D".

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  42
*                      newu701.cbl                                   )
01  flag-valid-ohip-or-chart                    pic x.
    88  valid-ohip                              value "Y".
    88  valid-chart                             value "Y".
    88  invalid-ohip                            value "N".
    88  invalid-chart                           value "N".

01  flag-ohip-mmyy                              pic x.
    88  valid-mmyy                              value "Y".
    88  invalid-mmyy                            value "N".

01  flag-err-data                               pic x.
    88  err-data                                value "N".
    88  ok-data                                 value "Y".

01  flag-done-clmdtl-recs                       pic x.
    88  done-clmdtl-recs-yes                    value "Y".

01  flag-eoj                                    pic x.
    88  eoj-create-new-patient                  value "C".
    88  eoj                                     value "E".

01  flag-tech-prof-suffix-rule                  pic x.
    88  tech-prof-suff-rule-applied             value "Y".

01  flag-sec-reduction-needed                   pic x.

01  flag-report-desc                            pic x.
    88 report-desc-required                     value "Y".

01  ws-oma-cd.
    05  ws-oma-cd-1                             pic x.
    05  ws-oma-cd-2-4                           pic 999.

*mf 01 skip-processing-this-acct-id-flag            pic x.
01 skip-process-this-acct-id-flag            pic x.
    88 skip-processing-this-acct-id     value "Y".
    88 skip-hdr-addr-but-write-dtl      value "D".

* MC37
01  hold-in-rec-type.
    05  hold-trans-id                   pic xx.
    05  hold-rec-type                   pic x.

*01  record-type-flags                   pic x.
*    88 b-record                         value "B".
*    88 h-record                         value "H".
*    88 r-record                         value "R".
*    88 t-record                         value "T".
*    88 a-record                         value "A".
*    88 e-record                         value "E".

*01 last-record-type-flag                pic x.
*    88 last-record-is-b                 value "B".
*    88 last-record-is-h                 value "H".
*    88 last-record-is-r                 value "R".
*    88 last-record-is-t                 value "T".
*    88 last-record-is-a                 value "A".
*    88 last-record-is-e                 value "E".
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  43
*                      newu701.cbl                                   )

01  record-type-flags                   pic x(3).
    88 b-record                         value "HEB".
    88 h-record                         value "HEH".
    88 r-record                         value "HER".
    88 t-record                         value "HET".
    88 a-record                         value "HEA".
    88 e-record                         value "HEE".

01 last-record-type-flag                pic x(3).
    88 last-record-is-b                 value "HEB".
    88 last-record-is-h                 value "HEH".
    88 last-record-is-r                 value "HER".
    88 last-record-is-t                 value "HET".
    88 last-record-is-a                 value "HEA".
    88 last-record-is-e                 value "HEE".
* MC37 - end

01  counters.
    05  ctr-read-const-mstr                     pic 9(7).
    05  ctr-diskout-writes                      pic 9(7).
    05  ctr-suspend-hdr-writes                  pic 9(7).
    05  ctr-suspend-dtl-writes                  pic 9(7).
* 2005/08/17 - MC
    05  ctr-suspend-desc-writes                 pic 9(7).
* 2005/08/17 - end
    05  ctr-suspend-addr-writes                 pic 9(7).
    05  ctr-recs-read                           pic 9(7).
    05  ctr-b-recs-read-skipped                 pic 9(7).
    05  ctr-h-recs-read-skipped                 pic 9(7).
    05  ctr-r-recs-read-skipped                 pic 9(7).
    05  ctr-t-recs-read-skipped                 pic 9(7).
    05  ctr-a-recs-read-skipped                 pic 9(7).
    05  ctr-e-recs-read-skipped                 pic 9(7).
    05  ctr-b-recs-read                         pic 9(7).
    05  ctr-h-recs-read                         pic 9(7).
    05  ctr-r-recs-read                         pic 9(7).
    05  ctr-t-recs-read                         pic 9(7).
    05  ctr-a-recs-read                         pic 9(7).
    05  ctr-e-recs-read                         pic 9(7).
    05  ctr-h-recs-skipped                      pic 9(7).
    05  ctr-r-recs-skipped                      pic 9(7).
    05  ctr-t-recs-skipped                      pic 9(7).
    05  ctr-a-recs-skipped                      pic 9(7).
    05  ctr-tot-b-recs                          pic 9(7).
    05  ctr-tot-h-recs                          pic 9(7).
    05  ctr-tot-r-recs                          pic 9(7).
    05  ctr-tot-t-recs                          pic 9(7).
    05  ctr-tot-a-recs                          pic 9(7).
    05  ctr-tot-dollars-read                    pic 9(7)v99.

*    05  ctr-tot-dollars-claim                   pic 9(7)v99.
    05  ctr-tot-dollars-oma                     pic 9(7)v99.
    05  ctr-tot-dollars-ohip                    pic 9(7)v99.

    05  ctr-tot-tech-claim                      pic 9(7)v99.
    05  ctr-tot-svcs-read                       pic 9(7).
*** S.B. - start.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  44
*                      newu701.cbl                                   )
    05  ctr-hdr2-rec                            pic 9(02).
    05  ctr-addr-rec                            pic 9(02).
*** S.B. - end.

01  flag-date                                   pic x.
    88 valid-date                                       value "Y".
    88 invalid-date                                     value "N".

01  flag-consec                                 pic x.
    88 valid-consec                                     value "Y".
    88 invalid-consec                                   value "N".

01  flag-clinic                                 pic x.
    88 clinic-found                                     value "Y".
    88 clinic-not-found                                 value "N".

* MC31
01  flag-doc-clinic                                 pic x.
    88 valid-doc-clinic                                 value "Y".
    88 invalid-doc-clinic                               value "N".
* MC31 - end

01  flag-hosp-nbr                               pic x.
    88 valid-hosp-nbr                                   value "Y".
    88 invalid-hosp-nbr                                 value "N".

01  flag-agent-cd                               pic x.
    88 valid-agent-cd                                   value "Y".
    88 invalid-agent-cd                                 value "N".

01  flag-in-out-ind                                     pic x.
    88 valid-in-out-ind                                 value "Y".
    88 invalid-in-out-ind                               value "N".

01  flag-doc                                    pic x.
    88  doc-found                                       value "Y".
    88  doc-not-found                                   value "N".

01  flag-oma                                    pic x.
    88  valid-oma-code                                  value "Y".
    88  invalid-oma-code                                value "N".

01  flag-agent-code                                     pic x.
    88  valid-agent-cd-code                             value "Y".
    88  invalid-agent-cd-code                           value "N".

01  flag-refer-phys                             pic x.
    88  valid-refer-phys                                value "Y".
    88  invalid-refer-phys                              value "N".

* 2013/12/05 - MC29
01  flag-refer-doc                              pic x.
    88  refer-doc-require                               value "Y".
    88  refer-doc-not-require                           value "N".
* 2013/12/05 - end

01  flag-location                               pic x.
    88  valid-location                                  value "Y".
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  45
*                      newu701.cbl                                   )
    88  invalid-location                                value "N".

01  flag-ohip                                   pic x.
    88  valid-ohip                                      value "Y".
    88  invalid-ohip                                    value "N".

01  flag-diag-cd                                pic x.
    88  valid-diag-code                                 value "Y".
    88  invalid-diag-code                               value "N".

01  detail-written-flag                         pic x.
    88  detail-written                          value 'Y'.
    88  detail-not-written                      value 'N'.

01  ws-chk-ind                                  pic x(8).

77  ws-val-total                                pic s9(7).
77  date-difference-in-days                     pic 9(3).
77  rem-even                                    pic 9v9(4).
77  max-nbr-digits                              pic 99 value 7.

77  max-doc-locations                           pic 99 value 30.

*   (include the pricing algorith's hold variables)
* 2006/02/15 - MC


* WARNING - keep the 'ss-max-nbr-oma-det-rec-allow' value in sync with
*           the definition of 'hold-oma-rec' in 'pricing_variables_hold.ws'

*77  ss-max-nbr-oma-det-rec-allow                pic 99  comp    value  40.
*77  ss-max-nbr-oma-det-rec-allow                pic 99  comp    value  60.
* change be - 1387
* MC37
*77  ss-max-nbr-oma-det-rec-allow                pic 99  comp    value  70.
77  ss-max-nbr-oma-det-rec-allow                pic 99  comp    value   90.

* WARNING - keep the 'ss-max-nbr-oma-det-rec-allow' value in sync with
*           the definition of 'hold-oma-rec' in 'pricing_variables_hold.ws'


* 2006/02/15 - end

    copy "pricing_variables_hold.ws".
* file: pricing_variables_hold.ws
* purpose: hold all variables used for pricing calcuations by programs
*          d001.cbl and newu701.cbl
*    note: newu701 needs more variables and requires a 50 occurs statment
*          which d001 doesn't need by will work with these larger
*          definitions


* 00/aug/03 B.E. - taken from d001.cbl/newu701.cbl
* 00/aug/30 B.E. - removed ss-max-nbr-oma-det-rec-allow from this copybook
*                  since it must be changed based upon which pgm uses
*                  the copybook.
* 00/aug/10 B.E. - added hold-ss-curr-prev
* 00/aug/31 B.E. - added hold-sv-nbr-serv-incoming
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  46
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
* 00/sep/04 B.E. - rename 'hold-sv-nbr-days-conseq' to 'hold-sv-nbr-days-conseq'
*                  and changed size of 'hold-sv-nbr' from 99 to 9.
* 00/sep/12 B.E. - changed sequence of fields hold-sv-nbr and  hold-sv-day
* 00/sep/25 B.E. - added 'hold-description-tmp' to be used to translate
*                  user entered 'short forms' into longer text
* 00/oct/25 B.E. - changed occurrences from 40 to 50 to handle web claim details
* 01/apr/23 B.E. - changed fees from 3 to 4 decimals to handle the 4 decimal
*                  percentages
* 01/aug/29 B.E. - added flag-desc-rec
* 01/sep/25 B.E. - added flag-update-suspense, flag-create-priced-file
* 02/jan/16 B.E. - added flag-payroll to indicate payroll claims being
*                  paid under
* 06/feb/15 B.E. - increase occurs size of hold-oma-rec from 50 to 60
*                - increase hold-grp-tot & hold-grp-nbr from 50 to 60
* 06/jun/30 b.e. - increase feb/15 stuff from 60 to 70
* 11/may/02 M.C. - expand hold-oma-cd-num into digit 1,2,3
* 12/Mar/28 M.C. - increase feb/15 stuff from 70 to 90
*======================================================================
*       (subscripts for this table in 'ss-oma-subscripts')
01  hold-claim-detail-recs.
    05  hold-oma-recs.

        10  hold-accounting-nbr         pic x(8).

*======================================================================
*========================  W A R N I N G  ! ! !  ======================
* WARNING #1 - length of 'hold-oma-rec'
*      if the length of the 'hold-oma-rec' is changed then the field
*     'hold-sort-oma-rec' must also be changed to reflect the new size.
* WARNING #2  - if the value                    '70' below changes then
*               the corresponding occurs must also be changed to match
*                       hold-grp-tot
*                       hold-grp-nbr
*========================  W A R N I N G  ! ! !  ======================
* WARNING- keep ss-max-nbr-oma-det-rec-allow in sync with the occurs value
*       10  hold-oma-rec                  occurs  50  times.
*       10  hold-oma-rec                  occurs  60  times.
*       10  hold-oma-rec                  occurs  70  times.
        10  hold-oma-rec                  occurs  90  times.
* WARNING- keep ss-max-nbr-oma-det-rec-allow in sync with the occurs value
            15  hold-oma-cd.
                20  hold-oma-cd-alpha   pic x.
* 2011/05/02 - MC
*               20  hold-oma-cd-num     pic 999.
                20  hold-oma-cd-num.
                    25  hold-oma-cd-num-1       pic 9.
                    25  hold-oma-cd-num-2       pic 9.
                    25  hold-oma-cd-num-3       pic 9.
* 2011/05/02 - end
            15  hold-oma-suff           pic a.

*               (added incoming svcs 00/aug/31 B.E.)
            15  hold-sv-nbr-serv-incoming pic 99.
            15  hold-sv-nbr-serv          pic 99.

            15  hold-admit-date-icc.
                20  hold-sv-date.
*y2k
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  47
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
*                   25  hold-sv-date-yy pic 99.
                    25  hold-sv-date-yy pic 9(4).
                    25  hold-sv-date-yy-r redefines hold-sv-date-yy.
                        30 hold-sv-date-yy-12     pic 99.
                        30 hold-sv-date-yy-34     pic 99.
                    25  hold-sv-date-mm pic 99.
                    25  hold-sv-date-dd pic 99.
                20  hold-icc-cd.
                    25  hold-icc-sec    pic xx.
                    25  hold-icc-grp    pic 99.
*y2k
            15  hold-key-r  redefines  hold-admit-date-icc.
*               20  filler              pic x(4).
                20  filler              pic x(6).
*               (sort key is service-date-dd + icc code)
                20  hold-sort-key-1     pic x(6).
            15  hold-sv-nbr-days-conseq  occurs  3  times.
*                   (00/sep/12 B.E. changed sequence of day/nbr)
                20  hold-sv-nbr         pic 9.
                20  hold-sv-day         pic xx.
                20  hold-sv-day-num redefines hold-sv-day pic 99.
*                       20  hold-sv-nbr         pic 99.

            15  hold-override-price     pic x(1).
            15  hold-bilateral          pic x(1).
            15  hold-fee-incoming       pic s9(5)v99.

            15  hold-fee-oma            pic s9(5)v99.
            15  hold-fee-oma-r redefines hold-fee-oma  pic s9(7).
            15  hold-fee-ohip           pic s9(5)v99.
            15  hold-fee-ohip-r redefines hold-fee-ohip pic s9(7).
            15  hold-priced-tech        pic s9(5)v99.
            15  hold-basic-tech         pic s9(5)v99.
            15  hold-basic-prof         pic s9(5)v99.
            15  hold-basic-fee          pic s9(5)v99.
*               (8 indicators for each detail rec -
*                see definitions below (eg. ss-diag-ind))
            15  hold-oma-rec-ind        pic x           occurs  8  times.
*               (10 possible add on codes for each detail rec)
            15  hold-oma-add-on-cd      pic x999        occurs  10  times.
            15  hold-oma-ind-card-requireds.
                20  hold-oma-ind-card-required pic x    occurs 3 times.

*               (fees are stored as: 1st occur = 'oma'
*                                    2nd occur = 'ohip' )
            15  hold-oma-fees    occurs  2  times.
*                   (oma fees changed from 2 to 3 decimals)
*                      20  hold-oma-fee-1      pic s9(5)v99.
*                      20  hold-oma-fee-2      pic s9(5)v99.
*                   (oma fees changed from 3 to 4 decimals - 2000/apr/23)
*                      20  hold-oma-fee-1      pic s9(4)v999.
*                      20  hold-oma-fee-2      pic s9(4)v999.
                20  hold-oma-fee-1      pic s9(4)v9999.
                20  hold-oma-fee-2      pic s9(4)v9999.
*                   (00/aug/03 B.E. - new min/max fields)
                20  hold-fee-min        pic s9(4)v999.
                20  hold-fee-max        pic s9(4)v999.
                20  hold-oma-fee-anae   pic 99.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  48
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
                20  hold-oma-fee-asst   pic 99.

*               (00/aug/10 B.E.
*                each oma code can have different effective date and therefore
*                lines may vary between current and previous rates)
            15  hold-ss-curr-prev       pic 9 comp.

            15  hold-flag-fee-used      pic x.
            15  hold-flag-sec-group.
                20  hold-flag-sec       pic  9.
                20  hold-flag-grp       pic  9.
            15  hold-diag-cd            pic  999.
            15  hold-line-no            pic 99.

*       NOTE:The value below only changes if the length of the above
*            record is increased - not if the # occurances of it increases
*       (00/aug/03 B.E. from 168 to 200 fold hold-fee-min/max fields)
*       (00/aug/04 B.E. from 200 to 220 when copybook created for d001/newu701
*       (00/aug/08 B.E. from 220 to 234 added 2nd dimension for min/max)
*       (00/aug/10 B.E. from 234 to 274 added hold-ss-curr-prev added)
*     05  hold-sort-oma-rec               pic x(168).
*     05  hold-sort-oma-rec               pic x(200).
*     05  hold-sort-oma-rec               pic x(220).
*     05  hold-sort-oma-rec               pic x(234).
      05  hold-sort-oma-rec               pic x(274).

    05  hold-descriptions.
        10  hold-desc-1                 pic x(22).
        10  hold-desc-2                 pic x(22).
        10  hold-desc-3                 pic x(22).
        10  hold-desc-4                 pic x(22).
        10  hold-desc-5                 pic x(22).

    05  hold-descs-r   redefines   hold-descriptions.
        10  hold-descs  occurs 5 times.
           15  hold-desc               pic x(22).
*            15  orig-desc.
*               20 orig-desc-start      pic x(03).
*               20 orig-desc-end        pic x(19).
    05  hold-desc-tmp.
        10 hold-desc-tmp-start          pic x(03).
        10 hold-desc-tmp-end            pic x(19).

    05  hold-basic-times-desc.
        10  hold-basic-plus-times-desc     occurs  2  times.
            15  hold-basic-units        pic zz9.
            15  hold-basic-b            pic xxx.
            15  hold-times-units        pic zz9.
            15  hold-times-t            pic xxx.

01  hold-grp-totals-tbl.
*   05  hold-grp-tot                    pic s9(5)v99 occurs  60 times.
*   05  hold-grp-nbr                                 occurs  60 times.
*   05  hold-grp-tot                    pic s9(5)v99 occurs  70 times.
*   05  hold-grp-nbr                                 occurs  70 times.
    05  hold-grp-tot                    pic s9(5)v99 occurs  90 times.
    05  hold-grp-nbr                                 occurs  90 times.
        10  hold-grp-nbr-sec            pic 9.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  49
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
        10  hold-grp-nbr-grp            pic 9.


*
*       (maximum values or limits that may have to be changed
*               if record layouts are altered)
*
77  ss-max-nbr-locs-in-doc-rec                  pic 99  comp    value  30.
77  ss-max-nbr-of-desc-rec-allow                pic 99  comp    value  5.

01  flag-desc-rec                               pic xx.
    88 basic-plus-times-entry                   value "BT".
    88 adjudication-desc-entry                  value "A".

01  flag-update-suspense                        pic x.
    88 update-suspense                          value "Y".
    88 dont-update-suspense                     value "N".

01  flag-create-priced-file                     pic x.
    88 create-priced-file                       value "Y".
    88 dont-create-priced-file                  value "N".

01  flag-claim-source                           pic x.
    88 web-claim                                value "W".
    88 online-claim                             value "O".
    88 diskette-claim                           value "D".
    88 price-only-claim                         value "P".

01  flag-payroll                                pic x.

01  flag-retain-prices                          pic x.
    88 retain-incoming-prices                   value "Y".
    88 override-with-rma-prices                 value "N".

*   (subscripts for the 'hold-oma-rec-ind' occurrence above)
77  ss-diag-ind                                 pic 99  comp  value 1.
77  ss-phy-ind                                  pic 99  comp  value 2.
77  ss-hosp-nbr-ind                             pic 99  comp  value 3.
77  ss-i-o-ind                                  pic 99  comp  value 4.
77  ss-admit-ind                                pic 99  comp  value 5.
77  ss-add-on-perc-or-flat-ind                  pic 99  comp  value 6.
77  ss-special-m-suffix-ind                     pic 99  comp  value 7.
77  ss-tech-ind                                 pic 99  comp  value 8.


01  province-flag                              pic x.
    88  province-found                          value "Y".
    88  province-not-found                      value "N".

01  prov-table.

    05  province.
        10  filler                              pic x(2) value "ON".
        10  filler                              pic x(2) value "AB".
* 2005/06/23 - MC - change NF to NL
*       10  filler                              pic x(2) value "NF".
        10  filler                              pic x(2) value "NL".
* 2005/06/23 - end
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  50
*                      newu701.cbl                                   )
        10  filler                              pic x(2) value "SK".
        10  filler                              pic x(2) value "MB".
        10  filler                              pic x(2) value "NT".
        10  filler                              pic x(2) value "PE".
*       10  FILLER                              PIC X(2) VALUE "QE".
        10  filler                              pic x(2) value "YT".
        10  filler                              pic x(2) value "BC".
        10  filler                              pic x(2) value "NB".
        10  filler                              pic x(2) value "NS".
*       10  FILLER                              PIC X(2) VALUE "OT".
* MC36
        10  filler                              pic x(2) value "NU".
* MC36 - end


    05  province-r               redefines      province.

        10  prov                 occurs 12 times pic x(2).

copy "def_agents.ws".
*
*    -----modification history------
*    date      who          what/why
* filename: def_agents.ws
*
* 90/jul/01  b. e.        - original
* 90/sep/10  b. e.        - added "4" to definition of direct bill
* 91/feb/11  m.c.  - sms 138 - use agent 2 for ohip wcb
* 95/oct/03  yas   - pdr 631 - use agent 5 for moh reduction
* 1999/Jun/18 S.B  - Combined Sick Kids and RMA agents.
* 2001/nov/06 B.E. - added agent 3 for ICU (revenue clinic 85) direct bills
* 2013/Jan/29 MC1  - since 2005/12/15 , agent 3 is no longer allowed
* 2017/Apr/25 MC2  - agent 6 only for bill direct

01  def-agent-code                              pic x(01).
    88 def-agent-ohip                   value "0".
    88 def-agent-in-pat-diag-billing    value "1".
    88 def-agent-ohip-wcb               value "2".
*    88 def-agent-3-not-used            value "3".
    88 def-agent-icu-direct-bill        value "3".
    88 def-agent-ohip-not-valid         value "4".
    88 def-agent-moh-reduction          value "5".
* 2013/01/29 - MC1
*    88 def-agent-bill-direct           value "6","4","3".
* MC2
*    88 def-agent-bill-direct           value "6","4".
    88 def-agent-bill-direct            value "6".
    88 def-agent-misc-payments          value "7".
    88 def-agent-alternate-funding      value "8".
    88 def-agent-wcb                    value "9".

    88 def-agent-ifhp-direct            value "x".
    88 def-agent-ontario-direct         value "x".
    88 def-agent-foreign-direct         value "x".
    88 def-agent-reciprocal             value "x".
    88 def-agent-quebec-direct          value "x".


* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  51
*                      newu701.cbl                                   )
copy "default_phone_area_code.ws".
* Filename: default_phone_area_code.ws

*   modification history
* 2000/mar/13 B.E. -original

77 default-area-code                            pic x(3) value "905".
01 swap-phone-nbr.
   10 swap-phone-nbr-1-7                        pic x(7).
   10 filler                                    pic x(3).


copy "sysdatetime.ws".
* 98/dec/01 D.B.        - y2k conversion
* 99/jan/13 B.E.        - changed sys-y1/y2 to y1 thru y4
*                       - added 'default-century-...' and century-date variables

01 century-year                                 pic 9(4).
01 century-date                                 pic 9(8).
01 default-century-cc                           pic 9(2) value 19.
01 default-century-cccc                         pic 9(4) value 1900.

01  sys-date.
* y2k    05  sys-date-long                              pic x(6).
    05  sys-date-long                           pic x(8).
    05  sys-date-long-r  redefines  sys-date-long.
* y2k   10  sys-yy                              pic 99.
        10  sys-yy                              pic 9999.
        10  sys-yy-alpha  redefines  sys-yy.
* y2k       15  sys-y1                          pic 9.
* y2k       15  sys-y2                          pic 9.
            15  sys-y1                          pic 9.
            15  sys-y2                          pic 9.
            15  sys-y3                          pic 9.
            15  sys-y4                          pic 9.
        10  sys-mm                              pic 99.
        10  sys-dd                              pic 99.
* remove after y2k upgrade of dgux
01  sys-date-numeric redefines sys-date         pic 9(8).
01  sys-date-y2kfix  redefines sys-date.
    05 sys-date-left                            pic x(6).
    05 filler                                   pic x(2).
01  sys-date-y2kfixed redefines sys-date.
    05 sys-date-blank                           pic x(2).
    05 sys-date-right                           pic x(6).
01  sys-date-temp                               pic x(8).

01  run-date.
* y2k    05  run-yy                                     pic 99.
    05  run-yy                                  pic 9999.
    05  filler                                  pic x   value "/".
    05  run-mm                                  pic 99.
    05  filler                                  pic x   value "/".
    05  run-dd                                  pic 99.

01  sys-time.
    05  sys-hrs                                 pic 99.
    05  sys-min                                 pic 99.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  52
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/sys)
    05  sys-sec                                 pic 99.
    05  sys-hdr                                 pic 99.

01  run-time.
    05  run-hrs                                 pic 99.
    05  filler                                  pic x   value ":".
    05  run-min                                 pic 99.
    05  filler                                  pic x   value ":".
    05  run-sec                                 pic 99.

copy "check_digit.ws".
01  ws-check-digit-nbrs.
    05  ws-temp                                 pic 999.
    05  ws-temp-1                               pic 99.
    05  ws-temp-2                               pic 99.
    05  ws-temp-2-r  redefines ws-temp-2.
        10  ws-temp-2a                          pic 9.
        10  ws-temp-2b                          pic 9.

*       (digit #8 is the check digit using modulus 10)
01  ws-check-nbr.
    05  ws-chk-nbr                              pic 9(8).
    05  ws-chk-nbr-r redefines ws-chk-nbr.
        10  ws-chk-nbr-1                        pic 9.
        10  ws-chk-nbr-2                        pic 9.
        10  ws-chk-nbr-3                        pic 9.
        10  ws-chk-nbr-4                        pic 9.
        10  ws-chk-nbr-5                        pic 9.
        10  ws-chk-nbr-6                        pic 9.
        10  ws-chk-nbr-7                        pic 9.
        10  ws-chk-nbr-8                        pic 9.



copy "check_digit_10.ws".
01  ws-check-digit-nbrs-10.
    05  ws-temp-10                                      pic 999.
    05  ws-temp-1-10                                    pic 99.
    05  ws-temp-2-10                                    pic 99.
    05  ws-temp-2-10-r  redefines ws-temp-2-10.
        10  ws-temp-2a-10                               pic 9.
        10  ws-temp-2b-10                               pic 9.

*       (digit #10 is the check digit using modulus 10)
01  ws-check-nbr-10.
    05  ws-chk-nbr-10                                   pic 9(10).
    05  ws-chk-nbr-10-r redefines ws-chk-nbr-10.
        10  ws-chk-nbr-1-10                             pic 9.
        10  ws-chk-nbr-2-10                             pic 9.
        10  ws-chk-nbr-3-10                             pic 9.
        10  ws-chk-nbr-4-10                             pic 9.
        10  ws-chk-nbr-5-10                             pic 9.
        10  ws-chk-nbr-6-10                             pic 9.
        10  ws-chk-nbr-7-10                             pic 9.
        10  ws-chk-nbr-8-10                             pic 9.
        10  ws-chk-nbr-9-10                             pic 9.
        10  ws-chk-nbr-10-10                            pic 9.

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  53
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/che)


copy "mod_check_digit.ws".
01  ws-nbr-val.

    05  ws-nbr-to-b-val                 pic 9(8).
    05  ws-nbr-to-b-val-r redefines ws-nbr-to-b-val.
        10  ws-nbr-to-b-val-1-8 occurs 8 times
                                        pic 9.
    05  ws-sum-1-2-val.
        10  ws-sum-1-2-val-r occurs 7 times.
            15  ws-sum-1-2-val-r1       pic 99.
            15  ws-sum-1-2-val-r1-r redefines ws-sum-1-2-val-r1.
                20  ws-sum-1            pic 9   occurs 2 times.
    05  ws-sum-1-2-val-r-sep redefines ws-sum-1-2-val.
        10  ws-sum-1-2 occurs 7 times   pic 99.

01  ws-hc-nbr-val.

    05  ws-hc-nbr-to-b-val                      pic 9(10).
    05  ws-hc-nbr-to-b-val-r redefines ws-hc-nbr-to-b-val.
        10  ws-hc-nbr-to-b-val-1-10 occurs 10 times
                                        pic 9.
    05  ws-hc-sum-1-2-val.
        10  ws-hc-sum-1-2-val-r occurs 9 times.
            15  ws-hc-sum-1-2-val-r1    pic 99.
            15  ws-hc-sum-1-2-val-r1-r redefines ws-hc-sum-1-2-val-r1.
                20  ws-hc-sum-1                 pic 9   occurs 2 times.
    05  ws-hc-sum-1-2-val-r-sep redefines ws-hc-sum-1-2-val.
        10  ws-hc-sum-1-2 occurs 9 times        pic 99.

copy "mth_desc_max_days.ws".
*
*       (each position contains:
*               - maximum nbr of days in month
*               - non-abreviated spelling of month
*               - nbr of julian days from jan-01 until last day of month
*       note: table does not take into consideration leap year)
*
01  month-descs-and-max-days-mth.
    05  mth-desc-max-days.
        10  filler                      pic x(14) value '31  JANUARY031'.
        10  filler                      pic x(14) value '29 FEBRUARY059'.
        10  filler                      pic x(14) value '31    MARCH090'.
        10  filler                      pic x(14) value '30    APRIL120'.
        10  filler                      pic x(14) value '31      MAY151'.
        10  filler                      pic x(14) value '30     JUNE181'.
        10  filler                      pic x(14) value '31     JULY212'.
        10  filler                      pic x(14) value '31   AUGUST243'.
        10  filler                      pic x(14) value '30SEPTEMBER273'.
        10  filler                      pic x(14) value '31  OCTOBER304'.
        10  filler                      pic x(14) value '30 NOVEMBER334'.
        10  filler                      pic x(14) value '31 DECEMBER365'.
    05  mth-desc-max-days-r   redefines mth-desc-max-days.
        10  mth-desc-max-days-occur     occurs  12  times.
            15  max-nbr-days            pic 99.
            15  mth-desc                pic x(9).
            15  nbr-julian-days-ytd     pic 9(3).
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  54
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/mth)


copy "hosp_table.ws".
*  (94/mar/17 b.e. changed 2784 to 3642)
01  hosp-table.

    05  hosp-values.
        10  filler                              pic x(5)        value
                "A1992".
        10  filler                              pic x(5)        value
                "B1160".
        10  filler                              pic x(5)        value
                "C1972".
        10  filler                              pic x(5)        value
                "D1557".
        10  filler                              pic x(5)        value
                "E1146".
        10  filler                              pic x(5)        value
                "F3361".
        10  filler                              pic x(5)        value
                "G1982".
        10  filler                              pic x(5)        value
                "H1983".
        10  filler                              pic x(5)        value
                "I3309".
        10  filler                              pic x(5)        value
                "J2003".
        10  filler                              pic x(5)        value
                "K1076".
        10  filler                              pic x(5)        value
                "L1538".
        10  filler                              pic x(5)        value
                "M1994".
        10  filler                              pic x(5)        value
                "N1591".
        10  filler                              pic x(5)        value
                "O1172".
        10  filler                              pic x(5)        value
                "P1524".
        10  filler                              pic x(5)        value
                "Q3446".
        10  filler                              pic x(5)        value
                "R1978".
        10  filler                              pic x(5)        value
                "S2006".
        10  filler                              pic x(5)        value
                "T1406".
        10  filler                              pic x(5)        value
                "U1542".
        10  filler                              pic x(5)        value
                "V1149".
        10  filler                              pic x(5)        value
                "W0000".
        10  filler                              pic x(5)        value
                "X1082".
        10  filler                              pic x(5)        value
                "Y1020".
        10  filler                              pic x(5)        value
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  55
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/hos)
                "Z1987".
        10  filler                              pic x(5)        value
                "11965".
        10  filler                              pic x(5)        value
                "21969".
        10  filler                              pic x(5)        value
                "33401".
        10  filler                              pic x(5)        value
                "42001".
        10  filler                              pic x(5)        value
                "51966".
        10  filler                              pic x(5)        value
                "61967".
        10  filler                              pic x(5)        value
                "73409".
        10  filler                              pic x(5)        value
                "83642".
        10  filler                              pic x(5)        value
                "93251".
    05  hosp-values-r redefines hosp-values.
        10  hosp-code-nbr occurs 35 times.
            15  hosp-code                       pic x.
            15  hosp-nbr                        pic x(4).


01 heading-l1.
    05  filler                                  pic x(08)       value
       "RU701".
    05  filler                                  pic x(10)       value
       "RUN DATE:".

* (y2k)
*   05  l1-run-date                             pic x(08).
    05  l1-run-date                             pic x(10).
*   05  filler                                  pic x(08)       value spaces.
    05  filler                                  pic x(06)       value spaces.
    05  filler                                  pic x(66)       value
       "OHIP Diskette Upload into Suspense - ERROR/WARNING/AUDIT Report".
    05  filler                                  pic x(06)       value
        "PAGE:".
    05  rpt-page-nbr                            pic zzz9.

01 heading-l2.
    05  filler                                  pic x(08)       value
        "DOCTOR: ".
*!    05  h-l2-doctor-nbr                         pic 999.
    05  h-l2-doctor-nbr                         pic xxx.
    05  filler                                  pic x(03)       value
        " / ".
    05  h-l2-doctor-initials                    pic x(03).
    05  filler                                  pic x(01)       value
        " ".
    05  h-l2-doctor-name                        pic x(24).
    05  filler                                  pic x(20)       value
        " CLINIC/SPECIALTY: ".
    05  h-l2-clinic                             pic x(4).
    05  filler                                  pic x(03)       value
        " / ".
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  56
*                      newu701.cbl                                   )
    05  h-l2-specialty                          pic x(3).

copy "f090_const_mstr_rec_1.ws".
* 2005/jan/04   - extend from 40 clinic to the max clinics allowed (63)

01 constants-mstr-rec-1.
    05  const-rec-1-rec-nbr                     pic 99.
    05  const-max-nbr-clinics                   pic 99.
    05  const-clinic-data.
* 2005/01/04 - MC
*       10  const-clinic-data-r occurs  40  times.
        10  const-clinic-data-r occurs  63  times.
            15  const-clinic-nbr-1-2            pic 99.
            15  const-clinic-nbr                pic x(4).
    05  const-scr-data  redefines  const-clinic-data.
        10  const-clinic-1-2-nbr-1              pic 99.
        10  const-clinic-nbr-1                  pic x(4).
        10  const-clinic-1-2-nbr-2              pic 99.
        10  const-clinic-nbr-2                  pic x(4).
        10  const-clinic-1-2-nbr-3              pic 99.
        10  const-clinic-nbr-3                  pic x(4).
        10  const-clinic-1-2-nbr-4              pic 99.
        10  const-clinic-nbr-4                  pic x(4).
        10  const-clinic-1-2-nbr-5              pic 99.
        10  const-clinic-nbr-5                  pic x(4).
        10  const-clinic-1-2-nbr-6              pic 99.
        10  const-clinic-nbr-6                  pic x(4).
        10  const-clinic-1-2-nbr-7              pic 99.
        10  const-clinic-nbr-7                  pic x(4).
        10  const-clinic-1-2-nbr-8              pic 99.
        10  const-clinic-nbr-8                  pic x(4).
        10  const-clinic-1-2-nbr-9              pic 99.
        10  const-clinic-nbr-9                  pic x(4).
        10  const-clinic-1-2-nbr-10             pic 99.
        10  const-clinic-nbr-10                 pic x(4).
        10  const-clinic-1-2-nbr-11             pic 99.
        10  const-clinic-nbr-11                 pic x(4).
        10  const-clinic-1-2-nbr-12             pic 99.
        10  const-clinic-nbr-12                 pic x(4).
        10  const-clinic-1-2-nbr-13             pic 99.
        10  const-clinic-nbr-13                 pic x(4).
        10  const-clinic-1-2-nbr-14             pic 99.
        10  const-clinic-nbr-14                 pic x(4).
        10  const-clinic-1-2-nbr-15             pic 99.
        10  const-clinic-nbr-15                 pic x(4).
        10  const-clinic-1-2-nbr-16             pic 99.
        10  const-clinic-nbr-16                 pic x(4).
        10  const-clinic-1-2-nbr-17             pic 99.
        10  const-clinic-nbr-17                 pic x(4).
        10  const-clinic-1-2-nbr-18             pic 99.
        10  const-clinic-nbr-18                 pic x(4).
        10  const-clinic-1-2-nbr-19             pic 99.
        10  const-clinic-nbr-19                 pic x(4).
        10  const-clinic-1-2-nbr-20             pic 99.
        10  const-clinic-nbr-20                 pic x(4).
        10  const-clinic-1-2-nbr-21             pic 99.
        10  const-clinic-nbr-21                 pic x(4).
        10  const-clinic-1-2-nbr-22             pic 99.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  57
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f09)
        10  const-clinic-nbr-22                 pic x(4).
        10  const-clinic-1-2-nbr-23             pic 99.
        10  const-clinic-nbr-23                 pic x(4).
        10  const-clinic-1-2-nbr-24             pic 99.
        10  const-clinic-nbr-24                 pic x(4).
        10  const-clinic-1-2-nbr-25             pic 99.
        10  const-clinic-nbr-25                 pic x(4).
        10  const-clinic-1-2-nbr-26             pic 99.
        10  const-clinic-nbr-26                 pic x(4).
        10  const-clinic-1-2-nbr-27             pic 99.
        10  const-clinic-nbr-27                 pic x(4).
        10  const-clinic-1-2-nbr-28             pic 99.
        10  const-clinic-nbr-28                 pic x(4).
        10  const-clinic-1-2-nbr-29             pic 99.
        10  const-clinic-nbr-29                 pic x(4).
        10  const-clinic-1-2-nbr-30             pic 99.
        10  const-clinic-nbr-30                 pic x(4).
        10  const-clinic-1-2-nbr-31             pic 99.
        10  const-clinic-nbr-31                 pic x(4).
        10  const-clinic-1-2-nbr-32             pic 99.
        10  const-clinic-nbr-32                 pic x(4).
        10  const-clinic-1-2-nbr-33             pic 99.
        10  const-clinic-nbr-33                 pic x(4).
        10  const-clinic-1-2-nbr-34             pic 99.
        10  const-clinic-nbr-34                 pic x(4).
        10  const-clinic-1-2-nbr-35             pic 99.
        10  const-clinic-nbr-35                 pic x(4).
        10  const-clinic-1-2-nbr-36             pic 99.
        10  const-clinic-nbr-36                 pic x(4).
        10  const-clinic-1-2-nbr-37             pic 99.
        10  const-clinic-nbr-37                 pic x(4).
        10  const-clinic-1-2-nbr-38             pic 99.
        10  const-clinic-nbr-38                 pic x(4).
        10  const-clinic-1-2-nbr-39             pic 99.
        10  const-clinic-nbr-39                 pic x(4).
        10  const-clinic-1-2-nbr-40             pic 99.
        10  const-clinic-nbr-40                 pic x(4).
* 2005/01/04 - MC - include clinic 41 to 63
*    05  filler                                 pic x(140).
        10  const-clinic-1-2-nbr-41             pic 99.
        10  const-clinic-nbr-41                 pic x(4).
        10  const-clinic-1-2-nbr-42             pic 99.
        10  const-clinic-nbr-42                 pic x(4).
        10  const-clinic-1-2-nbr-43             pic 99.
        10  const-clinic-nbr-43                 pic x(4).
        10  const-clinic-1-2-nbr-44             pic 99.
        10  const-clinic-nbr-44                 pic x(4).
        10  const-clinic-1-2-nbr-45             pic 99.
        10  const-clinic-nbr-45                 pic x(4).
        10  const-clinic-1-2-nbr-46             pic 99.
        10  const-clinic-nbr-46                 pic x(4).
        10  const-clinic-1-2-nbr-47             pic 99.
        10  const-clinic-nbr-47                 pic x(4).
        10  const-clinic-1-2-nbr-48             pic 99.
        10  const-clinic-nbr-48                 pic x(4).
        10  const-clinic-1-2-nbr-49             pic 99.
        10  const-clinic-nbr-49                 pic x(4).
        10  const-clinic-1-2-nbr-50             pic 99.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  58
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/f09)
        10  const-clinic-nbr-50                 pic x(4).
        10  const-clinic-1-2-nbr-51             pic 99.
        10  const-clinic-nbr-51                 pic x(4).
        10  const-clinic-1-2-nbr-52             pic 99.
        10  const-clinic-nbr-52                 pic x(4).
        10  const-clinic-1-2-nbr-53             pic 99.
        10  const-clinic-nbr-53                 pic x(4).
        10  const-clinic-1-2-nbr-54             pic 99.
        10  const-clinic-nbr-54                 pic x(4).
        10  const-clinic-1-2-nbr-55             pic 99.
        10  const-clinic-nbr-55                 pic x(4).
        10  const-clinic-1-2-nbr-56             pic 99.
        10  const-clinic-nbr-56                 pic x(4).
        10  const-clinic-1-2-nbr-57             pic 99.
        10  const-clinic-nbr-57                 pic x(4).
        10  const-clinic-1-2-nbr-58             pic 99.
        10  const-clinic-nbr-58                 pic x(4).
        10  const-clinic-1-2-nbr-59             pic 99.
        10  const-clinic-nbr-59                 pic x(4).
        10  const-clinic-1-2-nbr-60             pic 99.
        10  const-clinic-nbr-60                 pic x(4).
        10  const-clinic-1-2-nbr-61             pic 99.
        10  const-clinic-nbr-61                 pic x(4).
        10  const-clinic-1-2-nbr-62             pic 99.
        10  const-clinic-nbr-62                 pic x(4).
        10  const-clinic-1-2-nbr-63             pic 99.
        10  const-clinic-nbr-63                 pic x(4).

    05  filler                                  pic x(2).
* 2005/01/04 - end


* 2011/06/13 - MC16 - error messages have tranferred into the copy book $use/new

copy "newu701_oscar_error_messages.ws".

* $use/newu701_oscar_error_messages.ws - this copybook is used in newu701.cbl &

01  error-message-table.

    05  error-messages.
* #1
        10  filler.
            15  err-warn-msg                    pic x(14)  value spaces.
            15  filler                          pic x(08)  value
                "Batch = ".
            15  err-msg-pract-nbr               pic x(06).
            15  filler                          pic x(01)  value "/".
            15  err-msg-account-id              pic x(08).
            15  filler                          pic x(95)  value spaces.
* #2
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(43)  value
                "**ERROR** - NO SUCH DOCTOR FOUND ON FILE - ".
            15  err-msg-doc-nbr                 pic x(03).
            15  filler                          pic x(72)  value spaces.
* #3
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  59
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(61)  value
                "INVALID LOCATION CODE FOR DOCTOR: BATCH CONTAINED LOCATION - ".
            15  err-msg-loc-cd                  pic x(04).
            15  filler                          pic x(53)  value spaces.
* #4
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(54)  value
                "INVALID SPECIALITY CODE: BATCH CONTAINED SPECIALITY - ".
            15  err-msg-batch-spec-cd           pic x(04).
            15  filler                          pic x(60)  value spaces.
* #5
        10 filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(53)  value
                "                         DOCTOR'S  SPECIALTIES ARE - ".
            15  err-msg-doc-spec-cd             pic x(04).
            15  filler                          pic x(03) value " / ".
            15  err-msg-doc-spec-cd-2           pic x(04).
            15  filler                          pic x(03) value " / ".
            15  err-msg-doc-spec-cd-3           pic x(04).
            15  filler                          pic x(47)  value spaces.
* #6
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(56)  value
                "**ERROR** - INVALID CLINIC ID: BATCH CONTAINED CLINIC - ".
            15  err-msg-clinic-id               pic x(10).
            15  filler                          pic x(52)  value spaces.
* #7
        10  filler                              pic x(132) value
                "**ERROR** - FIRST RECORD FOUND IN FILE WAS NOT A 'B'ATCH RECORD
* #8
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(40)  value
                "INVALID OMA CODE - ACCOUNTING NBR = ".
            15  err-accounting-nbr              pic x(10).
            15  filler                          pic x(68).
* #9
        10  filler                              pic x(132) value
                "              DUPLICATE ACCOUNT ID FOUND IN SUSPENSE (HEADER) F
* #10
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(40)  value
                "INVALID WRITE NEW CLAIMS HDR - 'B' KEY=".
            15  bkey-clmhdr-err-msg             pic x(20)  value spaces.
            15  filler                          pic x(58)  value spaces.
* #11
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(40)  value
                "INVALID WRITE NEW CLAIMS HDR -'P' KEY = ".
            15  pkey-clm-err-msg                pic x(20)  value spaces.
            15  filler                          pic x(58)  value spaces.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  60
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
* #12
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(54)  value
                "INVALID REFERRING PHYSICIAN: BATCH CONTAINED CLINIC - ".
            15  err-refer-phys-nbr              pic x(6).
            15  filler                          pic x(58).
* #13
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(51)  value
                "INVALID PATIENT OHIP NBR: BATCH CONTAINED CLINIC - ".
            15  err-ohip-no                     pic x(08).
            15  filler                          pic x(59).
* #14
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(51)  value
                "INVALID DIAG CODE: ".
            15  err-diag-code                   pic x(03).
            15  filler                          pic x(64).
* #15
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(51)  value
                "INVALID I-O-INDICATOR: ".
            15  err-i-o-ind                     pic x(01).
            15  filler                          pic x(66).
* #16
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(92)  value
                "NBR OF HEADER1 RECORDS READ IS NOT =  NBR OF HEADER1 RECORDS FR
            15  err-ctr-h-count                 pic 99999.
            15  filler                          pic x(1)  value "/".
            15  err-trl-h-count                 pic 99999.
            15  filler                          pic x(15).
* #17
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(92)  value
                "NBR OF ITEM RECORDS READ IS NOT =  NBR OF ITEM RECORDS FROM TRA
            15  err-ctr-t-count                 pic 99999.
            15  filler                          pic x(1)  value "/".
            15  err-trl-t-count                 pic 99999.
            15  filler                          pic x(15).
* #18
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(92)  value
                "NBR OF ADDRESS RECORDS IS NOT =  NBR OF ADDRESS RECORDS FROM TR
            15  err-ctr-a-count                 pic 99999.
            15  filler                          pic x(1)  value "/".
            15  err-trl-a-count                 pic 99999.
            15  filler                          pic x(15).
* #19
        10  filler.
            15  filler                          pic x(14)  value spaces.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  61
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
            15  filler                          pic x(92)  value
                "NBR OF BATCH RECORDS READ IS NOT =  NBR OF BATCH RECORDS FROM T
            15  err-ctr-b-count                 pic 99999.
            15  filler                          pic x(1)  value "/".
            15  err-trl-b-count                 pic 99999.
            15  filler                          pic x(15).
* #20
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(51)  value
                "INVALID AGENT CODE:    ".
            15  err-agent-cd                    pic x(01).
            15  filler                          pic x(66).
* #21
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(20)  value
                "DOCTOR SPECIALITY: ".
            15  err-21-value-1                  pic x(02).
            15  filler                          pic x(27)  value
                "  NOT VALID FOR OHIP CODE: ".
            15  err-21-value-2                  pic x(04).
            15  filler                          pic x(33)  value
                " RANGE: ".
            15  err-21-value-3                  pic x(02).
            15  filler                          pic x(06)  value
                " THRU ".
            15  err-21-value-4                  pic x(02).
            15  filler                          pic x(22).
* #22
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(10) value
                "OMA CODE: ".
            15  err-22-oma-cd                   pic x(04).
            15  filler                          pic x(14) value
                "  REQUIRES -  ".
            15  err-22-msg                      pic x(90).
* #23
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(51)  value
                "INVALID HOSPITAL NBR: ".
            15  err-hosp-nbr                    pic x(04).
            15  filler                          pic x(63).
* #24
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(45)  value
* 2013/07/10 - MC27
*                "SERVICE NOT WITHIN 6 MONTHS OF SYSTEM DATE:".
* MC42/MC47
*                "SERVICE NOT WITHIN 7 MONTHS OF SYSTEM DATE:".
                "SERVICE NOT WITHIN 231 days OF SYSTEM DATE:".
* MC42/MC47 - end
* 2013/07/10 - end
            15  err-24-service-date             pic x(08).
*           15  filler                          pic x(67).
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  62
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
            15  filler                          pic x(65).
* #25
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)  value
                "DIRECT BILL CLAIM MISSING - MSG / AUTO LOGOUT / FEE COMPLEXITY
* #26
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(22)  value
                "INVALID -ADMIT- DATE: ".
            15  err-admit-date                  pic x(08).
*           15  filler                          pic x(90).
            15  filler                          pic x(88).
* #27
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(32)  value
                "INVALID INITIAL SERVICE DATE:".
            15  err-27-service-date             pic x(08).
*           15  filler                          pic x(80).
            15  filler                          pic x(78).
* #28
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(42)  value
                "INVALID CONSECUTIVE SERVICES DATES/SVC'S:".
            15  err-additional-servs            pic x(09).
            15  filler                          pic x(67).
* #29
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(25)  value
                "INVALID HEALTH CARE NBR:".
            15  err-health-care-nbr             pic x(10).
            15  filler                          pic x(83).
* #30
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(18)  value
                "INVALID PROVINCE:".
            15  err-province                    pic x(02).
            15  filler                          pic x(98).
* #31
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(27)  value
                "INVALID MANUAL REVIEW: ".
            15  err-manual-review               pic x.
            15  filler                          pic x(90).
* #32
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(54)  value
                "INVALID DEPT NO:  BATCH CONTAINED DEPT NO - ".
            15  err-msg-batch-dept-no           pic x(02).
            15  filler                          pic x(62)  value spaces.
* #33
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  63
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
        10 filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(53)  value
                "                  DOCTOR'S DEPT NO          - ".
            15  err-msg-doc-dept-no             pic x(02).
            15  filler                          pic x(63)  value spaces.
* #34
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(92)  value
                "NBR OF HEADER2 RECORDS READ IS NOT =  NBR OF HEADER2 RECORDS FR
            15  err-ctr-r-count                 pic 99999.
            15  filler                          pic x(1)  value "/".
            15  err-trl-r-count                 pic 99999.
            15  filler                          pic x(15).

* #35
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(53)  value
                "INVALID PROVIDER NO:  BATCH CONTAINED PROVIDER NO - ".
            15  err-msg-batch-prov-nbr          pic x(06).
            15  filler                          pic x(59)  value spaces.
* #36
        10 filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(53)  value
                "                  DOCTOR'S PROVIDER NO      - ".
            15  err-msg-doc-prov-nbr            pic x(06).
            15  filler                          pic x(59)  value spaces.
* #37
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(22)  value
                "INVALID BIRTH DATE:".
            15  err-birth-date                  pic x(08).
*           15  filler                          pic x(90).
            15  filler                          pic x(88).
* #38
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(28)  value
                "ZERO NUMBER OF SERVICE".
            15  err-nbr-of-serv                 pic x(4).
            15  filler                          pic x(86).
* #39
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(28)  value
                "ZERO AMOUNT BILLED".
*mf         15  err-fee-billed                  pic x(12).
            15  err-fee-billed                  pic 9(12).
            15  filler                          pic x(78).
* #40
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(48)  value
**              "INVALID SIZE OF OHIP NBR".
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  64
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
                "INVALID SIZE OF HEALTH CARE NBR - Province/Nbr: ".
            15  err-prov                        pic x(2).
            15  filler                          pic x(3)   value
                " / ".
            15  err-ohip-nbr                    pic x(12).
            15  filler                          pic x(53).
* #41 @@ USE
        10  filler                              pic x(132)  value
                "CONSTANTS MSTR REC 'LOCKED' -- INFORM OPERATIONS OF PROBLEM".
* #42  @@ USE
        10  filler                              pic x(132)  value
                "SERIOUS ERROR #10 - UNABLE TO READ CONSTANT MSTR REC #2 ".
* #43
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(53)  value
                "INVALID GROUP NBR: BATCH CONTAINED GROUP NBR - ".
            15  err-msg-group-nbr               pic x(06).
            15  filler                          pic x(59)  value spaces.
* #44
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(15)  value
                "SERVICE DATE: ".
            15  err-44-service-date             pic x(08).
            15  filler                          pic x(27)  value
                "IS PRIOR TO ADMIT DATE:".
            15  err-44-admit-date               pic x(08).
*           15  filler                          pic x(64).
            15  filler                          pic x(60).
* #45
        10  filler                              pic x(132)  value
                "SERIOUS ERROR #11 - UNABLE TO READ CONSTANT MSTR REC #1 ".
* #46
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(27)  value
                "INVALID RELATIONSHIP: ".
            15  err-relationship                pic x.
            15  filler                          pic x(90).
*** S.B.- start.
* #47
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(23)  value
                "   REFERRING DOCTOR: - ".
                15  err-msg-referring-doc               pic x(06).
            15  filler                                  pic x(37)  value
                " AND PROVIDER DOCTOR ARE THE SAME: - ".
            15  err-msg-provider-doc            pic x(06).
            15  filler                          pic x(46)  value spaces.

* #48
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(22)  value
                "      SERVICE DATE: - ".
            15  err-msg-svr-date                pic x(08).
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  65
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
              15  filler                        pic x(32)  value
                    " IS GREATER THAN SYSTEM DATE: - ".
                15  err-msg-sys-date            pic x(08).
            15  filler                          pic x(48)  value spaces.
* #49
        10  filler.
            15  filler                          pic x(10)  value spaces.
            15  filler                          pic x(18) value
                "OMA CODE I/O IND: ".
            15  err-49-oma-cd                   pic x(04).
            15  filler                          pic x(38) value
                " DOES NOT MATCH CLMHDR-2 REC I/O IND: ".
            15  err-49-hdr-cd                   pic x(04).
            15  filler                          pic x(58).

* #50
        10  filler.
            15  filler                          pic x(12)  value spaces.
            15  filler                          pic x(36)  value
                " MISSING DETAIL RECORDS FOR CLAIM: ".
            15  err-no-detail-claim             pic x(08).
            15  filler                          pic x(76)  value spaces.
* #51
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(61)  value
                "INVALID LOCATION CODE: BATCH CONTAINED LOCATION - ".
            15  err-51-loc-cd                   pic x(04).
            15  filler                          pic x(53).
* #52
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(35)  value
                "Incoming fee not = RMA priced fee  ".
            15  err-52-incoming-fee             pic zzz9.99.
            15  filler                          pic x(3)  value " / ".
            15  err-52-ohip-fee                 pic zzz9.99.
            15  filler                          pic x(66).

* #53
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(40)  value
                "Incoming I/O ind not = RMA I/O ind ".
            15  err-53-incoming-i-o-ind         pic x.
            15  filler                          pic x(3)  value " / ".
            15  err-53-i-o-ind                  pic x.
            15  filler                          pic x(73).
* 2002/06/12 - MC - add error 54
* #54
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(40)  value
                "Require facility number with premium cd ".
            15  filler                          pic x(3)  value " / ".
            15  err-54-prem-code                pic x(4).
            15  filler                          pic x(71).
* 2002/06/12 - end
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  66
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)

* 2002/08/21 - MC - add error 55
* #55
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(40)  value
                "Wrong hospital number with premium cd ".
            15  filler                          pic x(3)  value " / ".
            15  err-55-hosp-code                pic x(4).
            15  filler                          pic x(3)  value " / ".
            15  err-55-prem-code                pic x(4).
            15  filler                          pic x(64).
* 2002/06/12 - end

* 2003/06/11 - MC - add error 56
* #56
        10  filler.
            15  filler                          pic x(14)  value spaces.
* 2004/01/20 - MC
*            15  filler                          pic x(40)  value
*               "Wrong location code - must end with 112".
            15  filler                          pic x(60)  value
* 2004/09/27 - MC
*                "Wrong location code - must end with 112/153/400/250/422".
* 2007/10/24 - MC - add 055 as well
*               "Wrong location code - must end with 112/153/400/250/422/401".
* 2007/11/22 - MC -add 326 as well - yas add 122 2008/01/03
*                "Wrong locn code - must end with 112/153/400/250/422/401/055".
             "Wrong locn cd- must with 112/153/400/250/422/401/055/326/122".
* 2007/11/22 - end
* 2007/10/24 - end
* 2004/09/27 - end

* 2008/02/19 - MC - add 344 to the list
            15 filler                           pic x(20) value
* 2008/02/28 - MC add 111 & 354
*               "/344      ".
* 2008/03/18 - MC add 333
*               "/344/111/354        ".
* 2008/10/22 - MC add 777
*               "/344/111/354/333    ".
                "/344/111/354/333/777".
* 2008/10/22 - end
* 2008/03/18 - end
* 2008/02/28 - end
* 2008/02/19 -end

* 2004/01/20 - end
            15  filler                          pic x(3)  value " / ".
            15  err-56-loc-code                 pic x(4).
            15  filler                          pic x(3)  value " / ".
            15  err-56-prem-code                pic x(4).
* 2004/01/20 - MC
*            15  filler                          pic x(64).
* 2008/02/19 - MC
*            15  filler                          pic x(44).
            15  filler                          pic x(24).
* 2008/02/19 - end
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  67
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)

* 2004/01/20 - end

* 2003/06/11 - end

* 2003/10/22 - MC - add error 57
* #57
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(56)  value
                "**ERROR** - INVALID CLINIC NBR FOR THE DOCTOR -         ".
            15  err-msg-doc-clinic              pic 9(2).
            15  filler                          pic x(60)  value spaces.
* 2003/10/22 - end

* 2004/04/07 - MC - add error 58
* #58
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(15)  value
                "ADMIT DATE: ".
            15  err-58-admit-date               pic x(08).
            15  filler                          pic x(27)  value
                "  IS PRIOR TO BIRTH DATE:".
            15  err-58-birth-date               pic x(08).
            15  filler                          pic x(60).
* 2004/04/07 - end

* 2005/03/03 - MC - add error 59 and 60
* #59
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(17)  value
                "Doc Specialty = ".
            15  err-59-doc-spec                 pic 99.
            15  filler                          pic x(17)  value
                ", Birth date =  ".
            15  err-59-birth-date               pic x(08).
            15  filler                          pic x(27)  value
                "  and age must be >= 60".
            15  filler                          pic x(47).

* #60
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(17)  value
                "Doc Specialty = ".
            15  err-60-doc-spec                 pic 99.
            15  filler                          pic x(17)  value
                ", Birth date =  ".
            15  err-60-birth-date               pic x(08).
* 2010/04/01 - MC4
*           15  filler                          pic x(27)  value
*                "  and age must be >= 75".
*           15  filler                          pic x(47).
            15  filler                          pic x(74)  value
                "  and age must be >= 65 with diagnostic code 290".
* 2010/04/01 - end
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  68
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
* 2005/03/03 - end

* 2005/05/04 - MC - add error 61 and 62
* #61
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(17)  value
                "Service Date  = ".
            15  err-61-serv-date                pic x(08).
            15  filler                          pic x(17)  value
                ", Birth date =  ".
            15  err-61-birth-date               pic x(08).
            15  filler                          pic x(68) value
                "  and service date must be > birth date".

* #62
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(17)  value
                "Location code = ".
            15  err-62-loc-code                 pic x(4).
            15  filler                          pic x(17)  value
                ", clinic nbr = ".
            15  err-62-clinic-nbr               pic 99.
            15  filler                          pic x(78)  value
* 2014/04/23
*               "  and wrong location for clinic 61 - 65".
                "  and wrong location for clinic 61 - 74".
* 2014/04/23 - end
* 2005/05/04 - end

* 2005/10/31 - MC - add message 63 and 64 and 65

* #63
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "Oma code = E420, check pricing".
* #64
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "doc nbr = 049 and oma code = Z425 - take out manual review".
* #65
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "check for E078 premium".
* 2005/10/31 - end


* 2006/12/13 - MC - add message 66 and 67 and 68

* #66
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "Check C122".
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  69
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
* #67
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "Check C123".
* #68
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "Check C124".
* 2006/12/13 - end

* 2008/04/23 - add msg 69 to 84
* #69
        10  filler.
            15  filler                          pic x(14)  value spaces.
* 2013/04/11 - MC25
*           15  filler                          pic x(118) value
*               "Check number of services for E add-on code".
            15  filler                          pic x(58) value
                "Check number of services for C suffix code".
            15  err-oma-cd                      pic x(4).
            15  err-oma-suff                    pic x.
            15  filler                          pic x(3) value ' / '.
            15  err-nbr-serv                    pic x(4).
            15  filler                          pic x(3) value ' / '.
            15  err-nbr-serv-incoming           pic x(4).
            15  filler                          pic x(38) value spaces.
* 2013/04/11 - end
* #70
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "E020C only allowed with E022C, E017C or E016C".
* #71
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "E719 only allowed with Z570".
* #72
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "E720 only allowed with Z571".
* #73  for edit 5
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
* 2011/11/23 - MC19
*               "E717 only allowed with Z555 or Z580".
                "E717 only allowed with specific colonsocopy codes".
* 2011/11/23 - end

* #74
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "E702 only allowed with specific codes".
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  70
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
* #75
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "G123 only allowed with G228".
* #76
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "G223 only allowed with G231".
* #77
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "G265 only allowed with G264".
* #78
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "G385 only allowed with G384".
* #79
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "G281 only allowed with G381".
* #80
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "Maximum number of services exceeded".
* #81
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "E793 only allowed with specific procedures".
* #82
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "P022 deleted as of 2008/02/01".
* #83
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
                "K120 deleted as of 2008/02/01".
* #84
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118) value
* 2011/08/22 - MC18
*               "A007 only allowed for specialty '00'".
                "A007 not allowed  for specialty '26'".
* 2011/08/22 - end

* 2009/05/06 - MC1 - add message 85 to 90
* #85
        10  filler.
            15  filler                          pic x(14)  value spaces.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  71
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
            15  filler                          pic x(118)       value
                "Check fee and services of E400".
* #86
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "Check fee and services of E401".
* #87
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "E798 allowed only with  Z400".
* #88
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "Check fee of E409/E410".
* #89
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "Use General Listing code with special visit premium".
* #90
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "E450 may only be billed with J315".
* 2009/05/06 - end

* 2010/03/31 - MC4 - more edit checks as requested by Yasemin
* #91
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "G222 not allowed with G248, G125, G118 or G062".
* #92 - edit 21
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
* 2011/11/23 - MC19 - include A075
*               "A770 or A775 not allowed with special visit premium".
* MC43+MC48 - exclude A770 and A075
*                "A770 or A775 or A075 not allowed with special visit premium".
                "A775 not allowed with special visit premium".
* MC43+MC48 - end
* 2011/11/23 - end
* #93
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "Z432C deleted as of 2009/10/01".
* #94
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "H112 / H113 not allowed with another 'H' code".
* #95
        10  filler.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  72
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "Patient is underage for G489 / S323".
* #96
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "G222, Z804 or Z805 not allowed with P014C or P016C".
* #97
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
* 2010/09/21 - MC8
*                "H prefixed codes must be agent 2 in clinic 22".
* 2010/12/08 - MC11
*                "H prefixed codes must be agent 2 or 9 in clinic 22".
                "H prefixed E.R. codes must be agent 2 or 9 in clinic 22".
* 2010/12/08 - end
* 2010/09/21 - end
* #98
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
* 2001/05/18 - MC5 - change message
*                "G221 not allowed with G220".
                "G221 only allowed with G220".
* 2010/05/18 - end

* #99
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "Patient must be under 16 for service".
* #100
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "Patient is overage for H267".
* #101
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "Reassessment not allowed with resuscitation".
* #102
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "Assessment included in chemotherapy code".
* #103
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
* 2011/03/21 - MC13
*                "Check suffix on 'G' code".
                "Check suffix on 'G' code or premium code".
* 2011/03/31 - end

* #104
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  73
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "Patient must be 16 and under".
* 2010/03/31 - end

* 2011/04/06 - MC13 - add message 105 to 117
* #105
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "J021 and J022 should be at 50% with J025".
* #106
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                "Referring doctor must be an optometrist".
* #107
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Referral must be a midwife".
* #108
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Referring doctor cannot be an optometrist".
* #109
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Z611 or Z602 not allowed with Z608".
* #110
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Z176 or Z154 must have manual review".
* #111
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Z175 - Z192 must have manual review".
* #112
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Z403 with Z408 must have manual review".
* #113
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "A195 with K002 requires manual review with times of each servi
* #114
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Add E083 to MRP code".
* #115
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  74
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "E083 only allowed with specific codes".
* #116
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Clarification required to add J021".
* #117
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Echo needs admit date for in-patient".
* 2011/04/06 - end
* 2011/05/18 - MC15 - add message 118 to 119
* #118
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Oma code suffix  / SLI  does not have admit date".
* #119
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Oma code suffix  / SLI  does not require admit date".

* 2011/11/23 - MC19 - add message 120 to 122 for new edits 52 to 63
* #120 - edit 52
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Patient is overage for service".
* #121 - edit 53
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "K189 only allowed with specific codes".
* #122 - edit 54 to 63
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Travel Premium billed incorrectly".
* #123 - edit 64
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Check fee and services for E676B".
* 2011/11/23 - end

* 2013/04/11 - MC25 - add for edit 66 to 69
* #124 - edit 66
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "Canot use time units calculator for counselling".
* #125 - edit 67
        10  filler.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  75
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "G556 only allowed with Day 1 per diem".
* #126 - edit 68
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                 "A120 only allowed with colonscopy codes".
* #127 - edit 69
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
* MC43+MC48 - reuse for new edit 69
*                 "Referral cannot be a midwife".
                  "E402 or E403 only allowed with G247".
* MC43+MC48 - end

* 2013/04/11 - end
* 2014/09/08 - MC35/MC40
* #128
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(45)  value
                "DOCTOR HAS BEEN TERMINATED + 6 MONTHS :".
            15  err-128-term-date               pic x(08).
            15  filler                          pic x(65).
* 2014/09/08 - end

* 2015/01/20 - MC37
* #129
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(60)  value
                "**FATAL ERROR** - INVALID REC TYPE - RECORD MISALIGNED:  ".
            15  err-rec-type                    pic x(3).
            15  filler                          pic x(55)  value spaces.
* MC37 - end
* 2015/03/05 - MC38
* #130
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(60)  value
                "LOCATION Code not currently active for data entry = ".
            15  err-130-loc-cd                  pic x(4).
            15  filler                          pic x(54)  value spaces.
* MC38 - end

* MC43+MC48 - for edit 70 to 82
* #131 - edit 70
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                  "Services should be 2".
* #132 - edit 72
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                  "E797 allowed with specific colonoscopy codes only".
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  76
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
* #133 - edit 73
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                  "Requires manual review for E414".
* #134 - edit 74
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                  "Check G231/G223/Z228 for bilateral which requires manual revi
* #135 - edit 76
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                  "Assessment not allowed with P030".
* #136 - edit 77
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                  "A895 cannot be billed alone".
* #137 - edit 78
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                  "Z514 not allowed with Z512".
* #138 - edit 79
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                  "Z580 not allowed with other colonoscopy code".
* #139 - edit 80
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                  "Nerve block count exceeds 8".

* #140 - edit 81
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                  "Use A070 for consultation with special visit premium".
* #141 - edit 82
        10  filler.
            15  filler                          pic x(14)  value spaces.
            15  filler                          pic x(118)       value
                  "Process as bill direct, or change clinic to proper OHIP clini
* MC43+MC48 - end


    05  error-messages-r redefines error-messages.
        10  err-msg                             pic x(132)
                    occurs 141 times.


* 2011/06/13 - end

* 2010/03/31 - MC4
*01  err-ind                                     pic 99  value zero.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  77
*                      newu701.cbl                                   )
01  err-ind                                     pic 999  value zero.
* 2010/03/31 - end

01  err-msg-comment                             pic x(132).
01  save-prt-line                               pic x(132).


01  e1-error-line.

    05  e1-error-word                           pic x(11)   value
                        "*** ERROR- ".
    05  e1-error-msg                            pic x(52).
    05  e1-error-key                            pic x(17).



screen section.

01  scr-title.
    05  blank screen.
    05  line 03 col 10 value "Price claims/create Priced File/Upload to Suspense

01 scr-current-system-date.
    05  line 05 col 05 value "Current System Date".
    05  line 05 col 70 pic 99999999 using sys-date.

01 scr-claim-source-default-reply.
    05  line 07 col 05 value "Enter Claim SOURCE - 'W'eb / 'D'iskette / 'P'rice
    05  line 07 col 70 pic x(01) using flag-claim-source auto.

01 scr-update-suspense-reply.
    05  line 11 col 05 value "Do you want to upload claims to Suspense- [Y]/N ?"
    05  line 11 col 70 pic x(01) using flag-update-suspense auto.

01 scr-create-priced-file-reply.
    05  line 12 col 05 value "Do you want to create Priced File         [Y]/N ?"
    05  line 12 col 70 pic x(01) using flag-create-priced-file auto.

01 scr-retain-prices-reply.
    05  line 14 col 05 value "Do you want to RETAIN Incoming prices- [Y]/N ?".
    05  line 14 col 70 pic x(01) using flag-retain-prices auto.

01 scr-agent-default-reply.
    05  line 16 col 05 value "Do you want to default 'BLANK' AGENT Codes to 'OHI
    05  line 16 col 70 pic x(01) using ws-agent-default-reply auto.

01  scr-doc-nbr.
    05  line 15 col 05 value "Enter the DOCTOR NBR or press 'newline' to default
*!    05  line 15 col 66 pic 9(3) using ws-doc-nbr auto.
    05  line 15 col 66 pic x(3) using ws-doc-nbr auto.

01  scr-clinic-nbr.
    05  line 17 col 05 value "Enter the CLINIC NBR or press 'newline' to default
    05  line 17 col 68 pic 9(2) using ws-default-clinic-nbr auto.

* ('dummy' field added to allow compile of common code shared between
*  this pgm and d001)
01  scr-last-claim-lit.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  78
*                      newu701.cbl                                   )
    05                          line 03 col 65 value 'Nbr of Svc'.

01  scr-in-progress-message.
    05  line 19 col 20 value "PROGRAM  NEWU701  NOW IN PROGRESS".

01 file-status-display.
    05  line 24 col 56  "FILE STATUS = ".
    05  line 24 col 70  pic x(11) from status-file      bell blink.
*
01  scr-closing-screen.
    05  blank screen.
    05  line 21 col 01  value "PROGRAM NEWU701 ENDING".
* (y2k - auto fix)
*   05  line 21 col 40  pic 99  from sys-yy.
    05  line 21 col 40  pic 9(4)  from sys-yy.
    05  line 21 col 44  value "/".
    05  line 21 col 45  pic 99  from sys-mm.
    05  line 21 col 47  value "/".
    05  line 21 col 48  pic 99  from sys-dd.
    05  line 21 col 52  pic 99  from sys-hrs.
    05  line 21 col 54  value ":".
    05  line 21 col 55  pic 99  from sys-min.
    05  line 23 col 10  value "AUDIT REPORT IS IN FILE - RU701".

procedure division.
declaratives.

err-input-diskette-file section.
    use after standard error procedure on unpriced-claims-file.
err-input-diskette.
    stop "ERROR IN ACCESSING: dISKETTE INPUT FILE".
    move status-unpriced-claims         to status-file.
    display file-status-display.
*    stop " ".
    move status-cobol-unpriced-claims   to status-file.
    display file-status-display.
    stop run.

err-suspend-hdr-file section.
    use after standard error procedure on suspend-hdr.
err-suspend-hdr.
*   (IF DUPLICATE KEY ERROR, THEN SET FLAG TO SKIP PROCESSING OF THIS HEADER)
*   (NOTE: 90/01/14 B.E. LOGIC WILL BYPASS WRITING OF HEADER BUT HAS BEEN MODIFI
*          SO THAT THE DETAILS FOR THIS HEADER WILL BE PROCESSED AND THEREFORE
*          WILL BECOME DETAILS FOR THE HEADER ALREADY ON FILE. MESSAGE ON WARNIN
*          REPORT SHOULD ALERT STAFF TO REVIEW CLAIM TO CONFIRM THAT THESE
*          HEADERS ARE FOR SAME PATIENT.  THE ORIGINAL CLAIM HEADER ON FILE WILL
*          HAVE IT'S CLAIM STATUS SET TO "CANCEL (IE.'Y') SO THAT IT WON'T
*          BE PROCESSED UNLESS UNCANCELLED.  IT WILL ALSO APPEAR ON THE CANCELLE
*          SUSPENDED CLAIMS REPORTS)

*MC41
    display 'declarative status = ', status-suspend-hdr, ' cobol-status =  ', st
    stop ' '.
*MC41

    if   status-suspend-hdr       = "7013"
      or status-cobol-suspend-hdr = "22"
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  79
*                      newu701.cbl                                   )
    then
        go to err-suspend-hdr-50.
*   endif

    stop "ERROR IN ACCESSING: SUSPEND-HEADER"
    move status-suspend-hdr     to status-file
    display file-status-display
*    stop " "
    move status-cobol-suspend-hdr       to status-file
    display file-status-display
    stop run.

err-suspend-hdr-50.
*   (SET FLAG TO INDICATE THAT HEADER IS BEING SKIPPED DUE TO DUPLICATE
*    KEY BUT THAT DETAILS ARE TO BE WRITTEN TO DISK)
    move "D"                            to      skip-process-this-acct-id-flag.
    move suspend-hdr-rec                to      hold-suspend-hdr-rec.
*   (READ ORIGINAL HDR REC)
    read suspend-hdr
        invalid key
          display  "SERIOUS IMPOSSIBLE ERROR #1 SUSPEND HDR FILE - KEY IS = ",su

*   (UPDATE ORIGINAL HEADER'S STATUS TO "CANCELLED"
    move "Y"                            to      clmhdr-status.

*   (REWRITE UPDATED RECORD)
    rewrite suspend-hdr-rec
        invalid key
           display "SERIOUS IMPOSSIBLE ERROR #2 SUSPEND HDR FILE - KEY IS = ",su
           stop run.
*MC41
    display 'declarative flag = ', skip-process-this-acct-id-flag, ', account =
    stop " ".
*MC41

*   (RESTORE THE SUSPEND HDR RECORD DATA)
    move hold-suspend-hdr-rec           to      suspend-hdr-rec.

err-suspend-hdr-99-exit.
    exit.



err-suspend-dtl-file section.
    use after standard error procedure on suspend-dtl.
err-suspend-dtl.
    stop "ERROR IN ACCESSING: SUSPEND-DETAIL".
    move status-suspend-dtl             to status-file.
    display file-status-display.
*    stop " ".
    move status-cobol-suspend-dtl       to status-file.
    display file-status-display.
    stop run.

* 2005/08/17 - MC - add suspend-desc
err-suspend-desc-file section.
    use after standard error procedure on suspend-desc.
err-suspend-desc.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  80
*                      newu701.cbl                                   )
    stop "ERROR IN ACCESSING: SUSPEND-DETAIL".
    move status-suspend-desc             to status-file.
    display file-status-display.
*    stop " ".
    move status-cobol-suspend-desc       to status-file.
    display file-status-display.
    stop run.
* 2005/08/17 - end


err-suspend-addr-file section.
    use after standard error procedure on suspend-address.
err-suspend-addr.
    stop "ERROR IN ACCESSING: SUSPEND-ADDRESS".
    move status-suspend-addr            to status-file.
    display file-status-display.
*    stop " ".
    move status-cobol-suspend-addr      to status-file.
    display file-status-display.
    stop run.

err-doc-mstr-file section.
    use after standard error procedure on doc-mstr.
err-doc-mstr.
    stop "ERROR IN ACCESSING: DOCTOR MASTER".
    move status-doc-mstr                to status-file.
    display file-status-display.
    stop run.


err-diagnostics-mstr-file section.
    use after standard error procedure on diag-mstr.
err-diagnostics-mstr.
    stop "ERROR IN ACCESSING: DIAGNOSTIC CODES MASTER".
    move status-diag-mstr               to status-file.
    display file-status-display.
    stop run.

err-constants-mstr-file section.
    use after standard error procedure on iconst-mstr.

err-constants-mstr.
*   (IF 'RECORD LOCKED' PRINT WARNING, SET FLAG SO THAT 'READ' WILL LOOP UNTIL R
    if status-iconst-mstr = "7015"
    then
*       (ERROR - WRITE REPORT AND SKIP BATCH)
        move "Y"                        to      fatal-error-flag
        move 2                          to      ws-carriage-ctrl
        move 41                         to      err-ind
        move ws-error-literal           to      err-warn-msg
        move batch-group-nbr            to      err-msg-clinic-id
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit
    else
        move status-iconst-mstr         to      status-file
        display  file-status-display
        display "ERROR IN ACCESSING CONSTANTS MASTER"
        stop run.
*   endif.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  81
*                      newu701.cbl                                   )


err-report-file section.
    use after standard error procedure on report-file.
err-report.
    stop "ERROR IN WRITING TO AUDIT REPORT: RU701".
    move status-report                  to status-file.
    display file-status-display.
    stop run.

end declaratives.

mainline section.

    perform aa0-initialization          thru aa0-99-exit.
    perform ab0-processing              thru ab0-99-exit
            until   eof-input-file
                 or fatal-error.
    perform az0-finalization            thru az0-99-exit.
    stop run.

aa0-initialization.

    display scr-title.

    accept sys-date             from date.
    perform y2k-default-sysdate         thru y2k-default-sysdate-exit.

*   (when testing the 'master claims batch' allow operator to override
*    system date)
    display scr-current-system-date.
    accept  scr-current-system-date.

    move sys-mm                 to   run-mm.
    move sys-dd                 to   run-dd.
    move sys-yy                 to   run-yy.
    move run-date               to   l1-run-date.

    accept sys-time             from time.
    move sys-hrs                to   run-hrs.
    move sys-min                to   run-min.
    move sys-sec                to   run-sec.

*!    move 0                    to   ws-doc-nbr.
    move spaces                 to   ws-doc-nbr.
*   MOVE 2215                   TO   WS-DEFAULT-CLINIC-NBR.
    move 22                     to   ws-default-clinic-nbr.


*   (predisplay all options on screen)
    display scr-claim-source-default-reply.
    display scr-retain-prices-reply.
    display scr-update-suspense-reply.
    display scr-create-priced-file-reply.
    display scr-agent-default-reply.

aa0-05-default-claim-source.
    display scr-claim-source-default-reply.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  82
*                      newu701.cbl                                   )
    accept  scr-claim-source-default-reply.

    if   web-claim
      or diskette-claim
      or price-only-claim
    then
        next sentence
    else
        go to aa0-05-default-claim-source.
*   endif

aa0-07-retain-prices.
*   (prices are normally overridden, even for diskettes, however some
*    diskettes don't send a "complete" claim under 1 accounting number
*    (eg. PNP allows only 4 details per accounting number) and therefore
*   this program can't reprice the claim. This flag allows the operator
*   to turn on/off the repricing option. Web claim are automatically
*   "repriced")

*   CASE
    if web-claim
    then
        move "N"                        to flag-retain-prices
        go to aa0-09-update-suspense
    else
    if price-only-claim
    then
        move "N"                        to flag-retain-prices
        go to aa0-09-update-suspense.
*   ENDCASE

*   (default for diskettes is to retain prices)
    move "Y"                            to flag-retain-prices.
    accept  scr-retain-prices-reply.
    if    retain-incoming-prices
       or override-with-rma-prices
    then
        next sentence
    else
        go to aa0-07-retain-prices.
*   endif

aa0-09-update-suspense.
    display scr-retain-prices-reply.

*   CASE
    if web-claim
    then
        move "Y"                        to flag-update-suspense
        go to aa0-10-create-priced-file
    else
    if price-only-claim
    then
        move "N"                        to flag-update-suspense
        go to aa0-10-create-priced-file.
*   ENDCASE

*   (default for diskettes is to retain prices)
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  83
*                      newu701.cbl                                   )
    move "Y"                            to flag-update-suspense.
    accept  scr-update-suspense-reply.
    if    update-suspense
       or dont-update-suspense
    then
        next sentence
    else
        go to aa0-09-update-suspense.
*   endif

aa0-10-create-priced-file.
    display scr-update-suspense-reply.

*   CASE
    if web-claim
    then
        move "Y"                        to flag-create-priced-file
        go to aa0-20-default-agent
    else
    if price-only-claim
    then
        move "Y"                        to flag-create-priced-file
        go to aa0-20-default-agent.
*   ENDCASE

*   (default for diskettes is to retain prices)
    move "Y"                            to flag-create-priced-file
    accept  scr-create-priced-file-reply.
    if    create-priced-file
       or dont-create-priced-file
    then
        next sentence
    else
        go to aa0-10-create-priced-file.
*   endif


aa0-20-default-agent.
    display scr-create-priced-file-reply.

*   (00/mar/27 B.E. removed option - no longer required)
    move "Y"                    to  ws-agent-default-reply.
    display scr-agent-default-reply.
*    accept  scr-agent-default-reply.

    if ws-agent-default-reply = "Y" or "N"
    then
        next sentence
    else
        go to aa0-20-default-agent.
*   endif

*   (00/mar/27 B.E. removed option - no longer required)
    display scr-doc-nbr.
*    accept  scr-doc-nbr.

*   (00/mar/27 B.E. removed option - no longer required)
    display scr-clinic-nbr.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  84
*                      newu701.cbl                                   )
*    accept  scr-clinic-nbr.

    display scr-in-progress-message.

    move spaces to suspend-hdr-rec
                   suspend-dtl-rec
                   suspend-address-rec.

    move zero   to suspend-dtl-occur
                   ws-temp
                   counters.

    open input  unpriced-claims-file
                loc-mstr
                doc-mstr
                diag-mstr
                oma-fee-mstr
* 2011/05/18 - MC15
                sli-oma-code-suff-mstr
* 2011/05/18 - end
                iconst-mstr.

    open i-o    suspend-hdr
                suspend-dtl
                suspend-desc
                suspend-address.

*    expunge     report-file
*                priced-claims-file.
    open output report-file
* 2010/05/19 - MC6
                ru701-work-file
* 2010/05/19 - end
                priced-claims-file.

    move spaces                         to      hold-oma-recs.
    perform aa1-init-hold-oma-rec      thru    aa1-99-exit
                varying i
                from    1
                by      1
                until   i  > ss-max-nbr-oma-det-rec-allow.
*               until   i  > 40.

*   (OBTAIN CONSTANT'S MSTR RECORD THAT CONTAINS LIST OF VALID CLINIC NBR)
    move 1                          to      iconst-clinic-nbr-1-2.
    perform uj1-read-isam-const-mstr thru   uj1-99-exit.

*   (CHECK FOR ERRORS - SHUT DOWN)
    if fatal-error
    then
*       (ERROR - WRITE REPORT AND SKIP BATCH)
        move "Y"                        to      fatal-error-flag
        move 2                          to      ws-carriage-ctrl
        move 45                         to      err-ind
        move ws-error-literal           to      err-warn-msg
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit
        go to aa0-99-exit
    else
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  85
*                      newu701.cbl                                   )
*       (MOVE CONSTANT'S MSTR VALUES INTO HOLD AREA TO BE USED LATER TO VERIFY C
        move constants-mstr-rec-2       to      constants-mstr-rec-1.
*   endif

*   (OBTAIN PRICING CONSTANT'S VALUES FROM REC 2 OF CONSTANTS MASTER)
    move 2                          to      iconst-clinic-nbr-1-2.
    perform uj1-read-isam-const-mstr thru   uj1-99-exit.

*   (CHECK FOR ERRORS - SHUT DOWN)
    if fatal-error
    then
*       (ERROR - WRITE REPORT AND SKIP BATCH)
        move "Y"                        to      fatal-error-flag
        move 2                          to      ws-carriage-ctrl
        move 42                         to      err-ind
        move ws-error-literal           to      err-warn-msg
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit
        go to aa0-99-exit.
*   endif

    perform ta0-read-diskette                   thru ta0-99-exit.

*   (FIRST RECORD MUST BE "B"ATCH RECORD)
    if b-record
    then
        add 1                           to      ctr-b-recs-read
*       MOVE DISKETTE-INPUT-REC-DATA    TO      BATCH-REC
        perform ea0-proc-rec-type-batch thru    ea0-99-exit
*       (CHECK FOR ERRORS - SHUT DOWN)
        if fatal-error
        then
           go to aa0-99-exit
        else
*           (READ RECORD AFTER 'B' RECORD)
            perform ta0-read-diskette   thru    ta0-99-exit
*       endif
    else
*       (ERROR - FIRST RECORD NOT "B"ATCH RECORD)
        move "Y"                        to      fatal-error-flag
        move 2                          to      ws-carriage-ctrl
        move 7                          to      err-ind
        move ws-error-literal           to      err-warn-msg
        perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*       GO TO AA0-99-EXIT.
*   endif
*   (INITIALIZE SUBSCRIPT FOR PRICING HOLD AREA)
    move 0                              to      ss-clmdtl-oma.
*   (00/aug/13 B.E. - reset special add-on code flag)
    move "N"                            to      ws-special-add-on-cd-entered.

*2011/05/18 - MC15
copy "d001_newu701_oma_code_variables_reset.rtn".
* d001_newu701_oma_code_variables_reset.rtn - use in d001 & newu701 & u701oscar

* 2005/11/01 - MC - reset e078-premium flag
    move "N"                            to      ws-e078-premium.
* 2005/11/01 - end
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  86
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)

* 2008/04/28 - MC - reset flags
    move "N"   to    ws-e020.
    move "N"   to    ws-e719.
    move "N"   to    ws-e720.
    move "N"   to    ws-e717.
    move "N"   to    ws-e702.
    move "N"   to    ws-g123.
    move "N"   to    ws-g223.
    move "N"   to    ws-g265.
    move "N"   to    ws-g385.
    move "N"   to    ws-g281.
    move "N"   to    ws-e793.
    move "N"   to    ws-e022-e017-e016.
    move "N"   to    ws-z570.
    move "N"   to    ws-z571.
    move "N"   to    ws-z555-z580.
    move "N"   to    ws-z515-z760.
    move "N"   to    ws-g228.
    move "N"   to    ws-g231.
    move "N"   to    ws-g264.
    move "N"   to    ws-g384.
    move "N"   to    ws-g381.
    move "N"   to    ws-r905-s800.
    move "N"   to    ws-annna.
    move "N"   to    ws-gnnna.
    move "N"   to    ws-k991-u997.

* 2008/04/28 - end

* 2009/05/06 - MC1
    move "N"   to      ws-c998.
    move "N"   to      ws-c999.
    move "N"   to      ws-e798.
    move "N"   to      ws-z400.
    move "N"   to      ws-g400-other-codes.
    move "N"   to      ws-e409-e410.
    move "N"   to      ws-c990-to-c997.
    move "N"   to      ws-cnnn.
    move "N"   to      ws-e450.
    move "N"   to      ws-j315.
* 2009/05/06 -end


* 2010/03/31 - MC4
    move "N"   to      ws-c985.
    move "N"   to      ws-g248-g062.
    move "N"   to      ws-g222.
    move "N"   to      ws-a770-a775.
    move "N"   to      ws-X9nn.
    move "N"   to      ws-h112-h113.
    move "N"   to      ws-hnnn.
    move "N"   to      ws-g489-s323.
    move "N"   to      ws-g222-z805.
    move "N"   to      ws-p014-p016.
    move "N"   to      ws-g221.
    move "N"   to      ws-g220.
    move "N"   to      ws-s322-a198.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  87
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
    move "N"   to      ws-a765-c765.
    move "N"   to      ws-g521-g395.
    move "N"   to      ws-h104-h124.
    move "N"   to      ws-g345-g339.
    move "N"   to      ws-g431-g479.
    move "N"   to      ws-gnnn.
    move "N"   to      ws-annn.
* 2010/03/31 - end

* 2011/03/31 - MC13
    move "N"   to       ws-c983.
    move "N"   to       ws-j025.
    move "N"   to       ws-j021.
    move "N"   to       ws-j022.
    move "N"   to       ws-z608.
    move "N"   to       ws-z611-z602.
    move "N"   to       ws-z403.
    move "N"   to       ws-z408.
    move "N"   to       ws-a195.
    move "N"   to       ws-k002.
    move "N"   to       ws-c122-c143.
    move "N"   to       ws-e083.
    move "N"   to       ws-c122-c982.
    move "N"   to       ws-g489-g376.
* 2011/03/31 - end


* 2011/11/23 - MC19+MC22
    move "N"   to       ws-a197-a198.
    move "N"   to       ws-k189.
    move "N"   to       ws-a190-a795.
    move "N"   to       ws-k960.
    move "N"   to       ws-k990.
    move "N"   to       ws-k961.
    move "N"   to       ws-k992.
    move "N"   to       ws-k962.
    move "N"   to       ws-k994.
    move "N"   to       ws-k963.
    move "N"   to       ws-k998.
    move "N"   to       ws-k964.
    move "N"   to       ws-k996.
    move "N"   to       ws-c960.
    move "N"   to       ws-c990.
    move "N"   to       ws-c961.
    move "N"   to       ws-c992.
    move "N"   to       ws-c962.
    move "N"   to       ws-c994.
    move "N"   to       ws-c963.
    move "N"   to       ws-c986.
    move "N"   to       ws-c964.
    move "N"   to       ws-c996.
    move "N"   to       ws-e676.
* 2011/11/23 - end


* 2013/04/11- MC28
    move "N"   to      ws-g556.
    move "N"   to      ws-g400-g620.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  88
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
    move "N"   to      ws-a120.
    move "N"   to      ws-z491-to-z499.
* 2013/04/11 - end

* MC46+MC43+MC48
    move "N"   to       ws-g325.
    move "N"   to       ws-e402-e403.
    move "N"   to       ws-g247.
    move "N"   to       ws-e797.
    move "N"   to       ws-z491-z580.
    move "N"   to       ws-e414.
    move "N"   to       ws-p030.
    move "N"   to       ws-a895.
    move "N"   to       ws-wnnn.
    move "N"   to       ws-knnn.
    move "N"   to       ws-z512.
    move "N"   to       ws-z514.
    move "N"   to       ws-z580.
    move "N"   to       ws-cnnn-c101.
    move  0    to       ws-total-nbr-svc.
    move "N"   to       ws-edit-80.
    move "N"   to       ws-a075.

* MC46+MC43+MC48 - end



* 2010/09/23 - MC9
   move 0                to ws-sv-date-c1
                            ws-sv-date-c2.
* 2010/09/23 - end

    move carriage-return                to      diskout-cr.
    move line-feed                      to      diskout-lf.

aa0-99-exit.
    exit.

aa1-init-hold-oma-rec.

    move zeros          to  hold-sv-nbr-serv(i).
    move zeros          to  hold-sv-date-yy(i).
    move zeros          to  hold-sv-date-mm(i).
    move zeros          to  hold-sv-date-dd(i).
    move zeros          to  hold-icc-grp(i).
    move zeros          to  hold-fee-incoming(i).

*   (00/aug/31 B.E.)
    move zeros          to  hold-sv-nbr-serv-incoming(i).

*   (00/aug/10 B.E.)
    move zeros          to  hold-ss-curr-prev(i).

    move zeros          to  hold-fee-oma(i).
    move zeros          to  hold-fee-ohip(i).
    move zeros          to  hold-priced-tech(i).
    move zeros          to  hold-basic-tech(i).
    move zeros          to  hold-basic-prof(i).
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  89
*                      newu701.cbl                                   )
    move zeros          to  hold-basic-fee(i).
    move zeroes         to  hold-flag-sec(i).
    move zeroes         to  hold-flag-grp(i).
    move zeros          to  hold-diag-cd(i).
    move zeros          to  hold-line-no(i).

    perform aa2-init-oma-fees   thru aa2-99-exit
        varying ss1
        from    1
         by     1
        until   ss1 > 2.

    perform aa3-init-sv-nbr  thru aa3-99-exit
        varying ss1
        from    1
         by     1
        until   ss1 > 3.

aa1-99-exit.
    exit.


aa2-init-oma-fees.

    move zeroes to  hold-oma-fee-1(i,ss1).
    move zeroes to  hold-oma-fee-2(i,ss1).
    move zeroes to  hold-oma-fee-anae(i,ss1).
    move zeroes to  hold-oma-fee-asst(i,ss1).

aa2-99-exit.
    exit.

aa3-init-sv-nbr.

    move zeroes         to hold-sv-nbr(i,ss1).

aa3-99-exit.
    exit.





ab0-processing.

    if b-record
    then
        add 1                                   to      ctr-b-recs-read
        perform ea0-proc-rec-type-batch         thru    ea0-99-exit
    else
    if h-record
    then
        add 1                                   to      ctr-h-recs-read
        perform fa0-proc-rec-type-header1       thru    fa0-99-exit
    else
    if r-record
    then
        add 1                                   to      ctr-r-recs-read
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  90
*                      newu701.cbl                                   )
        move 1                                  to      ctr-hdr2-rec
        perform ga0-proc-rec-type-header2       thru    ga0-99-exit
    else
    if t-record
    then
        add 1                                   to      ctr-t-recs-read
        perform ha0-proc-rec-type-detail        thru    ha0-99-exit
    else
    if a-record
    then
        add 1                                   to      ctr-a-recs-read
        move 1                                  to      ctr-addr-rec
        perform ia0-proc-rec-type-address       thru    ia0-99-exit
    else
    if e-record
    then
        add 1                                   to      ctr-e-recs-read
* MC37
*       perform ka0-proc-rec-type-trailer       thru    ka0-99-exit.
        perform ka0-proc-rec-type-trailer       thru    ka0-99-exit
* fatal error - possibly record is not aligned
    else
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move "Y"                        to      fatal-error-flag
        move 129                        to      err-ind
        move hold-in-rec-type           to      err-rec-type
        perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
        go to ab0-99-exit.

* MC37 - end
*   endif

*   (IF ERROR FOUND PROCESSING THIS RECORD, SKIP PROCESSING ANY DTL/ADDR RECS TH
*    BELONG TO SAME ACCOUNT ID:
*    -- SKIP ALL INTERVEENING DETAIL AND ADDRESS RECORDS UNTIL ANOTHER HEADER (H
*    RECORD OR TRAILER (E) RECORD IS FOUND OR END OF INPUT FILE)
    if skip-processing-this-acct-id
    then
        move spaces                             to      unpriced-claims-record
        perform ta0-read-diskette               thru    ta0-99-exit
            until  b-record
*                                           OR "E")
                 or eof-input-file
*       MOVE "N"                                TO      SKIP-PROCESSING-THIS-ACC
*       GO TO AB0-99-EXIT
    else
        if not eof-input-file
             perform ta0-read-diskette               thru    ta0-99-exit.
*       endif
*   endif

ab0-99-exit.
    exit.
az0-finalization.

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  91
*                      newu701.cbl                                   )
   close unpriced-claims-file
         priced-claims-file
         suspend-hdr
         suspend-dtl
         suspend-address
         suspend-desc
         doc-mstr
         loc-mstr
         oma-fee-mstr
         diag-mstr
         iconst-mstr
* 2010/05/19 - MC6
         ru701-work-file

* 2011/05/18 - MC15
         sli-oma-code-suff-mstr
* 2011/05/18 - end
         report-file.

az0-99-exit.
    exit.

copy "db0_mod10_check_digit.rtn".
db0-mod10-check-digit.

    add  ws-chk-nbr-2
         ws-chk-nbr-4
         ws-chk-nbr-6                   giving ws-temp.

    add  ws-chk-nbr-1
         ws-chk-nbr-1                   giving ws-temp-2.
    add  ws-temp-2a
         ws-temp-2b                     to ws-temp.

    add  ws-chk-nbr-3
         ws-chk-nbr-3                   giving ws-temp-2.
    add  ws-temp-2a
         ws-temp-2b                     to ws-temp.

    add  ws-chk-nbr-5
         ws-chk-nbr-5                   giving ws-temp-2.
    add  ws-temp-2a
         ws-temp-2b                     to ws-temp.

    add  ws-chk-nbr-7
         ws-chk-nbr-7                   giving ws-temp-2.
    add  ws-temp-2a
         ws-temp-2b                     to ws-temp.

    divide   ws-temp    by  10          giving ws-temp-1.

    multiply ws-temp-1  by  10          giving ws-temp-1.

    subtract ws-temp-1                  from ws-temp.

    subtract ws-temp                    from 10
                                        giving ws-temp.

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  92
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/db0)
    if        ws-temp      = ws-chk-nbr-8
      or (    ws-temp      = 10
          and ws-chk-nbr-8 =  0 )
    then
        move "y"                        to flag
    else
        move "n"                        to flag.

db0-99-exit.
    exit.


copy "db0a_mod10_check_digit_10.rtn".
db0a-mod10-check-digit-10.

    add  ws-chk-nbr-2-10
         ws-chk-nbr-4-10
         ws-chk-nbr-6-10
         ws-chk-nbr-8-10                giving ws-temp-10.

    add  ws-chk-nbr-1-10
         ws-chk-nbr-1-10                giving ws-temp-2-10.
    add  ws-temp-2a-10
         ws-temp-2b-10                  to ws-temp-10.

    add  ws-chk-nbr-3-10
         ws-chk-nbr-3-10                giving ws-temp-2-10.
    add  ws-temp-2a-10
         ws-temp-2b-10                  to ws-temp-10.

    add  ws-chk-nbr-5-10
         ws-chk-nbr-5-10                giving ws-temp-2-10.
    add  ws-temp-2a-10
         ws-temp-2b-10                  to ws-temp-10.

    add  ws-chk-nbr-7-10
         ws-chk-nbr-7-10                giving ws-temp-2-10.
    add  ws-temp-2a-10
         ws-temp-2b-10                  to ws-temp-10.

    add  ws-chk-nbr-9-10
         ws-chk-nbr-9-10                giving ws-temp-2-10.
    add  ws-temp-2a-10
         ws-temp-2b-10                  to ws-temp-10.

    divide   ws-temp-10 by  10          giving ws-temp-1-10.

    multiply ws-temp-1-10 by 10         giving ws-temp-1-10.

    subtract ws-temp-1-10               from ws-temp-10.

    subtract ws-temp-10                 from 10
                                        giving ws-temp-10.

    if        ws-temp-10   = ws-chk-nbr-10-10
      or (    ws-temp-10   = 10
          and ws-chk-nbr-10-10 =  0 )
    then
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  93
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/db0)
        move "Y"                        to flag
    else
        move "N"                        to flag.

db0a-99-exit.
    exit.


copy "dc0_mod10_check_digit_alt.rtn".
dc0-mod10-check-digit-for-1-2.
* 00/dec/06 B.E. corrected bug whereby lowercase y/n were used instead of upper
* 01/feb/06 B.E. removed this code - force acceptance of all numbers.

    go to dc0-98-exit.

    move 0                              to ws-temp
                                           ws-temp-1
                                           ws-temp-2.

    add  ws-chk-nbr-2
         ws-chk-nbr-4
         ws-chk-nbr-6                   giving ws-temp.

    add  ws-chk-nbr-1
         ws-chk-nbr-1                   giving ws-temp-2.
    add  ws-temp-2a                     to ws-temp-1.
    add  ws-temp-2b                     to ws-temp.

    add  ws-chk-nbr-3
         ws-chk-nbr-3                   giving ws-temp-2.
    add  ws-temp-2a                     to ws-temp-1.
    add  ws-temp-2b                     to ws-temp.

    add  ws-chk-nbr-5
         ws-chk-nbr-5                   giving ws-temp-2.
    add  ws-temp-2a                     to ws-temp-1.
    add  ws-temp-2b                     to ws-temp.

    add  ws-chk-nbr-7
         ws-chk-nbr-7                   giving ws-temp-2.
    add  ws-temp-2a                     to ws-temp-1.
    add  ws-temp-2b                     to ws-temp.

    move ws-temp                        to ws-temp-2.
    add  ws-temp-2b                     to ws-temp-1.

    subtract ws-temp-1                  from 10
                                        giving ws-temp.

    if        ws-temp      = ws-chk-nbr-8
    then
        move "Y"                        to flag
    else
        move "N"                        to flag.
*   endif

dc0-98-exit.
    move "Y"                            to flag.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  94
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/dc0)

dc0-99-exit.
    exit.



ea0-proc-rec-type-batch.

*   (processing a new BATCH. If there were detail records in hold area
*    from the previous claim header rec then area process them - ie. price
*    them and write them out)
    perform xx0-process-hold-dtls       thru xx0-99-exit.

* 2012/04/23 - MC20 - reset field values
    move spaces                         to clmhdr-pat-acronym
                                           hdr-accounting-nbr
                                           hold-accounting-nbr.
* 2012/04/23 - end

*   (RE-SET TOTALS FOR THIS BATCH - NOTE THAT THIS ZEROING WILL ALSO
*    WIPE OUT THE COUNTER OF THE "B"ATCH RECORD READ THAT IS BEING
*    PROCESSED - THUS SET APPROPRIATE COUNTERS TO 1)
    move zero                           to      counters.
    move 1                              to      ctr-b-recs-read
                                                ctr-recs-read.
*    MOVE DISKETTE-INPUT-REC-DATA       TO      BATCH-REC.
    move unpriced-moh-code               to batch-dist-cd.
    move unpriced-bathdr-batch-nbr       to batch-identifier.
    move unpriced-bathdr-fac-no          to batch-group-nbr.
    move unpriced-bathdr-prov-ohip-no    to batch-provider-nbr.
    move unpriced-bathdr-spec-cd         to batch-specialty.
    move zero                           to batch-pay-type.

*2002/04/24 - MC
*2002/05/03 - MC
*    move unpriced-payroll-flag                 to ws-default-payroll-flag.
     if unpriced-bathdr-clinic-1-2 = 85
     then
        move "B"                        to ws-default-payroll-flag
     else
        move "A"                        to ws-default-payroll-flag.
*   endif
*2002/05/03 - end
*2002/04/24  -  end

    if unpriced-default-batch-loc not = " "
    then
       move unpriced-default-batch-loc  to ws-default-batch-location
    else
       move spaces                              to ws-default-batch-location.
*   endif

    if unpriced-default-batch-i-o-ind not = " "
    then
       move unpriced-default-batch-i-o-ind      to ws-default-batch-i-o-ind
    else
       move spaces                              to ws-default-batch-i-o-ind.
*   endif
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  95
*                      newu701.cbl                                   )

    perform ea10-determine-clinic-nbr   thru    ea10-99-exit.
*   (check if error - shut down)
    if fatal-error
    then
        go to ea0-99-exit.
*   endif

*   (read docter master by doc nbr)
*   MOVE BATCH-PROVIDER-NBR             TO      DOC-PRACT-NBR.
    move unpriced-bathdr-doc-nbr         to      doc-nbr.
    perform tb0-read-doc                thru    tb0-99-exit.
    if doc-found
    then
        perform ea11-check-doctor-specialty    thru    ea11-99-exit
        perform ea12-check-dept-no              thru    ea12-99-exit
        perform ea13-check-provider-nbr         thru    ea13-99-exit
* 2003/10/22 - MC - check doctor's clinic
        perform ea14-check-doctor-clinic        thru    ea14-99-exit
* 2003/10/22 - end
    else
*       (error - write report and skip batch)
        move "Y"                        to      fatal-error-flag
        move 2                          to      ws-carriage-ctrl
        move 2                          to      err-ind
        move ws-error-literal           to      err-warn-msg
        move unpriced-bathdr-doc-nbr     to      err-msg-doc-nbr
        perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*       GO TO EA0-99-EXIT.
*   endif

ea0-99-exit.
    exit.


ea10-determine-clinic-nbr.

    move "N"                            to flag-clinic.

    perform ea10a-search-clinic-tbl     thru ea10a-99-exit
        varying sub
        from   1
        by     1
        until   sub > const-max-nbr-clinics
             or clinic-found.

*   (diskettes from non-web sites don't all have the clinic in
*    the submission file - therefore if the clinic is zero
*    don't give an error but allow the operator to have specified
*    a clinic)
    if    clinic-not-found
* 2003/10/22 - MC - the size has changed from 4 to 2
*      and ws-default-clinic-nbr         = 0000
      and ws-default-clinic-nbr         = 00
* 2003/10/22 - end
    then
*       (error - clinic on diskette is bad and no override
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  96
*                      newu701.cbl                                   )
*        default clinic was specified by the operator)
        move "Y"                        to      fatal-error-flag
        move 2                          to      ws-carriage-ctrl
        move 6                          to      err-ind
        move ws-error-literal           to      err-warn-msg
        move batch-group-nbr            to      err-msg-clinic-id
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit
    else
        if    clinic-not-found
* 2003/10/22 - MC - the size has changed from 4 to 2
*          and ws-default-clinic-nbr     not = 0000
          and ws-default-clinic-nbr     not = 00
* 2003/10/22 - end
        then
*           (clinic is bad but override default clinic was specified)
            move ws-default-clinic-nbr  to      unpriced-bathdr-clinic-1-2
            move ws-default-clinic-nbr  to      bt-clinic-nbr-1-2
            move ws-default-clinic-nbr  to      batch-group-nbr.
*        endif
*   endif

ea10-99-exit.
    exit.



ea10a-search-clinic-tbl.
*   (97/sep/25 b.e. logic changed for web site file)
*   IF BATCH-GROUP-NBR           = CONST-CLINIC-NBR-1-2 (SUB)
    if unpriced-bathdr-clinic-1-2 = const-clinic-nbr-1-2 (sub)
    then
         move const-clinic-nbr-1-2 (sub) to bt-clinic-nbr-1-2
         move const-clinic-nbr     (sub) to batch-group-nbr
         move 'Y'                        to flag-clinic.
*   endif

ea10a-99-exit.
    exit.


ea11-check-doctor-specialty.

    if    batch-specialty not = doc-spec-cd
      and batch-specialty not = doc-spec-cd-2
      and batch-specialty not = doc-spec-cd-3
      and not price-only-claim
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 4                          to      err-ind
        move batch-specialty           to      err-msg-batch-spec-cd
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 5                          to      err-ind
        move doc-spec-cd                to      err-msg-doc-spec-cd
        move doc-spec-cd-2              to      err-msg-doc-spec-cd-2
        move doc-spec-cd-3              to      err-msg-doc-spec-cd-3
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  97
*                      newu701.cbl                                   )
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit.
*   endif


ea11-99-exit.
    exit.


ea12-check-dept-no.

    if    unpriced-bathdr-dept  not = doc-dept
      and not price-only-claim
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 32                         to      err-ind
        move unpriced-bathdr-dept        to      err-msg-batch-dept-no
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 33                         to      err-ind
        move doc-dept                   to      err-msg-doc-dept-no
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit.
*   endif

ea12-99-exit.
    exit.


ea13-check-provider-nbr.

    if    unpriced-bathdr-prov-ohip-no   not = doc-pract-nbr
      and not price-only-claim
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 35                         to      err-ind
        move unpriced-bathdr-prov-ohip-no to     err-msg-batch-prov-nbr
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 36                         to      err-ind
        move doc-pract-nbr              to      err-msg-doc-prov-nbr
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit.
*   endif

ea13-99-exit.
    exit.

* 2003/10/22 - MC - add this new subroutine
ea14-check-doctor-clinic.

* MC45 - edit 82
   if bt-clinic-nbr-1-2 = 98
   then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  98
*                      newu701.cbl                                   )
        move 141                        to      err-ind
        move bt-clinic-nbr-1-2          to      err-msg-doc-clinic
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit.
*   endif
* MC48 - end

* MC31
    move 'Y'                            to flag-doc-clinic.
* MC31 - end

    if    bt-clinic-nbr-1-2 not = doc-clinic-nbr
      and bt-clinic-nbr-1-2 not = doc-clinic-nbr-2
      and bt-clinic-nbr-1-2 not = doc-clinic-nbr-3
      and bt-clinic-nbr-1-2 not = doc-clinic-nbr-4
      and bt-clinic-nbr-1-2 not = doc-clinic-nbr-5
      and bt-clinic-nbr-1-2 not = doc-clinic-nbr-6
      and not price-only-claim
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 57                         to      err-ind
        move bt-clinic-nbr-1-2          to      err-msg-doc-clinic
* MC31
        move 'N'                        to      flag-doc-clinic
* MC31 - end
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit.
*   endif

ea14-99-exit.
    exit.

* 2003/10/22 - end


fa0-proc-rec-type-header1.

*   (processing a new HEADER rec. If there were detail records in hold area
*    from the previous claim header rec then area process them - ie. price
*    them and write them out)
    perform xx0-process-hold-dtls       thru xx0-99-exit.

    move "N"                          to   skip-process-this-acct-id-flag.

    perform fb0-build-susp-hdr-rec      thru fb0-99-exit.
*   (if error found processing this record, skip processing dtl/addr part of rec
    if skip-processing-this-acct-id
    then
        go to fa0-99-exit.
*   endif

*mf    perform fd0-build-susp-addr-rec-from-hdr1
    perform fd0-build-susp-addr-rec-hdr1
                                        thru    fd0-99-exit.

*   (moved to just before all details are written out so that total
*    amount of priced claim can be updated into header)
*   perform tc0-write-hdr-rec           thru    tc0-99-exit.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page  99
*                      newu701.cbl                                   )

    move 0                              to      ctr-hdr2-rec
                                                ctr-addr-rec.
fa0-99-exit.
    exit.



fb0-build-susp-hdr-rec.

*  (if 'RMB' claim output header/address records)
    if   last-record-is-h
      or detail-written
    then
        move 'N'                        to   detail-written-flag
*       (header written out with details in xx0)
*         perform tc0-write-hdr-rec       thru tc0-99-exit
        perform tf0-write-addr-rec      thru tf0-99-exit.
*   endif

*   move diskette-input-rec-data        to      header-rec.
*   98/04/06 mc - initialize header-rec
    move spaces                         to      header-rec.
    move zeroes                         to      hdr-birth-date
                                                hdr-birth-date-dd
                                                hdr-refer-pract-nbr
                                                hdr-admit-yy
                                                hdr-admit-mm
                                                hdr-admit-dd.

*   (incoming claim/accounting nbr moved to hold area so it can
*    be written back out to the unpriced(diskette-out) files

    move spaces                         to      suspend-hdr-rec.

    move zeroes                         to      clmhdr-batch-nbr.
    move unpriced-clmhdr-claim           to      hold-accounting-nbr.
    move unpriced-clmhdr-claim           to      hdr-accounting-nbr.
    move doc-nbr                        to      clmhdr-doc-nbr.



    move unpriced-clmhdr-health-nbr      to      hdr-health-care-nbr.
    if unpriced-clmhdr-birth-date = spaces
    then
        move zeroes                     to      hdr-birth-date-long
    else
        move unpriced-clmhdr-birth-date  to      hdr-birth-date-long.
*   endif

    inspect unpriced-clmhdr-ref-doc-nbr replacing all space-char by zeros.
    if unpriced-clmhdr-ref-doc-nbr = spaces
    then
        move zeroes                     to      hdr-refer-pract-nbr
    else
        move unpriced-clmhdr-ref-doc-nbr to      hdr-refer-pract-nbr.
    move unpriced-clmhdr-hosp-nbr        to      hdr-hosp-nbr.
    move unpriced-clmhdr-man-review      to      hdr-manual-review.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 100
*                      newu701.cbl                                   )
    if unpriced-clmhdr-admit-date = spaces
    then
        move zeroes                     to      hdr-admit-date
    else
        move unpriced-clmhdr-admit-date  to      hdr-admit-date.
*   endif
    move unpriced-clmhdr-version-cd      to      hdr-health-care-ver.

    move zeros                          to      clmhdr-zeroed-oma-suff-adj.
    move "C"                            to      clmhdr-batch-type.

*   (00/sep/21 B.E. distinguish between "D"iskette and "W"eb claims")
    move flag-claim-source              to      clmhdr-claim-source-cd.

* MC31
    if invalid-doc-clinic
    then
        move 00                         to      clmhdr-clinic-nbr-1-2
    else
* MC31 - end
    move bt-clinic-nbr-1-2              to      clmhdr-clinic-nbr-1-2.

*   IF BATCH-PROVIDER-NBR NOT = DOC-PRACT-NBR
*   THEN
*       MOVE '??????'                   TO      CLMHDR-DOC-NBR-OHIP-ALPHA
*   ELSE
        move batch-provider-nbr         to      clmhdr-doc-nbr-ohip.
*   endif

*   IF BATCH-SPECIALITY NOT = DOC-SPEC-CD
*   THEN
*       MOVE '??'                       TO      CLMHDR-DOC-SPEC-CD-ALPHA
*   ELSE
        move batch-specialty           to      clmhdr-doc-spec-cd.
*   endif

*   (REFERRING PHY. SPECIFIED - ENSURE THAT NBR IS VALID)

    if hdr-refer-pract-nbr not = spaces and not = zeros
    then
        perform fb02-verify-referring-phys-nbr
                                        thru    fb02-99-exit
*       IF INVALID-REFER-PHYS
*       THEN
*           MOVE "??????"               TO      CLMHDR-REFER-DOC-NBR-ALPHA
*       ELSE
            move hdr-refer-pract-nbr    to      clmhdr-refer-doc-nbr.
*       endif
*   endif

*2000/11/27 - MC - if referring doc nbr is blank for clinic 60's, set
*                  referring doc-nbr to be the same as original doc-nbr

    if     hdr-refer-pract-nbr = 0
      and (    bt-clinic-nbr-1-2 >= 61
* 2011/07/07 - MC17 - include clinic 66
*          and bt-clinic-nbr-1-2 <= 65
           and bt-clinic-nbr-1-2 <= 66
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 101
*                      newu701.cbl                                   )
* 2011/07/07 - end
          )
        then
            move batch-provider-nbr     to clmhdr-refer-doc-nbr.
*           endif

*2007/08/16 - MC - if referring doc nbr is blank for clinic 70's, set
*                  referring doc-nbr to be the same as original doc-nbr
    if     hdr-refer-pract-nbr = 0
      and (    bt-clinic-nbr-1-2 >= 71
           and bt-clinic-nbr-1-2 <= 75
          )
        then
            move batch-provider-nbr     to clmhdr-refer-doc-nbr.
*           endif
* 2007/08/16 - end

*   (determine if hospital nbr is required, and if so that the code is valid -
*    - if valid, replace 4 digit hospital number with 1 character code)
*       (hospital nbr specified - ensure that nbr is valid and translate to hosp


*2000/03/20 - MC - comment out the following if condition
*    if    hdr-hosp-nbr not = spaces and not = zeros
*      and not price-only-claim
*    then
*       perform fb05-verify-hospital    thru    fb05-99-exit
*       if clmhdr-hosp = "?"
*       then
*           perform xb0-print-warning-line
*                                       thru    xb0-99-exit
*           move 1                      to      ws-carriage-ctrl
*           move 23                     to      err-ind
*           move hdr-hosp-nbr           to      err-hosp-nbr, clmhdr-hosp
*           perform zb0-build-write-err-rpt-line
*                                       thru    zb0-99-exit.
*       endif
*   endif

*   (if requested by operator, set all blank agent codes to 'OHIP')
*   98/03/31 mc - also set clmhdr-tape-submit-ind to 'Y' and
*                 clmhdr-agent-cd = '0'
    if ws-agent-default-reply = "Y"
    then
        move "Y"                        to      clmhdr-tape-submit-ind
        move "0"                        to      clmhdr-agent-cd
        move "0"                        to      hdr-agent-cd.
*   endif

*   MOVE ZEROS                          TO      CLMHDR-ADJ-CD.
    move spaces                         to      clmhdr-adj-cd.


    move zero                           to      clmhdr-status-ohip.

    move spaces                         to      clmhdr-reference.

*   (non-rma-enhanced submissions don't have a location in the header
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 102
*                      newu701.cbl                                   )
*    records.  check the 'HEB' batch header record to see if rma has
*    input a default value to use for all claims in the batch and
*    override if required)


    if    (   hdr-loc-code = ws-4-nulls
           or hdr-loc-code = spaces)
      and ws-default-batch-location not = spaces
    then
        move ws-default-batch-location  to clmhdr-loc.
*   endif

*   (non-rma-enhanced submissions don't have a patient i/o indicator in the
*    hdr records.  check the 'HEB' batch header record to see if rma has
*    input a default value to use for all claims in the batch and
*    override if required)

    if    (   hdr-i-o-ind = ws-1-null
           or hdr-i-o-ind = spaces)
      and ws-default-batch-i-o-ind not = spaces
    then
        move ws-default-batch-i-o-ind   to clmhdr-i-o-pat-ind.
*   endif


    if hdr-admit-date not = spaces and not = zeros
    then
*       (ADMIT DATE SPECIFIED - ENSURE THAT DATE IS VALID)
        move hdr-admit-yy               to      ws-date-yy
        move hdr-admit-mm               to      ws-date-mm
        move hdr-admit-dd               to      ws-date-dd
        perform xd0-verify-date thru    xd0-99-exit
        if     invalid-date
           and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line
                                        thru    xb0-99-exit
            move 1                      to      ws-carriage-ctrl
            move 26                     to      err-ind
            move hdr-admit-date         to      err-admit-date
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*           MOVE "??????"               TO      CLMHDR-DATE-ADMIT
*       ELSE
            move hdr-admit-yy           to      clmhdr-date-admit-yy
            move hdr-admit-mm           to      clmhdr-date-admit-mm
            move hdr-admit-dd           to      clmhdr-date-admit-dd.
*       endif
*   endif


* 2004/04/07 - MC
    if hdr-admit-date not = spaces and not = zeros
    then
*       (ADMIT DATE SPECIFIED - ENSURE THAT DATE IS greater than birth date)
        if     hdr-admit-date < hdr-birth-date-long
           and not price-only-claim
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 103
*                      newu701.cbl                                   )
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line
                                        thru    xb0-99-exit
            move 1                      to      ws-carriage-ctrl
            move 58                     to      err-ind
            move hdr-admit-date         to      err-58-admit-date
            move hdr-birth-date-long    to      err-58-birth-date
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
            move "????????"             to      clmhdr-date-admit.
*       endif
*   endif
* 2004/04/07 - end


    move sys-date                       to      clmhdr-date-sys.
    move doc-dept                       to      clmhdr-doc-dept.
    move zero                           to      clmhdr-curr-payment
*mf                                             clmhdr-manual-and-tape-paymnts
                                                clmhdr-amt-tech-billed
                                                clmhdr-amt-tech-paid.

    if hdr-health-care-nbr not = spaces and not = zeros
    then
        move hdr-health-care-nbr        to      clmhdr-health-care-nbr
*       (THE FOLLOWING TWO MOVE STMT ADDED ON 91/04/23 BY M.C. - MOVED TO
*        NEW LINES NUMBER BY B.L. 91/SEP/05)
        move hdr-health-care-nbr        to      clmhdr-pat-key-data
        move "O"                        to      clmhdr-pat-key-type.
*   endif

    move hdr-health-care-ver            to      clmhdr-health-care-ver.

*   (CHECK THE RELATIONSHIP FIELD)
*   IF HDR-RELATIONSHIP =  SPACES
*                        OR 'Y'
*                        OR 'N'
*    THEN
*        MOVE HDR-RELATIONSHIP           TO      CLMHDR-RELATIONSHIP
*    ELSE
*        PERFORM XB0-PRINT-WARNING-LINE
*                                       THRU    XB0-99-EXIT
*        MOVE 1                          TO      WS-CARRIAGE-CTRL
*        MOVE 46                         TO      ERR-IND
*        MOVE HDR-RELATIONSHIP           TO      ERR-RELATIONSHIP
*        PERFORM ZB0-BUILD-WRITE-ERR-RPT-LINE
*                                        THRU    ZB0-99-EXIT
*        MOVE HDR-RELATIONSHIP           TO      CLMHDR-RELATIONSHIP.
**       MOVE "?"                        TO      CLMHDR-RELATIONSHIP.
**   endif

*   (CHECK THE MANUAL REVIEW INDICATOR)
    if  hdr-manual-review =  spaces
                          or 'Y'
                          or 'N'
    then
        move hdr-manual-review              to      clmhdr-manual-review
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 104
*                      newu701.cbl                                   )
    else
        if not price-only-claim
        then
            move ws-warning-literal         to      err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 31                         to      err-ind
            move hdr-manual-review          to      err-manual-review
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
            move hdr-manual-review          to      clmhdr-manual-review.
*       endif
*   endif

*   (00/sep/14 B.E.)
*   (number of description records set to zero here and updated by
*    program that processes the description record upload file)
*    move 0                             to clmhdr-nbr-suspend-desc-recs.

    move doc-pract-nbr                  to      clmhdr-doc-pract-nbr.
    move hdr-accounting-nbr             to      clmhdr-accounting-nbr.

* 2010/08/12 - MC7
    move clmhdr-doc-nbr                 to      susp-hdr-doc-nbr.
    move bt-clinic-nbr-1-2              to      susp-hdr-clinic-nbr.
    move hold-accounting-nbr            to      susp-hdr-accounting-nbr.
* 2010/08/12 - end

fb0-99-exit.
    exit.

fb0a-search-province.

    if hdr-health-care-prov = prov(sub)
    then
        move "Y"                        to province-flag.
*   endif

fb0a-99-exit.
    exit.


fb02-verify-referring-phys-nbr.

*   MOVE HDR-REFER-PRACT-NBR            TO      WS-CHK-IND.
*   MOVE "Y"                            TO      FLAG-REFER-PHYS.

    move hdr-refer-pract-nbr            to      ws-chk-nbr.
*   IF      WS-CHK-NBR     = ZEROES
        if  ws-chk-nbr-8   = 1
        or  ws-chk-nbr-8   = 2
    then
        perform dc0-mod10-check-digit-for-1-2 thru dc0-99-exit
    else perform db0-mod10-check-digit  thru    db0-99-exit.
*   endif

    move flag                           to      flag-refer-phys.

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 105
*                      newu701.cbl                                   )
    if    invalid-refer-phys
      and not price-only-claim
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 12                         to      err-ind
        move hdr-refer-pract-nbr        to      err-refer-phys-nbr
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit.
*   endif

    if    hdr-refer-pract-nbr = batch-provider-nbr
* 2007/08/16 - MC - include 70's check
*      and (   bt-clinic-nbr-1-2 < 60
*          or bt-clinic-nbr-1-2 > 65
      and (   bt-clinic-nbr-1-2 < 60
           or bt-clinic-nbr-1-2 > 75
* 2007/08/16 - end
          )
      and not price-only-claim
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 47                         to      err-ind
*2000/03/20 - MC
*       move unpriced-clmhdr-ref-doc-nbr to      err-msg-referring-doc
*       move unpriced-bathdr-prov-ohip-no to     err-msg-provider-doc
*
        move hdr-refer-pract-nbr        to      err-msg-referring-doc
        move batch-provider-nbr          to     err-msg-provider-doc
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit.

*** S.B. - end.

fb02-99-exit.
    exit.

fb03-verify-diag-code.

    move "Y"                            to      flag-diag-cd.
*mf    read diag-mstr      suppress data record
       read diag-mstr
        invalid key
            if not price-only-claim
            then
                move ws-error-literal           to      err-warn-msg
                perform xb0-print-warning-line  thru    xb0-99-exit
                move 1                          to      ws-carriage-ctrl
                move 14                         to      err-ind
                move diag-cd                    to      err-diag-code
                perform zb0-build-write-err-rpt-line    thru    zb0-99-exit
                move            'N'             to      flag-diag-cd.
*           endif

fb03-99-exit.
    exit.

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 106
*                      newu701.cbl                                   )

fb04-verify-doc-location.

*   (NON-RMA-ENHANCED SUBMISSIONS DON'T HAVE A LOCATION IN THE HEADER
*    RECORDS.  CHECK THE 'HEB' BATCH HEADER RECORD TO SEE IF RMA HAS
*    INPUT A DEFAULT VALUE TO USE FOR ALL CLAIMS IN THE BATCH AND
*    OVERRIDE IF REQUIRED)

    if    Hdr-loc-code = spaces
      and ws-default-batch-location not = spaces
      and not price-only-claim
    then
        move ws-default-batch-location  to hdr-loc-code.
*   endif

    move 'N'                            to      flag-location.
    if hdr-loc-code not = spaces
    then
        perform fb04a-search-doc-location       thru    fb04a-99-exit
            varying sub
            from 1
            by   1
            until   sub > max-doc-locations
                 or valid-location.
*   endif

    if    invalid-location
      and not price-only-claim
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 3                          to      err-ind
        move hdr-loc-code               to      err-msg-loc-cd
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit.
*   endif

fb04-99-exit.
    exit.


fb04a-search-doc-location.

    if hdr-loc-code = doc-loc(sub)
    then
        move 'Y'                        to flag-location.
*   endif

fb04a-99-exit.
    exit.

*2000/03/20 - MC  add the new subroutine fb04b-read-loc-mstr
fb04b-read-loc-mstr.

    move hdr-loc-code                   to loc-nbr.

    read loc-mstr
      invalid key
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 107
*                      newu701.cbl                                   )
        if not price-only-claim
        then
            move zeroes                     to  loc-hospital-nbr
            move spaces                     to  loc-card-colour
            move ws-error-literal           to  err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 51                         to      err-ind
            move hdr-loc-code               to      err-51-loc-cd
            perform zb0-build-write-err-rpt-line
                                            thru    zb0-99-exit.
*       endif

* MC38
     if    loc-active-for-entry = "N"
     then
         move ws-error-literal           to      err-warn-msg
         perform xb0-print-warning-line  thru    xb0-99-exit
         move 1                          to      ws-carriage-ctrl
         move 130                        to      err-ind
         move hdr-loc-code               to      err-130-loc-cd
         perform zb0-build-write-err-rpt-line
                                            thru    zb0-99-exit.
*    endif
* MC38 - end

fb04b-99-exit.
    exit.



copy "hospital.dc".
*        valid hospital codes are:
*        code      nbr        name
*        a        1992        macassa lodge
*        b        1160        joseph brant
*        c        1972        chedoke general
*        d        1557        hotel dieu
*        e        1146        haldimand war memorial hospital
*        f        3361        manitoulin health centre
*        g        1982        hamilton general
*        h        1983        henderson general
*        i        3309        shaver hospital
*        j        2003        st. joseph's
*        k        1076        hotel dieu-windsor
*        l        1538        west lincoln memorial
*        m        1994        mcmaster university medical centre
*        n        1591        norfolk general
*        o        1172        oakville trafalgar, active treatment
*        p        1524        muskoka hospital
*        q        3446        pine villa nursing home
*        r        1978        dr. rygiels home
*        s        2006        st. peter's
*        t        1406        toronto sick kids
*        u        1542        greater niagara
*        v        1149        west haldimand general hospital (hagersville)
*        w        0000        "weird" ie. used as miscellaneous hosp -- keyers
*                             will enter "report" when using this hospital,
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 108
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/hos)
*                             a card will be produced and manually changed to
*                             the correct hospital number
*        x        1082        salvation army/grace windsor
*        y        1020        willett hospital, paris
*        z        1987        hamilton psychiatric
*        1        1965        blackadar nursing home
*        2        1969        beacon hill lodge
*        3        3401        the brownstone nursing home
*        4        2001        st. elizabeth
*        5        1966        st. joseph's villa
*        6        1967        wentworth lodge
*        7        3409        grace villa
*        8        3642        wellington place
*        9        3251        parkview nursing centre


copy "hosp_nbr_code_to_nbr.rtn"
     replacing  ==ca11-move-hosp==      by ==fb05-verify-hospital==
                ==ca11-10-hosp-loop==   by ==fb05-10-hosp-loop==
                ==ca11-99-exit==        by ==fb05-99-exit==
                ==clmhdr-hosp==         by ==hdr-hosp-nbr==
                ==hosp-nbr==            by ==hosp-code==
                ==hosp-code==           by ==hosp-nbr==
                ==spaces==              by =="?"==
                ==l1-hosp==             by ==clmhdr-hosp==.


fb05-verify-hospital.
*       (TRANSLATE HOSPITAL CODE INTO THE CORRESPONDING HOSPITAL NUMBER)

    MOVE ZERO                   TO      SUBS-HOSP.
fb05-10-hosp-loop.

    ADD 1                       TO      SUBS-HOSP.

    IF hdr-hosp-nbr = hosp-nbr  (SUBS-HOSP)
    THEN
        MOVE hosp-code (SUBS-HOSP)
                                TO      clmhdr-hosp
        GO TO fb05-99-exit.
*   (ELSE)
*   ENDIF

    IF SUBS-HOSP < 35
    THEN
        GO TO fb05-10-hosp-loop
    ELSE
*mf     MOVE SPACES             TO      L1-HOSP.
        MOVE ZERO               TO      clmhdr-hosp.
*   ENDIF

fb05-99-exit.
    EXIT.
copy "verify_agent_code.rtn"
     replacing  ==xx00-verify-agent==   by ==fb06-verify-agent==
                ==xx00-99-exit==        by ==fb06-99-exit==
                ==agent-2b-tested==     by ==hdr-agent-cd==.
fb06-verify-agent.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 109
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/ver)

    MOVE hdr-agent-cd                   TO      DEF-AGENT-CODE.

    IF   DEF-AGENT-OHIP
      OR DEF-AGENT-OHIP-WCB
      OR DEF-AGENT-IN-PAT-DIAG-BILLING
* 2013/01/29 - MC - from d001, since 2005/dec/15, agent 3,5,7,8 are not allowed,
*                   this copybook is used in d001, newu701 & u701oscar
      OR DEF-AGENT-OHIP-NOT-VALID
*      OR DEF-AGENT-MOH-REDUCTION
      OR DEF-AGENT-BILL-DIRECT
*      OR DEF-AGENT-MISC-PAYMENTS
*      OR DEF-AGENT-ALTERNATE-FUNDING
* 2013/01/29
      OR DEF-AGENT-WCB
    THEN
        MOVE "Y"                        TO      FLAG-AGENT-CD
    ELSE
        MOVE "N"                        TO      FLAG-AGENT-CD.
*   ENDIF

fb06-99-exit.
    EXIT.
fb07-verify-in-out-ind.

*   (NON-RMA-ENHANCED SUBMISSIONS DON'T HAVE A PATIENT I/O INDICATOR IN THE
*    HDR RECORDS.  CHECK THE 'HEB' BATCH HEADER RECORD TO SEE IF RMA HAS
*    INPUT A DEFAULT VALUE TO USE FOR ALL CLAIMS IN THE BATCH AND
*    OVERRIDE IF REQUIRED)

    if    hdr-i-o-ind = spaces
      and ws-default-batch-i-o-ind not = spaces
    then
        move ws-default-batch-i-o-ind   to hdr-i-o-ind.
*   endif

*   IF HDR-I-O-IND = "1" OR "2" OR SPACES
    if hdr-i-o-ind = "1" or "2" or "I" or "O" or spaces
    then
        move "Y"                        to      flag-in-out-ind
    else
        move "N"                        to      flag-in-out-ind.
*   endif

fb07-99-exit.
    exit.
*mf fd0-build-susp-addr-rec-from-hdr1.
fd0-build-susp-addr-rec-hdr1.

    move spaces                 to suspend-address-rec.

*   VALIDATE THE BIRTH DATE

    move hdr-birth-date-long    to addr-birth-date.

    if    hdr-birth-date-long = spaces or zeros
      and not price-only-claim
    then
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 110
*                      newu701.cbl                                   )
        move ws-warning-literal to err-warn-msg
        perform xb0-print-warning-line thru xb0-99-exit
        move 1                  to ws-carriage-ctrl
        move 37                 to err-ind
        move hdr-birth-date-long to err-birth-date
        perform zb0-build-write-err-rpt-line thru zb0-99-exit
*       MOVE '??????'           TO ADDR-BIRTH-DATE
    else
        move addr-birth-yy      to ws-date-yy
        move addr-birth-mm      to ws-date-mm
        move addr-birth-dd      to ws-date-dd
        perform xd0-verify-date thru xd0-99-exit
        if    invalid-date
          and not price-only-claim
        then
            move ws-error-literal       to err-warn-msg
            perform xb0-print-warning-line thru xb0-99-exit
            move 1                      to ws-carriage-ctrl
            move 37                     to err-ind
            move hdr-birth-date-long    to err-birth-date
            perform zb0-build-write-err-rpt-line thru zb0-99-exit.
*           MOVE '??????'               TO ADDR-BIRTH-DATE.
*       endif
*   endif

    move clmhdr-doc-pract-nbr   to addr-doc-pract-nbr.
    move clmhdr-accounting-nbr  to addr-accounting-nbr.

fd0-99-exit.
    exit.


ga0-proc-rec-type-header2.

    if unpriced-clmhdr-claim = 00523321
    then
        next sentence.
*   endif

    move unpriced-clmhdr-pat-surname     to clmhdr-pat-acronym6
                                           clmhdr-patient-surname.

    move unpriced-clmhdr-given-name      to clmhdr-pat-acronym3
                                           clmhdr-subscr-initials.

* 2010/08/12 - MC7
   move clmhdr-pat-acronym              to susp-hdr-acronym.
* 2010/08/12 - end


* 2000/jun/09 -BA/BE begin
*  (if either 'confidentiality' or 'manual review' flags have been
*   set then update 'manual review' to  "Y"es in the suspend header rec)
*    move unpriced-confidentiality-flag to    clmhdr-confidential-flag.
    if   unpriced-confidentiality-flag = "Y"
      or hdr-manual-review            = "Y"
    then
        move "Y"                          to    hdr-manual-review
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 111
*                      newu701.cbl                                   )
    else
        move ' '                          to    hdr-manual-review.
*   endif
    if   unpriced-confidentiality-flag = "Y"
    then
        move "Y"                          to    clmhdr-confidential-flag
    else
        move ' '                          to    clmhdr-confidential-flag.
* 2000/jun/09 -BA end

    move unpriced-clmhdr-loc-code        to hdr-loc-code.
*   (DETERMINE IF VALID LOCATION FOR DOCTOR)
    perform fb04-verify-doc-location    thru    fb04-99-exit.
*   IF INVALID-LOCATION
*   THEN
*       MOVE "????"                     TO      CLMHDR-LOC
*   ELSE
        move hdr-loc-code               to      clmhdr-loc.
*   endif


* 2005/05/05 - MC - check certain location code if clinic 61 - 65
*    if  bt-clinic-nbr-1-2 >= 61 and bt-clinic-nbr-1-2  <= 65
* 2011/07/07 - MC17 - include clinic 66
*    if     (     (bt-clinic-nbr-1-2 >= 61 and bt-clinic-nbr-1-2  <= 65)
    if     (     (bt-clinic-nbr-1-2 >= 61 and bt-clinic-nbr-1-2  <= 66)
* 2011/07/07 - end
* 2007/11/27 - MC - include check for clinic 71 - 75 as well
* MC32
*           or   (bt-clinic-nbr-1-2 >= 71 and bt-clinic-nbr-1-2  <= 75)
            or   (bt-clinic-nbr-1-2 >= 71 and bt-clinic-nbr-1-2  <= 74)
* MC32 - end
           )
* 2007/11/27 - end
        and  not price-only-claim
    then
        if    hdr-loc-code not = 'M233'
          and hdr-loc-code not = 'M521'
          and hdr-loc-code not = 'M525'
* MC32
*         and hdr-loc-code not = 'M526'
*         and hdr-loc-code not = 'M527'
* MC32 - end
          and hdr-loc-code not = 'M540'
          and hdr-loc-code not = 'M541'
          and hdr-loc-code not = 'M542'
          and hdr-loc-code not = 'M544'
          and hdr-loc-code not = 'M545'
          and hdr-loc-code not = 'M546'
          and hdr-loc-code not = 'M547'
          and hdr-loc-code not = 'M555'
          and hdr-loc-code not = 'M556'
        then
            move ws-warning-literal         to      err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 62                         to      err-ind
            move bt-clinic-nbr-1-2          to      err-62-clinic-nbr
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 112
*                      newu701.cbl                                   )
            move hdr-loc-code               to      err-62-loc-code
            move "????"                     to      clmhdr-loc
            perform zb0-build-write-err-rpt-line
                                                thru    zb0-99-exit.
*       endif
*   endif

* 2005/05/05 - end

*2000/03/20 - MC -get the hosp nbr and i/o ind from f030-locations-mstr
*                 by loc-code
    perform fb04b-read-loc-mstr         thru    fb04b-99-exit.
    move loc-hospital-nbr               to      clmhdr-hosp.
*

*2002/04/24 - substitute hosp with payroll-flag
    move ws-default-payroll-flag        to      clmhdr-hosp.
*2002/04/24  - end

    move unpriced-clmhdr-agent-cd        to      hdr-agent-cd.
*   (DETERMINE IF VALID AGENT)
    perform fb06-verify-agent           thru    fb06-99-exit.
    if    invalid-agent-cd
      and not price-only-claim
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 20                         to      err-ind
        move hdr-agent-cd               to      err-agent-cd
        perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.

*       MOVE "?"                        TO      CLMHDR-AGENT-CD
*   ELSE
        move hdr-agent-cd               to      clmhdr-agent-cd.
*   endif

    if     def-agent-ohip
        or def-agent-ohip-wcb
    then
        move zero                       to      clmhdr-date-cash-tape-payment
    else
        if not price-only-claim
        then
* 2012/11/05 - MC24 - set default values for agent 6
          if clmhdr-agent-cd = 6
          then
            move "00"                       to      clmhdr-msg-nbr
            move "N"                        to      clmhdr-reprint-flag
            move "0"                        to      clmhdr-sub-nbr
            move "N"                        to      clmhdr-auto-logout
            move "0"                        to      clmhdr-fee-complex
          else
* 2012/11/05 - end
*           (PRINT WARNING THAT DIRECT BILL AGENT ENTERED AND ALL DIRECT
*            BILL INFO IS MISSING)
            move ws-warning-literal         to      err-warn-msg
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 113
*                      newu701.cbl                                   )
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 25                         to      err-ind
            perform zb0-build-write-err-rpt-line
                                            thru    zb0-99-exit
            move "??"                       to      clmhdr-msg-nbr
            move "?"                        to      clmhdr-reprint-flag
            move "?"                        to      clmhdr-sub-nbr
            move "?"                        to      clmhdr-auto-logout
            move "?"                        to      clmhdr-fee-complex.
*         endif
*       endif
*   endif

*   (SET INDICATOR TO ASSUME THAT CLAIM CAN BE SUBMITTED ON TAPE - WHEN
*    ACTUAL CLAIM IS BUILT THE DETAILS WERE BE CHECKED TO ENSURE THAT
*    THIS INDICATOR IS SET CORRECLTY)
    if clmhdr-agent-cd = 0 or 2
    then
        move "Y"                        to      clmhdr-tape-submit-ind
    else
        move "N"                        to      clmhdr-tape-submit-ind.
*   endif

*2001/02/28 - MC- if agent = 6 or 9, set clmhdr-status = 'I'gnore

* 2012/11/05 - MC24 - allow to process agent 6
*   if clmhdr-agent-cd = 6 or 9
    if clmhdr-agent-cd =  9
* 2012/11/05 - end
    then
        move "I"                        to      clmhdr-status.
*   endif


*2000/03/20 - MC - use loc-card-colour instead
*   move unpriced-clmhdr-i-o-ind         to      hdr-i-o-ind.
    move loc-card-colour                to      hdr-i-o-ind.
*
*2000/03/29 - MC - check the incoming i-o ind with loc-card-colour
    if    unpriced-clmhdr-i-o-ind  not =   hdr-i-o-ind
      and not price-only-claim
    then
        move ws-warning-literal         to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 53                         to      err-ind
        move unpriced-clmhdr-i-o-ind     to      err-53-incoming-i-o-ind
        move hdr-i-o-ind                to      err-53-i-o-ind
        perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit .
*   endif
*


    perform fb07-verify-in-out-ind      thru    fb07-99-exit.
    if    invalid-in-out-ind
      and not price-only-claim
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 114
*                      newu701.cbl                                   )
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 15                         to      err-ind
        move hdr-i-o-ind                to      err-i-o-ind
        perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
*       MOVE "?"                        TO      CLMHDR-I-O-PAT-IND
        move hdr-i-o-ind                to      clmhdr-i-o-pat-ind
    else
*       IF HDR-I-O-IND = 1 - 96/07/30
        if hdr-i-o-ind = "1" or "I"
        then
            move "I"                    to      clmhdr-i-o-pat-ind
        else
*           IF HDR-I-O-IND = 2 - 96/07/30
            if hdr-i-o-ind = "2" or "O"
            then
                move "O"                to      clmhdr-i-o-pat-ind
            else
*               (IF INDICATOR IS BLANK - CONSIDER AS 'OUT' PATIENT)
                move "O"                to      clmhdr-i-o-pat-ind.
*           endif
*       endif
*   endif


* MC33
*   if unpriced-clmhdr-prov-cd = spaces
    if unpriced-clmhdr-prov-cd = spaces or '.' or '..'
* MC33 - end
    then
        move 'ON'                        to      hdr-health-care-prov
    else
        move unpriced-clmhdr-prov-cd     to      hdr-health-care-prov.
*   endif

    move 'N'                            to      province-flag.
    perform fb0a-search-province        thru    fb0a-99-exit
            varying sub from 1 by 1
* MC36
*           until (province-found or sub > 11).
            until (province-found or sub > 12).
* MC36 - end


    if    province-not-found
      and not price-only-claim
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line
                                        thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 30                         to      err-ind
        move hdr-health-care-prov       to      err-province
* MC33
        move 'ON'                       to      hdr-health-care-prov
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 115
*                      newu701.cbl                                   )
* MC33 - end
        perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*       MOVE "??"                       TO      CLMHDR-HEALTH-CARE-PROV
*   ELSE
        move hdr-health-care-prov       to      clmhdr-health-care-prov.
*   endif


******************

* 2013/04/10 - MC24 - if agent = 6, bypass health nbr/RMB nbr edit check
    if hdr-agent-cd = 6
    then
        move unpriced-clmhdr-pat-surname        to hdr-surname-3
        move hdr-birth-date                     to hdr-birthdate-yymm
        move hdr-birth-date-dd                  to hdr-birthdate-dd
        move 'O'                                to clmhdr-pat-key-type
        move hdr-direct-key                     to clmhdr-pat-key-data
        go to ga0-90.
*    endif
* 2013/04/17 - end

* 2001/02/07 - MC - save RMB registration nbr
    if hdr-health-care-prov not = 'ON'  and
       unpriced-clmhdr-pat-ohip-nbr not = spaces and
       unpriced-clmhdr-pat-ohip-nbr not = zeroes
    then
        move unpriced-clmhdr-pat-ohip-nbr       to hdr-ohip-nbr.
*   endif

******************
    if hdr-health-care-prov = 'ON'
    then
        if    hdr-health-care-nbr = spaces
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line
                                        thru    xb0-99-exit
            move 1                      to      ws-carriage-ctrl
            move 29                     to      err-ind
            move hdr-health-care-nbr
                                        to      err-health-care-nbr
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
            move "??????????"           to      clmhdr-health-care-nbr
        else
            move hdr-health-care-nbr    to      ws-nbr-10
            if   (   ws-nbr-10 not numeric
                  or ws-nbr-10 = zero
                 )
              and not price-only-claim
            then
                move ws-error-literal   to      err-warn-msg
                perform xb0-print-warning-line
                                        thru    xb0-99-exit
                move 1                  to      ws-carriage-ctrl
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 116
*                      newu701.cbl                                   )
                move 29                 to      err-ind
                move hdr-health-care-nbr
                                        to      err-health-care-nbr
                perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
                move "??????????"       to      clmhdr-health-care-nbr
            else
                move hdr-health-care-nbr
                                        to      ws-check-nbr-10
                perform db0a-mod10-check-digit-10 thru  db0a-99-exit
                if    flag = 'N'
                  and not price-only-claim
                then
                    move ws-error-literal       to      err-warn-msg
                    perform xb0-print-warning-line
                                        thru    xb0-99-exit
                    move 1              to      ws-carriage-ctrl
                    move 29             to      err-ind
                    move hdr-health-care-nbr to err-health-care-nbr
                    perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
                    move "??????????"   to      clmhdr-health-care-nbr
                else
*               (DATA IS OK - HAS ALREADY BEEN MOVED INTO CLMHDR FIELDS
                    next sentence.
*               endif
*           endif
*       endif
*   endif

*   (DETERMINE IF VALID SIZE OF OHIP NBR FOR OUT OF PROVINCE PATIENT)

* 2005/06/23 - MC - change from NF to NL
* if hdr-health-care-prov = 'NF'
    if hdr-health-care-prov = 'NL'
* 2005/06/23 - end
    then
        if   (    nf-ohip-nbr is not numeric
              or (nf-ohip-nbr = spaces or zeros)
             )
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line thru xb0-99-exit
            move 1                      to ws-carriage-ctrl
            move 40                     to err-ind
            move hdr-health-care-prov   to err-prov
            move hdr-ohip-nbr           to err-ohip-nbr
            perform zb0-build-write-err-rpt-line thru zb0-99-exit
*           MOVE "?"                    TO      CLMHDR-PAT-KEY-TYPE
*           MOVE "????????"             TO      CLMHDR-PAT-KEY-DATA
            move "O"                    to      clmhdr-pat-key-type
            move hdr-ohip-nbr           to      clmhdr-pat-key-data
        else
            move "O"                    to      clmhdr-pat-key-type
            move hdr-ohip-nbr           to      clmhdr-pat-key-data
* 2001/02/07 - MC - move hdr-ohip-nbr to clmhdr-health-care-nbr
                                                clmhdr-health-care-nbr
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 117
*                      newu701.cbl                                   )
***
*       endif
    else
* 2001/02/12 - MC - ohip nbr size has changed
*   if hdr-health-care-prov = 'AB' or 'NS'
    if hdr-health-care-prov = 'BC' or 'NS'
    then
*       if      (ab-ns-11-digits is not numeric)
*           or  (ab-ns-11-digits =  spaces or zeros)
*           or  (ab-ns-last-digits not = spaces)
        if   (    (bc-ns-10-digits is not numeric)
              or  (bc-ns-10-digits =  spaces or zeros)
              or  (bc-ns-last-digits not = spaces)
             )
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line thru xb0-99-exit
            move 1                      to ws-carriage-ctrl
            move 40                     to err-ind
            move hdr-health-care-prov   to err-prov
            move hdr-ohip-nbr           to err-ohip-nbr
            perform zb0-build-write-err-rpt-line thru zb0-99-exit
*           MOVE "?"                    TO      CLMHDR-PAT-KEY-TYPE
*           MOVE "????????"             TO      CLMHDR-PAT-KEY-DATA
            move "O"                    to      clmhdr-pat-key-type
            move hdr-ohip-nbr           to      clmhdr-pat-key-data
        else
            move "O"                    to      clmhdr-pat-key-type
            move hdr-ohip-nbr           to      clmhdr-pat-key-data
* 2001/02/07 - MC - move hdr-ohip-nbr to clmhdr-health-care-nbr
                                                clmhdr-health-care-nbr
*       endif
    else
*   if hdr-health-care-prov = 'BC'
    if hdr-health-care-prov = 'PE'
    then
*       if      (bc-10-digits is not numeric)
*           or  (bc-10-digits =  spaces or zeros)
*           or  (bc-last-digits not = spaces)
        if   (    (pe-8-digits is not numeric)
              or  (pe-8-digits =  spaces or zeros)
              or  (pe-last-digits not = spaces)
             )
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line thru xb0-99-exit
            move 1                      to ws-carriage-ctrl
            move 40                     to err-ind
            move hdr-health-care-prov   to err-prov
            move hdr-ohip-nbr           to err-ohip-nbr
            perform zb0-build-write-err-rpt-line thru zb0-99-exit
*           MOVE "?"                    TO      CLMHDR-PAT-KEY-TYPE
*           MOVE "????????"             TO      CLMHDR-PAT-KEY-DATA
            move "O"                    to      clmhdr-pat-key-type
            move hdr-ohip-nbr           to      clmhdr-pat-key-data
        else
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 118
*                      newu701.cbl                                   )
            move "O"                    to      clmhdr-pat-key-type
            move hdr-ohip-nbr           to      clmhdr-pat-key-data
* 2001/02/07 - MC - move hdr-ohip-nbr to clmhdr-health-care-nbr
                                                clmhdr-health-care-nbr
*       endif
    else
*   if hdr-health-care-prov = 'NB' or 'PE' or 'SK' or 'YT'
* MC36
*   if hdr-health-care-prov = 'AB' or 'NB' or 'SK' or 'YT'
    if hdr-health-care-prov = 'AB' or 'NB' or 'SK' or 'YT' or 'NU'
* MC36 - end
    then
*       if      (nb-pe-sk-yt-9-digits is not numeric)
*           or  (nb-pe-sk-yt-9-digits =  spaces or zeros)
*           or  (nb-pe-sk-yt-last-digits not = spaces)
        if   (    (ab-nb-sk-yt-9-digits is not numeric)
              or  (ab-nb-sk-yt-9-digits =  spaces or zeros)
              or  (ab-nb-sk-yt-last-digits not = spaces)
             )
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line thru xb0-99-exit
            move 1                      to ws-carriage-ctrl
            move 40                     to err-ind
            move hdr-health-care-prov   to err-prov
            move hdr-ohip-nbr           to err-ohip-nbr
            perform zb0-build-write-err-rpt-line thru zb0-99-exit
*           MOVE "?"                    TO      CLMHDR-PAT-KEY-TYPE
*           MOVE "????????"             TO      CLMHDR-PAT-KEY-DATA
            move "O"                    to      clmhdr-pat-key-type
            move hdr-ohip-nbr           to      clmhdr-pat-key-data
        else
            move "O"                    to      clmhdr-pat-key-type
            move hdr-ohip-nbr           to      clmhdr-pat-key-data
* 2001/02/07 - MC - move hdr-ohip-nbr to clmhdr-health-care-nbr
                                                clmhdr-health-care-nbr
*       endif
    else
    if hdr-health-care-prov = 'NT'
    then
        if   (    (nt-first-digit is not alphabetic)
              or  (nt-first-digit =  spaces)
              or  (nt-7-digits is not numeric)
              or  (nt-7-digits =  spaces or zeros)
              or  (nt-last-digits not = spaces)
             )
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line thru xb0-99-exit
            move 1                      to ws-carriage-ctrl
            move 40                     to err-ind
            move hdr-health-care-prov   to err-prov
            move hdr-ohip-nbr           to err-ohip-nbr
            perform zb0-build-write-err-rpt-line thru zb0-99-exit
*           MOVE "?"                    TO      CLMHDR-PAT-KEY-TYPE
*           MOVE "????????"             TO      CLMHDR-PAT-KEY-DATA
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 119
*                      newu701.cbl                                   )
            move "O"                    to      clmhdr-pat-key-type
            move hdr-ohip-nbr           to      clmhdr-pat-key-data
        else
            move "O"                    to      clmhdr-pat-key-type
            move hdr-ohip-nbr           to      clmhdr-pat-key-data
* 2001/02/07 - MC - move hdr-ohip-nbr to clmhdr-health-care-nbr
                                                clmhdr-health-care-nbr
*       endif
    else
    if hdr-health-care-prov = 'MB'
    then
* 2005/06/23 - MC - Manitoba should be 9 digits
*        if   (    (mb-6-digits is not numeric)
*             or  (mb-6-digits =  spaces or zeros)
        if   (    (mb-9-digits is not numeric)
              or  (mb-9-digits =  spaces or zeros)
* 2005/06/23 - end
              or  (mb-last-digits not = spaces)
             )
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line thru xb0-99-exit
            move 1                      to ws-carriage-ctrl
            move 40                     to err-ind
            move hdr-health-care-prov   to err-prov
            move hdr-ohip-nbr           to err-ohip-nbr
            perform zb0-build-write-err-rpt-line thru zb0-99-exit
*           MOVE "?"                    TO      CLMHDR-PAT-KEY-TYPE
*           MOVE "????????"             TO      CLMHDR-PAT-KEY-DATA
            move "O"                    to      clmhdr-pat-key-type
            move hdr-ohip-nbr           to      clmhdr-pat-key-data
        else
            move "O"                    to      clmhdr-pat-key-type
            move hdr-ohip-nbr           to      clmhdr-pat-key-data
* 2001/02/07 - MC - move hdr-ohip-nbr to clmhdr-health-care-nbr
                                                clmhdr-health-care-nbr.
*       endif
*   endif

* 2013/04/17 - MC24
ga0-90.
* 2013/04/17 - end

    perform ga1-build-addr-rec-from-hdr2    thru ga1-99-exit.

ga0-99-exit.
   exit.


ga1-build-addr-rec-from-hdr2.

    move unpriced-clmhdr-pat-surname     to      addr-surname.
    move unpriced-clmhdr-given-name      to      addr-first-name.
    if   unpriced-clmhdr-sex = "1"
    then
         move "M"                       to      addr-sex
    else
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 120
*                      newu701.cbl                                   )
    if   unpriced-clmhdr-sex = "2"
    then
         move "F"                       to      addr-sex
    else
         move unpriced-clmhdr-sex        to      addr-sex.
*   endif

*   (if phone nbr is only 7 digits long then default to local area code)
    move unpriced-clmhdr-phone-no       to      temp-phone-nbr.
    if    (    temp-phone-nbr-1-3  =  0
           and temp-phone-nbr-4-10 <> 0
          )
       or (    temp-phone-nbr-1-7  <> 0
           and temp-phone-nbr-8-10 =  0
          )
    then
*       (default area-code)
        move default-area-code           to     unpriced-clmhdr-phone-no-1-3
        if temp-phone-nbr-8-10 = 0
        then
            move temp-phone-nbr-1-7      to     unpriced-clmhdr-phone-no-4-10
        else
            move temp-phone-nbr-4-10     to     unpriced-clmhdr-phone-no-4-10.
*       endif
*   endif

    move unpriced-clmhdr-phone-no         to      addr-phone-no.


ga1-99-exit.
    exit.

gb1-verify-dtl-diag-cd.

    if hold-diag-cd(ss-write-dtl) =   spaces
                                   or zeros
    then
*       (CHECK IF CODE REQUIRES A DIAGNOSIS CODE)
        if    hold-oma-rec-ind (ss-write-dtl, ss-diag-ind) = "Y"
          and hold-oma-suff    (ss-write-dtl)              = "A" or "M"
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line
                                          thru    xb0-99-exit
            move 1                        to      ws-carriage-ctrl
            move 22                       to      err-ind
            move hold-oma-cd(ss-write-dtl) to     err-22-oma-cd
            move "DIAGNOSTIC CODE"        to      err-22-msg
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit
*           MOVE "???"                    TO      CLMDTL-DIAG-CD-ALPHA
            move zero                     to      clmdtl-diag-cd
        else
*           (NO DIAG. CODE SPECIFIED BUT NONE WAS REQUIRED)
            move zero                     to      clmdtl-diag-cd
*       endif
    else
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 121
*                      newu701.cbl                                   )
*       (DIAG. CODE SPECIFIED - ENSURE THAT CODE IS VALID)
        move hold-diag-cd(ss-write-dtl) to      diag-cd
*##     CHCE3DCK ROUTINE TO SEE IF USING HOLD
        perform fb03-verify-diag-code     thru    fb03-99-exit
*       IF INVALID-DIAG-CODE
*       THEN
*           MOVE "???"                    TO      CLMDTL-DIAG-CD-ALPHA
*       ELSE
            move hold-diag-cd(ss-write-dtl)
                                          to      clmdtl-diag-cd
*           (### ENSURE THAT CLMHDR STILL AVAILLE AND NOT NEW REC)
*mf            if clmhdr-diag-cd = spaces or zeros
            if clmhdr-diag-cd-alpha = spaces or zeros
            then
                move hold-diag-cd(ss-write-dtl)
                                          to      clmhdr-diag-cd.
*           endif
*       endif
*   endif

gb1-99-exit.
    exit.

*2000/04/28 - B.A. begin
copy "d001_d003_newu701_confidentiality_check.rtn".
*  file: d001_d003_newu701_confidentiality_check.rtn

* 2000/may/26 B.E. - original

ga11-check-for-confidentially.

*   (skip checking if already flagged by user as confidential)
    if clmhdr-confidential-flag =    "Y"
                                  or "R"
    then
        go to ga11-99-exit.
*   endif

    perform ga11a-check-conf-ministry           thru ga11a-99-exit.
    if clmhdr-confidential-flag     <> "Y"
                                and <> "R"
    then
        perform ga11b-check-conf-rma            thru ga11b-99-exit.
*   endif


ga11-99-exit.
    exit.

copy "confidentially_check_ministry_codes.rtn".
* file: confidentially_check_ministry_codes.rtn
*       (These edits ensure no verification letter is sent to a patient.
*       The codes checked match codes that the ministry automatically
*       recognizes as confidential and won't send letters for, but must
*       be flagged for internal RMA processing to ensure that RMA doesn't
*       send letters either)
*
* 2000/may 26 B.E. - original
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 122
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/con)

ga11a-check-conf-ministry.

*   (Don't override the "Y"es to be sent to the ministry with an "R"MA flag)
    if clmhdr-confidential-flag = "Y"
    then
        go to ga11a-99-exit.
*   endif

*   (ministry will 'no verify' these codes but RMA processing must also ignore)
    if hold-diag-cd (ss-clmdtl-oma) =
                                           099
                                        or 290
                                        or 291
                                        or 292
                                        or 295
                                        or 296
                                        or 297
                                        or 298
                                        or 299
                                        or 634
                                        or 635
                                        or 640
                                        or 895

    then
        move 'R'                to clmhdr-confidential-flag
    else
*       (ministry doesn't automatically 'no verify' these codes so set flag)
        if hold-oma-cd (ss-clmdtl-oma) =
                                           'A777'
                                        or 'A902'

                                        or 'C777'

                                        or 'E108'
                                        or 'E753'

                                        or 'K015'
                                        or 'K018'
                                        or 'K021'
                                        or 'K051' or 'K052' or 'K053'
                                        or 'K061'
                                        or 'K620'
                                        or 'K623' or 'K624'
                                        or 'K629'

                                        or 'G100'

                                        or 'R200'
                                        or 'R872'

                                        or 'S274'
                                        or 'S436'
                                        or 'S626'
                                        or 'S738'
                                        or 'S741'
                                        or 'S752'
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 123
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/con)
                                        or 'S756'
                                        or 'S768'
                                        or 'S783'
                                        or 'S785'

                                        or 'W777'
        then
            move 'R'            to clmhdr-confidential-flag.
*           endif
*       endif
*   endif

ga11a-99-exit.
    exit.
copy "confidentially_check_rma_codes.rtn".
* file: confidentially_check_rma_codes.rtn
*       (edits in addition to the ministry codes, that ensure no verification
*       letter is sent to a patient.  These are addition codes that the ministry
*       DOESN'T automatically supress letters for, but for which RMA
*       wants to suppress any contact with patient.)
*
* 00/may 26 B.E. - original
* 00/sep/15 B.E. - removed all but 1 diag code and 1 oma code as per Thekla
* 00/sep/26 B.E. - as per Dr Hucker request added 302

ga11b-check-conf-rma.

*   (check DIAGNOSIS Code)
    if hold-diag-cd (ss-clmdtl-oma) =
                                           632
                                        or 302


*                                          042
*                                       or 043
*                                       or 044
*                                       or 097
*                                       or 098
*                                       or 300
*                                       or 301
*                                       or 311
*                                       or 319


    then
        move 'R'                to clmhdr-confidential-flag
    else
*       (check BILLING Code)
        if hold-oma-cd (ss-clmdtl-oma) =
                                           'G362'



*                                          'A193' or 'A194'
*                                       or 'A195' or 'A196' or 'A197' or 'A198'
*                                       or 'A395'
*
*                                       or 'C192' or 'C193'
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 124
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/con)
*                                       or 'C195' or 'C196' or 'C197'
*                                       or 'C198' or 'C199'
*                                       or 'C395'
*
*                                       or 'K004' or 'K005'
*                                       or 'K007' or 'K008'
*                                       or 'K010'
*                                       or 'K012'
*                                       or 'K024' or 'K025'
*                                       or 'K190' or 'K191' or 'K192'
*                                       or 'K193' or 'K194' or 'K195'
*                                       or 'K196' or 'K197' or 'K198'
*                                       or 'K199'
*                                       or 'K200' or 'K201' or 'K202'
*                                       or 'K203' or 'K204' or 'K205'
*                                       or 'K206' or 'K207'
*
*                                       or 'W195' or 'W196'
*                                       or 'W395'
        then
            move 'R'            to clmhdr-confidential-flag.
*           endif
*       endif
*   endif

ga11b-99-exit.
    exit.


ha0-proc-rec-type-detail.

*   (move the 2 service details from the 'unpriced' rec to pricing hold area)
    add 1                               to                   ss-clmdtl-oma.

    move unpriced-itm1-oma-svc-code      to hold-oma-cd      (ss-clmdtl-oma).
    move unpriced-itm1-oma-svc-suff      to hold-oma-suff    (ss-clmdtl-oma).

*  2008/04/29 - MC - transfer oma code edit check to the copybook 'd001_newu701_
    perform la4-oma-code-edit           thru la4-99-exit.
* 2008/04/29 - end

copy "pricing_logic_check_for_special_addon_codes.rtn"
        replacing  ==ws-oma-cd== by ==hold-oma-cd(ss-clmdtl-oma)==.

*       (set flag if special add on oma codes of e409 or e400
*        or e401 or e410 entered)
    if hold-oma-cd(ss-clmdtl-oma) =
copy "special_addon_codes.rtn".
                     "E400"
                  or "E409"
* brad3 (2011/nov/02)
                  or "E412"
                  or "E401"
                  or "E410"
* brad3 (2011/nov/02)
                  or "E413"
*(2005/10/01)
                  or "E420"
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 125
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/spe)
*(2005/10/01)
    then
        move "Y"                                to ws-special-add-on-cd-entered.
*   (else)
*   endif
**   (00/aug/31 B.E. set flag is special addin code found)
**   (set flag if special add on oma codes of e409 or e400
**    or e401 or e410 entered)
*    if hold-oma-cd(ss-clmdtl-oma) =  "E400"
**                                 or "E409"
*                                  or "E401"
*                                  or "E410"
*    then
*        move "Y"                               to ws-special-add-on-cd-entered.
**   endif

*   MOVE TAPEOUT-ITM1-OMA-AMT-BILLED    TO HOLD-FEE-BILLED  (SS-CLMDTL-OMA).

*   (save incoming $ and #-svcs so that if RMA pricing alters these
*    values they can be recovered if needed)
    move unpriced-itm1-oma-amt-billed    to hold-fee-incoming(ss-clmdtl-oma).
    move unpriced-itm1-nbr-serv         to hold-sv-nbr-serv-incoming
                                                            (ss-clmdtl-oma).
*
    move unpriced-itm1-override-price    to hold-override-price
                                                            (ss-clmdtl-oma).
    move unpriced-itm1-bilateral         to hold-bilateral   (ss-clmdtl-oma).
*   (IF PRICE OVERRIDE IS REQUESTED THEN MOVE THE ENTERED FEE INTO FEE-OMA/OHIP)
*  (NOTE: PRICE OVERRIDE FLAG ASSUMED TO BE SET IF THE INCOMING RECORD
*         HAS PRICES. THIS HANDLES PC BASED BILLING PACKAGES THAT PRICE
*         CLAIMS BUT DON'T SET THE PRICE OVERRIDE FLAG.
*         THIS CODE SHOULD EVENTUALLY BE CHANGED TO USE THE INCOMING
*         PRICE BUT REPORT IF THE RMA PRICING SOFTWARE CALCULATES
*         A DIFFERENT PRICE)

    inspect unpriced-itm1-oma-amt-billed replacing all space-char by zeros.

*    if unpriced-itm1-oma-amt-billed not = 0
*    then
*        move "Y"               to      unpriced-itm1-override-price.
**   endif

*    if   unpriced-itm1-override-price = "Y"

    if unpriced-itm1-oma-amt-billed not = 0
    then
        move unpriced-itm1-oma-amt-billed to hold-fee-incoming(ss-clmdtl-oma)
    else
        move 0                            to hold-fee-oma     (ss-clmdtl-oma)
                                             hold-basic-prof  (ss-clmdtl-oma)
                                             hold-fee-ohip    (ss-clmdtl-oma).
*   endif

    move unpriced-itm1-nbr-serv          to hold-sv-nbr-serv (ss-clmdtl-oma).
*   (REPEATING SERVICES NOT ALLOWED IN OHIP SUBMITTAL TAPE SPECIFICATION)
    move 0                              to hold-sv-nbr      (ss-clmdtl-oma,1)
                                           hold-sv-nbr      (Ss-clmdtl-oma,2)
                                           hold-sv-nbr      (ss-clmdtl-oma,3)
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 126
*                      newu701.cbl                                   )
                                           hold-sv-day-num  (ss-clmdtl-oma,1)
                                           hold-sv-day-num  (ss-clmdtl-oma,2)
                                           hold-sv-day-num  (ss-clmdtl-oma,3).
*  (if Override Price or Bilateral flags set, then default the first
*   repetitive day field as per the way D001 works)

    if unpriced-itm1-override-price = "Y"
    then
        move "OP"                       to hold-sv-day      (ss-clmdtl-oma,1)
    else
    if unpriced-itm1-bilateral = "Y"
    then
        move "BI"                       to hold-sv-day      (ss-clmdtl-oma,1).
*   ENDCASE

    move unpriced-itm1-svc-date          to hold-sv-date     (ss-clmdtl-oma).
    move unpriced-itm1-diag-cd           to hold-diag-cd     (ss-clmdtl-oma).
    move hold-oma-cd (ss-clmdtl-oma)    to fee-oma-cd.
    perform xc0-check-oma-code          thru xc0-99-exit.
*   (00/04/28 - B.A. begin)
*   (The check for oma and diag code is to set the confidentiality flag
*    at the detail level)
    perform ga11-check-for-confidentially thru ga11-99-exit.
*   (00/04/28 end)

* 2011/05/18 - MC15
    perform ha12-check-for-sli-oma thru ha12-99-exit.
* 2011/05/18 - end

    perform ha1-move-pricing-to-hold    thru ha1-99-exit.

* ## BELOW FLAG MOVED - WHAT IMPACT ON RESET OF PGM)
*   MOVE 'Y'                            TO DETAIL-WRITTEN-FLAG.

    if unpriced-itm2-oma-svc-code = spaces
    then
*       (MOVE DETAIL REC TO PRICING HOLD AREA)
        go to ha0-90-after-2nd-detail.
*   endif

    add 1                               to                   ss-clmdtl-oma.

    move unpriced-itm2-oma-svc-code      to hold-oma-cd      (ss-clmdtl-oma).
    move unpriced-itm2-oma-svc-suff      to hold-oma-suff    (ss-clmdtl-oma).

*  2008/04/29 - MC - transfer oma code edit check to the copybook 'd001_newu701_
    perform la4-oma-code-edit           thru la4-99-exit.
* 2008/04/29 - end


copy "pricing_logic_check_for_special_addon_codes.rtn"
        replacing  ==ws-oma-cd== by ==hold-oma-cd(ss-clmdtl-oma)==.

*       (set flag if special add on oma codes of e409 or e400
*        or e401 or e410 entered)
    if hold-oma-cd(ss-clmdtl-oma) =
copy "special_addon_codes.rtn".
                     "E400"
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 127
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/spe)
                  or "E409"
* brad3 (2011/nov/02)
                  or "E412"
                  or "E401"
                  or "E410"
* brad3 (2011/nov/02)
                  or "E413"
*(2005/10/01)
                  or "E420"
*(2005/10/01)
    then
        move "Y"                                to ws-special-add-on-cd-entered.
*   (else)
*   endif
*   (00/aug/31 B.E. set flag is special addin code found)
*   (set flag if special add on oma codes of e409 or e400
*    or e401 or e410 entered)
*    if hold-oma-cd(ss-clmdtl-oma) =  "E400"
*                                  or "E409"
*                                  or "E401"
*                                  or "E410"
*    then
*        move "Y"                                to ws-special-add-on-cd-entered
*   endif

*   MOVE TAPEOUT-ITM2-OMA-AMT-BILLED    TO HOLD-FEE-BILLED  (SS-CLMDTL-OMA).

*   (save incoming $ and #-svcs so that if RMA pricing alters these
*    values they can be recovered if needed)
    move unpriced-itm2-oma-amt-billed    to hold-fee-incoming(ss-clmdtl-oma).
    move unpriced-itm2-nbr-serv         to hold-sv-nbr-serv-incoming
                                                            (ss-clmdtl-oma).

    move unpriced-itm2-override-price    to hold-override-price
                                                            (ss-clmdtl-oma).
    move unpriced-itm2-bilateral         to hold-bilateral   (ss-clmdtl-oma).

*    if unpriced-itm2-oma-amt-billed not = 0
*    then
*        move "Y"               to      unpriced-itm2-override-price.
**   endif

*    if unpriced-itm2-override-price = "Y"

    if unpriced-itm2-oma-amt-billed not = 0
    then
        move unpriced-itm2-oma-amt-billed to hold-fee-incoming(ss-clmdtl-oma)
    else
        move 0                            to hold-fee-oma     (ss-clmdtl-oma)
                                             hold-basic-prof  (ss-clmdtl-oma)
                                             hold-fee-ohip    (ss-clmdtl-oma).
*   endif

    move unpriced-itm2-nbr-serv          to hold-sv-nbr-serv (ss-clmdtl-oma).
    move 0                              to hold-sv-nbr      (ss-clmdtl-oma,1)
                                           hold-sv-nbr      (ss-clmdtl-oma,2)
                                           hold-sv-nbr      (ss-clmdtl-oma,3)
                                           hold-sv-day-num  (ss-clmdtl-oma,1)
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 128
*                      newu701.cbl                                   )
                                           hold-sv-day-num  (ss-clmdtl-oma,2)
                                           hold-sv-day-num  (ss-clmdtl-oma,3).
    move unpriced-itm2-svc-date          to hold-sv-date   (ss-clmdtl-oma).
    move unpriced-itm2-diag-cd           to hold-diag-cd   (ss-clmdtl-oma).
*  (if Override Price or Bilateral flags set, then default the first
*   repetitive day field as per the way D001 works)

    if unpriced-itm2-override-price = "Y"
    then
        move "OP"                       to hold-sv-day      (ss-clmdtl-oma,1)
    else
    if unpriced-itm2-bilateral = "Y"
    then
        move "BI"                       to hold-sv-day      (ss-clmdtl-oma,1).
*   ENDCASE

*   (CALL TO THESE 2 ROUTINES MOVED TO OUTPUT OF SUSPENSE RECORDS)
*    EXCEPT FOR READ OF OMA-FEE-MSTR SINCE VALUES NEEDED NOW TO
*    PUT INTO HOLD AREA FOR LATER PRICING CACULATIONS)
*    PERFORM HB0-BUILD-SUSP-DTL-REC-FROM-DTL THRU HB0-99-EXIT
*    PERFORM YD0-WRITE-DTL-REC THRU YD0-99-EXIT.

    move hold-oma-cd(ss-clmdtl-oma)     to   fee-oma-cd.
    perform xc0-check-oma-code          thru xc0-99-exit.
*   (00/04/28 - B.A. begin)
*   (The check for oma and diag code is to set the confidentiality flag
*    at the detail level)
    perform ga11-check-for-confidentially thru ga11-99-exit.
*   (00/04/28 end)

* 2011/05/18 - MC15
    perform ha12-check-for-sli-oma thru ha12-99-exit.
* 2011/05/18 - end

    perform ha1-move-pricing-to-hold    thru ha1-99-exit.

ha0-90-after-2nd-detail.

ha0-99-exit.
    exit.



ha1-move-pricing-to-hold.
*WC0-MOVE-OMA-DATA-TO-HOLD. (TAKEN FROM D001.CB)

*   (save the nbr of the incoming detail record so that if the pricing
*    module re-sorts the claim details within the hold area, the program
*    can use the hold-line-no field to re-sort the records back into
*    the original sequence)
    move  ss-clmdtl-oma      to hold-line-no         (ss-clmdtl-oma).

*        (MOVE OMA REC'S DATA TO THE DETAIL ENTRY'S HOLD AREA)

    move fee-tech-ind        to hold-oma-rec-ind(ss-clmdtl-oma,ss-tech-ind).
    move fee-diag-ind        to hold-oma-rec-ind(ss-clmdtl-oma,ss-diag-ind).
    move fee-phy-ind         to hold-oma-rec-ind(ss-clmdtl-oma,ss-phy-ind).
    move fee-hosp-nbr-ind    to hold-oma-rec-ind(ss-clmdtl-oma,ss-hosp-nbr-ind).
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 129
*                      newu701.cbl                                   )
    move fee-i-o-ind         to hold-oma-rec-ind(ss-clmdtl-oma,ss-i-o-ind).
    move fee-admit-ind       to hold-oma-rec-ind(ss-clmdtl-oma,ss-admit-ind).
    move fee-special-m-suffix-ind
                             to hold-oma-rec-ind(ss-clmdtl-oma,ss-special-m-suff

    move fee-icc-sec         to hold-icc-sec    (ss-clmdtl-oma).
    move fee-icc-grp         to hold-icc-grp    (ss-clmdtl-oma).

*   (move oma rec's fees according to whether service is current or
*    previous fees
*    -- if service date is < constants mstr "CURRENT PRICES EFFECT DATE"
*       then use previous rates)
*   (change to use f040 oma fee code's effective date rather than
*    constants master's date)
*     if hold-sv-date (ss-clmdtl-oma) < const-effective-date (curr)

* MC44 - for bill direct , check with const-effective-date instead of fee-effect
    if def-agent-bill-direct
    then
        if hold-sv-date (ss-clmdtl-oma) < const-effective-date (curr)
        then
            move prev                       to hold-ss-curr-prev(ss-clmdtl-oma)
        else
            move curr                       to hold-ss-curr-prev(ss-clmdtl-oma)
*       endif
    else
* MC44 - end
    if hold-sv-date (ss-clmdtl-oma) < fee-effective-date
    then
        move prev                       to hold-ss-curr-prev(ss-clmdtl-oma)
    else
        move curr                       to hold-ss-curr-prev(ss-clmdtl-oma).
*   endif

    move hold-ss-curr-prev(ss-clmdtl-oma)
                                        to ss-curr-prev.
    move fee-1    (ss-curr-prev, oma)  to hold-oma-fee-1   (ss-clmdtl-oma, oma).
    move fee-2    (ss-curr-prev, oma)  to hold-oma-fee-2   (ss-clmdtl-oma, oma).
    move fee-anae (ss-curr-prev, oma)  to hold-oma-fee-anae(ss-clmdtl-oma, oma).
    move fee-asst (ss-curr-prev, oma)  to hold-oma-fee-asst(ss-clmdtl-oma, oma).
    move fee-1    (ss-curr-prev,ohip)  to hold-oma-fee-1   (ss-clmdtl-oma,ohip).
    move fee-2    (ss-curr-prev,ohip)  to hold-oma-fee-2   (ss-clmdtl-oma,ohip).
    move fee-anae (ss-curr-prev,ohip)  to hold-oma-fee-anae(ss-clmdtl-oma,ohip).
    move fee-asst (ss-curr-prev,ohip)  to hold-oma-fee-asst(ss-clmdtl-oma,ohip).
    move fee-min  (ss-curr-prev,ohip)  to hold-fee-min     (ss-clmdtl-oma,ohip).
    move fee-max  (ss-curr-prev,ohip)  to hold-fee-max     (ss-clmdtl-oma,ohip).
*   (be2)
* MC44
*    move fee-min  (ss-curr-prev,ohip) to hold-fee-min      (ss-clmdtl-oma,oma )
*    move fee-max  (ss-curr-prev,ohip) to hold-fee-max      (ss-clmdtl-oma,oma )
     move fee-min  (ss-curr-prev,oma)  to hold-fee-min      (ss-clmdtl-oma,oma )
     move fee-max  (ss-curr-prev,oma)  to hold-fee-max      (ss-clmdtl-oma,oma )
* MC44 - end

    move fee-add-on-cd(ss-curr-prev,1) to hold-oma-add-on-cd(ss-clmdtl-oma, 1).
    move fee-add-on-cd(ss-curr-prev,2) to hold-oma-add-on-cd(ss-clmdtl-oma, 2).
    move fee-add-on-cd(ss-curr-prev,3) to hold-oma-add-on-cd(ss-clmdtl-oma, 3).
    move fee-add-on-cd(ss-curr-prev,4) to hold-oma-add-on-cd(ss-clmdtl-oma, 4).
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 130
*                      newu701.cbl                                   )
    move fee-add-on-cd(ss-curr-prev,5) to hold-oma-add-on-cd(ss-clmdtl-oma, 5).
    move fee-add-on-cd(ss-curr-prev,6) to hold-oma-add-on-cd(ss-clmdtl-oma, 6).
    move fee-add-on-cd(ss-curr-prev,7) to hold-oma-add-on-cd(ss-clmdtl-oma, 7).
    move fee-add-on-cd(ss-curr-prev,8) to hold-oma-add-on-cd(ss-clmdtl-oma, 8).
    move fee-add-on-cd(ss-curr-prev,9) to hold-oma-add-on-cd(ss-clmdtl-oma, 9).
    move fee-add-on-cd(ss-curr-prev,10) to hold-oma-add-on-cd(ss-clmdtl-oma,10).
    move fee-oma-ind-card-requireds(ss-curr-prev)
                                to hold-oma-ind-card-requireds(ss-clmdtl-oma).

*   (oma fee mstr records for sp add-ons should have data duplicated
*    in fee-1 and fee-2 for 'f'lat or 'p'erc rates. Some do not and
*    therefore require this logic patch)
*   (00/aug/08 B.E.
*    recognize 'add on' codes by "P"ercent/"F"lat designation rather
*    than having to have a specific ICC code)
*   if hold-icc-cd (ss-clmdtl-oma) = 'SP98'
*                                 or 'SP99'
    if fee-add-on-perc-or-flat-ind(ss-curr-prev) =   "P"
                                                  or "F"
    then
        perform ha1a-addon-fee-fix      thru ha1a-99-exit.
*   endif

    if fee-add-on-perc-or-flat-ind(ss-curr-prev) =   "P"
                                                  or "F"
    then
        move fee-add-on-perc-or-flat-ind(ss-curr-prev)
                 to hold-oma-rec-ind (ss-clmdtl-oma,ss-add-on-perc-or-flat-ind)
    else
        move " " to hold-oma-rec-ind (ss-clmdtl-oma,ss-add-on-perc-or-flat-ind).
*   endif

*   (if indicator for flat vs percent not set then use fee > 1.00 as flat
*                                                      and < 1.01 as percent
*   (00/aug/08 B.E. - removed below code - the "F"lat or "P"ercentage
*                     MUST be set in order to identify code as an 'add on',
*                     so no defaulting of flag can now be performed.)
*    else
*        if hold-oma-fee-1 (ss-clmdtl-oma,  oma) > 1.00
*        then
*            move "F"    to hold-oma-rec-ind     (ss-clmdtl-oma, ss-add-on-perc-
*        else
*            move "P"    to hold-oma-rec-ind     (ss-clmdtl-oma, ss-add-on-perc-
**       endif
**   endif

ha1-99-exit.
    exit.

ha1a-addon-fee-fix.

*   (format of f040 file fees is: 99.999 allowing only 3 decimals. 2001/apr/23
*    requirement was for 4 decimal positions only for PERCENTAGE based addons.
*    Percentages were originally stored using only the numbers after the
*    decimal place. Conversion run to multiply by 100 and now percentages
*    that were stored as .605 were stored as 60.500 . This means that
*    when pricing claims the Percentage rates must be divided by 100 before
*    moving into pricing hold variables.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 131
*                      newu701.cbl                                   )
    if fee-add-on-perc-or-flat-ind(ss-curr-prev) =   "P"
    then
        compute hold-oma-fee-1 (ss-clmdtl-oma,  oma) =
                hold-oma-fee-1 (ss-clmdtl-oma,  oma) / 100
        compute hold-oma-fee-2 (ss-clmdtl-oma,  oma) =
                hold-oma-fee-2 (ss-clmdtl-oma,  oma) / 100
        compute hold-oma-fee-1 (ss-clmdtl-oma, ohip) =
                hold-oma-fee-1 (ss-clmdtl-oma, ohip) / 100
        compute hold-oma-fee-2 (ss-clmdtl-oma, ohip) =
                hold-oma-fee-2 (ss-clmdtl-oma, ohip) / 100.
*   endif

*       (IF 'OMA' FEE-1  RATE IS ZERO, THEN USE FEE-2 AND VISA VERSA)
    if        hold-oma-fee-1 (ss-clmdtl-oma,  oma) = 0
    then
       move  hold-oma-fee-2 (ss-clmdtl-oma,  oma)       to hold-oma-fee-1(ss-clm
    else
        if        hold-oma-fee-2 (ss-clmdtl-oma,  oma) = 0
        then
            move  hold-oma-fee-1 (ss-clmdtl-oma,  oma)  to hold-oma-fee-2(ss-clm
        else
            next sentence.
*       endif
*   endif

*       (IF 'OHIP' FEE-1  RATE IS ZERO, THEN USE FEE-2 AND VISA VERSA)
    if        hold-oma-fee-1 (ss-clmdtl-oma, ohip) = 0
    then
        move  hold-oma-fee-2 (ss-clmdtl-oma, ohip)      to hold-oma-fee-1(ss-clm
    else
        if        hold-oma-fee-2 (ss-clmdtl-oma, ohip) = 0
        then
            move  hold-oma-fee-1 (ss-clmdtl-oma, ohip)  to hold-oma-fee-2(ss-clm
        else
            next sentence.
*       endif
*   endif
*

ha1a-99-exit.
    exit.

* 2011/06/13 - MC16 - ha12-check-for-sli-oma & hb0-build-susp-dtl-rec-dtl subrou
*                   copybook $use/newu701_oscar_dtl_edit_check.rtn

copy "newu701_oscar_dtl_edit_check.rtn".
*  $use/newu701_oscar_dtl_edit_check.rtn  - used in newu701.cbl & u701oscar.cbl

* 2011/05/18 - MC15
ha12-check-for-sli-oma.

    move hold-oma-cd (ss-clmdtl-oma)            to sli-oma-code.
    move hold-oma-suff(ss-clmdtl-oma)           to sli-oma-suff.
    move loc-service-location-indicator         to sli-code.

    read  sli-oma-code-suff-mstr
        invalid key
            go to ha12-99-exit.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 132
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)

    if sli-admit-ind = 'Y' and (hdr-admit-date = spaces or zeroes)
    then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 118                        to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

    if sli-admit-ind = 'N' and (hdr-admit-date not = spaces and not = zeroes)
    then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 119                        to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

ha12-99-exit.
   exit.
* 2011/05/18 - end



hb0-build-susp-dtl-rec-dtl.

*   (THIS ROUTINE CALLED PASSING SS-WRITE-DTL AS SUBSCRIPT OF PRICED HOLD AREA)

    move spaces                         to   suspend-dtl-rec.

*   (keep BI and OP flags by moving them into consecutives services area)
    move hold-sv-day(ss-write-dtl,1)    to clmdtl-sv-day(1).
    move hold-sv-day(ss-write-dtl,2)    to clmdtl-sv-day(2).
    move hold-sv-day(ss-write-dtl,3)    to clmdtl-sv-day(3).
*   (00/sep/12 B.E. repetitive services were not initialized)
    move 0                              to clmdtl-sv-nbr(1)
                                           clmdtl-sv-nbr(2)
                                           clmdtl-sv-nbr(3).

*   ## CHECK IF CLMHDR-STILL AVAILABLE - MIGHT HAVE BEEN READ INTO BY
*   ## NEW HAEADER???
    move clmhdr-batch-nbr               to   clmdtl-batch-nbr.

    move hold-oma-cd(ss-write-dtl)      to   clmdtl-oma-cd
                                             fee-oma-cd.
    move hold-oma-suff(ss-write-dtl)    to   clmdtl-oma-suff.
    move 0                              to   clmdtl-adj-nbr.
    move 0                              to   clmdtl-rev-group-cd.
    move clmhdr-agent-cd                to   clmdtl-agent-cd.
    move clmhdr-adj-cd                  to   clmdtl-adj-cd.

*2001/02/28 - MC - default clmhdr-status into clmdtl-status
*2001/03/30 - BE - if not 'I'gnore status, then if claim details have been
*                  altered due to tech/prof/suffix rule processing,
*                  then update detail/header status to "U"pdated
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 133
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
    if     tech-prof-suff-rule-applied
       and clmhdr-status <> "I"
    then
* 2005/08/17 - MC
*       move "U"                        to   clmdtl-status
        move "U"                        to   clmdtl-status of suspend-dtl-rec
                                             clmhdr-status
    else
*       move clmhdr-status              to   clmdtl-status.
        move clmhdr-status              to   clmdtl-status of suspend-dtl-rec.
* 2005/08/17 - end
*   endif

    perform gb1-verify-dtl-diag-cd thru gb1-99-exit.

    if    hold-sv-nbr-serv(ss-write-dtl) = 0
      and not price-only-claim
    then
        move ws-error-literal           to   err-warn-msg
        perform xb0-print-warning-line thru xb0-99-exit
        move 1                          to   ws-carriage-ctrl
        move 38                         to   err-ind
        move hold-sv-nbr-serv(ss-write-dtl)
                                        to   err-nbr-of-serv
        perform zb0-build-write-err-rpt-line thru zb0-99-exit
*       MOVE '??'                       TO   CLMDTL-NBR-SERV-ALPHA
    else
*       (91/MAR/13 B.E.)
*       (SUM NBR SERVICES FOR AUDIT TOTALS)
*       ADD  DTL-NBR-OF-SERV            TO   CTR-TOT-SVCS-READ
        add  hold-sv-nbr-serv(ss-write-dtl)
                                        to   ctr-tot-svcs-read
*       MOVE DTL-NBR-OF-SERV            TO   CLMDTL-NBR-SERV
        move hold-sv-nbr-serv(ss-write-dtl)
                                        to   clmdtl-nbr-serv.
*   endif

    if    hold-fee-ohip     (ss-write-dtl)  = 0
      and not price-only-claim
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line thru xb0-99-exit
        move 1                          to   ws-carriage-ctrl
        move 39                         to   err-ind
*       MOVE DTL-FEE-BILLED             TO   ERR-FEE-BILLED
        move hold-fee-ohip (ss-write-dtl)
                                        to   err-fee-billed
        perform zb0-build-write-err-rpt-line thru zb0-99-exit.


*    (2000/03/20 - MC - check the two prices)
*    if  hold-fee-incoming(ss-write-dtl) not = 0  and
*       hold-fee-incoming(ss-write-dtl) not = hold-fee-ohip(ss-write-dtl)
*    then
*       move ws-warning-literal         to      err-warn-msg
*        perform xb0-print-warning-line  thru    xb0-99-exit
*        move 1                          to      ws-carriage-ctrl
*        move 52                         to      err-ind
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 134
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
*        move hold-fee-incoming(ss-write-dtl) to err-52-incoming-fee
*        move hold-fee-ohip    (ss-write-dtl) to err-52-ohip-fee
*        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit.
*   endif


*   (ya0- pricing logic has determined correction price to use and therefore
*         this routine can use the hold-fee-ohip)
*           if  hold-fee-incoming(ss-write-dtl) not = 0
*           then
*               move hold-fee-incoming(ss-write-dtl)to clmdtl-fee-oma
*                                                      clmdtl-fee-ohip
*           else

*   (00/sep/08 B.E. - don't automatically use ohip fees for both)
*            move hold-fee-ohip(ss-write-dtl)      to clmdtl-fee-oma
*                                                     clmdtl-fee-ohip.
     move hold-fee-oma (ss-write-dtl)    to clmdtl-fee-oma.
     move hold-fee-ohip(ss-write-dtl)    to clmdtl-fee-ohip.

*   (2000/jun/05 B.E. correct pricing of tech portion of fee)
    move hold-priced-tech(ss-write-dtl)       to clmdtl-amt-tech-billed

*   (Perform a second read to oma-fee-mstr for each detail
*    before any edit checks.)
    perform xc0-check-oma-code          thru xc0-99-exit.

*   (verify specialty against ohip code in header rec)
    if    (   fee-spec-fr < batch-specialty
           or fee-spec-fr = batch-specialty)
      and (   fee-spec-to = batch-specialty
           or fee-spec-to > batch-specialty)
    then
        move batch-specialty           to      clmhdr-doc-spec-cd
    else
        if not price-only-claim
        then
            move ws-error-literal           to  err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 21                         to      err-ind
            move batch-specialty           to      err-21-value-1
            move hold-oma-cd(ss-write-dtl)  to      err-21-value-2
            move fee-spec-fr                to      err-21-value-3
            move fee-spec-to                to      err-21-value-4
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
            move batch-specialty           to      clmhdr-doc-spec-cd.
*   endif

*   (DETERMINE IF REFERRING PHY. NBR REQUIRED, AND IF SO THAT THE NBR IS VALID)
    if hdr-refer-pract-nbr =   spaces
                            or zeros
    then
* 2013/06/18 - MC26 - set referring doc nbr = batch-provider-nbr if
*                     oma codes = 'GnnnA' and fee-phy-ind = 'Y'
* 2013/10/16 - MC28/MC34 - include 'J' & 'X' oma code but do not need to check s
*       if    hold-oma-cd-alpha (ss-write-dtl) = 'G'
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 135
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
        if    hold-oma-cd-alpha (ss-write-dtl) = 'G' or 'J' or 'X'
*         and hold-oma-suff (ss-write-dtl) = 'A'
* 2013/10/16 - end
          and fee-phy-ind = 'Y'
          and not price-only-claim
        then
            move batch-provider-nbr             to clmhdr-refer-doc-nbr
        else
* 2013/06/18 - end
        if    fee-phy-ind = "Y"
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line
                                        thru    xb0-99-exit
            move 1                      to      ws-carriage-ctrl
            move 22                     to      err-ind
            move hold-oma-cd(ss-write-dtl)
                                        to      err-22-oma-cd
            move "REFERRING PHYSICIAN"  to      err-22-msg
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*       endif
*       endif

*   (DETERMINE IF DIAGNOSTIC CODE IS REQUIRED, AND IF SO THAT THE CODE IS VALID)
    if hold-diag-cd(ss-write-dtl) =   spaces
                                     or zeros
    then
        if    fee-diag-ind = "Y"
          and hold-oma-suff (ss-write-dtl)  = "A" or "M"
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line
                                        thru    xb0-99-exit
            move 1                      to      ws-carriage-ctrl
            move 22                     to      err-ind
            move hold-oma-cd(ss-write-dtl)
                                        to      err-22-oma-cd
            move "DIAGNOSTIC CODE"      to      err-22-msg
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*       endif
*   endif

*    (00/sep/14 B.E. - this edit no longer required)
*    if hdr-hosp-nbr =   spaces
*                     or zeros
*    then
*        if fee-hosp-nbr-ind = "Y"
*         and not price-only-claim
*        then
*           move ws-error-literal       to      err-warn-msg
*            perform xb0-print-warning-line
*                                        thru    xb0-99-exit
*            move 1                      to      ws-carriage-ctrl
*            move 22                     to      err-ind
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 136
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
*            move hold-oma-cd(ss-write-dtl)
*                                        to      err-22-oma-cd
*            move "HOSPITAL NUMBER"      to      err-22-msg
*            perform zb0-build-write-err-rpt-line
*                                        thru    zb0-99-exit.
**           MOVE "?"                    TO      CLMHDR-HOSP.
**       endif
**   endif

*   (DETERMINE IF IN/OUT INDICATOR IS REQUIRED, AND IF SO THAT IT IS VALID)
    if hdr-i-o-ind =   spaces
                    or zeros
    then
        if   (   fee-i-o-ind = "I"
              or fee-i-o-ind = "O"
              or fee-i-o-ind = "B"
             )
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line
                                        thru    xb0-99-exit
            move 1                      to      ws-carriage-ctrl
            move 22                     to      err-ind
            move hold-oma-cd(ss-write-dtl)
                                        to      err-22-oma-cd
            move "IN/OUT PATIENT INDICATOR"
                                        to      err-22-msg
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
        else next sentence
    else
        if   (   (     hdr-i-o-ind = "I"
                   and fee-i-o-ind <> "I"
                   and fee-i-o-ind <> "B"
                 )
              or (    hdr-i-o-ind = "O"
                  and fee-i-o-ind <> "O"
                  and fee-i-o-ind <> "B"
                 )
             )
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line
                                        thru    xb0-99-exit
            move 1                      to      ws-carriage-ctrl
            move 49                     to      err-ind
            move fee-i-o-ind            to      err-49-oma-cd
            move hdr-i-o-ind            to      err-49-hdr-cd
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*       endif
*   endif

* 2002/06/12 - MC

    if (hdr-hosp-nbr = spaces or zero) and
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 137
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
* 2002/08/12 - MC
*      (hold-oma-cd(ss-write-dtl) >= 'K994' and hold-oma-cd(ss-write-dtl) <= 'K9
      (hold-oma-cd(ss-write-dtl) >= 'K990' and hold-oma-cd(ss-write-dtl) <= 'K99
* 2002/08/12 - end
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line
                                        thru    xb0-99-exit
            move 1                      to      ws-carriage-ctrl
            move 54                     to      err-ind
            move hold-oma-cd(ss-write-dtl)
                                        to      err-54-prem-code
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*    endif

* 2002/06/12 - end

* 2002/08/21 - MC

    if (hdr-hosp-nbr = 'G000' or 'M200' or 'H000' or 'J000') and
      (hold-oma-cd(ss-write-dtl) >= 'K990' and hold-oma-cd(ss-write-dtl) <= 'K99
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line
                                        thru    xb0-99-exit
            move 1                      to      ws-carriage-ctrl
            move 55                     to      err-ind
            move hdr-hosp-nbr           to      err-55-hosp-code
            move hold-oma-cd(ss-write-dtl)
                                        to      err-55-prem-code
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*    endif

* 2002/08/21 - end

* 2003/06/11 - MC

    if (hdr-loc-nbr not = '112' ) and
* 2004/01/20 - MC
       (hdr-loc-nbr not = '153' ) and
       (hdr-loc-nbr not = '400' ) and
       (hdr-loc-nbr not = '250' ) and
       (hdr-loc-nbr not = '422' ) and
* 2004/01/20 - end
* 2004/09/27 - MC
       (hdr-loc-nbr not = '401' ) and
* 2004/09/27 - end
* 2007/10/24 - MC
       (hdr-loc-nbr not = '055' ) and
* 2007/10/24 - end
* 2007/11/22 - MC
       (hdr-loc-nbr not = '326' ) and
* 2008/01/03 - Yas
       (hdr-loc-nbr not = '122' ) and
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 138
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
* 2007/11/22 - end

* 2008/02/19 - MC
       (hdr-loc-nbr not = '344' ) and
* 2008/02/19 - end
* 2008/02/28 - MC
       (hdr-loc-nbr not = '111' ) and
       (hdr-loc-nbr not = '354' ) and
* 2008/02/28 - end
* 2008/03/18 - MC
       (hdr-loc-nbr not = '333' ) and
* 2008/03/18 - end
* 2008/10/22 - MC
       (hdr-loc-nbr not = '777' ) and
* 2008/10/22 - end

      (hold-oma-cd(ss-write-dtl) >= 'K990' and hold-oma-cd(ss-write-dtl) <= 'K99
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line
                                        thru    xb0-99-exit
            move 1                      to      ws-carriage-ctrl
            move 56                     to      err-ind
            move hdr-loc-code           to      err-56-loc-code
            move hold-oma-cd(ss-write-dtl)
                                        to      err-56-prem-code
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*    endif

* 2003/06/11 - end


*
*   (CHECK IF ADMIT DATE IS REQUIRED, AND IF SO VERIFY THAT DATE IS VALID)
    if hdr-admit-date =   spaces
                       or zeros
    then
        if    fee-admit-ind = "Y"
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line
                                        thru    xb0-99-exit
            move 1                      to      ws-carriage-ctrl
            move 22                     to      err-ind
            move hold-oma-cd(ss-write-dtl)
                                        to      err-22-oma-cd
            move "ADMIT DATE"           to      err-22-msg
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*       endif
*   endif


*  (2006/12/13 - MC - Yasemin requested to have the following 3 edit checks
*       with respect to date-of-admission and service-dates)
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 139
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)

   If     hold-oma-cd(ss-write-dtl) = 'C122' or 'C123' or 'C124'
      and hold-sv-date(ss-write-dtl) >= hdr-admit-date
      and not price-only-claim
   then
      move hdr-admit-date               to ws-date-yymmdd
      compute date-difference-in-days
                    =   (  (hold-sv-date-yy(ss-write-dtl) * 365)
                         + (hold-sv-date-mm(ss-write-dtl) *  30)
                         +  hold-sv-date-dd(ss-write-dtl)
                        )
                      - (  (ws-date-yy                    * 365)
                         + (ws-date-mm                    *  30)
                         +  ws-date-dd
                        )
*     CASE
*       (if billing code is C122 and the service date < 1 day or > 1 day from th
*       admit date, then report on ru701 (newu701) with message "Check C122")
      if      hold-oma-cd(ss-write-dtl) = 'C122'
        and  (date-difference-in-days < 1
           or date-difference-in-days > 1
             )
      then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 66                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit
      else
*        (If billing code is C123 and the service date < 2 days or > 2 days from
*         admit date, then report on ru701 (newu701) with message "Check C123")
      if      hold-oma-cd(ss-write-dtl) = 'C123'
        and  (date-difference-in-days < 2
           or date-difference-in-days > 2
             )
      then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 67                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit
      else
*        (If billing code is C124 and the service date <= 1 day from the admit d
*         then report on ru701 (newu701) with message "Check C124")
       if     hold-oma-cd(ss-write-dtl) = 'C124'
          and date-difference-in-days <= 1
       then
           move ws-error-literal           to      err-warn-msg
           perform xb0-print-warning-line  thru    xb0-99-exit
           move 1                          to      ws-carriage-ctrl
           move 68                         to      err-ind
           perform zb0-build-write-err-rpt-line
                                           thru    zb0-99-exit.
*       ENDCASE
* 2006/12/13 - end

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 140
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
*   (VERIFY SERVICE DATE IS VALID)
    move hold-sv-date-dd(ss-write-dtl) to   ws-date-dd.
    move hold-sv-date-mm(ss-write-dtl) to   ws-date-mm.
    move hold-sv-date-yy(ss-write-dtl) to   ws-date-yy.
    perform xd0-verify-date              thru xd0-99-exit.
    if    invalid-date
      and not price-only-claim
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 27                         to      err-ind
        move hold-sv-date(ss-write-dtl)
                                        to      err-27-service-date
        perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
    else
*       (service is a real date - ensure that it is not greater than the
*        run date.)
        if    hold-sv-date(ss-write-dtl) > sys-date
          and not price-only-claim
        then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 48                         to      err-ind
          move hold-sv-date(ss-write-dtl)
                                          to      err-msg-svr-date
          move sys-date                   to      err-msg-sys-date
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit
          move "????????"                 to      clmdtl-sv-date
* MC35/MC40 - check  for terminated doctor + 6 months
        else
         if   (   (hold-sv-date-yy(ss-write-dtl) * 365)
                + (hold-sv-date-mm(ss-write-dtl) *  30)
                +  hold-sv-date-dd(ss-write-dtl)
                   > (doc-date-fac-term-yy * 365) + (doc-date-fac-term-mm * 30)
              )
          and doc-date-fac-term not = zeroes
          and not price-only-claim
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line
                                        thru    xb0-99-exit
            move 1                      to      ws-carriage-ctrl
            move 128                    to      err-ind
            move doc-date-fac-term
                                        to      err-128-term-date
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
            move hold-sv-date-dd(ss-write-dtl) to      clmdtl-sv-dd
            move hold-sv-date-mm(ss-write-dtl) to      clmdtl-sv-mm
            move hold-sv-date-yy(ss-write-dtl) to      clmdtl-sv-yy
* MC35/MC40 - end
        else
*         (service is valid - ensure it is not stale-dated ie. not
*          within 6 months of current system date)
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 141
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
         if   (   (hold-sv-date-yy(ss-write-dtl) * 365)
                + (hold-sv-date-mm(ss-write-dtl) *  30)
*                 (+ 6 MONTHS TIMES 30 DAYS = 180)
* 2011/01/26 - MC12  - change to 6 months + 20 days per Yasemin
*               +  190
* 2013/07/10 - MC27  - change to 7 months per Linda O & Yasemin
*               +  200
* MC42/MC47 - change to 232 days per Yasemin
*               +  210
                +  232
* MC42/MC47 - end
* 2013/07/10 - end
* 2011/01/26 - end

                + hold-sv-date-dd(ss-write-dtl)
                   < (sys-yy * 365) + (SYS-MM * 30) + SYS-DD
              )
          and not price-only-claim
*               (02/08/21 - MC - Yas requests to bypass the edit check on
*                stale date for clinic 80 or 95)
*               (2006/05/16 b.e. - re apply this check for 80/95)
*          and   bt-clinic-nbr-1-2 not = 80
*          and   bt-clinic-nbr-1-2 not = 95
* 2002/05/03 - MC - temporary edit check (ie error if svc date < 20010901)
*         and hold-sv-date(ss-write-dtl) < 20010901
* 2002/05/03 - end
*         and hold-sv-date(ss-write-dtl) < 20120701
        then
            move ws-error-literal       to      err-warn-msg
            perform xb0-print-warning-line
                                        thru    xb0-99-exit
            move 1                      to      ws-carriage-ctrl
            move 24                     to      err-ind
            move hold-sv-date(ss-write-dtl)
                                        to      err-24-service-date
            perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
            move "????????"             to      clmdtl-sv-date
        else
*           (VERIFY SERVICE DATE IS NOT BEFORE ADMIT DATE IF SPECIFIED)
            if    hdr-admit-date  not = spaces
              and hold-sv-date(ss-write-dtl) < hdr-admit-date
              and not price-only-claim
            then
                move ws-error-literal   to      err-warn-msg
                perform xb0-print-warning-line
                                        thru    xb0-99-exit
                move 1                  to      ws-carriage-ctrl
                move 44                 to      err-ind
                move hold-sv-date(ss-write-dtl)
                                        to      err-44-service-date
                move hdr-admit-date     to     err-44-admit-date
                perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
*2001/03/08 - MC
*               move "????????"         to      clmdtl-sv-date
                move "????????"         to      clmhdr-date-admit
                move hold-sv-date-dd(ss-write-dtl) to      clmdtl-sv-dd
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 142
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
                move hold-sv-date-mm(ss-write-dtl) to      clmdtl-sv-mm
                move hold-sv-date-yy(ss-write-dtl) to      clmdtl-sv-yy
***
            else
*              (INITIAL SERVICE DATE IS VALID AND WITHIN 6 MONTHS OF CURRENT DAT
                move hold-sv-date-dd(ss-write-dtl) to      clmdtl-sv-dd
                move hold-sv-date-mm(ss-write-dtl) to      clmdtl-sv-mm
                move hold-sv-date-yy(ss-write-dtl) to      clmdtl-sv-yy.
*           endif
*           endif
*       endif
*   endif

* 2005/03/03 - MC -add two more edit check  - edit 34
    if    clmhdr-doc-spec-cd = 7
*           (check the patient's age )
    then
        move    hold-sv-date(ss-write-dtl)      to ws-sv-date
        move    hdr-birth-date-long             to ws-birth-date
        compute date-difference-in-days = (ws-sv-date - ws-birth-date) / 10000
        if       (hold-oma-cd(ss-write-dtl) = 'A775' or 'W775' or 'C775')
* 2010/04/01 - MC4 - change to check less than 65 and diagnostic code <> 290
*             and date-difference-in-days < 75
              and date-difference-in-days < 65
              and hold-diag-cd (ss-write-dtl) not = 290
* 2010/04/01 - end
              and not price-only-claim
            then
                move ws-error-literal   to      err-warn-msg
                perform xb0-print-warning-line
                                        thru    xb0-99-exit
                move 1                  to      ws-carriage-ctrl
                move 60                 to      err-ind
                move clmhdr-doc-spec-cd to      err-60-doc-spec
                move hdr-birth-date-long to      err-60-birth-date
                perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
        else
        if      date-difference-in-days < 60
              and not price-only-claim
            then
                move ws-error-literal   to      err-warn-msg
                perform xb0-print-warning-line
                                        thru    xb0-99-exit
                move 1                  to      ws-carriage-ctrl
                move 59                 to      err-ind
                move clmhdr-doc-spec-cd to      err-59-doc-spec
                move hdr-birth-date-long to     err-59-birth-date
                perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*       endif
*   endif

*2005/03/03 - end


* 2011/12/05 - MC19- add edit 65 check - use the error message 60 as edit 34 abo
    if    clmhdr-doc-spec-cd = 19
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 143
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
*           (check the patient's age )
    then
        move    hold-sv-date(ss-write-dtl)      to ws-sv-date
        move    hdr-birth-date-long             to ws-birth-date
        compute date-difference-in-days = (ws-sv-date - ws-birth-date) / 10000
        if       (hold-oma-cd(ss-write-dtl) = 'A191' or 'A192')
              and date-difference-in-days < 65
              and hold-diag-cd (ss-write-dtl) not = 290
              and not price-only-claim
            then
                move ws-error-literal   to      err-warn-msg
                perform xb0-print-warning-line
                                        thru    xb0-99-exit
                move 1                  to      ws-carriage-ctrl
                move 60                 to      err-ind
                move clmhdr-doc-spec-cd to      err-60-doc-spec
                move hdr-birth-date-long to      err-60-birth-date
                perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*       endif
*   endif
* 2011/12/05 - end


* 2005/05/05 - MC
*    service date - ensure that it is greater than the
*    birth  date.)
     if    hold-sv-date(ss-write-dtl) < hdr-birth-date-long
       and not price-only-claim
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 61                         to      err-ind
          move hold-sv-date(ss-write-dtl)
                                          to      err-61-serv-date
          move hdr-birth-date-long        to      err-61-birth-date
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit
          move "????????"                 to      clmdtl-sv-date.
*   endif
* 2005/05/05 - end

* 2005/11/01 - MC -add three  more edit check
    if    hold-oma-cd (ss-write-dtl) = 'E420'
    then
        move ws-error-literal   to      err-warn-msg
        perform xb0-print-warning-line
                                thru    xb0-99-exit
        move 1                  to      ws-carriage-ctrl
        move 63                 to      err-ind
        perform zb0-build-write-err-rpt-line
                                thru    zb0-99-exit.
*   endif


     if    hold-oma-cd (ss-write-dtl) = 'Z425'
       and clmhdr-doc-nbr = '049'
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 144
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 64                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* MC39 remove 16 oma codes for checking
*    if    hold-oma-cd (ss-write-dtl) = 'A073' or 'A074' or 'A071' or 'A078' or
*                                    or 'A134' or 'A131' or 'A138' or 'A183' or
     if    hold-oma-cd (ss-write-dtl) = 'A073' or 'A074' or 'A071' or 'A078'
                                     or 'A183' or 'A184'
                                     or 'A181' or 'A188' or 'A263' or 'A264' or
                                     or 'A283' or 'A284' or 'A313' or 'A310' or
*                                    or 'A318' or 'A413' or 'A414' or 'A411' or
                                     or 'A318'
                                     or 'A473' or 'A474' or 'A471' or 'A478' or
*                                    or 'A484' or 'A481' or 'A488' or 'A603' or
*                                    or 'A601' or 'A608' or 'A613' or 'A614' or
                                     or 'A484' or 'A481' or 'A488'
                                     or 'A613' or 'A614' or 'A611'
                                     or 'A618' or 'A623' or 'A624' or 'A621' or
* 2005/12/14 - include A340, A341, A343, and A348
                                     or 'A340' or 'A341' or 'A343' or 'A348'
* 2005/12/14 - end
* 2008/01/17 - include A262 as requested by Yas/Thekla
                                     or 'A262'
* 2008/01/17 - end
* 2011/03/31 - MC13 - include 16 more oma codes
*                                    or 'A153' or 'A154' or 'A151' or 'A158' or
*                                    or 'A164' or 'A161' or 'A168' or 'A443' or
                                     or 'A153' or 'A154' or 'A151' or 'A158'
                                     or 'A443' or 'A444'
* MC39 - end
                                     or 'A441' or 'A448' or 'A463' or 'A464' or
                                     or 'A468'
* 2011/03/31 - end
     then
          if  (      (    (hold-diag-cd (ss-write-dtl) =    42 or  43 or  44 or
                                                        or 332 or 340 or 343 or
                                                        or 492 or 493 or 515 or
* 2008/01/09 - MC -Thekla requested to include 299, 313, 315, 765 & 902
*                                                       or 710 or 714 or 720 or
                                                        or 710 or 714 or 720 or
                                                        or 299 or 313 or 315 or
                          )
* 2008/01/09 - end
                      and  ws-e078-premium = 'N'
                     )
                or   (    (hold-diag-cd (ss-write-dtl)      not =  42 and not =
                                                        and not = 286 and not =
                                                        and not = 340 and not =
                                                        and not = 428 and not =
                                                        and not = 515 and not =
                                                        and not = 585 and not =
                                                        and not = 721 and not =
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 145
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
* 2008/01/09 - MC -Thekla requested to include 299, 313, 315, 765 & 902
                                                        and not = 299 and not =
                                                        and not = 902
                          )
* 2008/01/09 - end
                      and  ws-e078-premium = 'Y'
                     )
              )
          then
                move ws-error-literal             to      err-warn-msg
                perform xb0-print-warning-line  thru    xb0-99-exit
                move 1                          to      ws-carriage-ctrl
                move 65                           to      err-ind
                perform zb0-build-write-err-rpt-line
                                                  thru    zb0-99-exit.
*          endif

* 2011/04/04 - end

*   endif

* 2005/11/01 - end

* 2008/04/23 - MC - more edit checks for error 69 to 84

* edit 1

* 2010/03/31 - MC4 - do not include E007C
*     if   (    (     (   hold-oma-cd (ss-write-dtl) = 'E007'
*                      or hold-oma-cd (ss-write-dtl) = 'E505'

* 2011/03/31 - MC13 - do not include E505C, E721C, E757C, E787C or E955C
*     if   (    (     (   hold-oma-cd (ss-write-dtl) = 'E505'
     if   (     (     (   hold-oma-cd (ss-write-dtl) = 'E722'
* 2010/03/31 - end
*                      or hold-oma-cd (ss-write-dtl) = 'E721'
*                      or hold-oma-cd (ss-write-dtl) = 'E722'
*                      or hold-oma-cd (ss-write-dtl) = 'E757'
*                      or hold-oma-cd (ss-write-dtl) = 'E787'
*                      or hold-oma-cd (ss-write-dtl) = 'E955'
* 2011/03/31 - end
                      )
                 and  hold-oma-suff  (ss-write-dtl) = 'C'
                 and  hold-sv-nbr-serv (ss-write-dtl) not = 1
                )
            or
* 2010/03/31 - MC4 - do not include E019C
*               (     (   hold-oma-cd (ss-write-dtl) = 'E019'
*                      or hold-oma-cd (ss-write-dtl) = 'E010'
                (     (   hold-oma-cd (ss-write-dtl) = 'E010'
* 2010/03/31 - end
* 2011/03/31 - MC13 - do not include E556C, E632C, E622C, E618C, E546C, E725C, E
*                       or hold-oma-cd (ss-write-dtl) = 'E556'
*                      or hold-oma-cd (ss-write-dtl) = 'E632'
*                      or hold-oma-cd (ss-write-dtl) = 'E622'
                       or hold-oma-cd (ss-write-dtl) = 'E604'
*                      or hold-oma-cd (ss-write-dtl) = 'E618'
*                      or hold-oma-cd (ss-write-dtl) = 'E546'
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 146
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
*                      or hold-oma-cd (ss-write-dtl) = 'E725'
*                      or hold-oma-cd (ss-write-dtl) = 'E726'
*                      or hold-oma-cd (ss-write-dtl) = 'E731'
*                      or hold-oma-cd (ss-write-dtl) = 'E739'
*                      or hold-oma-cd (ss-write-dtl) = 'E756'
                       or hold-oma-cd (ss-write-dtl) = 'E956'
*                      or hold-oma-cd (ss-write-dtl) = 'E981'
* 2011/03/31- end
* 2013/04/11 - MC25 - include E022C
                       or hold-oma-cd (ss-write-dtl) = 'E022'
* 2013/04/11- end
                      )
                 and  hold-oma-suff  (ss-write-dtl) = 'C'
                 and  hold-sv-nbr-serv (ss-write-dtl) not = 2
                )
            or
* 2010/03/31 - MC4 - do not include E018C
*               (     (   hold-oma-cd (ss-write-dtl) = 'E018'
*                      or hold-oma-cd (ss-write-dtl) = 'E667'
                (     (   hold-oma-cd (ss-write-dtl) = 'E667'
* 2010/03/31 - end
* 2011/03/31 - MC13 - do not include E627C, E693C, E694C, E733C, E734C, E735C, E
*                      or hold-oma-cd (ss-write-dtl) = 'E627'
*                      or hold-oma-cd (ss-write-dtl) = 'E693'
*                      or hold-oma-cd (ss-write-dtl) = 'E694'
*                      or hold-oma-cd (ss-write-dtl) = 'E733'
*                      or hold-oma-cd (ss-write-dtl) = 'E734'
*                      or hold-oma-cd (ss-write-dtl) = 'E735'
*                      or hold-oma-cd (ss-write-dtl) = 'E736'
*                      or hold-oma-cd (ss-write-dtl) = 'E723'
* 2011/03/31- end
                      )
                 and  hold-oma-suff  (ss-write-dtl) = 'C'
                 and  hold-sv-nbr-serv (ss-write-dtl) not = 3
                )
            or
* 2010/03/31 - MC4 - do not include E009C
*               (     (   hold-oma-cd (ss-write-dtl) = 'E009'
*                      or hold-oma-cd (ss-write-dtl) = 'E011'
                (     (   hold-oma-cd (ss-write-dtl) = 'E011'
* 2010/03/31 - end
* 2012/07/04 - MC21 - temporary remove the edit check on E022
*                      or hold-oma-cd (ss-write-dtl) = 'E022'
* 2012/07/04 - end
                       or hold-oma-cd (ss-write-dtl) = 'E020'
* 2011/03/31 - MC13 - include E024C
                       or hold-oma-cd (ss-write-dtl) = 'E024'
* 2011/03/31 - end
                      )
                 and  hold-oma-suff  (ss-write-dtl) = 'C'
                 and  hold-sv-nbr-serv (ss-write-dtl) not = 4
                )
            or
* 2010/03/31 - do not include E014C
*               (     (   hold-oma-cd (ss-write-dtl) = 'E014'
*                      or hold-oma-cd (ss-write-dtl) = 'E012'
                (     (   hold-oma-cd (ss-write-dtl) = 'E012'
* 2010/03/31 - end
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 147
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
* 2013/04/16 - MC25 - include E137C to E141C, E143C to E147C, E149C, Z606C, Z607
                        or (     hold-oma-cd (ss-write-dtl) >= 'E137'
                             and hold-oma-cd (ss-write-dtl) <= 'E141'
                           )
                        or (     hold-oma-cd (ss-write-dtl) >= 'E143'
                             and hold-oma-cd (ss-write-dtl) <= 'E147'
                           )
                        or hold-oma-cd (ss-write-dtl) = 'E149'
                        or hold-oma-cd (ss-write-dtl) = 'Z606'
                        or hold-oma-cd (ss-write-dtl) = 'Z607'
                        or (     hold-oma-cd (ss-write-dtl) >= 'Z491'
                             and hold-oma-cd (ss-write-dtl) <= 'Z499'
                           )
                        or hold-oma-cd (ss-write-dtl) = 'Z555'
                        or hold-oma-cd (ss-write-dtl) = 'Z580'
* 2013/04/10 - end
                      )
                 and  hold-oma-suff  (ss-write-dtl) = 'C'
                 and  hold-sv-nbr-serv (ss-write-dtl) not = 5
                )
            or
                (     (   hold-oma-cd (ss-write-dtl) = 'P014'
                      )
                 and  hold-oma-suff  (ss-write-dtl) = 'C'
                 and  hold-sv-nbr-serv (ss-write-dtl) not = 6
                )
* 2011/11/23 - MC - edit 1 to include the check of E676B
            or
                (     (   hold-oma-cd (ss-write-dtl) = 'E676'
                      )
                 and  hold-oma-suff  (ss-write-dtl) = 'B'
                 and  hold-sv-nbr-serv (ss-write-dtl) not = 6
                )
* 2011/11/23 - end
            or
                (     (   hold-oma-cd (ss-write-dtl) = 'E021'
                      )
                 and  hold-oma-suff  (ss-write-dtl) = 'C'
                 and  hold-sv-nbr-serv (ss-write-dtl) not = 4
                )
            or
* 2011/03/31 - MC13 - do not include E004C
*               (     (   hold-oma-cd (ss-write-dtl) = 'E004'
*                      or hold-oma-cd (ss-write-dtl) = 'E017'
                (     (   hold-oma-cd (ss-write-dtl) = 'E017'
* 2011/11/23 - MC19 - edit 1 to include the check of E025C
                       or hold-oma-cd (ss-write-dtl) = 'E025'
* 2011/12/23 - end
* 2011/03/31 - end
                      )
                 and  hold-oma-suff  (ss-write-dtl) = 'C'
                 and  hold-sv-nbr-serv (ss-write-dtl) not = 10
                )
            or
                (     (   hold-oma-cd (ss-write-dtl) = 'E016'
                      )
                 and  hold-oma-suff  (ss-write-dtl) = 'C'
                 and  hold-sv-nbr-serv (ss-write-dtl) not = 20
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 148
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
                )
         )
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 69                         to      err-ind
* 2013/06/10 - MC - debug purpose
          move hold-oma-cd (ss-write-dtl) to      err-oma-cd
          move hold-oma-suff (ss-write-dtl) to    err-oma-suff
          move hold-sv-nbr-serv (ss-write-dtl) to err-nbr-serv
          move hold-sv-nbr-serv-incoming (ss-write-dtl) to err-nbr-serv-incoming
* 2013/06/10 - end
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 2

    if    ws-e020 = "Y"
       and ws-e022-e017-e016 = "N"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 70                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 3

     if    ws-e719 = "Y"
       and ws-z570 = "N"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 71                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 4

     if    ws-e720 = "Y"
       and ws-z571 = "N"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 72                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 5

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 149
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
     if    ws-e717 = "Y"
       and ws-z555-z580 = "N"
* 2013/04/16 - MC25
       and ws-z491-to-z499 = "N"
* 2013/04/16 - end
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 73                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 6

     if    ws-e702 = "Y"
       and ws-z515-z760 = "N"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 74                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 7

     if    ws-g123 = "Y"
       and ws-g228 = "N"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 75                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 8

     if    ws-g223 = "Y"
       and ws-g231 = "N"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 76                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 9

     if    ws-g265 = "Y"
       and ws-g264 = "N"
     then
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 150
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 77                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 10

     if    ws-g385 = "Y"
       and ws-g384 = "N"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 78                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 11

     if    ws-g281 = "Y"
       and ws-g381 = "N"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 79                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 12

* 2010/03/31 - MC4 - include G060 and G061
*     if   (    (    (hold-oma-cd (ss-write-dtl) = 'G123'  or  hold-oma-cd (ss-w
     if   (     (    (    hold-oma-cd (ss-write-dtl) = 'G123'
                       or hold-oma-cd (ss-write-dtl) = 'E719'
                       or hold-oma-cd (ss-write-dtl) = 'G060'
                       or hold-oma-cd (ss-write-dtl) = 'G061'
* 2013/04/16 - MC25 - include J022
                       or hold-oma-cd (ss-write-dtl) = 'J022'
* 2013/04/16 - end
                     )
* 2010/03/31 - end
                 and  hold-sv-nbr-serv (ss-write-dtl) > 4
                )
            or
* 2010/03/31 - MC4 - include G292
*               (    (hold-oma-cd (ss-write-dtl) = 'G265')
                (    (   hold-oma-cd (ss-write-dtl) = 'G265'
                      or hold-oma-cd (ss-write-dtl) = 'G292'
* 2011/11/23 - MC19 - edit 12 to include check of E837 and G285
                      or hold-oma-cd (ss-write-dtl) = 'E837'
                      or hold-oma-cd (ss-write-dtl) = 'G285'
* 2011/11/23 - end
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 151
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
                     )
* 2010/03/31 - end
                 and  hold-sv-nbr-serv (ss-write-dtl) > 3
                )
            or
* 2010/03/31 - MC4 - include G218, G219, H104, H134, H124, H154
*               (    (hold-oma-cd (ss-write-dtl) = 'G385'  or  hold-oma-cd (ss-w
                (    (   hold-oma-cd (ss-write-dtl) = 'G385'
                      or hold-oma-cd (ss-write-dtl) = 'E720'
                      or hold-oma-cd (ss-write-dtl) = 'G218'
                      or hold-oma-cd (ss-write-dtl) = 'G219'
                      or hold-oma-cd (ss-write-dtl) = 'H104'
                      or hold-oma-cd (ss-write-dtl) = 'H134'
                      or hold-oma-cd (ss-write-dtl) = 'H124'
                      or hold-oma-cd (ss-write-dtl) = 'H154'
* 2011/03/31 - MC13 - include G480, G482, G483, G372, G379, G215 or E542
                      or hold-oma-cd (ss-write-dtl) = 'G480'
                      or hold-oma-cd (ss-write-dtl) = 'G482'
                      or hold-oma-cd (ss-write-dtl) = 'G483'
                      or hold-oma-cd (ss-write-dtl) = 'G372'
* MC43+MC48 - edit 12 - exclude G379 and include G297 and G250
*                     or hold-oma-cd (ss-write-dtl) = 'G379'
                      or hold-oma-cd (ss-write-dtl) = 'G297'
                      or hold-oma-cd (ss-write-dtl) = 'G250'
* MC43+MC48 - end
* 2011/11/23 - MC19 - edit 12 to exclude the check of G215
*                     or hold-oma-cd (ss-write-dtl) = 'G215'
* 2011/11/23 - end
                      or hold-oma-cd (ss-write-dtl) = 'E542'
* 2011/03/31 - end
                     )
* 2010/03/31 - end
                 and  hold-sv-nbr-serv (ss-write-dtl) > 2
                )
            or
* 2010/03/31 - MC4 - include G223, G220, G291, G237, Z316, G395, G523, G443, G53
*               (    (hold-oma-cd (ss-write-dtl) = 'E702'  or  hold-oma-cd (ss-w
                (    (   hold-oma-cd (ss-write-dtl) = 'E702'
                      or hold-oma-cd (ss-write-dtl) = 'E717'
* MC43+MC48 - edit 12 - exclude G223 and include G244, G246, G240, G384, G379
*                     or hold-oma-cd (ss-write-dtl) = 'G223'
                      or hold-oma-cd (ss-write-dtl) = 'G244'
                      or hold-oma-cd (ss-write-dtl) = 'G246'
                      or hold-oma-cd (ss-write-dtl) = 'G240'
                      or hold-oma-cd (ss-write-dtl) = 'G384'
                      or hold-oma-cd (ss-write-dtl) = 'G379'
* MC43+MC48 - end
                      or hold-oma-cd (ss-write-dtl) = 'G220'
                      or hold-oma-cd (ss-write-dtl) = 'G291'
* 2011/11/23 - MC19 - edit 12 to exclude the check of G237 but include the check
*                     or hold-oma-cd (ss-write-dtl) = 'G237'
                      or hold-oma-cd (ss-write-dtl) = 'G286'
                      or hold-oma-cd (ss-write-dtl) = 'G700'
                      or hold-oma-cd (ss-write-dtl) = 'Z546'
                      or hold-oma-cd (ss-write-dtl) = 'Z566'
* 2011/11/23 - end

* MC30/MC36 - edit 12 to exclude the check of Z316
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 152
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
*                     or hold-oma-cd (ss-write-dtl) = 'Z316'
* MC30 - end
                      or hold-oma-cd (ss-write-dtl) = 'G395'
                      or hold-oma-cd (ss-write-dtl) = 'G523'
                      or hold-oma-cd (ss-write-dtl) = 'G443'
                      or hold-oma-cd (ss-write-dtl) = 'G530'
* 2011/03/31 - MC13 - include E082, E083, E409, E410, Z441, G370, G328, G420, E1
                      or hold-oma-cd (ss-write-dtl) = 'E082'
                      or hold-oma-cd (ss-write-dtl) = 'E083'
                      or hold-oma-cd (ss-write-dtl) = 'E409'
                      or hold-oma-cd (ss-write-dtl) = 'E410'
                      or hold-oma-cd (ss-write-dtl) = 'Z441'
                      or hold-oma-cd (ss-write-dtl) = 'G370'
                      or hold-oma-cd (ss-write-dtl) = 'G328'
                      or hold-oma-cd (ss-write-dtl) = 'G420'
* 2011/05/18 - MC15 - include suffix A for E158 or E159
*                     or hold-oma-cd (ss-write-dtl) = 'E158'
*                     or hold-oma-cd (ss-write-dtl) = 'E159'
                      or (    hold-oma-cd (ss-write-dtl) = 'E158'
                          and hold-oma-suff(ss-write-dtl) = 'A'
                         )
                      or (    hold-oma-cd (ss-write-dtl) = 'E159'
                          and hold-oma-suff(ss-write-dtl) = 'A'
                         )
* 2011/05/18 - end
* 2013/04/16 - MC25 - include J021
                      or hold-oma-cd (ss-write-dtl) = 'J021'
* 2013/04/16 - end
                      or hold-oma-cd (ss-write-dtl) = 'J025'
                      or hold-oma-cd (ss-write-dtl) = 'G521'
* 2011/03/31 - end
                     )
* 2010/03/31 - end
                 and  hold-sv-nbr-serv (ss-write-dtl) > 1
                )
* 2010/03/31 - MC4 - include new condition
            or
                (    (   hold-oma-cd (ss-write-dtl) = 'G221'
* 2011/03/31 - MC13 - include G489
                      or hold-oma-cd (ss-write-dtl) = 'G489'
* 2011/03/31 - end
* 2015/07/27 - MC40 - include G371
              or hold-oma-cd (ss-write-dtl) = 'G371'
* MC43+MC48 - include E396
              or hold-oma-cd (ss-write-dtl) = 'E396'
* MC43+MC48 -  end

* 2015/07/27 - end
                     )
                 and  hold-sv-nbr-serv (ss-write-dtl) > 5
                )
* 2010/03/31 - end
* 2011/11/23 - MC19 - edit 12 to add new condition
            or
                (    (   hold-oma-cd (ss-write-dtl) = 'K630'
                     )
                 and  hold-sv-nbr-serv (ss-write-dtl) > 6
                )
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 153
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
* 2011/11/23 - end
         )
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 80                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* 2011/11/23 - MC19 - remove edit 13 for error 81 is no longer needed
*                       This can be deleted as it is captured in "fee value of z

*     if    ws-e793 = "Y"
* 2010/03/31 - MC4 - add 18 more oma codes in ws-r905-s800
* 2011/03/31 - MC13 - add 3 more oma codes in ws-r905-s800
*       and ws-r905-s800 = "N"
*     then
*         move ws-error-literal           to      err-warn-msg
*          perform xb0-print-warning-line  thru    xb0-99-exit
*          move 1                          to      ws-carriage-ctrl
*          move 81                         to      err-ind
*          perform zb0-build-write-err-rpt-line
*                                          thru    zb0-99-exit.
*   endif
* 2011/11/23 - end


* 2010/03/31 - MC4 - error 82 & 83 are no longer needed
*    if    hold-oma-cd (ss-write-dtl) = 'P022'
*      and hold-sv-date (ss-write-dtl) > 20080131
*    then
*         move ws-error-literal           to      err-warn-msg
*         perform xb0-print-warning-line  thru    xb0-99-exit
*         move 1                          to      ws-carriage-ctrl
*         move 82                         to      err-ind
*         perform zb0-build-write-err-rpt-line
*                                         thru    zb0-99-exit.
*   endif

*    if    hold-oma-cd (ss-write-dtl) = 'K120'
*      and hold-sv-date (ss-write-dtl) > 20080131
*    then
*         move ws-error-literal           to      err-warn-msg
*          perform xb0-print-warning-line  thru    xb0-99-exit
*          move 1                          to      ws-carriage-ctrl
*          move 83                         to      err-ind
*          perform zb0-build-write-err-rpt-line
*                                          thru    zb0-99-exit.
*   endif
* 2010/03/31 - end

     if    hold-oma-cd (ss-write-dtl) = 'A007'
* 2011/08/22 - MC18
*      and clmhdr-doc-spec-cd not = 00
       and clmhdr-doc-spec-cd = 26
* 2011/08/22 - end
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 154
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)

* 2010/03/31 - MC4 - no check on date
*      and hold-sv-date (ss-write-dtl) > 20071231
* 2010/03/31 - end
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 84                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* 2008/04/23 - end

* edit 14

* 2009/05/06 - MC1
     if    ws-c998 = "Y"
* 2010/03/31 - MC4 - include C985
        or ws-c985 = 'Y'
* 2010/03/31 - end
* 2011/03/31 - MC13 - include C983
        or ws-c983 = 'Y'
* 2011/03/31 - end
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 85                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 15

     if    ws-c999 = "Y"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 86                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 16

     if    ws-e798 = "Y"
       and ws-z400 = "N"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 87                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 155
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
* 2011/04/07 - MC13 - edit 17 & 49 share the same error message 'Check fee of E4
*    if    ws-g400-other-codes = "Y"
*MC43+MC48 - edit 17, 49 & 71
**     if    (   ws-g400-other-codes = "Y"
**            or ws-g489-g376         = "Y"
**         )
* 2011/04/07 - end
**       and ws-e409-e410  = "Y"
* edit 17
    if (   (        ws-g400-other-codes = "Y"
            and (   ws-e409-e410 = "Y"
                 or ws-g325 = "Y"
                )
           )
* edit 49 & 71
        or (        ws-g489-g376        = "Y"
            and     ws-e409-e410 = "Y"
           )
        )
* MC43+MC48 - end

     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 88                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 18

* 2010/03/31 - MC4 - add 7 more oma codes
     if    ws-c990-to-c997 = "Y"
       and ws-cnnn = "Y"
* 2010/09/23 - MC9 - if two dates are the same
       and ws-sv-date-c1 = ws-sv-date-c2
* 2010/09/23 - end
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 89                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 19

     if    ws-e450 = "Y"
       and ws-j315 = "N"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 90                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 156
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
*   endif

* 2009/05/06 - end

* 2010/03/31 - MC4 - add for message 91 to whatever

* edit 20

     if    ws-g222 = "Y"
       and ws-g248-g062 = "Y"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 91                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 21

     if    ws-X9nn = "Y"
       and ws-a770-a775 = "Y"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 92                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* 2011/03/31 - MC13 -comment out - no longer needed
*    if    hold-oma-cd (ss-write-dtl) = "Z432"
*      and hold-oma-suff (ss-write-dtl) = "C"
*      and hold-sv-date (ss-write-dtl) > 20090930
*    then
*          move ws-error-literal           to     err-warn-msg
*          perform xb0-print-warning-line  thru    xb0-99-exit
*          move 1                          to      ws-carriage-ctrl
*          move 93                         to      err-ind
*          perform zb0-build-write-err-rpt-line
*                                          thru    zb0-99-exit.
*    endif
* 2011/03/31 - end

* edit 23

* 2014/06/05 - MC - user decided to comment out the edit
*    if    ws-hnnn = "Y"
*      and ws-h112-h113 = "Y"
*    then
*         move ws-error-literal           to      err-warn-msg
*         perform xb0-print-warning-line  thru    xb0-99-exit
*         move 1                          to      ws-carriage-ctrl
*         move 94                         to      err-ind
*         perform zb0-build-write-err-rpt-line
*                                         thru    zb0-99-exit.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 157
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
*   endif
* 2014/06/05 - end

* edit 24

*    if    ws-g489-s323 = 'Y'
     if    hold-oma-cd (ss-write-dtl) = "G489" or "S323"
    then
*           (check the patient's age )
        move    hold-sv-date(ss-write-dtl)      to ws-sv-date
        move    hdr-birth-date-long             to ws-birth-date
        compute date-difference-in-days = (ws-sv-date - ws-birth-date) / 10000
        if    date-difference-in-days < 16
              and not price-only-claim
        then
             move ws-error-literal      to      err-warn-msg
             perform xb0-print-warning-line
                                        thru    xb0-99-exit
             move 1                  to      ws-carriage-ctrl
             move 95                 to      err-ind
             perform zb0-build-write-err-rpt-line
                                           thru    zb0-99-exit.
*    endif

* edit 25

     if    ws-g222-z805 = 'Y'
       and ws-p014-p016 = "Y"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 96                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* 2011/03/31 - MC13 - comment out
**     if    hold-oma-cd-alpha(ss-write-dtl) =   "H"
**       and hdr-agent-cd not = "2"
*  2010/09/21 - MC8
**       and hdr-agent-cd not = "9"
*  2010/09/21 - end
**       and bt-clinic-nbr-1-2 = 22
* 2010/12/08 - MC11 - change to H1xx or H055 or H065
* 2010/05/18 - MC5 - add except if code is H007 or H001 o H002 or H003
*      and hold-oma-cd (ss-write-dtl) not = "H007"
*      and hold-oma-cd (ss-write-dtl) not = "H001"
*      and hold-oma-cd (ss-write-dtl) not = "H002"
*      and hold-oma-cd (ss-write-dtl) not = "H003"
* 2010/05/18 - end
**     and (     hold-oma-cd (ss-write-dtl) = 'H055'
**           or  hold-oma-cd (ss-write-dtl) = 'H065'
**           or (    hold-oma-cd (ss-write-dtl) >= 'H100'
**               and hold-oma-cd (ss-write-dtl) <= 'H199'
**              )
**         )
* 2010/12/08 - end
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 158
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
**    then
**        move ws-error-literal           to      err-warn-msg
**        perform xb0-print-warning-line  thru    xb0-99-exit
**          move 1                          to      ws-carriage-ctrl
**          move 97                         to      err-ind
**          perform zb0-build-write-err-rpt-line
****************                                          thru    zb0-99-exit.
*   endif
* 2011/03/31 - end

* edit 27

     if    ws-g221 = 'Y'
       and ws-g220 = "N"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 98                         to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.

* edit 29

    if    ws-s322-a198 = 'Y'
    then
*           (check the patient's age )
        move    hold-sv-date(ss-write-dtl)      to ws-sv-date
        move    hdr-birth-date-long             to ws-birth-date
        compute date-difference-in-days = (ws-sv-date - ws-birth-date) / 10000
        if    date-difference-in-days > 15
              and not price-only-claim
        then
             move ws-error-literal      to      err-warn-msg
             perform xb0-print-warning-line
                                        thru    xb0-99-exit
             move 1                  to      ws-carriage-ctrl
             move 99                 to      err-ind
             perform zb0-build-write-err-rpt-line
                                           thru    zb0-99-exit.
*    endif

* edit 30

    if  hold-oma-cd(ss-write-dtl) = 'H267'
    then
*           (check the patient's age )
        move    hold-sv-date(ss-write-dtl)      to ws-sv-date
        move    hdr-birth-date-long             to ws-birth-date
        if    ws-sv-date not = ws-birth-date
        then
             move ws-error-literal      to      err-warn-msg
             perform xb0-print-warning-line
                                        thru    xb0-99-exit
             move 1                  to      ws-carriage-ctrl
             move 100                to      err-ind
             perform zb0-build-write-err-rpt-line
                                           thru    zb0-99-exit.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 159
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
*    endif

* edit 31

     if    ws-g521-g395 = 'Y'
       and ws-h104-h124 = "Y"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 101                        to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 32

     if    ws-g345-g339 = 'Y'
*      and hold-oma-cd-alpha(ss-clmdtl-oma) =   "A"
       and ws-annn = "Y"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 102                        to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 33

    if    ws-a765-c765 = 'Y'
    then
*           (check the patient's age )
        move    hold-sv-date(ss-write-dtl)      to ws-sv-date
    if    ws-a765-c765 = 'Y'
    then
*           (check the patient's age )
        move    hold-sv-date(ss-write-dtl)      to ws-sv-date
        move    hdr-birth-date-long             to ws-birth-date
        compute date-difference-in-days = (ws-sv-date - ws-birth-date) / 10000
        if    date-difference-in-days > 16
              and not price-only-claim
        then
             move ws-error-literal      to      err-warn-msg
             perform xb0-print-warning-line
                                        thru    xb0-99-exit
             move 1                  to      ws-carriage-ctrl
             move 104                to      err-ind
             perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 35

     if    ws-g431-g479 = "N"
* 2011/03/31 - MC13 - include E409, E410, E111
*      and hold-oma-cd-alpha(ss-clmdtl-oma) =   "G"
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 160
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
       and (   hold-oma-cd-alpha(ss-write-dtl)  =   "G"
            or hold-oma-cd(ss-write-dtl) = 'E409'
            or hold-oma-cd(ss-write-dtl) = 'E410'
            or hold-oma-cd(ss-write-dtl) = 'E111'
            )
* 2011/03/31 - end
       and hold-oma-suff  (ss-write-dtl) =   "C"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 103                        to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif


* 2011/04/06 - MC13

* edit 37

     if    ws-j025 = 'Y'
       and (ws-j021 = 'Y' or ws-j022 = 'Y')
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 105                        to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
* endif

* edit 38

     if    hold-oma-cd(ss-write-dtl) = 'A253'
        or hold-oma-cd(ss-write-dtl) = 'A256'
     then
         move hdr-refer-pract-nbr               to ws-chk-nbr
         if ws-chk-nbr-3  not = 8
         then
            move ws-error-literal                 to      err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 106                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*        endif
*    endif

* edit 40

     if    hold-oma-cd(ss-write-dtl) = 'A813'
        or hold-oma-cd(ss-write-dtl) = 'A815'
        or hold-oma-cd(ss-write-dtl) = 'C813'
        or hold-oma-cd(ss-write-dtl) = 'C815'
* 2011/11/23 - MC19 - edit 40 to include the check of A800, C800, A801, C801, A8
        or hold-oma-cd(ss-write-dtl) = 'A800'
        or hold-oma-cd(ss-write-dtl) = 'C800'
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 161
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
        or hold-oma-cd(ss-write-dtl) = 'A801'
        or hold-oma-cd(ss-write-dtl) = 'C801'
        or hold-oma-cd(ss-write-dtl) = 'A802'
        or hold-oma-cd(ss-write-dtl) = 'C802'
        or hold-oma-cd(ss-write-dtl) = 'K224'
        or hold-oma-cd(ss-write-dtl) = 'A816'
        or hold-oma-cd(ss-write-dtl) = 'C816'
* 2011/11/23 - end
     then
         move hdr-refer-pract-nbr               to ws-chk-nbr
         if ws-chk-nbr-3  not = 7
         then
            move ws-error-literal                 to      err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 107                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*        endif
*    endif


* 2011/05/18 - MC18 - user requested to remove the edit
*     if    hold-oma-cd(ss-write-dtl) not = 'A253'
*       and hold-oma-cd(ss-write-dtl) not = 'A256'
*     then
*        move hdr-refer-pract-nbr               to ws-chk-nbr
*         if ws-chk-nbr-3  = 8
*         then
*           move ws-error-literal                 to      err-warn-msg
*            perform xb0-print-warning-line  thru    xb0-99-exit
*            move 1                          to      ws-carriage-ctrl
*            move 108                        to      err-ind
*            perform zb0-build-write-err-rpt-line
*                                          thru    zb0-99-exit.
*        endif
*    endif
* 2011/05/18 - end

* edit 41

     if    ws-z608 = 'Y'
       and ws-z611-z602 = 'Y'
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 109                        to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
* endif

* edit 42

     if   (    hold-oma-cd(ss-write-dtl) = 'Z176'
            or hold-oma-cd(ss-write-dtl) = 'Z154'
          )
      and  hold-oma-suff(ss-write-dtl) = 'A'
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 162
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
      and  hdr-manual-review not = 'Y'
      and  hold-sv-nbr-serv (ss-write-dtl) > 5
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 110                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*        endif

* edit 43

     if   (    hold-oma-cd(ss-write-dtl) = 'Z175'
            or hold-oma-cd(ss-write-dtl) = 'Z177'
            or hold-oma-cd(ss-write-dtl) = 'Z179'
            or hold-oma-cd(ss-write-dtl) = 'Z190'
            or hold-oma-cd(ss-write-dtl) = 'Z191'
            or hold-oma-cd(ss-write-dtl) = 'Z192'
          )
      and  hold-oma-suff(ss-write-dtl) = 'A'
      and  hdr-manual-review not = 'Y'
      and  hold-sv-nbr-serv (ss-write-dtl) > 1
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 111                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*        endif

* edit 44

     if    ws-z403 = 'Y'
       and ws-z408 = 'Y'
       and hdr-manual-review not = 'Y'
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 112                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*        endif

* 2011/11/23 - MC19 - remove the edit 45 for error 113
*                       this can be deleted as new billing guidelines have repla

*     if    ws-a195 = 'Y'
*       and ws-k002 = 'Y'
*       and hdr-manual-review not = 'Y'
*     then
*            move ws-error-literal          to    err-warn-msg
*            perform xb0-print-warning-line  thru    xb0-99-exit
*            move 1                          to      ws-carriage-ctrl
*            move 113                        to      err-ind
*            perform zb0-build-write-err-rpt-line
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 163
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
*                                          thru    zb0-99-exit.
*        endif
* 2011/11/23 - end

* edit 46

     if    ws-c122-c143 = 'Y'
       and ws-e083 not = 'Y'
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 114                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*        endif

* edit 47

     if    ws-c122-c982 not = 'Y'
       and ws-e083 = 'Y'
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 115                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*        endif

* edit 48

     if    ws-j021 not = 'Y'
       and ws-j022 = 'Y'
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 116                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*        endif

* edit 50

* 2011/11/23 - MC19 - edit 50 to exclude the check of G567 but include the check
*    if   (    hold-oma-cd(ss-write-dtl) = 'G567'
     if   (    hold-oma-cd(ss-write-dtl) = 'G571'

* MC43+MC48 - exclude G578 and G584
*            or hold-oma-cd(ss-write-dtl) = 'G578'
            or hold-oma-cd(ss-write-dtl) = 'G581'
*            or hold-oma-cd(ss-write-dtl) = 'G584'
* MC43+MC48 -  end
* 2011/11/23 - end
          )
      and  hdr-loc-code = 'G430'
      and  hdr-admit-date = zeros or spaces
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 164
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 117                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*        endif

* 2011/04/06 - end

* 2011/11/23 - MC19 - new edit check 52 to 63

* edit 52

    if    ws-a197-a198 = 'Y'
    then
*           (check the patient's age )
        move    hold-sv-date(ss-write-dtl)      to ws-sv-date
        move    hdr-birth-date-long             to ws-birth-date
        compute date-difference-in-days = (ws-sv-date - ws-birth-date) / 10000
        if    date-difference-in-days > 21
              and not price-only-claim
        then
             move ws-error-literal      to      err-warn-msg
             perform xb0-print-warning-line
                                        thru    xb0-99-exit
             move 1                  to      ws-carriage-ctrl
             move 120                to      err-ind
             perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 53

     if    ws-k189 = 'Y'
       and ws-a190-a795 not = 'Y'
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 121                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*        endif

* edit 54 to 63
     if    (    ws-k960 = 'Y'
            and ws-k990 not = 'Y'
           )
       or  (    ws-k961 = 'Y'
            and ws-k992 not = 'Y'
           )
       or  (    ws-k962 = 'Y'
            and ws-k994 not = 'Y'
           )
       or  (    ws-k963 = 'Y'
            and ws-k998 not = 'Y'
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 165
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
           )
       or  (    ws-k964 = 'Y'
            and ws-k996 not = 'Y'
           )
       or  (    ws-c960 = 'Y'
            and ws-c990 not = 'Y'
           )
       or  (    ws-c961 = 'Y'
            and ws-c992 not = 'Y'
           )
       or  (    ws-c962 = 'Y'
            and ws-c994 not = 'Y'
           )
       or  (    ws-c963 = 'Y'
            and ws-c986 not = 'Y'
           )
       or  (    ws-c964 = 'Y'
            and ws-c996 not = 'Y'
           )
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 122                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*        endif

* edit 64

* 2012/10/22 - MC23 - comment out the below if condition since the pricing of E6
*     if    ws-e676 = 'Y'
*     then
*           move ws-error-literal           to    err-warn-msg
*            perform xb0-print-warning-line  thru    xb0-99-exit
*            move 1                          to      ws-carriage-ctrl
*            move 123                        to      err-ind
*            perform zb0-build-write-err-rpt-line
*                                          thru    zb0-99-exit.
*        endif
* 2012/10/22 - end
*
* 2011/11/23 - end
*

* 2013/04/16 - MC25 -add edit 66
     if    hold-oma-cd-alpha(ss-write-dtl) = "K"
       and hold-oma-suff  (ss-write-dtl) =   "C"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 124                        to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* 2013/04/16 - MC25 - add edit 67 to 68
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 166
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
* edit 67
     if    ws-g556 = "Y"
       and ws-g400-g620 = "N"
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 125                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 68
     if    ws-a120 = "Y"
       and ws-z491-to-z499 = "N"
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 126                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

** 2013/06/20 - MC25 - after implementation on Jun 11, 2013, now users complaine
**                     and this one is similar to edit 39 which has removed on 2
**                   - now that they agree to remove this edit as well. (comment

* 2013/04/16 - MC25 - add edit 69
**     if     hold-oma-cd(ss-write-dtl) not = 'A813'
**        and hold-oma-cd(ss-write-dtl) not = 'A815'
**        and hold-oma-cd(ss-write-dtl) not = 'C813'
**        and hold-oma-cd(ss-write-dtl) not = 'C815'
**        and hold-oma-cd(ss-write-dtl) not = 'A800'
**        and hold-oma-cd(ss-write-dtl) not = 'C800'
**        and hold-oma-cd(ss-write-dtl) not = 'A801'
**        and hold-oma-cd(ss-write-dtl) not = 'C801'
**        and hold-oma-cd(ss-write-dtl) not = 'A802'
**        and hold-oma-cd(ss-write-dtl) not = 'C802'
**        and hold-oma-cd(ss-write-dtl) not = 'K224'
**        and hold-oma-cd(ss-write-dtl) not = 'A816'
**        and hold-oma-cd(ss-write-dtl) not = 'C816'
**     then
**       move hdr-refer-pract-nbr               to ws-chk-nbr
**         if ws-chk-nbr-3 = 7
**         then
**          move ws-error-literal                 to      err-warn-msg
**            perform xb0-print-warning-line  thru    xb0-99-exit
**            move 1                          to      ws-carriage-ctrl
**            move 127                        to      err-ind
**            perform zb0-build-write-err-rpt-line
**                                          thru    zb0-99-exit.
*        endif
*    endif
* 2013/04/16 - end

* 2013/06/20 -end

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 167
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
* MC43+MC48 - add edit 69 to 79

* edit 69

     if    ws-e402-e403 = 'Y'
       and ws-g247 not = 'Y'
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 127                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 70

     if    hold-bilateral (ss-write-dtl) = 'Y'
      and  hold-sv-nbr-serv (ss-write-dtl)  = 1
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 131                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 72
     if    ws-e797 = 'Y'
       and ws-z491-z580 = 'Y'
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 132                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 73
     if    ws-e409-e410 = 'Y'
       and ws-e414 = 'Y'
       and hdr-manual-review not = 'Y'
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 133                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 74

    if   (    hold-oma-cd(ss-write-dtl) = 'G231'
           or hold-oma-cd(ss-write-dtl) = 'G223'
           or hold-oma-cd(ss-write-dtl) = 'Z228'
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 168
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
          )
     and  hold-sv-nbr-serv (ss-write-dtl) > 1
      and  hdr-manual-review not = 'Y'
     then
            move ws-error-literal           to    err-warn-msg
            perform xb0-print-warning-line  thru    xb0-99-exit
            move 1                          to      ws-carriage-ctrl
            move 134                        to      err-ind
            perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 75

    if   hold-oma-cd(ss-write-dtl) = 'K704'
    then
*           (check the patient's age )
        move    hold-sv-date(ss-write-dtl)      to ws-sv-date
        move    hdr-birth-date-long             to ws-birth-date
        compute date-difference-in-days = (ws-sv-date - ws-birth-date) / 10000
        if    date-difference-in-days > 18
              and not price-only-claim
        then
             move ws-error-literal      to      err-warn-msg
             perform xb0-print-warning-line
                                        thru    xb0-99-exit
             move 1                  to      ws-carriage-ctrl
             move 120                to      err-ind
             perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 76
     if        ws-p030 = 'Y'
       and (   ws-annn = 'Y'
            or ws-cnnn = 'Y'
           )
     then
             move ws-error-literal      to      err-warn-msg
             perform xb0-print-warning-line
                                        thru    xb0-99-exit
             move 1                  to      ws-carriage-ctrl
             move 135                to      err-ind
             perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif


* edit 77
     if         ws-a895 = 'Y'
       and (    ws-cnnn not = 'Y'
            and ws-wnnn not = 'Y'
            and ws-knnn not = 'Y'
           )
     then
             move ws-error-literal      to      err-warn-msg
             perform xb0-print-warning-line
                                        thru    xb0-99-exit
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 169
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
             move 1                  to      ws-carriage-ctrl
             move 136                to      err-ind
             perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif


* edit 78
     if    ws-z512 = 'Y'
       and ws-z514 = 'Y'
     then
             move ws-error-literal      to      err-warn-msg
             perform xb0-print-warning-line
                                        thru    xb0-99-exit
             move 1                  to      ws-carriage-ctrl
             move 137                to      err-ind
             perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif


* edit 79
     if    ws-z580 = 'Y'
       and ws-z491-to-z499 = 'Y'
     then
             move ws-error-literal      to      err-warn-msg
             perform xb0-print-warning-line
                                        thru    xb0-99-exit
             move 1                  to      ws-carriage-ctrl
             move 138                to      err-ind
             perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif


* edit 80

     if    ws-edit-80 = "Y"
       and ws-total-nbr-svc > 8
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 139                        to      err-ind
          perform zb0-build-write-err-rpt-line
                                          thru    zb0-99-exit.
*   endif

* edit 81

     if    ws-X9nn = "Y"
       and ws-a075 = "Y"
     then
          move ws-error-literal           to      err-warn-msg
          perform xb0-print-warning-line  thru    xb0-99-exit
          move 1                          to      ws-carriage-ctrl
          move 140                        to      err-ind
          perform zb0-build-write-err-rpt-line
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 170
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/new)
                                          thru    zb0-99-exit.
*   endif






*----------------------------------------------------


* MC43+MC48 - end

* 2005/08/17 - MC
*    move clmhdr-doc-pract-nbr to clmdtl-doc-pract-nbr.
*    move clmhdr-accounting-nbr to clmdtl-accounting-nbr.
    move clmhdr-doc-pract-nbr to clmdtl-doc-pract-nbr  of suspend-dtl-rec.
    move clmhdr-accounting-nbr to clmdtl-accounting-nbr of suspend-dtl-rec.
* 2005/08/17 - end

hb0-99-exit.
    exit.


* 2011/06/13 - end

ia0-proc-rec-type-address.

    move unpriced-pat-addr-1             to addr-address-line-1.
    move unpriced-pat-addr-2             to addr-address-line-2.
    move unpriced-pat-addr-3             to addr-address-line-3.
    move unpriced-pat-addr-post-cd       to addr-postal-code.


*   PERFORM YE0-WRITE-ADDR-REC  THRU    YE0-99-EXIT.


ia0-99-exit.
    exit.

ka0-proc-rec-type-trailer.

*   (processing a TRAILER rec)
*   (ensure that all numeric fields are zero filled in trailer rec)
    inspect unpriced-trailer-clmhdr1-cnt  replacing all space-char by zeros.
    inspect unpriced-trailer-clmhdr2-cnt  replacing all space-char by zeros.
    inspect unpriced-trailer-itm-cnt      replacing all space-char by zeros.
    inspect unpriced-trailer-pat-addr-cnt replacing all space-char by zeros.

*    (if there were detail records in hold area from the previous claim
*      header rec then area process them - ie. price them and write them out)
    perform xx0-process-hold-dtls       thru xx0-99-exit.

    if (last-record-is-h) or (detail-written)
    then
        move 'N'                   to   detail-written-flag
*       (HEADER WRITTEN OUT IN XX0 ROUTINE)
*       PERFORM TC0-WRITE-HDR-REC  THRU TC0-99-EXIT
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 171
*                      newu701.cbl                                   )
        perform tf0-write-addr-rec thru tf0-99-exit.
*   endif

*       CHECK IF AUDIT TOTALS MATCH TRAILER REC TOTAL - WARNING MESSAGE
    move unpriced-trailer-clmhdr1-cnt    to trl-h-count.
    move unpriced-trailer-clmhdr2-cnt    to trl-r-count.
    move unpriced-trailer-itm-cnt        to trl-t-count.
    move unpriced-trailer-pat-addr-cnt   to trl-a-count.

    add ctr-h-recs-read
        ctr-h-recs-skipped      giving ctr-tot-h-recs.

    add ctr-r-recs-read
        ctr-r-recs-skipped      giving ctr-tot-r-recs.

    add ctr-t-recs-read
        ctr-t-recs-read-skipped giving ctr-tot-t-recs.

    add ctr-a-recs-read
        ctr-a-recs-read-skipped giving ctr-tot-a-recs.

    if trl-h-count not = ctr-tot-h-recs
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 16                         to      err-ind
        move ctr-tot-h-recs             to      err-ctr-h-count
        move trl-h-count                to      err-trl-h-count
        perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*   endif
    if trl-r-count not = ctr-tot-r-recs
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 34                         to      err-ind
        move ctr-tot-r-recs             to      err-ctr-r-count
        move trl-r-count                to      err-trl-r-count
        perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*   endif
    if trl-t-count not = ctr-tot-t-recs
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 17                         to      err-ind
        move ctr-tot-t-recs             to      err-ctr-t-count
        move trl-t-count                to      err-trl-t-count
        perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*   endif
    if trl-a-count not = ctr-tot-a-recs
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 172
*                      newu701.cbl                                   )
        move 1                          to      ws-carriage-ctrl
        move 18                         to      err-ind
        move ctr-tot-a-recs             to      err-ctr-a-count
        move trl-a-count                to      err-trl-a-count
        perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*   endif
    if    trl-b-count not = zero
      and trl-b-count not = ctr-b-recs-read
    then
        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 19                         to      err-ind
        move ctr-b-recs-read            to      err-ctr-b-count
        move trl-b-count                to      err-trl-b-count
        perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit.
*   endif

    perform ka1-print-batch-audit-tots  thru    ka1-99-exit.

*** S.B. - start.
*** Added the following to prevent a missing detail error
*** from appearing on the first batch record after a previous
*** batch that had any detail records in it.
    move 0                              to      ctr-hdr2-rec
                                                ctr-addr-rec.
*** S.B. - end.

ka0-99-exit.
    exit.



ka1-print-batch-audit-tots.

*  (PRINT BATCH AUDIT COUNTERS ON NEW PAGE)
    move 99                                     to ctr-lines-printed.
    move 2                                      to ws-carriage-ctrl.

* 2010/05/19 - MC6
    move '9'                                    to ru701-page-area.
* 2010/05/19 - end

    move "********** AUDIT COUNTERS **********" to audit-title.
    move zero                                   to audit-value
                                                   audit-value-2
                                                   audit-value-3.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move 3                                      to ws-carriage-ctrl.
    move "TOTAL NBR INPUT RECORDS READ= "       to audit-title.
    move ctr-recs-read                          to audit-value
                                                   audit-value-2.
    move audit-line                             to rpt-line.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 173
*                      newu701.cbl                                   )
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move 2                                      to ws-carriage-ctrl.
    move "NBR OF BATCH   RECORDS READ = "       to audit-title.
    move ctr-b-recs-read                        to audit-value
                                                   audit-value-2.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move "NBR OF TRAILER RECORDS READ = "       to audit-title.
    move ctr-e-recs-read                        to audit-value
                                                   audit-value-2.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move "NBR OF HEADER1 RECORDS READ = "       to audit-title.
    move ctr-h-recs-read                        to audit-value
                                                   audit-value-3
                                                   audit-value-4.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move "NBR OF HEADER2 RECORDS READ = "       to audit-title.
    move ctr-r-recs-read                        to audit-value
                                                   audit-value-3
                                                   audit-value-4.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move "NBR OF DETAIL  RECORDS READ = "       to audit-title.
    move ctr-t-recs-read                        to audit-value
                                                   audit-value-3.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move "NBR OF DETAIL  RECS SKIPPED = "       to audit-title.
    move ctr-t-recs-read-skipped                to audit-value
                                                   audit-value-2.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move "NBR OF ADDRESS RECORDS READ = "       to audit-title.
    move ctr-a-recs-read                        to audit-value
                                                   audit-value-4.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move "TOTAL SVCS HDRS/DETAILS READ= "       to audit-title.
    move ctr-tot-svcs-read                      to audit-value-5.
    move audit-line                             to rpt-line.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 174
*                      newu701.cbl                                   )
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move "TOTAL $$$  HDRS/DETAILS READ= "       to audit-title.
    move ctr-tot-dollars-read                   to audit-value-5.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move "NBR OF ADDRESS RECS SKIPPED = "       to audit-title.
    move ctr-a-recs-read-skipped                to audit-value
                                                   audit-value-2.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move 3                                      to ws-carriage-ctrl.
    move "NBR OF HEADER  RECORDS WRITTEN = "    to audit-title.
    move ctr-suspend-hdr-writes                 to audit-value-2
                                                   audit-value-4.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move 2                                      to ws-carriage-ctrl.
    move "NBR OF HEADER1 RECORDS SKIPPED = "    to audit-title.
    move ctr-h-recs-skipped                     to audit-value-2.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move 2                                      to ws-carriage-ctrl.
    move "NBR OF HEADER2 RECORDS SKIPPED = "    to audit-title.
    move ctr-r-recs-skipped                     to audit-value-2.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

    move "NBR OF DETAIL  RECORDS WRITTEN = "    to audit-title.
    move ctr-suspend-dtl-writes                 to audit-value-2
                                                   audit-value-3.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

* 2005/08/17 - MC
    move "NBR OF DESCRIPTION RECORDS WRITTEN = "    to audit-title.
    move ctr-suspend-desc-writes                 to audit-value-2
                                                   audit-value-3.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
    perform zz0-write-err-rpt-line              thru zz0-99-exit.
* 2005/08/17 - end

    move "NBR OF ADDRESS RECORDS WRITTEN = "    to audit-title.
    move ctr-suspend-addr-writes                to audit-value-4.
    move audit-line                             to rpt-line.
    move spaces                                 to audit-line.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 175
*                      newu701.cbl                                   )
    perform zz0-write-err-rpt-line              thru zz0-99-exit.

*  (FORCE NEW PAGE AFTER TOTALS)
    move 99                                     to ctr-lines-printed.

ka1-99-exit.
    exit.
xb0-print-warning-line.

    move 2                      to      ws-carriage-ctrl.
    move 1                      to      err-ind.
    move batch-provider-nbr     to      err-msg-pract-nbr.
    move hdr-accounting-nbr     to      err-msg-account-id.
    perform zb0-build-write-err-rpt-line
                                thru    zb0-99-exit.

xb0-99-exit.
    exit.

xd0-verify-date.

    move "Y"                            to flag-date.

    if   ws-date-mm < 1
      or ws-date-mm > 12
    then
        move "N"                        to flag-date
    else
        if   ws-date-dd < 1
          or ws-date-dd > max-nbr-days (ws-date-mm)
        then
            move "N"                    to flag-date.
*       endif
*   endif

xd0-99-exit.
    exit.
ta0-read-diskette.

* MC37
*   move unpriced-input-rec-type         to      last-record-type-flag.
    move unpriced-trans-id               to      hold-trans-id.
    move unpriced-input-rec-type         to      hold-rec-type.
    move hold-in-rec-type                to      last-record-type-flag.
* MC37 - end

    move low-values                     to      unpriced-Claims-record.

    read unpriced-claims-file
        at end
            move "Y" to eof-input-file-flag
            go to ta0-99-exit.

*  (REPLACE ANY NULLS IN RECORD WITH BLANKS)
    inspect unpriced-claims-record replacing all low-values by spaces.

*  (REPLACE ANY CARRIAGE-RETURNS IN RECORD WITH BLANKS)
    inspect unpriced-claims-record replacing all carriage-return by spaces.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 176
*                      newu701.cbl                                   )

*   (SET FLAG TO TEST RECORD TYPE)
* MC37
*   move unpriced-input-rec-type         to      record-type-flags.
    move unpriced-trans-id               to      hold-trans-id.
    move unpriced-input-rec-type         to      hold-rec-type.
    move hold-in-rec-type                to      record-type-flags.
* MC37 - end

*   (CHECK WHETHER THIS RECORD WILL BE PROCESSED OR SKIPPED)
    if    skip-processing-this-acct-id
      and t-record
    then
        add 1                   to      ctr-t-recs-read-skipped
    else
        if   (skip-processing-this-acct-id or skip-hdr-addr-but-write-dtl)
          and a-record
        then
            add 1               to      ctr-a-recs-read-skipped
        else
            next sentence.
*       endif
*   endif

    add 1                       to      ctr-recs-read.

ta0-99-exit.
    exit.




tb0-read-doc.

    move "Y"                    to flag-doc.
    read doc-mstr
        invalid key move "N"    to flag-doc
                    go to tb0-99-exit.

*   IF WS-DOC-NBR NOT EQUAL TO 0 AND
*      WS-DOC-NBR NOT EQUAL TO DOC-NBR
*   THEN
*       PERFORM YB1-READ-NEXT-DOC   THRU YB1-99-EXIT
*   ELSE
*       IF DOC-DATE-FAC-TERM GREATER THAN '000000'
*       THEN
*           PERFORM YB1-READ-NEXT-DOC   THRU YB1-99-EXIT.
*       endif
*   endif


tb0-99-exit.
    exit.



tc0-write-hdr-rec.

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 177
*                      newu701.cbl                                   )
*   (00/oct/02 B.E. - oma/ohip prices summed separately)
*      move ctr-tot-dollars-claim  to clmhdr-tot-claim-ar-oma
    move ctr-tot-dollars-oma    to clmhdr-tot-claim-ar-oma.
    move ctr-tot-dollars-ohip   to clmhdr-tot-claim-ar-ohip.

*   (00/jun/05 B.E. added summation into header amt for tech fee)
    move ctr-tot-tech-claim     to clmhdr-amt-tech-billed.

*   2005/08/09 - MC - override clmhdr-tape-submit-ind to blank before
*                       writing to suspend hdr. The value should be blank instea

    move space                  to clmhdr-tape-submit-ind.
*   2005/08/09 - end

* 2013/12/05 - MC29 - if none of oma code detail does not require referring doct
    if  refer-doc-not-require  and clmhdr-refer-doc-nbr not = zeroes
    then
        move zeroes             to clmhdr-refer-doc-nbr.
*   endif
* 2013/12/05 - end

    if update-suspense
    then
        add 1                           to      ctr-suspend-hdr-writes
*MC41
*       write suspend-hdr-rec.
        write suspend-hdr-rec
        invalid key
                move "D"                to      skip-process-this-acct-id-flag
*   (UPDATE ORIGINAL HEADER'S STATUS TO "CANCELLED"
                move "Y"                to      clmhdr-status

*   (REWRITE UPDATED RECORD)
                rewrite suspend-hdr-rec
                invalid key
                   display "SERIOUS IMPOSSIBLE ERROR #2 SUSPEND HDR FILE - KEY I
*MC41
*   endif

*   (CHECK FOR ERROR FLAG SET BY DECLARATIVES ON PREVIOUS WRITE STMNT)
    if skip-processing-this-acct-id or skip-hdr-addr-but-write-dtl
    then
*     (NOTE: 90/01/14 B.E. LOGIC WILL ALLOW WRITING OF HEADER TO FAIL BUT FLAG H
*      SET SO THAT THE DETAIL RECS  FOR THIS HEADER WILL BE PROCESSED AND THEREF
*      WILL BECOME DETAILS FOR THE HEADER ALREADY ON FILE. MESSAGE ON WARNING
*      REPORT SHOULD ALERT STAFF TO REVIEW CLAIM TO CONFIRM THAT THESE
*      HEADERS ARE FOR SAME PATIENT)

        move ws-error-literal           to      err-warn-msg
        perform xb0-print-warning-line  thru    xb0-99-exit
        move 1                          to      ws-carriage-ctrl
        move 9                          to      err-ind
        perform zb0-build-write-err-rpt-line
                                        thru    zb0-99-exit
        add 1                           to      ctr-h-recs-skipped
        go to tc0-99-exit.
*   endif

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 178
*                      newu701.cbl                                   )
    move zero                           to      ctr-tot-dollars-oma
                                                ctr-tot-dollars-ohip
                                                ctr-tot-tech-claim.

tc0-99-exit.
    exit.



td0-write-susp-dtl.

    if update-suspense
    then
        add 1                       to ctr-suspend-dtl-writes
        write suspend-dtl-rec.
*    endif

td0-99-exit.
    exit.



te0-write-disk-out.

    if create-priced-file
    then
        add 1                       to ctr-diskout-writes
        write diskout-output-rec.
*   endif

te0-99-exit.
    exit.



tf0-write-addr-rec.

    if update-suspense
    then
        add 1                      to ctr-suspend-addr-writes
        write suspend-address-rec
        invalid key
* MC41         move "D"            to skip-process-this-acct-id-flag
               go to tf0-99-exit.

tf0-99-exit.
    exit.


tg0-read-oma-fee-mstr.

    move "Y"                    to flag-oma.
    read oma-fee-mstr
        invalid key move "N"    to flag-oma.

tg0-99-exit.
    exit.
uj1-read-isam-const-mstr.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 179
*                      newu701.cbl                                   )

    move 'N'                            to flag-lock.

    read    iconst-mstr
        invalid key
            move "Y"                    to      fatal-error-flag
            go to uj1-99-exit.

    move "N"                            to      fatal-error-flag

    add  1                              to ctr-read-const-mstr.

uj1-99-exit.
    exit.


xc0-check-oma-code.

    perform tg0-read-oma-fee-mstr        thru tg0-99-exit.

    if     not valid-oma-code
       and not price-only-claim
    then
        move 2                          to      ws-carriage-ctrl
        move 8                          to      err-ind
        move clmhdr-accounting-nbr      to      err-accounting-nbr
        perform zb0-build-write-err-rpt-line    thru    zb0-99-exit
*       (BLANK OUT OMA FEE RECORD SINCE IT WAS INVALID)
        move spaces                     to      fee-mstr-rec.
*   endif

xc0-99-exit.
    exit.


xx0-process-hold-dtls.

*   (process the detail records in the hold area  - ie. price
*    them, write them out, and reset counters/subscripts)
    if batch-provider-nbr = "264978"
    then
        if hold-accounting-nbr = "00000004"
        then
            next sentence
        else
            next sentence
    else
        next sentence.
*   endif

    if ss-clmdtl-oma > 0
    then
*       (initialize next available dtl subscript)
        move ss-clmdtl-oma                     to     ss-clmdtl-next-avail-dtl
        move "N"                               to     flag-tech-prof-suffix-rule
        perform zz3-apply-tech-prof-suff-rules thru   zz3-99-exit
                varying ss-tech-prof-suff
                from    1
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 180
*                      newu701.cbl                                   )
                by      1
                until ss-tech-prof-suff > ss-clmdtl-oma
*       (if new details added, then increase max dtl subscript)
        perform xx1-test-for-new-dtls   thru    xx1-99-exit
        move 1                          to      ss-basic-times-desc-rec
        move 0                          to      ss-basic-times
        perform ya0-price-claim         thru    ya0-99-exit

* 2005/08/17 - MC
        perform xx3-write-susp-desc     thru xx3-99-exit
        move spaces                     to flag-desc-rec

* 2005/08/17 - end

* 2013/12/05 - MC29 - check refer doc required or not
        move 'N'                        to flag-refer-doc
* 2013/12/05 - end

        perform xx2-write-susp-diskout-dtl      thru    xx2-99-exit
                varying ss-write-dtl
                from    1
                by      1
                until ss-write-dtl > ss-clmdtl-oma
        move 'Y'                        to   detail-written-flag

*       (reset subscripts for detail recs)
        move 0                          to   ss-clmdtl-oma
                                             ss-price
                                             ss-write-dtl
*       (00/aug/13 B.E. - reset special add-on code flag)
        move "N"                        to   ws-special-add-on-cd-entered

* 2011/05/18 - MC15
        perform xx1a-reset-oma-flag     thru xx1a-99-exit
* 2011/05/18 - end


* 2013/12/05 - MC29 - initialize hold-oma-recs
        move spaces                     to hold-oma-recs
* 2013/12/05 -end

*       (b.e. - 2000/jun/28 zero out hold area)
        perform aa1-init-hold-oma-rec      thru    aa1-99-exit
                varying i
                from    1
                by      1
* 2006/02/15 - MC
*               until   i  > 40
                until   i  > ss-max-nbr-oma-det-rec-allow
*       (WRITE OUT HEADER NOW THAT PRICES ARE KNOWN)
        perform tc0-write-hdr-rec       thru tc0-99-exit
   else
**      (This is to ensure that each claim has a detail record.  If not,
**       then an error is generated)
        if     ss-clmdtl-oma = 0
           and ctr-hdr2-rec = 1
           and ctr-addr-rec = 1
           and not price-only-claim
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 181
*                      newu701.cbl                                   )
        then
           move ws-error-literal                to      err-warn-msg
           perform xb0-print-warning-line thru xb0-99-exit
           move 1                          to   ws-carriage-ctrl
           move 50                         to   err-ind
           move clmhdr-accounting-nbr      to   err-no-detail-claim
           perform zb0-build-write-err-rpt-line thru zb0-99-exit.
*       endif
*   endif

xx0-99-exit.
    exit.


xx1-test-for-new-dtls.

*   (if next available detail record number is greater than original
*    max number of details, then new records were created so update
*    new maximum)

    if ss-clmdtl-next-avail-dtl > ss-clmdtl-oma
    then
        move ss-clmdtl-next-avail-dtl   to      ss-clmdtl-oma.
*   endif

xx1-99-exit.
    exit.

* 2011/05/18 - MC15
xx1a-reset-oma-flag.

copy  "d001_newu701_oma_code_variables_reset.rtn".
* d001_newu701_oma_code_variables_reset.rtn - use in d001 & newu701 & u701oscar

* 2005/11/01 - MC - reset e078-premium flag
    move "N"                            to      ws-e078-premium.
* 2005/11/01 - end

* 2008/04/28 - MC - reset flags
    move "N"   to    ws-e020.
    move "N"   to    ws-e719.
    move "N"   to    ws-e720.
    move "N"   to    ws-e717.
    move "N"   to    ws-e702.
    move "N"   to    ws-g123.
    move "N"   to    ws-g223.
    move "N"   to    ws-g265.
    move "N"   to    ws-g385.
    move "N"   to    ws-g281.
    move "N"   to    ws-e793.
    move "N"   to    ws-e022-e017-e016.
    move "N"   to    ws-z570.
    move "N"   to    ws-z571.
    move "N"   to    ws-z555-z580.
    move "N"   to    ws-z515-z760.
    move "N"   to    ws-g228.
    move "N"   to    ws-g231.
    move "N"   to    ws-g264.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 182
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
    move "N"   to    ws-g384.
    move "N"   to    ws-g381.
    move "N"   to    ws-r905-s800.
    move "N"   to    ws-annna.
    move "N"   to    ws-gnnna.
    move "N"   to    ws-k991-u997.

* 2008/04/28 - end

* 2009/05/06 - MC1
    move "N"   to      ws-c998.
    move "N"   to      ws-c999.
    move "N"   to      ws-e798.
    move "N"   to      ws-z400.
    move "N"   to      ws-g400-other-codes.
    move "N"   to      ws-e409-e410.
    move "N"   to      ws-c990-to-c997.
    move "N"   to      ws-cnnn.
    move "N"   to      ws-e450.
    move "N"   to      ws-j315.
* 2009/05/06 -end


* 2010/03/31 - MC4
    move "N"   to      ws-c985.
    move "N"   to      ws-g248-g062.
    move "N"   to      ws-g222.
    move "N"   to      ws-a770-a775.
    move "N"   to      ws-X9nn.
    move "N"   to      ws-h112-h113.
    move "N"   to      ws-hnnn.
    move "N"   to      ws-g489-s323.
    move "N"   to      ws-g222-z805.
    move "N"   to      ws-p014-p016.
    move "N"   to      ws-g221.
    move "N"   to      ws-g220.
    move "N"   to      ws-s322-a198.
    move "N"   to      ws-a765-c765.
    move "N"   to      ws-g521-g395.
    move "N"   to      ws-h104-h124.
    move "N"   to      ws-g345-g339.
    move "N"   to      ws-g431-g479.
    move "N"   to      ws-gnnn.
    move "N"   to      ws-annn.
* 2010/03/31 - end

* 2011/03/31 - MC13
    move "N"   to       ws-c983.
    move "N"   to       ws-j025.
    move "N"   to       ws-j021.
    move "N"   to       ws-j022.
    move "N"   to       ws-z608.
    move "N"   to       ws-z611-z602.
    move "N"   to       ws-z403.
    move "N"   to       ws-z408.
    move "N"   to       ws-a195.
    move "N"   to       ws-k002.
    move "N"   to       ws-c122-c143.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 183
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
    move "N"   to       ws-e083.
    move "N"   to       ws-c122-c982.
    move "N"   to       ws-g489-g376.
* 2011/03/31 - end


* 2011/11/23 - MC19+MC22
    move "N"   to       ws-a197-a198.
    move "N"   to       ws-k189.
    move "N"   to       ws-a190-a795.
    move "N"   to       ws-k960.
    move "N"   to       ws-k990.
    move "N"   to       ws-k961.
    move "N"   to       ws-k992.
    move "N"   to       ws-k962.
    move "N"   to       ws-k994.
    move "N"   to       ws-k963.
    move "N"   to       ws-k998.
    move "N"   to       ws-k964.
    move "N"   to       ws-k996.
    move "N"   to       ws-c960.
    move "N"   to       ws-c990.
    move "N"   to       ws-c961.
    move "N"   to       ws-c992.
    move "N"   to       ws-c962.
    move "N"   to       ws-c994.
    move "N"   to       ws-c963.
    move "N"   to       ws-c986.
    move "N"   to       ws-c964.
    move "N"   to       ws-c996.
    move "N"   to       ws-e676.
* 2011/11/23 - end


* 2013/04/11- MC28
    move "N"   to      ws-g556.
    move "N"   to      ws-g400-g620.
    move "N"   to      ws-a120.
    move "N"   to      ws-z491-to-z499.
* 2013/04/11 - end

* MC46+MC43+MC48
    move "N"   to       ws-g325.
    move "N"   to       ws-e402-e403.
    move "N"   to       ws-g247.
    move "N"   to       ws-e797.
    move "N"   to       ws-z491-z580.
    move "N"   to       ws-e414.
    move "N"   to       ws-p030.
    move "N"   to       ws-a895.
    move "N"   to       ws-wnnn.
    move "N"   to       ws-knnn.
    move "N"   to       ws-z512.
    move "N"   to       ws-z514.
    move "N"   to       ws-z580.
    move "N"   to       ws-cnnn-c101.
    move  0    to       ws-total-nbr-svc.
    move "N"   to       ws-edit-80.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 184
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
    move "N"   to       ws-a075.

* MC46+MC43+MC48 - end



xx1a-99-exit.
exit.

* 2011/05/18 - end


xx2-write-susp-diskout-dtl.
*   (write detail rec from data in the priced hold area to the suspend file)

*   (sum total priced detail into audit total of run
*    using whichever price is to be used)

*   (pricing algorithm may have overriden prices but for total
*   dollars 'read' use the incoming amounts)

    add hold-fee-incoming(ss-write-dtl) to   ctr-tot-dollars-read.

    add hold-fee-ohip(ss-write-dtl)     to   ctr-tot-dollars-ohip.
    add hold-fee-oma (ss-write-dtl)     to   ctr-tot-dollars-oma.

*   (2000/jun/05 B.E. - keep running counter of tech fee to sum into hdr rec)
    add  hold-priced-tech(ss-write-dtl) to   ctr-tot-tech-claim.

    perform hb0-build-susp-dtl-rec-dtl  thru hb0-99-exit.

    perform td0-write-susp-dtl           thru td0-99-exit.

*   (BUILD DISKOUT DISKETTE RECORD)
    perform xx2a-build-diskout-rec       thru xx2a-99-exit.
    perform te0-write-disk-out           thru te0-99-exit.

* 2013/12/05 - MC29 - check refer doc required or not

    if hold-oma-rec-ind(ss-write-dtl,ss-phy-ind) = 'Y'
    then
        move 'Y'                        to flag-refer-doc.
*   endif

* 2013/12/05 - end

xx2-99-exit.
    exit.


xx2a-build-diskout-rec.

    move hold-accounting-nbr                to  diskout-clmhdr-claim.

*   (2001/oct/03 B.E. added new clinic-nbr to output file)
    move bt-clinic-nbr-1-2                  to  diskout-clmhdr-clinic-nbr.

    move hold-oma-cd        (ss-write-dtl)  to  diskout-oma-svc-code.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 185
*                      newu701.cbl                                   )
    move hold-oma-suff      (ss-write-dtl)  to  diskout-oma-svc-suff.
    move hold-sv-nbr-serv   (ss-write-dtl)  to  diskout-nbr-serv.
    move hold-sv-date       (ss-write-dtl)  to  diskout-svc-date.
    move hold-fee-oma       (ss-write-dtl)  to  diskout-oma-amt-billed.
    move hold-fee-ohip      (ss-write-dtl)  to  diskout-ohip-amt-billed.
    move hold-priced-tech   (ss-write-dtl)  to  diskout-priced-tech.
    move hold-basic-tech    (ss-write-dtl)  to  diskout-basic-tech.
    move hold-basic-prof    (ss-write-dtl)  to  diskout-basic-prof.
    move hold-basic-fee     (ss-write-dtl)  to  diskout-basic-fee.
    move carriage-return                    to  diskout-cr.

xx2a-99-exit.
    exit.

* 2005/08/17 - MC - if adjudication-desc-entry, create description record
*                   and set manual review to 'Y'
xx3-write-susp-desc.

* 2008/04/29 - MC - initialize line no
    move 0                                      to clmdtl-line-no of suspend-des
* 2008/04/29 - end

    if adjudication-desc-entry
    then
        move 'Y'                                to clmhdr-manual-review
        move "G259 BILLED AT 85%"               to clmdtl-suspend-desc of suspen
        move 1                                  to clmdtl-line-no of suspend-des
        move clmhdr-doc-pract-nbr               to clmdtl-doc-pract-nbr of suspe
        move clmhdr-accounting-nbr              to clmdtl-accounting-nbr of susp
        move clmhdr-status                      to clmdtl-status of suspend-desc
        if update-suspense
        then
            add 1                               to ctr-suspend-desc-writes
            write suspend-desc-rec.
*       endif
*    endif

* 2008/04/29 - MC  - percentage visit preimium

* 2010/10/04 - MC10 - disable the edit check below

*     if        ws-annna = 'Y'
*        and    ws-gnnna = 'Y'
*        and    ws-k991-u997 = 'Y'
*     then
*       move 'Y'                                to clmhdr-manual-review
*       move "Pay visit premium"                to clmdtl-suspend-desc of suspen
*       add  1                                  to clmdtl-line-no of suspend-des
*       move clmhdr-doc-pract-nbr               to clmdtl-doc-pract-nbr of suspe
*       move clmhdr-accounting-nbr              to clmdtl-accounting-nbr of susp
*       move clmhdr-status                      to clmdtl-status of suspend-desc
*       if update-suspense
*       then
*           add 1                               to ctr-suspend-desc-writes
*           write suspend-desc-rec
*           move "based on 'A---A' code"        to clmdtl-suspend-desc of suspen
*           add  1                              to clmdtl-line-no of suspend-des
*           move clmhdr-doc-pract-nbr           to clmdtl-doc-pract-nbr of suspe
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 186
*                      newu701.cbl                                   )
*           move clmhdr-accounting-nbr          to clmdtl-accounting-nbr of susp
*           move clmhdr-status                  to clmdtl-status of suspend-desc
*           add 1                               to ctr-suspend-desc-writes
*           write suspend-desc-rec.
*       endif
*    endif

* 2010/10/04 - end


* 2008/04/29 - end

xx3-99-exit.
    exit.

* 2005/08/17 - end



copy "pricing_logic.rtn".
* file: pricing_logic.rtn
* 00/aug/31 B.E. - original
* 00/sep/07 B.E. - the sequence of incoming claim details is stored in
*                   hold-incoming-line-nbr so that if the pricing
*                   module re-sorts the claim details within the hold area,
*                   the program can use the hold-line-no field to re-sort
*                   the records back into the original sequence)
*  00/sep/07 B.E. - added additional display fields in ya11-
*  00/sep/12 B.E. - yz0-reset-verify-prices logic moved from newu701 into
*                   this common pricing logic so that the resetting to
*                   'incoming' prices can be done before the technical/
*                   professional fee calculations is performed.
* 00/sep/25 B.E. - added display/confirm logic after each stage of pricing
* 00/oct/02 B.E. - adjust pricing for newu701 so that:
*                (OP claims from the web/diskette retain their incoming $ while
*                 online claims use the amount the user entered into the OMA fee
*                 as the basis for basic pricing)
* 00/dec/22 B.E. - "special"reduction (see MaryAnne) based upon oma code and
*                  location for in patients (currently G259/G420)
* 01/aug/29 B.E. - changed warnings so that now only if the OHIP amount
*                 is zero does the system stop the user and the value in the
*                 oma amount is ignored
* 01/sep/02 B.E. - changed logic of how ADJUDICATION description was being
*                  created so that clmhdr manual-review-flag would be
*                  set automatically
* 01/sep/27 B.E. - uncommented line on .85 reduction pricing that was
*                  accidentally commented out
* 05/sep/28 b.e. - price E676B like E676A at 62.55
* 10/feb/10 brad1 - redesign screen and change logic so that 10 details can be e
* 2011/nov/02 brad2 - undo 2005 sep 28 change
* 2011/nov/02 brad3 - add E412 to work like E409
*                   - add E413 to work like E410
* 2011/Nov/07 MC1   - price E676B like E676A at 62.55 for service date before 20
*                     price as assisting unit * assist price
* 2011/Nov/22 MC2   - Add E410/E413 to the same as E409/E412
* 2011/Nov/30 MC    - Note ONLY:  Brad has suggested to use fee-effective-date i
*                     If it is compared with '>', then I agree; but now it is co
*                     get the wrong result for future fee master update. Before
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 187
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
*                     like E676A, but after 20110901, they want (assist fee * nb
* 2012/Jul/12 MC3   - subroutine yi0 should be processed before yf0 for add ons
* 2012/Aug/09 MC3   - relocate ya0-98-display-fee paragraph
* 2012/Aug/14 MC4   - correct in yi0 subroutine to price correctly for SP98 or S
* 2012/Oct/18 MC5   - do not consider E676B as add on, modify in yf2

ya0-price-claim.

*   (turn off the zero fee flag until the end of pricing so that the
*    warning is not produced each pass)
    move 'N'                                            to flag-zero-fee.

*    (note:  all pricing constant values are found in record 2 of constants
*            master file which was read in 'mainline')

*   (if the agent code is 'wcb' the constants master wcb rate is held
*    or else the variable is set to 1 for no affect in the
*    multiplication.)
    if def-agent-wcb
    then
*       (wcb pricing/reductions not required at RMA currently, therefore
*        just use the 1st line's curr-prev value to set rate)
        move hold-ss-curr-prev(1)               to ss-curr-prev
        move const-wcb(ss-curr-prev)            to ws-hold-wcb-rate
    else
        move 1                                  to ws-hold-wcb-rate.
*   endif

*   (if incoming diskette file was priced, then "B" and "C" suffix'd lines
*    have the number of services combined using the 'basic + times' logic
*    and this routine will strip out the basic units so that the regular
*    pricing algorithm will work)
    if   (    diskette-claim
          and override-with-rma-prices
         )
    then
        perform ya5-reset-nbr-services-value    thru ya5-99-exit
            varying ss
            from 1 by 1
            until   ss > ss-clmdtl-oma.
*   endif

*   (find the 'SP99' and 'SP98' add-on group reduction rates)
*   (00/aug/08 changed to allow all ICC codes to be possible add on's)
    move 1                                      to ws-reduc-rate.

    perform ya2-find-add-on-reduc-rate          thru ya2-99-exit
        varying subs
        from 1 by 1
        until   subs > const-max-nbr-rates.


    perform yb0-calc-basic-fee                  thru yb0-99-exit
        varying ss
        from 1 by 1
        until   ss > ss-clmdtl-oma.


* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 188
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
*       (if only 1 detail entry then no further reductions necessary)
    if ss-clmdtl-oma = 1
    then
        go to ya0-98-display-fees.
*   (else)
*   endif

    perform ya1-display-fees                    thru ya1-99-exit.
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
    if password-input = password-special-privledges
    then
        move 90                                 to err-ind
        perform za0-common-error                thru za0-99-exit.
*   (else)
*   endif
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==

    move 1                                      to ss
                                                   ss2.
    perform yc0-sort-by-icc-and-fee             thru yc0-99-exit
                until ss2 not < ss-clmdtl-oma.

    move "N"                                    to flag-sec-reduction-needed.

    move zero                                   to ss-grp-tot
                                                   hold-grp-totals-tbl.
    move 1                                      to ss-sec
                                                   ss-grp
                                                   hold-flag-sec ( 1 )
                                                   hold-flag-grp ( 1 ).
    perform yd0-set-icc-sort-flags              thru yd0-99-exit
        varying ss
        from 2 by 1
        until   ss > ss-clmdtl-oma.

    move ss-clmdtl-oma                          to ss-hold-clmdtl-oma.

    perform xa0-display-details                 thru xa0-99-exit
                 varying ss-clmdtl-oma
                 from 1
                 by 1
                 until   ss-clmdtl-oma > ss-hold-clmdtl-oma
                      or ss-clmdtl-oma > ss-max-nbr-oma-det-rec-allow.

    move ss-hold-clmdtl-oma                     to ss-clmdtl-oma.

*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
    if password-input = password-special-privledges
    then
        move 91                                 to err-ind
        perform za0-common-error                thru za0-99-exit.
*   (else)
*   endif
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==

    perform ye0-group-reductions                thru ye0-99-exit
        varying ss
       from 1 by 1
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 189
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
        until   ss > ss-clmdtl-oma
*  (00/jul/27 B.E. removed hard coding of 7 and replace with calculation)
*            or ss > 7.
             or ss > (ss-max-nbr-oma-det-rec-allow - 1) .

    perform ya1-display-fees                    thru ya1-99-exit.

*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
    if password-input = password-special-privledges
    then
        move 92                                 to err-ind
        perform za0-common-error                thru za0-99-exit.
*   (else)
*   endif
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==

* 2012/07/12 - MC3 - transfer the below section to be processed after yi0

**    perform yf0-add-on-increases                thru yf0-99-exit
**       varying ss
**        from 1 by 1
**        until   ss > ss-clmdtl-oma.

**    perform ya1-display-fees                    thru ya1-99-exit.
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
**    if password-input = password-special-privledges
**    then
**        move 93                                 to err-ind
**        perform za0-common-error                thru za0-99-exit.
*   (else)
*   endif
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
* 2012/07/12 - end

*       (at this time, only 'sp' oma codes require 'sectional' reduction)
    if flag-sec-reduction-needed = "N"
    then
        go to ya0-98-display-fees.
*   (else)
*   endif

    move 1                                      to ss-from.
    move 0                                      to ss-to.

ya0-calc-sectional-reductions.

    if hold-icc-sec (ss-from) not = "SP"
    then
        move ss-from                    to      ss-to
        go to ya0-increment-ss-from.
*   (else)
*   endif

    perform yh0-find-high-grp-within-sec        thru yh0-99-exit.

    if online-claim
    then
        display scr-acpt-det-desc.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 190
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
*   endif

*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
    if password-input = password-special-privledges
    then
        move 94                                 to err-ind
        perform za0-common-error                thru za0-99-exit.
*   (else)
*   endif
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==

    perform yi0-sec-reduct-within-sec           thru yi0-99-exit
                varying ss
                from ss-from by 1
                until   ss > ss-to.

ya0-increment-ss-from.

    if ss-to < ss-clmdtl-oma
    then
        add  1, ss-to                           giving  ss-from
        move 0                                  to      ss-to
        perform ya1-display-fees                thru    ya1-99-exit
*       ==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
        if password-input = password-special-privledges
        then
            move 95                                 to err-ind
            perform za0-common-error                thru za0-99-exit
*       ==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
            go to ya0-calc-sectional-reductions
        else
            go to ya0-calc-sectional-reductions.
*       endif
*   (else)
*   endif


* 2012/07/12 - MC3 - transfer the below section to be processed after yi0 from a
* transfer ya0-98 here from below
ya0-98-display-fees.

    perform yf0-add-on-increases                thru yf0-99-exit
       varying ss
        from 1 by 1
        until   ss > ss-clmdtl-oma.

    perform ya1-display-fees                    thru ya1-99-exit.
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
    if password-input = password-special-privledges
    then
        move 93                                 to err-ind
        perform za0-common-error                thru za0-99-exit.
*   (else)
*   endif
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
* 2012/07/12 - end

    perform yf1-special-add-on-incr             thru yf1-99-exit
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 191
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
        varying ss
        from 1 by 1
        until   ss > ss-clmdtl-oma.

    perform ya1-display-fees                    thru ya1-99-exit.
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
    if password-input = password-special-privledges
    then
        move 96                                 to err-ind
        perform za0-common-error                thru za0-99-exit.
*   (else)
*   endif
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==

* 2012/08/09 - MC3 - transfer to above just before yf0
*ya0-98-display-fees.
* 2012/08/09 - end

*   (display fees before min-max testing so that if warning message is displayed
*    that fees being in/decreased then the Operator can see the fees on the
*    screen)
    perform ya1-display-fees                    thru ya1-99-exit.
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
    if password-input = password-special-privledges
    then
        move 97                                 to err-ind
        perform za0-common-error                thru za0-99-exit.
*   (else)
*   endif
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==

*   (test min/max price to ensure that calculated basic prices are within
*    acceptable range)
    perform test-min-max-limits                 thru test-min-max-limits-99-exit
        varying ss
        from 1 by 1
        until   ss > ss-clmdtl-oma.

*  (display the fees again in case they min-max testing has changed the
*   fee)
*  (turn on flag to print warning message if a zero fee is found)
    move 'Y'                                    to flag-zero-fee.
    perform ya1-display-fees                    thru ya1-99-exit.
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
    if password-input = password-special-privledges
    then
        move 98                                 to err-ind
        perform za0-common-error                thru za0-99-exit.
*   (else)
*   endif
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==



*   (00/sep/12 B.E. - reset prices, if necessary, before calculating
*                     technical/professional breakdown)
*   (this routine has priced claims according to RMA pricing. If
*    incoming file was "D"iskette, then reset prices to the 'incoming'
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 192
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
*    values rather than RMA priced amounts. If the file was from the "W"eb,
*    then reset any OP or MR line to 'incoming' prices)
    if not online-claim
    then
        perform yz0-reset-verify-prices      thru yz0-99-exit.
*   endif

    perform ya3-calc-priced-tech                thru ya3-99-exit
        varying ss
        from 1
        by   1
        until   ss > ss-clmdtl-oma.

    perform ya1-display-fees                    thru ya1-99-exit.
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
    if password-input = password-special-privledges
    then
        move 99                                 to err-ind
        perform za0-common-error                thru za0-99-exit.
*   (else)
*   endif
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==


*   (00/sep/07 B.E. - if necessary, sort the details back into their
*                     original sequence)
    move 1                                      to ss
                                                   ss2.
    perform yj0-sort-by-orig-line-no            thru yj0-99-exit
                until ss2 not < ss-clmdtl-oma.
*   (redisplay records in original sequence)
    perform ya1-display-fees                    thru ya1-99-exit.
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==
    if password-input = password-special-privledges
    then
        move 100                                to err-ind
        perform za0-common-error                thru za0-99-exit.
*   (else)
*   endif
*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==


ya0-99-exit.
    exit.


ya1-display-fees.

    move ss-clmdtl-oma                          to ss-hold-clmdtl-oma.

    perform ya11-disp-oma-fees                  thru ya11-99-exit
                varying ss-clmdtl-oma
                from 1
                by   1
                until   ss-clmdtl-oma > ss-hold-clmdtl-oma
                     or ss-clmdtl-oma > ss-max-nbr-oma-det-rec-allow.

    move ss-hold-clmdtl-oma                     to ss-clmdtl-oma.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 193
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)

ya1-99-exit.
    exit.


ya11-disp-oma-fees.

*   (display fields on screen, only if pricing is for "online" d001 pgm)
*    and skip if 'web' or 'diskette' type batch pricing)
    if online-claim
    then
        next sentence
    else
        go to ya11-99-exit.
*   endif

    add ss-clmdtl-oma
*       (sms 126 allow for 8 claim details instead of 6)
*       14                              giving pline.
* (brad1 - allow 10 claim lines per screen rather than 8)
*       13                              giving pline.
        10                              giving pline.

*   (00/sep/07 B.E. - added additional display fields)
    display scr-hold-oma-cd.
    display scr-hold-oma-suff.
    display scr-hold-sv-date-yy-12.
    display scr-hold-sv-date-yy-34.
    display scr-hold-sv-date-mm.
    display scr-hold-sv-date-dd.

    display scr-hold-sv-nbr-0
    display scr-hold-fee-oma.
    display scr-hold-fee-ohip.
*   (2001/aug/29 B.E. changed warning so that now only if the OHIP amount
*                     is zero does the system stop the user)
*      if      ( hold-fee-oma(ss-clmdtl-oma)  = 0
*            or  hold-fee-ohip(ss-clmdtl-oma) = 0 )

    if    hold-fee-ohip(ss-clmdtl-oma) = 0
      and flag-zero-fee = 'Y'
    then
        move '* Warning - '             to e1-error-word
        move 59                         to err-ind
        perform za0-common-error        thru za0-99-exit
        move '* Error - '               to e1-error-word.
*   (else)
*   endif

ya11-99-exit.
    exit.



ya2-find-add-on-reduc-rate.

*   (find the 'SP99' and 'SP98' add-on group reduction rates)

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 194
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
*  ****  BUG BUG BUG BUG BUG BUG  - using first line's curr-prev subscript  ***
*  ****  which may/maynot be SP98/SP99 item) **********************************
    move hold-ss-curr-prev(1)               to ss-curr-prev.

    if const-section-group (subs) = 'SP98'
    then
            move const-rates-curr-prev ( subs, ss-curr-prev) to ws-reduc-rate98
    else
        if const-section-group (subs) = 'SP99'
        then
            move const-rates-curr-prev ( subs, ss-curr-prev) to ws-reduc-rate99
        else
*           (00/aug/08 - no rate needed for non-SP add ons)
            move 1                                           to ws-reduc-rate98
                                                                ws-reduc-rate99.
*       endif
*   endif

ya2-99-exit.
    exit.


ya3-calc-priced-tech.

*   (sms #113 - treat agent 4 as direct bill)
    if         def-agent-wcb
      and not hold-fee-ohip-r(ss) = 0
      and not hold-fee-oma-r (ss) = 0
    then
        perform ya4-round-wcb                   thru ya4-99-exit.
*   endif

    if    hold-basic-tech(ss) = 0
       or hold-basic-fee (ss) = 0
       or hold-fee-ohip  (ss) = 0
    then
       move 0 to hold-priced-tech(ss)
    else
       compute hold-priced-tech(ss) rounded =
                (hold-basic-tech(ss) * hold-fee-ohip(ss)) / hold-basic-fee(ss).
*   endif

ya3-99-exit.
    exit.

ya4-round-wcb.

    divide hold-fee-ohip-r(ss)  by 5
        giving ws-hold-temp-3 remainder ws-hold-temp-2.

    if ws-hold-temp-2 < 3
    then
        subtract ws-hold-temp-2 from hold-fee-ohip-r(ss)
    else
        subtract ws-hold-temp-2 from 5 giving ws-hold-temp-2
        add      ws-hold-temp-2 to   hold-fee-ohip-r(ss).
*   endif

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 195
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
    divide hold-fee-oma-r(ss)   by 5
        giving ws-hold-temp-3 remainder ws-hold-temp-2.

    if ws-hold-temp-2 < 3
    then
        subtract ws-hold-temp-2 from hold-fee-oma-r(ss)
    else
        subtract ws-hold-temp-2 from 5 giving ws-hold-temp-2
        add      ws-hold-temp-2 to   hold-fee-oma-r(ss).
*   endif

ya4-99-exit.
    exit.


ya5-reset-nbr-services-value.

*  (incoming anaesthetis/assistance records (B and C suffixed claims) have
*   the number of services bumped up by the act of pricing the claim. so that
*   the RMA pricing algorithm will work, extract out the basic units from
*   the number of services from incoming claims)


*      hold-sv-nbr-serv-incoming(ss)
    if hold-sv-nbr-serv(ss) not = 0
    then
*       CASE
        if hold-oma-suff(ss) = "B"
        then
            if hold-oma-cd(ss) = "E400" or "E401"
            then
                move 0                  to     hold-sv-nbr-serv(ss)
            else
                subtract hold-oma-fee-asst (ss,ohip)
                                        from   hold-sv-nbr-serv(ss)
                                        giving hold-sv-nbr-serv(ss)
        else
        if hold-oma-suff(ss) = "C"
        then
            if hold-oma-cd(ss) = "E400" or "E401"
            then
                move 0                  to     hold-sv-nbr-serv(ss)
            else
                subtract hold-oma-fee-anae (ss,ohip)
                                        from   hold-sv-nbr-serv(ss)
                                        giving hold-sv-nbr-serv(ss).
*       ENDCASE
*   endif

ya5-99-exit.
    exit.

yb0-calc-basic-fee.

*       (all entries except 'BI','OP' and 'add on codes' are priced according to
*        the calculated basic-fee using the following formula :
*               fee = basic-fee * (#-of-services)
*
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 196
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
*       'bi'lateral entries are priced according to:
*               fee = basic-fee * (constants-master-bilateral-percentage-rate)

*       'OP' override priced uses the fee entered by the
*         operator for the oma-amt
*         and multiply this fee by a constants-mstr-indep-consider-rate
*         to obtain the ohip-amt unless batch-agent-code is 'direct' or 'wcb'
*         in which case the amt-entered is used for both oma and ohip fees.

*        NOTE: as documented in line below, 'add on' codes were identified by
*              having ICC code of SP98/99. Changed to look for
*              "F"lat/"P"ercentage designation
*              in field fee-add-on-perc-or-flat-ind
*         'add on' codes which have an icc-code of "SP98" or "SP99"
*          are set to zero at this time --
*           -- routine 'yf0' will later price these add on codes)


*       agent code = 'wcb' ("9") is priced according to --
*            'basic-rate' * constants master 'wcb-rate'
*       wcb uses ohip-rate not oma-rate for basic-fee
*                ----          ---

*       agent code = 'direct bill' ("6") uses oma not ohip-rate for basic-fee
*                                             ---     ----

*=============  put the table used in calculating prices here =================

*       (this flag will indicate if fee-1 ('1'),
*                                   fee-2 ('2')
*                                or "fee-1 + fee-2" ('3')
*        is used in calculating final amount)
*    brad3
*    if hold-oma-cd(ss) = "E409"
    if hold-oma-cd(ss) = "E409" or "E412"
    then
        next sentence.
*    endif

    move "0"                                    to hold-flag-fee-used (ss).

*   (OP claims from the web/diskette retain their incoming $ while
*    online claims use the amount the user entered into the OMA fee
*    as the basis for basic pricing)
    if hold-sv-day ( ss ,1) = "MR" or "OP"
    then
*   (sms #113 - treat agent 4 as direct bill)
        if   def-agent-ohip
          or def-agent-ohip-wcb
          or def-agent-alternate-funding
        then
            move hold-ss-curr-prev(ss)              to ss-curr-prev
            if online-claim
            then
                compute hold-fee-ohip (ss) rounded
                      = hold-fee-oma  (ss) * const-ic (ss-curr-prev)
                go to yb0-98-technical
            else
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 197
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
                compute hold-fee-ohip      (ss) rounded
                      = hold-fee-incoming  (ss) * const-ic (ss-curr-prev)
                move    hold-fee-ohip      (ss) to hold-fee-oma (ss)
                go to yb0-98-technical

        else
*               (agent 'non-ohip' ie. 'wcb' and 'direct')
            move  hold-fee-oma  (ss) to hold-fee-ohip (ss)
            go to yb0-98-technical.
*       endif
*   (else)
*   endif

*   (00/aug/08 B.E.
*    recognize 'add on' codes by "P"ercent/"F"lat designation rather
*    than having to have a specific ICC code)
*           if hold-icc-cd (ss) =    "SP99"
*                                 or "SP98"

*brad2
* E676B is not to be priced as an add on code even though E676 in f040 has that
    if          (hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind) = "P"
                                                                 or "F"
                )
           and (    hold-oma-suff (ss) <> "B"
* 2011/12/06 - MC22
*            and hold-oma-cd   (ss) <> "E676"
              or hold-oma-cd   (ss) <> "E676"
* 2011/12/06 - end
               )
    then
        move 0                                  to hold-fee-oma  (ss)
        move 0                                  to hold-fee-ohip (ss)
        go to yb0-98-technical.
*   else
*       if hold-sv-day ( ss ,1) = "OP"
*       then
*           if   def-agent-ohip
*             or def-agent-alternate-funding
*           then
*               move hold-ss-curr-prev(ss)          to ss-curr-prev
*               compute hold-fee-ohip (ss) rounded
*                     = hold-fee-oma  (ss) * const-ic (ss-curr-prev)
*               go to yb0-98-technical
*           else
*                       (agent 'non-ohip' ie. 'wcb' and 'direct')
*               move    hold-fee-oma  (ss)
*                            to hold-fee-ohip (ss)
*               go to yb0-98-technical.
*           endif
*       (else)
*       endif
*   endif


*   (basic fee calculation)

*   (setup current/previous rate subscript for this detail line)
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 198
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
    move hold-ss-curr-prev(ss)  to ss-curr-prev.

    if   (hold-icc-sec (ss) = "CV")
      or (     (   hold-icc-sec (ss) =   "NM"
           or      hold-icc-sec (ss) =   "DR"
           or      hold-icc-sec (ss) =   "PF"
           or      hold-icc-sec (ss) =   "DU")
           and hold-oma-suff (ss) = "B"        )

      or (      hold-icc-sec (ss) = "SP"
           and (hold-oma-suff (ss) = "A" or "M")   )
*        E676B priced as per E676A
* 2011/11/07 - MC1 - before 2011/09/01 only for fixed price
*     brad2 -undo this change
*      or (      hold-oma-cd  (ss) = "E676"
*           and (hold-oma-suff (ss) = "B"       )   )

      or (      hold-oma-cd   (ss) = "E676"
           and  hold-oma-suff (ss) = "B"
           and  hold-sv-date  (ss) < '20110901'   )
* 2011/11/07 - end
      or (      hold-icc-sec (ss) = "CP"
           and (hold-oma-suff (ss) = "A" or "M") )

      or (      hold-icc-sec (ss) = "DT"
           and (hold-oma-suff (ss) = "A" or "M")   )

    then
        move hold-oma-fee-1 (ss,oma)    to hold-fee-oma       (ss)
        move hold-oma-fee-1 (ss,ohip)   to hold-fee-ohip      (ss)
        move 1                          to hold-flag-fee-used (ss)

    else
        if   (    (   hold-icc-sec (ss) =   "NM"
               or     hold-icc-sec (ss) =   "DR"
               or     hold-icc-sec (ss) =   "DU"
               or     hold-icc-sec (ss) =   "PF")
              and hold-oma-suff (ss) = "C"          )
        then
            move hold-oma-fee-2 (ss,oma ) to hold-fee-oma       (ss)
            move hold-oma-fee-2 (ss,ohip) to hold-fee-ohip      (ss)
            move 2                        to hold-flag-fee-used (ss)

        else
            if   (    (   hold-icc-sec (ss) =   "NM"
                   or     hold-icc-sec (ss) =   "DU"
                   or     hold-icc-sec (ss) =   "PF"
                   or     hold-icc-sec (ss) =   "DR")
                  and (hold-oma-suff (ss) = "A" or "M") )
            then
                add hold-oma-fee-1 (ss,oma)
                    hold-oma-fee-2 (ss, oma)
                                        giving hold-fee-oma   (ss)
                add hold-oma-fee-1 (ss,ohip)
                    hold-oma-fee-2 (ss,ohip)
                                        giving hold-fee-ohip  (ss)
                move "3"                to hold-flag-fee-used (ss)
            else
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 199
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
                if   (     (   hold-icc-sec (ss) = "CP"
                            or hold-icc-sec (ss) = "DT"
                            or hold-icc-sec (ss) = "SP")
                      and  hold-oma-suff (ss) = "C"        )
                then
                    if ws-doc-spec-cd = 0
                    then
                        move const-reg (ss-curr-prev, 2)
                                        to hold-fee-oma (ss)
                        move const-reg (ss-curr-prev, 1)
                                        to hold-fee-ohip (ss)
                    else
                        move const-cert (ss-curr-prev, 2)
                                        to hold-fee-oma (ss)
                        move const-cert (ss-curr-prev, 1)
                                        to hold-fee-ohip (ss)
*                   endif
                else
                    if    hold-icc-sec  (ss) = "SP"
                      and hold-oma-suff (ss) = "B"
                    then
                        move const-asst (ss-curr-prev, 2)
                                        to hold-fee-oma (ss)
                        move const-asst (ss-curr-prev, 1)
                                        to hold-fee-ohip (ss)
                    else
                        next sentence.
*                   endif
*               endif
*           endif
*       endif
*   endif


*       (apply 'bi'lateral reduction unless i.o.p. code)

    if     hold-sv-day ( ss, 1)         = "BI"
       and hold-oma-cd-alpha ( ss ) not = "Z"
    then
        compute hold-fee-oma  (ss) rounded
                = hold-fee-oma  (ss) * const-bilateral( ss-curr-prev)
        compute hold-fee-ohip (ss) rounded
                = hold-fee-ohip (ss) * const-bilateral( ss-curr-prev)
        go to yb0-50
    else
        next sentence.
*   endif


*       (calculate total # of services)
    compute ws-tot-serv = hold-sv-nbr-serv (ss)
                        + hold-sv-nbr      (ss, 1)
                        + hold-sv-nbr      (ss, 2)
                        + hold-sv-nbr      (ss, 3).

*   (if anae or asst then create a 'basic + times' description rec)
    if         (hold-oma-suff (ss) =  "B" or "C")
       and not (hold-icc-sec(ss)   = "NM" or "PF" or "DU")
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 200
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
    then
*       (set flag indicating a new 'B+T' type description record)
        move "BT"                               to flag-desc-rec
        perform ym0-create-desc-record          thru ym0-99-exit
    else
        next sentence.
*   endif

*   (if anaesthetist ('C') then  fee =
*    =      basic fee (which takes into consideration regular vs certified rate)
*     times (# services + oma code's anaesthetist 'basic' units)
    if     hold-oma-suff (ss) = "C"
      and (hold-icc-sec (ss)  = "CP" or "DT" or "SP")
    then
        compute hold-fee-oma  (ss) rounded
           = hold-fee-oma  (ss) * ( ws-tot-serv + hold-oma-fee-anae (ss,  oma) )
        compute hold-fee-ohip (ss) rounded
           = hold-fee-ohip (ss) * ( ws-tot-serv + hold-oma-fee-anae (ss, ohip) )
        add hold-oma-fee-anae ( ss, ohip)               to hold-sv-nbr-serv (ss)
*       (since system adds the 'basic' units to the 'nbr of svcs' then
*        automatically increase the audit totals with these 'hidden' svcs)
        add hold-oma-fee-anae ( ss, ohip)               to nbr-of-services
        if online-claim
        then
            display scr-last-claim
            go to yb0-50
        else
            go to yb0-50
    else
        next sentence.
*   endif


*   (if assistant ('B') then  fee =
*             =       basic fee
*               times (# services + oma code's 'basic' assistant units)
    if    hold-oma-suff (ss) = "B"
      and hold-icc-sec (ss) = "SP"
    then
        compute hold-fee-oma  (ss) rounded
           = hold-fee-oma  (ss) * ( ws-tot-serv + hold-oma-fee-asst (ss,  oma) )
        compute hold-fee-ohip (ss) rounded
           = hold-fee-ohip (ss) * ( ws-tot-serv + hold-oma-fee-asst (ss, ohip) )
        add hold-oma-fee-asst ( ss, ohip)               to hold-sv-nbr-serv (ss)
*       (since system adds the 'basic' units to the 'nbr of svcs' then
*        automatically increase the audit totals with these 'hidden' svcs)
        add hold-oma-fee-asst ( ss, ohip)               to nbr-of-services
        display scr-last-claim
        go to yb0-50
    else
        next sentence.
*   endif


    compute hold-fee-oma  (ss) rounded = hold-fee-oma  (ss) * ws-tot-serv.
    compute hold-fee-ohip (ss) rounded = hold-fee-ohip (ss) * ws-tot-serv.


* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 201
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
yb0-50.

*       (agent is wcb - calculate at 'basic-rate' (ohip-rate not oma-rate) * 'wc
*                                                  ----          ---

*   (sms #113 - treat agent 4 as direct bill)
    if def-agent-wcb
    then
        compute hold-fee-ohip (ss) rounded = hold-fee-ohip (ss) * const-wcb( ss-
        move    hold-fee-ohip (ss)        to hold-fee-oma  (ss)
    else
*       (agent is direct bill - use oma-rate not ohip-rate)
*                                   ---          ----

*   (sms #113 - treat agent 4 as direct bill)
        if def-agent-bill-direct
           or def-agent-foreign-direct
           or def-agent-ifhp-direct
           or def-agent-ontario-direct
           or def-agent-quebec-direct
        then
            move hold-fee-oma (ss)      to hold-fee-ohip (ss)
        else
           next sentence.
*       endif
*   endif

yb0-98-technical.

* 2009/05/05 MC1 - apply 'ER' for 75 % if clinic 88 and oma code starts with 'D'

     if      hold-sv-day ( ss, 1)         = "ER"
         and clmhdr-clinic-nbr-1-2        = "88"
         and site-id                      = "RMA"
         and (hold-oma-cd-alpha ( ss )     = "D" or "F")
     then
        compute hold-fee-oma  (ss) rounded
                = hold-fee-oma  (ss) * .75
         compute hold-fee-ohip (ss) rounded
                 = hold-fee-ohip (ss) * .75
     else
         next sentence.
*   endif
* 2009/05/05 - end

*   ("special" reduction of fees based upon OMA/LOCATION, note that an
*    appropriate description record must also be created and the manual review
*    flag set to that OHIP is informed of the special pricing)

    if    hold-oma-cd(ss)    = "G259"
      and hold-oma-suff(ss)  = "A"
      and clmhdr-loc         = "G420"
      and clmhdr-i-o-pat-ind = "I"
    then
        compute hold-fee-ohip(ss) = hold-fee-ohip(ss) * .85

*       (set flag indicating an 'A'djudication type description record
*        is to be created)
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 202
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
         move "A"                               to flag-desc-rec
         perform ym0-create-desc-record        thru ym0-99-exit
    else
        next sentence.
*   endif

*   save basic fee and basic technical portion for later
*   calculation of the priced technical portion

    move hold-fee-ohip (ss)                     to hold-basic-fee(ss).

    if    hold-oma-rec-ind (ss,ss-tech-ind) = "Y"
       or hold-oma-suff    (ss) = 'B'
    then
        move hold-basic-fee(ss)                 to hold-basic-tech(ss)
    else
        if hold-oma-suff(ss) = 'C'
        then
            move zero                           to hold-basic-tech(ss)
        else
            if hold-icc-sec(ss) = 'NM' or 'DR' or 'DU' or 'PF'
            then
                move hold-oma-fee-1(ss,ohip)    to hold-basic-tech(ss)
                move hold-oma-fee-2(ss,ohip)    to hold-basic-prof(ss)
                perform yb1-compute-basic-tech  thru yb1-99-exit
            else
                move zero                       to hold-basic-tech(ss).
*   endif

yb0-99-exit.
    exit.


yb1-compute-basic-tech.

    add hold-basic-tech(ss), hold-basic-prof(ss) giving ws-hold-temp-1.

    if ws-hold-temp-1 = zero
    then
        move zero                               to hold-basic-tech(ss)
    else
        compute hold-basic-tech(ss) rounded =
                hold-basic-tech(ss) *
                (hold-basic-fee(ss) / ws-hold-temp-1).

yb1-99-exit.

    exit.

yc0-sort-by-icc-and-fee.

    if hold-sort-key-1 (ss) > hold-sort-key-1 (ss + 1)
    then
        move hold-oma-rec (ss)          to hold-sort-oma-rec
        move hold-oma-rec (ss + 1)      to hold-oma-rec (ss)
        move hold-sort-oma-rec          to hold-oma-rec (ss + 1)
        if ss > 1
        then
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 203
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
            subtract 1 from ss
            go to yc0-sort-by-icc-and-fee
        else
            next sentence
*       endif
    else
        if hold-sort-key-1 (ss) = hold-sort-key-1 (ss + 1)
        then
            if hold-fee-ohip (ss) < hold-fee-ohip (ss + 1)
            then
                move hold-oma-rec (ss)          to hold-sort-oma-rec
                move hold-oma-rec (ss + 1)      to hold-oma-rec (ss)
                move hold-sort-oma-rec          to hold-oma-rec (ss + 1)
                if ss > 1
                then
                    subtract 1 from ss
                    go to yc0-sort-by-icc-and-fee.
*               (else)
*               endif
*           (else)
*           endif
*       (else)
*       endif
*   endif

    add 1,  ss2                                 giving ss2
                                                       ss.

yc0-99-exit.
    exit.

yj0-sort-by-orig-line-no.

    if hold-line-no (ss) > hold-line-no (ss + 1)
    then
        move hold-oma-rec (ss)          to hold-sort-oma-rec
        move hold-oma-rec (ss + 1)      to hold-oma-rec (ss)
        move hold-sort-oma-rec          to hold-oma-rec (ss + 1)
        if ss > 1
        then
            subtract 1 from ss
            go to yj0-sort-by-orig-line-no
        else
            next sentence.
*       endif
*   endif

    add 1,  ss2                                 giving ss2
                                                       ss.

yj0-99-exit.
    exit.

yd0-set-icc-sort-flags.

    if hold-icc-sec (ss) = "SP"
    then
        move "Y"                        to flag-sec-reduction-needed.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 204
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
*   (else)
*   endif

*   (if same day, check for add on code)
*   (00/aug/08 B.E.
*    recognize 'add on' codes by "P"ercent/"F"lat designation rather
*    than having to have a specific ICC code)
*             ('sp98' and 'sp99' are checks for 'add-on' codes)

    if     hold-sv-date    (ss) = hold-sv-date (ss - 1)
       and hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind) <> "P"
       and hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind) <> "F"
*             and  (hold-icc-cd (ss) not = "SP98")
*             and  (hold-icc-cd (ss) not = "SP99")
    then
        if    hold-icc-sec (ss) = hold-icc-sec (ss - 1)
           or hold-icc-sec (ss) = "SP"
        then
            if     hold-icc-grp       (ss) = hold-icc-grp (ss - 1)
              and  (    (hold-icc-cd  (ss) not = "SP00")
                     or (hold-icc-grp (ss) not = "00"  ) )
            then
                move hold-flag-sec (ss - 1) to hold-flag-sec (ss)
                move hold-flag-grp (ss - 1) to hold-flag-grp (ss)
                go to yd0-99-exit
            else
                move hold-flag-sec (ss - 1)     to     hold-flag-sec (ss)
                add  1, ss-grp          giving ss-grp
                                                       hold-flag-grp (ss)
                go to yd0-99-exit.
*           endif
*       (else)
*       endif
*   (else)
*   endif

    add 1, ss-sec                               giving ss-sec
                                                       hold-flag-sec (ss).
    move 1                                      to     ss-grp
                                                       hold-flag-grp (ss).

yd0-99-exit.
    exit.



ye0-group-reductions.

*       (do not do group reduction if the 'icc' group code = "00" --
*       -- also bilateral and independent considerations are not 'group reduced"
*       note - sort has put highest valued entry in group in lower subscripted
*              position of hold-array. therefore we reduce entires (ss+1)
*            - if the icc code of entry to be reduced is not found in constant
*              master record's table of rate then no reduction is done

    add ss, 1                           giving ss-plus-one.

    if      hold-flag-sec-group (ss)  = hold-flag-sec-group (ss-plus-one)
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 205
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
       and (hold-icc-grp (ss)     not = "00")
       and (hold-sv-day ( ss, 1)  not = "BI")
       and (hold-sv-day ( ss, 1)  not = "MR")
       and (hold-sv-day ( ss, 1)  not = "OP")
    then
        move 0                          to rate-found-ss
        perform ye1-find-group-rate     thru ye1-99-exit
                varying ss-x
                from 1 by 1
                until    rate-found-ss not = 0
                      or ss-x > const-max-nbr-rates

*       (setup current/previous rate subscript for this detail line)
        move hold-ss-curr-prev(ss)  to ss-curr-prev
        if rate-found-ss not = 0
        then
            compute hold-fee-ohip (ss-plus-one)  rounded =
                    hold-fee-ohip (ss-plus-one) * const-rates-curr-prev ( rate-f
            compute hold-fee-oma  (ss-plus-one)  rounded =
                    hold-fee-oma  (ss-plus-one) * const-rates-curr-prev ( rate-f
*       (else)
*       endif
*   (else)
*   endif

*  (may need 'pricing_test_min_max_limits.ws' logic here!!)

ye0-99-exit.
    exit.

ye1-find-group-rate.

    if const-section-group (ss-x) = hold-icc-cd (ss-plus-one)
    then
        move ss-x                       to rate-found-ss.
*   (else)
*   endif

ye1-99-exit.
    exit.


yf0-add-on-increases.

*       (this rtn is called varying 'ss' across # of detail lines ('ss-clmdtl-om
*       - if add on codes e409 or e400 have been entered then flag
*         will force search for these codes -- search must be made since
*         these codes are considered as add on's for all oma codes
*         but are not found in any code's 'hold-oma-add-on-cd (x)' fields)


*        skip search if code being checked (ie. oma-cd (ss) )
*          is an add-on code itself since add on's for add on's is not allowed)

    if     hold-oma-cd (ss) =
copy "special_addon_codes.rtn".
                     "E400"
                  or "E409"
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 206
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/spe)
* brad3 (2011/nov/02)
                  or "E412"
                  or "E401"
                  or "E410"
* brad3 (2011/nov/02)
                  or "E413"
*(2005/10/01)
                  or "E420"
*(2005/10/01)
       or hold-sv-day(ss,1) = "MR" or "OP"
*================   you can add on  to an add on  ==========================
****      or (hold-icc-cd (ss) =   "SP98"
****                            or "SP99")
*      or hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind )=   "P"
*                                                           or "F"

    then
        go to yf0-99-exit.
*   (else)
*   endif
*============================================================================

    if     ws-special-add-on-cd-entered = "N"
      and (hold-oma-add-on-cd (ss, 1) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 2) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 3) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 4) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 5) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 6) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 7) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 8) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 9) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss,10) = spaces  or  zeroes)
    then
        next sentence
    else
        perform yf2-search-oma-recs-4-addon-cd  thru yf2-99-exit
            varying ss2
            from 1 by 1
            until   ss2 > ss-clmdtl-oma.
*   endif

yf0-99-exit.
    exit.

yf2-search-oma-recs-4-addon-cd.

*       (note: add on codes "E409", "E400", E420 and E412 are considerated as ad
*        codes for all oma codes and need not be found in add-on-code slots
*                  ===
*        as of 2005/oct/01 E420 also included in this test and 2011/nov E412


*       (add on codes allowed only if performed on same service date)
    if hold-sv-date (ss2) not = hold-sv-date (ss)
    then
        go to yf2-99-exit.
*   (else)
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 207
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
*   endif
*   (00/aug/08 B.E.
*    SP98 and SP99 add on codes have to be reduced by their 'group reduction'
*    factor, however all other add ons have no reduction rate)
    if hold-icc-cd (ss2) = 'SP98'
    then
        move ws-reduc-rate98                    to ws-reduc-rate
    else
        if hold-icc-cd (ss2) = 'SP99'
        then
            move ws-reduc-rate99                to ws-reduc-rate
        else
            move 1                              to ws-reduc-rate.
*       endif
*   endif

    if hold-oma-cd (ss2) =    hold-oma-add-on-cd (ss, 1)
                           or hold-oma-add-on-cd (ss, 2)
                           or hold-oma-add-on-cd (ss, 3)
                           or hold-oma-add-on-cd (ss, 4)
                           or hold-oma-add-on-cd (ss, 5)
                           or hold-oma-add-on-cd (ss, 6)
                           or hold-oma-add-on-cd (ss, 7)
                           or hold-oma-add-on-cd (ss, 8)
                           or hold-oma-add-on-cd (ss, 9)
                           or hold-oma-add-on-cd (ss,10)
*============================================================================
*                                 or "E409"
*                                 or "E412" brad3
*============================================================================
                           or "E400"
                           or "E401"
*                          2005/sept/25
                           or "E420"
*                          2005/sept/25
    then
        next sentence
    else
        go to yf2-99-exit.
*   endif

*    b.e. 2005/sep/28
*    (check for special circumstance of E420 - it may also be add on
*     but under special circumstances)
    if hold-oma-cd(ss2) = "E420"
    then
        if     hold-oma-cd (ss) <> "E400"
           and hold-oma-cd (ss) <> "E401"
           and hold-oma-cd (ss) <> "E409"
*              brad3
           and hold-oma-cd (ss) <> "E412"
           and hold-oma-cd (ss) <> "E410"
*              brad3
           and hold-oma-cd (ss) <> "E413"
           and hold-oma-cd (ss) <> "E411"
           and (   ( hold-icc-cd    (ss) =  "SP00"
                   )
                or (    hold-icc-cd    (ss) = "CV00"
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 208
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
                    and hold-oma-suff  (ss) = "A"
                    and (   hold-oma-cd-num(ss) < 990
                         or hold-oma-cd-num(ss) > 997
                        )
                   )
                or (    hold-oma-suff  (ss) = "A"
                    and (   hold-oma-cd-num(ss) =
copy "special_dt_codes.rtn".
                           "G395"
                        or "G391"
                        or "G521"
                        or "G523"

                        )
                   )
                )
        then
            next sentence
        else
            go to yf2-99-exit
*       endif
    else
        next sentence.
*   endif

*   b.e. 2005/sep/28 - E420A change
*   (for E420A suffix doesn't have to match as it's an add on code to other
*    codes even if their suffix is "B" or "C")
    if    hold-oma-suff(ss2)      = hold-oma-suff(ss)
       or (    hold-oma-cd  (ss2) = "E420"
           and hold-oma-suff(ss2) = "A"
          )
    then
        next sentence
    else
        go to yf2-99-exit.
*   endif

*       (note - fee-1 contains percent of add on code (ss2) --
*        - also the percentage type add-on is not multiplied by
*          wcb-rate since the value of oma code from which add on's percentage
*          is calculated, has already been multiplied by the wcb-rate --
*          however flat rate is calculated as flat-rate * wcb-rate)

*brad2 - don't consider E676B as an add on - flag there only for "A" suffixes
*    if hold-oma-rec-ind (ss2 , ss-add-on-perc-or-flat-ind) <> "P"
    if      hold-oma-rec-ind (ss2 , ss-add-on-perc-or-flat-ind) <> "P"
        or  (    hold-oma-suff (ss2) = "B"
             and hold-oma-cd   (ss2) = "E676"
* 2011/11/08 - MC1 - consider the service date prior 2011/09/01 as well for flat
             and hold-sv-date  (ss2) < "20110901"
* 2011/11/08 - end
            )
    then
        go to yf2-30.
*   endif

* 2012/10/18 - MC5 - do not consider E67B as add on after 20110901
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 209
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
    if           hold-oma-suff (ss2) = "B"
             and hold-oma-cd   (ss2) = "E676"
             and hold-sv-date  (ss2) >= "20110901"
    then
        go to yf2-99-exit.
*   endif
* 2012/10/18 - end

*   (============  percentage add-on code calculation ==========)

*   (calculate Percentage price unless operator has Overridden Price)
*   (00/aug/31 B.E. changed subscript line below from ss-clmdtl-oma to ss2)
*       if hold-sv-day ( ss-clmdtl-oma, 1) not = "OP"

    if hold-sv-day ( ss2, 1) not = "OP"
    then
        compute hold-fee-oma  (ss2) rounded =
                hold-fee-oma  (ss2)     + (   hold-fee-oma   (ss)
                                            * hold-oma-fee-1 (ss2 , oma)
                                            * ws-reduc-rate    )
        compute hold-fee-ohip  (ss2) rounded =
                hold-fee-ohip  (ss2)    + (   hold-fee-ohip   (ss)
                                            * hold-oma-fee-1 (ss2 , ohip)
                                            * ws-reduc-rate    )
*       (if special add-on code then update addon with # of services from 'main'
        if hold-oma-cd (ss2) =    "E400"
                               or "E401"
        then
            compute hold-sv-nbr-serv (ss2)      =  hold-sv-nbr-serv ( ss2)
                                                 + hold-sv-nbr-serv ( ss)
                                                 + hold-sv-nbr      ( ss, 1)
                                                 + hold-sv-nbr      ( ss, 2)
                                                 + hold-sv-nbr      ( ss, 3)
*           (since system adds the 'basic' units to the 'nbr of svcs' then
*            increase the audit totals with these 'additional' svcs)
            compute nbr-of-services             =  nbr-of-services
                                                 + hold-sv-nbr-serv ( ss)
                                                 + hold-sv-nbr      ( ss, 1)
                                                 + hold-sv-nbr      ( ss, 2)
                                                 + hold-sv-nbr      ( ss, 3)
            display scr-last-claim
            go to yf2-50
        else
            go to yf2-50
*           endif
*       endif
    else
        next sentence.
*   endif


yf2-30.
*   ( ===========  FLAT add-on code calculation ========== )
*   (the # of services doesn't effect pricing for the two special add-on codes)
*   if hold-oma-cd ( ss2 ) = "E409"
*   then
*       move 1                                  to ws-pricing-nbr-serv
*   else
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 210
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
        compute ws-pricing-nbr-serv =             hold-sv-nbr-serv ( ss2)
                                                + hold-sv-nbr      ( ss2, 1)
                                                + hold-sv-nbr      ( ss2, 2)
                                                + hold-sv-nbr      ( ss2, 3).
*   endif

*    note - fee-2 contains flat rate value of add on code (ss2)
*   (calculate Flag price unless operator has Overridden Price)
*   (00/aug/31 B.E. changed subscript line below from ss-clmdtl-oma to ss2)
*       if hold-sv-day ( ss-clmdtl-oma, 1) not = "OP"

    if hold-sv-day ( ss2, 1) not = "OP"
    then
        compute hold-fee-oma   (ss2) rounded =
                hold-fee-oma   (ss2)        +   (   hold-oma-fee-2 (ss2 ,  oma)
                                                  * ws-hold-wcb-rate
                                                  * ws-pricing-nbr-serv
                                                  * ws-reduc-rate       )
        compute hold-fee-ohip  (ss2) rounded =
                hold-fee-ohip  (ss2)        +  (   hold-oma-fee-2 (ss2 , ohip)
                                                 * ws-hold-wcb-rate
                                                 * ws-pricing-nbr-serv
                                                 * ws-reduc-rate       ).
*   endif

yf2-50.

*    (e409 has special processing - it is calculated as a percent but then
*     the result is compared against the 'flat' rate -- the greater amount is us

*   if hold-oma-cd (ss2) = "E409"
*   then
*       (if percent calculated amt < 'flat' rate)
*       if  hold-fee-oma (ss2)     < hold-oma-fee-2 (ss2, oma)
*       then
*           move hold-oma-fee-2 (ss2, oma)      to hold-fee-oma  (ss2)
*           move hold-oma-fee-2 (ss2,ohip)      to hold-fee-ohip (ss2)
*       else
*           next sentence.
*       endif
*   endif

*       (agent is wcb - calculate at 'basic-rate' (ohip-rate not oma-rate) * 'wc
*                                                  ----          ---

*   (sms #113 - treat agent 4 as direct bill)
*   if def-agent-wcb
*   then
**      (setup currrent/previous rate subscript for this detail line)
*       move hold-ss-curr-prev(ss)  to ss-curr-prev
*       compute hold-fee-ohip (ss) rounded = hold-fee-ohip (ss) * const-wcb( ss-
*       move    hold-fee-ohip (ss)        to hold-fee-oma  (ss)
*   else
*       (agent is direct bill - use oma-rate not ohip-rate)
*                                   ---          ----

*   (sms #113 - treat agent 4 as direct bill)
        if def-agent-bill-direct
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 211
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
           or def-agent-foreign-direct
           or def-agent-ifhp-direct
           or def-agent-ontario-direct
           or def-agent-quebec-direct
        then
            move hold-fee-oma (ss)      to hold-fee-ohip (ss)
        else
            next sentence.
*       endif
*   endif

yf2-99-exit.
    exit.


yf1-special-add-on-incr.

*       (this rtn is called varying 'ss' across # of detail lines ('ss-clmdtl-om
*       - if add on codes e409 or e400 have been entered then flag
*         will force search for these codes -- search must be made since
*         these codes are considered as add on's for all oma codes
*         but are not found in any code's 'hold-oma-add-on-cd (x)' fields)


*        skip search if code being checked (ie. oma-cd (ss) )
*          is an add-on code itself since add on's for add on's is not allowed)

    if     hold-oma-cd (ss) =
copy "special_addon_codes.rtn".
                     "E400"
                  or "E409"
* brad3 (2011/nov/02)
                  or "E412"
                  or "E401"
                  or "E410"
* brad3 (2011/nov/02)
                  or "E413"
*(2005/10/01)
                  or "E420"
*(2005/10/01)

*==*==   you can add on  to an add on  *==*==**
***      or (hold-icc-cd (ss) =   "SP98"
***                            or "SP99")
*    if hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind )=   "P"
*                                                         or "F"

    then
        go to yf1-99-exit.
*   (else)
*   endif


    if     ws-special-add-on-cd-entered = "N"
      and (hold-oma-add-on-cd (ss, 1) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 2) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 3) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 4) = spaces  or  zeroes)
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 212
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
      and (hold-oma-add-on-cd (ss, 5) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 6) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 7) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 8) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss, 9) = spaces  or  zeroes)
      and (hold-oma-add-on-cd (ss,10) = spaces  or  zeroes)
    then
        next sentence
    else
        perform yf3-search-oma-recs-4-addon-cd  thru yf3-99-exit
            varying ss2
            from 1 by 1
            until   ss2 > ss-clmdtl-oma.
*   endif

yf1-99-exit.
    exit.

yf3-search-oma-recs-4-addon-cd.

*       (note: add on codes "E409"(and E412) and "E400" are considerated as add
*        codes for all oma codes and need not be found in add-on-code slots
*                  ===

*       (add on codes allowed only if performed on same service date)
    if hold-sv-date (ss2) not = hold-sv-date (ss)
    then
        go to yf3-99-exit.
*   (else)
*   endif
*   (00/aug/08 B.E.
*    if not SP add on, no group reduction factor needed, default to 1)

    if hold-icc-cd (ss2) = 'SP98'
    then
        move ws-reduc-rate98                    to ws-reduc-rate
    else
        if hold-icc-cd (ss2) = 'SP99'
        then
            move ws-reduc-rate99                to ws-reduc-rate
        else
            move 1                              to ws-reduc-rate.
*       endif
*   endif

*   if hold-oma-cd (ss2) =    hold-oma-add-on-cd (ss, 1)
*                          or hold-oma-add-on-cd (ss, 2)
*                          or hold-oma-add-on-cd (ss, 3)
*                          or hold-oma-add-on-cd (ss, 4)
*                          or hold-oma-add-on-cd (ss, 5)
*                          or hold-oma-add-on-cd (ss, 6)
*                          or hold-oma-add-on-cd (ss, 7)
*                          or hold-oma-add-on-cd (ss, 8)
*                          or hold-oma-add-on-cd (ss, 9)
*                          or hold-oma-add-on-cd (ss,10)
*       brad3
*    if hold-oma-cd (ss2) =  "E410"

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 213
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
* 2011/11/22 - MC2 transfer to the same as E409/E412 below
**     if hold-oma-cd (ss2) =  "E410" or "E413"
**     then
**      next sentence
**     else
* 2011/11/22 -end

*       brad3
*       if hold-oma-cd(ss2) = "E409"
        if hold-oma-cd(ss2) = "E409" or "E412"
* 2011/11/22 - transfer from above to be included here
                           or "E410" or "E413"
* 2011/11/22 - end
        then
*           (E409/E412 doesn't apply to certain DT codes NOR to ANY CV codes)
            if  (  hold-oma-cd(ss) =
copy "special_dt_codes.rtn".
                           "G395"
                        or "G391"
                        or "G521"
                        or "G523"

                )
             or (hold-icc-sec(ss) = "CV"
                )
            then
                go to yf3-99-exit
            else
                next sentence
*           endif
        else
            go to yf3-99-exit.
*       endif
*   endif

    if hold-oma-suff(ss2) not = hold-oma-suff(ss)
    then
        go to yf3-99-exit.
*   (else)
*   endif

*       (note - fee-1 contains percent of add on code (ss2) --
*        - also the percentage type add-on is not multiplied by
*          wcb-rate since the value of oma code from which add on's percentage
*          is calculated, has already been multiplied by the wcb-rate --
*          however flat rate is calculated as flat-rate * wcb-rate)

    if hold-oma-rec-ind (ss2 , ss-add-on-perc-or-flat-ind) <> "P"
    then
        go to yf3-30.
*   endif

*   (============  percentage add-on code calculation ==========)
*   (calculate PERCENTAGE price unless operator has Overridden Price)
*   (00/aug/31 B.E. changed subscript line below from ss-clmdtl-oma to ss2)
*       if hold-sv-day ( ss-clmdtl-oma, 1) not = "OP"

    if hold-sv-day ( ss2, 1) not = "OP"
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 214
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
    then
*       ( ===========  percentage add-on code calculation ========== )
        compute hold-fee-oma  (ss2) rounded =
                hold-fee-oma  (ss2)     + (   hold-fee-oma   (ss)
                                            * hold-oma-fee-1 (ss2 , oma)
                                            * ws-reduc-rate    )
        compute hold-fee-ohip  (ss2) rounded =
                hold-fee-ohip  (ss2)    + (   hold-fee-ohip   (ss)
                                            * hold-oma-fee-1 (ss2 , ohip)
                                            * ws-reduc-rate    )
            if hold-oma-cd(ss2) =    "E409"
*                       brad3
                                  or "E412"
                                  or "E410"
*                       brad3
                                  or "E413"
            then
                move 1                          to hold-sv-nbr-serv(ss2)
                go to yf3-50
            else
                go to yf3-50
*           endif
*       endif
    else
        next sentence.
*   endif


yf3-30.
*   ( ===========  flat add-on code calculation ========== )

*   (the # of services doesn't effect pricing for the two special add-on codes)
    if hold-oma-cd ( ss2 ) =    "E409"
*brad3
                             or "E412"
                             or "E410"
*brad3
                             or "E413"
    then
        move 1                                  to ws-pricing-nbr-serv.
*   else
*       compute ws-pricing-nbr-serv =             hold-sv-nbr-serv ( ss2)
*                                               + hold-sv-nbr      ( ss2, 1)
*                                               + hold-sv-nbr      ( ss2, 2)
*                                               + hold-sv-nbr      ( ss2, 3).
*   endif

*    note - fee-2 contains flat rate value of add on code (ss2)
*   (calculate FLAT price unless operator has Overridden Price)
*   (00/aug/31 B.E. changed subscript line below from ss-clmdtl-oma to ss2)
*       if hold-sv-day ( ss-clmdtl-oma, 1) not = "OP"

    if hold-sv-day ( ss2, 1) not = "OP"
    then
        compute hold-fee-oma   (ss2) rounded =
                hold-fee-oma   (ss2)        +   (   hold-oma-fee-2 (ss2 ,  oma)
                                                  * ws-hold-wcb-rate
                                                  * ws-pricing-nbr-serv
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 215
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
                                                  * ws-reduc-rate       )
        compute hold-fee-ohip  (ss2) rounded =
                hold-fee-ohip  (ss2)        +  (   hold-oma-fee-2 (ss2 , ohip)
                                                 * ws-hold-wcb-rate
                                                 * ws-pricing-nbr-serv
                                                 * ws-reduc-rate       ).
*   endif


yf3-50.

*    (E409/E412  has special processing - it is calculated as a percent but then
*     the result is compared against the 'flat' rate -- the greater amount is us

*   (00/aug/31 B.E. changed subscript line below from ss-clmdtl-oma to ss2)
    if     (hold-oma-cd (ss2) =    "E409"
*brad3
                                or "E412"
                                or "E413"
                                or "E410")
*                and hold-sv-day ( ss-clmdtl-oma, 1) not = "OP"
       and hold-sv-day ( ss2, 1) not = "OP"
    then
*       (if percent calculated amt < 'flat' rate)
        if  hold-fee-oma (ss2)     < hold-oma-fee-2 (ss2, oma)
        then
            move hold-oma-fee-2 (ss2, oma)      to hold-fee-oma  (ss2)
            move hold-oma-fee-2 (ss2,ohip)      to hold-fee-ohip (ss2)
        else
            next sentence.
*       endif
*   endif

*       (agent is wcb - calculate at 'basic-rate' (ohip-rate not oma-rate) * 'wc
*                                                  ----          ---

*   (sms #113 - treat agent 4 as direct bill)
*    if def-agent-bill-direct
*   then
*       (setup currrent/previous rate subscript for this detail line)
*       move hold-ss-curr-prev(ss)  to ss-curr-prev.
*       compute hold-fee-ohip (ss) rounded = hold-fee-ohip (ss) * const-wcb( ss-
*       move    hold-fee-ohip (ss)        to hold-fee-oma  (ss)
*   else
*       (agent is direct bill - use oma-rate not ohip-rate)
*                                   ---          ----

*   (sms #113 - treat agent 4 as direct bill)
        if def-agent-bill-direct
           or def-agent-foreign-direct
           or def-agent-ifhp-direct
           or def-agent-ontario-direct
           or def-agent-quebec-direct
        then
            move hold-fee-oma (ss)      to hold-fee-ohip (ss)
        else
            next sentence.
*       endif
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 216
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
*   endif

yf3-99-exit.
    exit.



yh0-find-high-grp-within-sec.
*       (calculate each group's value -- ignore all anaesthetist ('c') and assis

*       (since 'yh1' varies 'ss' from ss-from+1 up, check ss-from position of ho
    move zeros                                  to hold-grp-totals-tbl
                                                 ss-grp-tot
                                                ws-highest-grp-tot
                                                ws-highest-grp-nbr.
    move "N"                                    to flag-new-sec.

yh0-100-find-sp-suffix-a.

    if hold-oma-suff (ss-from) = "A"
    then
        add 1                           to      ss-grp-tot
        move ss-from                    to      ss
        perform yh11-add-singular-value thru    yh11-99-exit
    else
        add 1                           to      ss-from
        if ss-from > ss-clmdtl-oma
        then
            move ss-clmdtl-oma          to      ss-to
            move "Y"                    to      flag-new-sec
        else
            go to yh0-100-find-sp-suffix-a.
*       endif
*   endif

*       (if the icc section code indicates that 'sectional reduction' will be
*        necessary ((at this time only 'sp' for suffix codes "A" qualify)) -- th
*        the group total.  these group totals will later be used to determine
*         which group is highest valued and therefore not to be sectionally redu

    add 1, ss-from                              giving ss-from-plus-one.

    perform yh1-calc-group-values               thru yh1-99-exit
                varying ss
                from ss-from-plus-one by 1
                until   flag-new-sec = "Y".


*       (determine which group in hold-grp-tot array has highest value)

    move 'N'                                    to flag-z-highest-grp

    perform yh2-find-highest-value              thru yh2-99-exit
                varying ss
                from 1 by 1
                until ss > ss-grp-tot.

yh0-99-exit.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 217
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
    exit.


yh1-calc-group-values.

*       (process only 'ss-clmdtl-oma' nbr of entries)

    if ss > ss-clmdtl-oma
    then
        move ss-clmdtl-oma                      to ss-to
        move "Y"                                to flag-new-sec
        go to yh1-99-exit.
*   (else)
*   endif

*       (if anesthetist or assistant ignore entry)
    if hold-oma-suff (ss) = "B" or "C"
    then
        go to yh1-99-exit.
*   (else)
*   endif


    if hold-icc-sec  (ss) not = "SP"
    then
        next sentence
    else
        if  hold-flag-sec-group (ss) = hold-flag-sec-group (ss - 1)
        then
            perform yh11-add-singular-value     thru    yh11-99-exit
            go to yh1-99-exit
        else
            if hold-flag-sec (ss) = hold-flag-sec (ss - 1)
            then
                add 1                           to ss-grp-tot
                perform yh11-add-singular-value thru    yh11-99-exit
                go to yh1-99-exit.
*           (else)
*           endif
*       endif
*    endif

*       (new section found - set flag to stop perform)

    subtract 1 from ss                          giving ss-to.
    move "Y"                                    to flag-new-sec.

yh1-99-exit.
    exit.



yh11-add-singular-value.

*       (store sec/group flag and add up group's "SINGULAR UNIT" values

*        -- determine if 'fee-1'/'fee-2'/'fee-1+fee-2' was used to calculate
*       'singular unit value'.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 218
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
*       if fee used is not known (ie. flag=0) then use calculated
*       'fee-oma')


    move hold-flag-sec-group (ss)               to hold-grp-nbr (ss-grp-tot).


    if hold-flag-fee-used (ss) = "0"
    then
        add hold-fee-oma (ss)                   to hold-grp-tot (ss-grp-tot)
    else
        if hold-flag-fee-used (ss) = "1"
        then
            add hold-oma-fee-1 (ss, ohip)       to hold-grp-tot (ss-grp-tot)
        else
            if hold-flag-fee-used (ss) = "2"
            then
                add hold-oma-fee-2 (ss, ohip)   to hold-grp-tot (ss-grp-tot)
            else
                if hold-flag-fee-used (ss) = "3"
                then
                    add hold-oma-fee-1 (ss, ohip)
                        hold-oma-fee-2 (ss, ohip)
                        hold-grp-tot (ss-grp-tot) giving hold-grp-tot (ss-grp-to
*               (else)
*               endif
*           endif
*       endif
*   endif

yh11-99-exit.
    exit.



yh2-find-highest-value.

    if hold-grp-tot ( ss ) > ws-highest-grp-tot
    then
        move hold-grp-tot ( ss )                to ws-highest-grp-tot
        move hold-grp-nbr ( ss )                to ws-highest-grp-nbr
        if hold-oma-cd-alpha(ss) = 'Z'
        then
            move 'Y'                            to flag-z-highest-grp.
*       (else)
*       endif
*   (else)
*   endif

yh2-99-exit.
    exit.



yi0-sec-reduct-within-sec.

*      (sectional reduction entails reducing all groups except the
*       highest priced one by the sectional reduction rate.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 219
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
*       THE FOLLOWING ARE not SECTIONALLY REDUCED:
*               - 'add on' codes ("P"ercentage/"F"lat designation)
*               - 'I.O.P' codes (starting with 'Z') ,
*               - Manual Review (MR) and
*               - Entries for anesthetists (suffix = 'C')
*                          or assistants   (suffix = 'B')

*   (setup currrent/previous rate subscript for this detail line)
    move hold-ss-curr-prev(ss)  to ss-curr-prev.

*   if       hold-icc-sec (ss)  = "SP"

    if     hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind) <> "P"
       and hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind) <> "F"
       and hold-sv-day     (ss, 1)  <> "MR"
       and hold-sv-day     (ss, 1)  <> "OP"
       and hold-oma-suff   (ss)     <> "B"
       and hold-oma-suff   (ss)     <> "C"
    then
*       (reduce this group if its not the highest valued group)
        if    hold-flag-sec-group (ss) = ws-highest-grp-nbr
          or  flag-z-highest-grp = 'Y'
        then
            next sentence
        else
            if    hold-oma-cd-alpha (ss) <> "Z"
              and hold-oma-rec-ind  (ss, ss-add-on-perc-or-flat-ind) <> "P"
              and hold-oma-rec-ind  (ss, ss-add-on-perc-or-flat-ind) <> "F"
*                      and (hold-icc-cd (ss) not = "SP98")
*                      and (hold-icc-cd (ss) not = "SP99")
* 2012/08/14 - MC4 - uncomment the above 2 lines - according to Linda Ohara, no
*                    eg. E735, E736, E739, E725, E726
              and (hold-icc-cd (ss) not = "SP98")
              and (hold-icc-cd (ss) not = "SP99")
* 2012/08/14 - end
            then
                compute hold-fee-oma  (ss) rounded =
                        hold-fee-oma  (ss) * const-sr (ss-curr-prev)
                compute hold-fee-ohip (ss) rounded =
                        hold-fee-ohip (ss) * const-sr (ss-curr-prev).
*           (else)
*           endif
*       endif
*   (else)
*   endif

yi0-99-exit.
    exit.


*ym0-create-basic-times-desc.
ym0-create-desc-record.

* (2001/aug/29 B.E. changed routine's name and overloaded it to produce
*  basic+times description records and regular 'text' message description
*  records)

*   (CURRENTLY newu701 doesn't create these records in the suspense files -
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 220
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
*    so code is skipped)
    if not online-claim
    then
* 2005/08/17 - MC  (now   newu701 does create these records in the suspense file
       if adjudication-desc-entry
       then
*       (set flag to force creation of description rec later in processing)
           move "Y"                          to flag-adjudication-required
           go to ym0-99-exit
        else
* 2005/08/17 - end
           go to ym0-99-exit.

*   endif

    if adjudication-desc-entry
    then
*       (set flag to force creation of description rec later in processing)
        move "Y"                          to flag-adjudication-required

*       move "REFER TO ADJUDICATION"      to hold-desc (ss-basic-times-desc-rec)
**      (force subscript to indicate description record is 'full' so that code
**       won't try to slip a B+T description into this desc rec)
*        move 2                            to ss-basic-times

        go to ym0-90-display.
*   endif


    add 1                               to ss-basic-times.

*   ('basic+times' description records are created with 2 'B+T' entries
*    per description record so skip to next description record if current
*    one is already full and creating another B+T record or skip to new
*    rec if creating a text message record and a B+T already in current
*    record)
*    if    (    adjudication-desc-required
*           and ss-basic-times > 1
*         )
*       or (    basic-plus-times-entry
     if   (    basic-plus-times-entry
           and ss-basic-times > 2
          )
    then
        move 1                          to ss-basic-times
        add 1, ss-basic-times-desc-rec  giving ss-basic-times-desc-rec.
*   (else)
*   endif

    if basic-plus-times-entry
    then
        move "B +"                        to hold-basic-b (ss-basic-times)
        move "T /"                        to hold-times-t (ss-basic-times)
        move ws-tot-serv                  to hold-times-units (ss-basic-times)
        if hold-oma-suff (ss) = "B"
        then
            move hold-oma-fee-asst (ss, ohip)
                                          to hold-basic-units (ss-basic-times)
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 221
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
            move hold-basic-times-desc    to hold-desc (ss-basic-times-desc-rec)
            go to ym0-90-display
        else
            move hold-oma-fee-anae (ss, ohip)
                                          to hold-basic-units (ss-basic-times)
            move hold-basic-times-desc    to hold-desc (ss-basic-times-desc-rec)
            go to ym0-90-display.
*       endif
*   endif


ym0-90-display.
    display scr-acpt-det-desc.

ym0-99-exit.
    exit.




yz0-reset-verify-prices.

    perform yz1-check-price             thru yz1-99-exit
        varying ss
        from 1 by 1
        until   ss > ss-clmdtl-oma.

yz0-99-exit.
    exit.


yz1-check-price.

*  (routine 'ya0' has priced claims according to RMA pricing. if
*   incoming file was "D"iskette AND the operator requested that the
*   incoming prices NOT be retain, then reset prices to
*   the 'incoming' values rather than RMA priced amounts.
*   If the file was from the "W"eb, then reset any OP or MR line
*   to 'incoming' prices)
*   NOTE: updating OHIP price only - OMA has RMA calculated prices!!!!!

    if   (    diskette-claim
          and retain-incoming-prices
         )
      or     web-claim
         and (    retain-incoming-prices
               or hold-sv-day (ss,1) = "MR" or "OP"
             )
    then
        move hold-fee-incoming (ss)     to hold-fee-ohip    (ss).
*   endif

*  (routine 'ya0-' also may have altered the nbr services on the claim
*   as it priced "B/C" suffix claims for basic+times calculations.
*   Reset these to original incoming values if incoming file was a
*   diskette claim)
    if   diskette-claim
    then
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 222
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
        move hold-sv-nbr-serv-incoming(ss)
                                        to hold-sv-nbr-serv (ss).
*   endif

yz1-99-exit.
    exit.


xa0-display-details .
*   (this is dummy routine called from pricing copybook logic that
*    is used by d001 to display priced claims on screen.
*
*    IF EVER WE NEED TO DUMP PRICED CLAIMS INTO REPORT OR DO OTHER CHECKING
*    THEN HERE IS THE IDEAL AREA TO PLACE THIS CODE
*

xa0-99-exit.
    exit.
za0-common-error.
*   (this is dummy routine called from pricing copybook logic that
*    is used by d001 to display errors
za0-99-exit.
    exit.


zb0-build-write-err-rpt-line.

    move err-msg (err-ind)              to      rpt-line.

* 2010/05/19 - MC6
    move '5'                             to      ru701-page-area.
* 201/05/19 - end

    perform zz0-write-err-rpt-line      thru    zz0-99-exit.

zb0-99-exit.
    exit.


zz0-write-err-rpt-line.

     add ws-carriage-ctrl               to      ctr-lines-printed.
     if ctr-lines-printed > max-lines-per-page
     then
        perform zz1-print-headings      thru    zz1-99-exit
        move 1                          to      ws-carriage-ctrl.
*    endif

    write rpt-line      after advancing ws-carriage-ctrl lines.

* 2010/05/19 - MC6

    move doc-nbr                   to ru701-doc-nbr.
    move bt-clinic-nbr-1-2         to ru701-clinic-nbr.
    move batch-specialty           to ru701-doc-spec-cd.
    move clmhdr-pat-acronym        to ru701-pat-acronym.
    move hold-accounting-nbr       to ru701-accounting-nbr.
    move rpt-line                  to ru701-print-line.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 223
*                      newu701.cbl                                   )
    move ctr-recs-read             to ru701-orig-rec-no.
    move 'N'                       to ru701-acronym-flag.
    move clmhdr-pat-acronym        to ru701-acronym.
    move ctr-lines-printed         to ru701-line-no.
    write ru701-work-rec.
* 2010/05/19 - end
zz0-99-exit.
    exit.



zz1-print-headings.

*   (SAVE LINE THAT WAS TO BE PRINTED, RESTORE AFTER HEADINGS PRINTED)
    move rpt-line                  to   save-prt-line.

    add 1                          to   ws-rpt-page-nbr.
    move ws-rpt-page-nbr           to   rpt-page-nbr.
    write rpt-line from heading-l1 after advancing page.

*   (97/09/25 B.E. - ADD DOCTOR INFO INTO AUDIT REPORT)
    move doc-nbr                   to h-l2-doctor-nbr.
    move doc-inits                 to h-l2-doctor-initials.
    move doc-name                  to h-l2-doctor-name.
    move batch-group-nbr           to h-l2-clinic.
    move batch-specialty           to h-l2-specialty.
    write rpt-line from heading-l2 after advancing 1 line.

    move spaces                    to   rpt-line
    write rpt-line                 after advancing 2 lines.
    move 2                         to   ctr-lines-printed.

    move save-prt-line             to   rpt-line.

zz1-99-exit.
    exit.


zz3-apply-tech-prof-suff-rules.

copy "tech_prof_suff_split_part1.rtn"
     replacing  ==ss-clmdtl-oma== by ==ss-tech-prof-suff==.
* file: tech_prof_suff_split_part1.rtn
* purpose: certain ICC codes must be submitted appropriate suffix depending
*          upon tech/prof components. Note that diskette uploaded claims
*          are NOT changed
* 2001/apr/01 B.E. - original
* 2001/oct/01 B.E. documentation wrong - corrected!


*   (note only RMA repsonsible claims with sufix "A" are tested)
    if    ( hold-icc-sec (ss-tech-prof-suff) = "PF" or "DU" or "DR" or "NM" )
      and ( hold-oma-suff(ss-tech-prof-suff) = "A" )
      and ( not diskette-claim)
    then
*       CASE
*       (if "TECH" only and "A" suffix - change to "B")
        if    hold-oma-fee-1(ss-tech-prof-suff , ohip)<> 0
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 224
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/tec)
          and hold-oma-fee-2(ss-tech-prof-suff , ohip) = 0
        then
            move "Y"                        to   flag-tech-prof-suffix-rule
            move "B" to hold-oma-suff(ss-tech-prof-suff)
            perform xa0-display-details     thru xa0-99-exit
        else

*       (if "PROF" only and "A" suffix - change to "C")
        if    hold-oma-fee-1(ss-tech-prof-suff , ohip) = 0
          and hold-oma-fee-2(ss-tech-prof-suff , ohip)<> 0
        then
            move "Y"                            to flag-tech-prof-suffix-rule
            move "C"                            to hold-oma-suff(ss-tech-prof-su
            perform xa0-display-details         thru xa0-99-exit
        else

*       (if both "PROF+TECH" "A" suffix - change to "B" and add 2nd line
*                                        with "C" code if not 8th line of input)
        if    hold-oma-fee-1(ss-tech-prof-suff , ohip)<> 0
          and hold-oma-fee-2(ss-tech-prof-suff , ohip)<> 0
        then
            perform zz6-calc-ss-for-next-dtl    thru   zz6-99-exit
            if    online-claim
            then
*               (error if new line would exceed max allowed number of detail lin
                if ss-clmdtl-new-dtl > ss-max-nbr-oma-det-rec-allow
                then
                    move 101                    to err-ind
                    perform za0-common-error    thru za0-99-exit
*                   (blank line entered since it can't be expanded)
                    move spaces         to hold-oma-rec     (ss-tech-prof-suff)
                    move zero           to hold-sv-nbr-serv (ss-tech-prof-suff)
                    move zero           to hold-sv-date     (ss-tech-prof-suff)
                    move zero           to hold-sv-nbr-days-conseq
                                                            (ss-clmdtl-oma,1)
                    move zero           to hold-sv-nbr-days-conseq
                                                            (ss-clmdtl-oma,2)
                    move zero           to hold-sv-nbr-days-conseq
                                                            (ss-clmdtl-oma,3)
                    move zero           to hold-fee-incoming(ss-tech-prof-suff)
                    move zero           to hold-fee-oma     (ss-tech-prof-suff)
                    move zero           to hold-fee-ohip    (ss-tech-prof-suff)
                    move zero           to hold-priced-tech (ss-tech-prof-suff)
                    move zero           to hold-basic-tech  (ss-tech-prof-suff)
                    move zero           to hold-basic-prof  (ss-tech-prof-suff)
                    move zero           to hold-basic-fee   (ss-tech-prof-suff)
                    move zero           to hold-oma-fees    (ss-clmdtl-oma,1)
                    move zero           to hold-oma-fees    (ss-clmdtl-oma,2)
                    move zero           to hold-fee-min     (ss-clmdtl-oma,1)
                    move zero           to hold-fee-min     (ss-clmdtl-oma,2)
                    move zero           to hold-fee-max     (ss-clmdtl-oma,1)
                    move zero           to hold-fee-max     (ss-clmdtl-oma,2)
                    move zero           to hold-oma-fee-anae(ss-clmdtl-oma,1)
                    move zero           to hold-oma-fee-anae(ss-clmdtl-oma,2)
                    move zero           to hold-oma-fee-asst(ss-clmdtl-oma,1)
                    move zero           to hold-oma-fee-asst(ss-clmdtl-oma,2)
                    move zero           to hold-ss-curr-prev(ss-tech-prof-suff)
                    move zero           to hold-flag-sec-group(ss-tech-prof-suff
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 225
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/tec)
                    move zero           to hold-diag-cd     (ss-tech-prof-suff)
                    move zero           to hold-line-no     (ss-tech-prof-suff)
                    subtract 1          from                 ss-tech-prof-suff
                else
                    perform zz7-split-a-into-b-and-c thru zz7-99-exit
*                   (split line's svc need to be added to claim audit counter)
                    add hold-sv-nbr-serv (ss-tech-prof-suff)
                                                     to  nbr-of-services
                    display scr-last-claim-lit
                    perform xa0-display-details      thru xa0-99-exit
*                   (bump up line number so that operator skips the system
*                    built line from above code)
                    add 1                            to   ss-tech-prof-suff
                    perform xa0-display-details      thru xa0-99-exit
*               endif
            else
                perform zz7-split-a-into-b-and-c     thru zz7-99-exit
                add 1                                to ss-clmdtl-next-avail-dtl
*           endif
*       endif
*       ENDCASE



zz3-99-exit.
    exit.


copy "tech_prof_suff_split_part2.rtn"
     replacing  ==ss-clmdtl-oma== by ==ss-tech-prof-suff==.
* file: tech_prof_suff_split_part2.rtn
* purpose: - certain ICC codes must be submitted appropriate suffix depending
*            upon tech/prof components
*          - this routine calculates the next avail subscript for a new dtl rec


zz6-calc-ss-for-next-dtl.

    if    online-claim
    then
        add 1                           to     ss-tech-prof-suff
                                        giving ss-clmdtl-new-dtl
    else
        add 1                           to     ss-clmdtl-next-avail-dtl
                                        giving ss-clmdtl-new-dtl.
*   endif

zz6-99-exit.
    exit.



zz7-split-a-into-b-and-c.
*   (set flag that change has been made)

    move "Y"                        to   flag-tech-prof-suffix-rule.

*   (change "A" suffix to "B" and create new detail with "C" suffix)
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 226
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/tec)
    move "B"                        to hold-oma-suff(ss-tech-prof-suff)
*   (default next line as same oma code with "C" suffix
    move hold-oma-rec(ss-tech-prof-suff)to hold-oma-rec(ss-clmdtl-new-dtl).
    move "C"                        to hold-oma-suff(ss-clmdtl-new-dtl).
    move ss-clmdtl-new-dtl          to hold-line-no (ss-clmdtl-new-dtl).

zz7-99-exit.
    exit.


copy "y2k_default_sysdate_century.rtn".
y2k-default-sysdate.

    move sys-date-left                  to sys-date-temp.
    move sys-date-temp                  to sys-date-right.
    move zeros                          to sys-date-blank.
* 1999/dec/30 B.E.
*   add 19000000                        to sys-date-numeric.
    add 20000000                        to sys-date-numeric.

y2k-default-sysdate-exit.
    exit.

copy "pricing_test_min_max_limits.rtn".
* file: pricing_test_min_max_limits.rtn
* 00/aug/14 B.E. original
* 01/aug/29 B.E. - remove error messages when reducing or increase amounts
* 01/sep/01 B.E. - changed min/max fee checkings so that it takes place only
*                  on "A" suffix claim details

test-min-max-limits.

*   (test min/max price to ensure that calculated basic prices are within
*    acceptable range for "A" suffix claims only - doesn't apply to
*    assistant(B) and anesthetist(C) details)

*   (non add-on, non OP'd fees must be > minimum if specified)

    if    hold-fee-min    (ss, oma) <> 0
      and hold-fee-oma    (ss)      <  hold-fee-min(ss, oma)
*        and hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind) <> "P"
*        and hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind) <> "F"
      and hold-sv-day     (ss,1) <> "OP"
      and hold-oma-suff   (ss)   = "A"
    then
        move hold-fee-min (ss, oma)             to hold-fee-oma (ss).
*          move 86                                 to      err-ind
*          perform za0-common-error                thru    za0-99-exit.
*   endif

    if    hold-fee-min    (ss,ohip) <> 0
      and hold-fee-ohip   (ss)      <  hold-fee-min(ss,ohip)
*        and hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind) <> "P"
*        and hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind) <> "F"
      and hold-sv-day     (ss,1) <> "OP"
      and hold-oma-suff   (ss)   = "A"
    then
        move hold-fee-min (ss,ohip)             to hold-fee-ohip(ss).
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 227
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/pri)
*          move 87                                 to      err-ind
*          perform za0-common-error                thru    za0-99-exit.
*   endif

*   (non add-on, non OP'd fees must be < maximum if specified)
    if    hold-fee-max    (ss, oma) <> 0
      and hold-fee-oma    (ss)       > hold-fee-max(ss, oma)
*         and hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind) <> "P"
*         and hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind) <> "F"
      and hold-sv-day     (ss,1) <> "OP"
      and hold-oma-suff   (ss)   = "A"
    then
        move hold-fee-max (ss, oma)             to hold-fee-oma (ss).
*          move 88                                 to      err-ind
*          perform za0-common-error                thru    za0-99-exit.
*   endif

    if    hold-fee-max    (ss,ohip) <> 0
      and hold-fee-ohip   (ss)       > hold-fee-max(ss,ohip)
*         and hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind) <> "P"
*         and hold-oma-rec-ind(ss, ss-add-on-perc-or-flat-ind) <> "F"
      and hold-sv-day     (ss,1) <> "OP"
      and hold-oma-suff   (ss)   = "A"
    then
        move hold-fee-max (ss,ohip)             to hold-fee-ohip(ss).
*          move 89                                 to      err-ind
*          perform za0-common-error                thru    za0-99-exit.
*   endif

test-min-max-limits-99-exit.
    exit.

copy "d001_newu701_oma_code_edit.rtn".
***  d001_newu701_oma_code_edit.rtn  - set flag if selected oma code is met
**   this copybook is used in d001.cbl, newu701.cbl, u701oscar.cbl

la4-oma-code-edit.

*   (05/nov/01 M.C. set flag if E708 found)
    if hold-oma-cd(ss-clmdtl-oma) =   "E078"
    then
        move "Y"                                to ws-e078-premium.
*   endif
*  2005/11/01 - end

* edit 2 -----------------------------------------------------------

* 2008/04/28 - M.C. set flag if code found
    if     hold-oma-cd(ss-clmdtl-oma) =   "E020"
      and  hold-oma-suff(ss-clmdtl-oma) = "C"
    then
        move "Y"                                to ws-e020.
* endif

    if   (    hold-oma-cd(ss-clmdtl-oma) =   "E022"
          or  hold-oma-cd(ss-clmdtl-oma) =   "E017"
          or  hold-oma-cd(ss-clmdtl-oma) =   "E016"
         )
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 228
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
      and  hold-oma-suff(ss-clmdtl-oma) = "C"
    then
        move "Y"                                to ws-e022-e017-e016.
*   endif

* edit 3 ------------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "E719"
    then
        move "Y"                                to ws-e719.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "Z570"
    then
        move "Y"                                to ws-z570.
*   endif

* edit 4 -----------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "E720"
    then
        move "Y"                                to ws-e720.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "Z571"
    then
        move "Y"                                to ws-z571.
*   endif

* edit 5 -----------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "E717"
    then
        move "Y"                                to ws-e717.
*   endif

* 2013/04/10 - MC28 - for edit 5 & 68

* 2013/04/10 - MC28 - just only check Z580 and comment out the others
*   if    hold-oma-cd(ss-clmdtl-oma) =   "Z555"
    if    hold-oma-cd(ss-clmdtl-oma) =   "Z580"
**    or  hold-oma-cd(ss-clmdtl-oma) =   "Z580"
* 2011/11/23 - MC19+MC22 - for edit 5 to include check of Z496 to Z499  (colonsc
**    or  hold-oma-cd(ss-clmdtl-oma) =   "Z496"
**    or  hold-oma-cd(ss-clmdtl-oma) =   "Z497"
**    or  hold-oma-cd(ss-clmdtl-oma) =   "Z498"
**    or  hold-oma-cd(ss-clmdtl-oma) =   "Z499"
* 2013/04/10 - end
* 2011/11/23 - end
    then
        move "Y"                                to ws-z555-z580.
*   endif

* edit 68 & edit 79 ------------------------------------------------

    if    hold-oma-cd(ss-clmdtl-oma) =   "Z555"
      or (     hold-oma-cd(ss-clmdtl-oma) >=  "Z491"
          and  hold-oma-cd(ss-clmdtl-oma) <=  "Z499"
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 229
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
         )
    then
        move "Y"                                to ws-z491-to-z499.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "A120"
    then
        move "Y"                                to ws-a120.
*   endif

* 2013/04/10 - end

* edit 6 -----------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "E702"
    then
        move "Y"                                to ws-e702.
*   endif

    if    hold-oma-cd(ss-clmdtl-oma) =   "Z515"
      or  hold-oma-cd(ss-clmdtl-oma) =   "Z399"
      or  hold-oma-cd(ss-clmdtl-oma) =   "Z400"
      or  hold-oma-cd(ss-clmdtl-oma) =   "Z561"
      or  hold-oma-cd(ss-clmdtl-oma) =   "Z558"
      or  hold-oma-cd(ss-clmdtl-oma) =   "Z760"
    then
        move "Y"                                to ws-z515-z760.
*   endif

* edit 7 -----------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "G123"
    then
        move "Y"                                to ws-g123.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "G228"
    then
        move "Y"                                to ws-g228.
*   endif

* edit 8 -----------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "G223"
    then
        move "Y"                                to ws-g223.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "G231"
    then
        move "Y"                                to ws-g231.
*   endif

* edit 9 -----------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "G265"
    then
        move "Y"                                to ws-g265.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 230
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "G264"
    then
        move "Y"                                to ws-g264.
*   endif

* edit 10 ----------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "G385"
    then
        move "Y"                                to ws-g385.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "G384"
    then
        move "Y"                                to ws-g384.
*   endif

* edit 11 ----------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "G281"
    then
        move "Y"                                to ws-g281.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "G381"
    then
        move "Y"                                to ws-g381.
*   endif

* edit 11 -  end ---------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "E793"
    then
        move "Y"                                to ws-e793.
*   endif

    if    hold-oma-cd(ss-clmdtl-oma) =   "R905"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S091"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S092"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S166"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S167"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S169"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S171"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S798"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S799"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S800"
* 2010/03/31 - MC4 - add 18 more codes
      or  hold-oma-cd(ss-clmdtl-oma) =   "S122"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S123"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S125"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S128"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S120"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S134"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S149"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S157"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S165"
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 231
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
      or  hold-oma-cd(ss-clmdtl-oma) =   "S172"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S168"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S170"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S189"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S213"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S214"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S215"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S217"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S218"
* 2010/03/31 - end
* 2011/03/31 - MC13 - add 3 more codes
      or  hold-oma-cd(ss-clmdtl-oma) =   "S113"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S114"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S115"
* 2011/03/31 - end
    then
        move "Y"                                to ws-r905-s800.
*   endif

    if      hold-oma-cd-alpha(ss-clmdtl-oma) =   "A"
       and  hold-oma-suff    (ss-clmdtl-oma) =   "A"
    then
        move "Y"                                to ws-annna.
*   endif

    if      hold-oma-cd-alpha(ss-clmdtl-oma) =   "G"
       and  hold-oma-suff    (ss-clmdtl-oma) =   "A"
    then
        move "Y"                                to ws-gnnna.
*   endif

    if   (    hold-oma-cd(ss-clmdtl-oma) =   "K991"
          or  hold-oma-cd(ss-clmdtl-oma) =   "K993"
          or  hold-oma-cd(ss-clmdtl-oma) =   "K995"
          or  hold-oma-cd(ss-clmdtl-oma) =   "K997"
          or  hold-oma-cd(ss-clmdtl-oma) =   "U991"
          or  hold-oma-cd(ss-clmdtl-oma) =   "U993"
          or  hold-oma-cd(ss-clmdtl-oma) =   "U995"
          or  hold-oma-cd(ss-clmdtl-oma) =   "U997"
         )
       and  hold-oma-suff    (ss-clmdtl-oma) =   "A"
    then
        move "Y"                                to ws-k991-u997.
*   endif

*  2008/04/28 - end

* 2009/05/04 - MC1
* edit 14  --------------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "C998"
    then
        move "Y"                                to ws-c998.
*   endif

* edit 15  --------------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "C999"
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 232
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
    then
        move "Y"                                to ws-c999.
*   endif

* edit 16 ---------------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "E798"
    then
        move "Y"                                to ws-e798.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "Z400"
    then
        move "Y"                                to ws-z400.
*   endif

* edit 17 ---------------------------------------------------------------

    if        hold-oma-cd(ss-clmdtl-oma) =   "G400"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G401"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G402"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G557"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G558"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G559"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G405"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G406"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G407"
          or  hold-oma-cd(ss-clmdtl-oma) =   "E411"
* 2013/04/11 - MC28 - include P001 & G210
          or  hold-oma-cd(ss-clmdtl-oma) =   "P001"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G210"
* 2013/04/11 - end
    then
        move "Y"                                to ws-g400-other-codes.
*   endif

    if        hold-oma-cd(ss-clmdtl-oma) =   "E409"
          or  hold-oma-cd(ss-clmdtl-oma) =   "E410"
    then
        move "Y"                                to ws-e409-e410.
*   endif

* MC46+MC43+MC48 - include the check of G325

    if        hold-oma-cd(ss-clmdtl-oma) =   "G325"
    then
        move "Y"                                to ws-g325.
*   endif

* MC46+MC43+MC48 - end

* edit 18 ---------------------------------------------------------------

    if        hold-oma-cd(ss-clmdtl-oma) =   "C990"
          or  hold-oma-cd(ss-clmdtl-oma) =   "C991"
          or  hold-oma-cd(ss-clmdtl-oma) =   "C992"
          or  hold-oma-cd(ss-clmdtl-oma) =   "C993"
          or  hold-oma-cd(ss-clmdtl-oma) =   "C994"
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 233
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
          or  hold-oma-cd(ss-clmdtl-oma) =   "C995"
          or  hold-oma-cd(ss-clmdtl-oma) =   "C996"
          or  hold-oma-cd(ss-clmdtl-oma) =   "C997"
* 2010/03/31 - MC4 - add 7 more oma codes
          or  hold-oma-cd(ss-clmdtl-oma) =   "C986"
          or  hold-oma-cd(ss-clmdtl-oma) =   "C987"
          or  hold-oma-cd(ss-clmdtl-oma) =   "C960"
          or  hold-oma-cd(ss-clmdtl-oma) =   "C961"
          or  hold-oma-cd(ss-clmdtl-oma) =   "C962"
          or  hold-oma-cd(ss-clmdtl-oma) =   "C963"
          or  hold-oma-cd(ss-clmdtl-oma) =   "C964"
* 2010/03/31 - end
     then
* 2010/09/23 - MC14 - save the service date for comparison later
        move hold-sv-date(ss-clmdtl-oma)        to ws-sv-date-c1
* 2010/09/23 - end
        move "Y"                                to ws-c990-to-c997.
*   endif

    if (      hold-oma-cd(ss-clmdtl-oma) <>   "C990"
         and  hold-oma-cd(ss-clmdtl-oma) <>   "C991"
         and  hold-oma-cd(ss-clmdtl-oma) <>   "C992"
         and  hold-oma-cd(ss-clmdtl-oma) <>   "C993"
         and  hold-oma-cd(ss-clmdtl-oma) <>   "C994"
         and  hold-oma-cd(ss-clmdtl-oma) <>   "C995"
         and  hold-oma-cd(ss-clmdtl-oma) <>   "C996"
         and  hold-oma-cd(ss-clmdtl-oma) <>   "C997"
* 2009/05/27 - MC3 - with exception of C101
         and  hold-oma-cd(ss-clmdtl-oma) <>   "C101"
* 2009/05/27 - end
* 2010/03/31 - MC4 - add 7 more oma codes
         and  hold-oma-cd(ss-clmdtl-oma) <>  "C986"
         and  hold-oma-cd(ss-clmdtl-oma) <>  "C987"
         and  hold-oma-cd(ss-clmdtl-oma) <>  "C960"
         and  hold-oma-cd(ss-clmdtl-oma) <>  "C961"
         and  hold-oma-cd(ss-clmdtl-oma) <>  "C962"
         and  hold-oma-cd(ss-clmdtl-oma) <>  "C963"
         and  hold-oma-cd(ss-clmdtl-oma) <>  "C964"
* 2010/03/31 - end
       )
      and   hold-oma-cd-alpha(ss-clmdtl-oma) =   "C"

    then
* 2010/09/23 - MC14 - save the service date for comparison later
        move hold-sv-date(ss-clmdtl-oma)        to ws-sv-date-c2
* 2010/09/23 - end
* MC46+MC43+MC48 - change to use ws-cnnn-c101
*       move "Y"                                to ws-cnnn.
        move "Y"                                to ws-cnnn-c101.
* MC46+MC43+MC48 - end
*   endif

* edit 19 ---------------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "E450"
    then
        move "Y"                                to ws-e450.
*   endif
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 234
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)

    if hold-oma-cd(ss-clmdtl-oma) =   "J315"
    then
        move "Y"                                to ws-j315.
*   endif

* 2009/05/04 - end

* 2010/03/31 - MC4
    if hold-oma-cd(ss-clmdtl-oma) =   "C985"
    then
        move "Y"                                to ws-c985.
*   endif

* edit 20---------------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "G222"
    then
        move "Y"                                to ws-g222.
*   endif

    if        hold-oma-cd(ss-clmdtl-oma) =   "G248"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G125"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G118"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G062"
    then
        move "Y"                                to ws-g248-g062.
*   endif

* edit 21---------------------------------------------------------------

* MC46+MC43+MC48 - exclude A770 and A075, A075 has transferred to new edit 81

*    if       hold-oma-cd(ss-clmdtl-oma) =   "A770"
*         or  hold-oma-cd(ss-clmdtl-oma) =   "A775"
* 2011/11/23 - MC19+MC22 - edit 21 to include the check of A075
*         or  hold-oma-cd(ss-clmdtl-oma) =   "A075"
* 2011/11/23 - end
      if      hold-oma-cd(ss-clmdtl-oma) =   "A775"
* MC46+MC43+MC48 - end
    then
        move "Y"                                to ws-a770-a775.
*   endif

    if        hold-oma-cd-num (ss-clmdtl-oma) >= 900
          and hold-oma-cd-num (ss-clmdtl-oma) <= 999
          and (    hold-oma-cd-alpha(ss-clmdtl-oma) =   "C"
               or  hold-oma-cd-alpha(ss-clmdtl-oma) =   "W"
               or  hold-oma-cd-alpha(ss-clmdtl-oma) =   "K"
* 2011/11/23 - MC19+MC22 - edit 21 to exclude the check of B9xx
*              or  hold-oma-cd-alpha(ss-clmdtl-oma) =   "B"
* 2011/12/23 - end
              )
    then
        move "Y"                                to ws-X9nn.
*   endif

* edit 23---------------------------------------------------------------
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 235
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)

    if        hold-oma-cd(ss-clmdtl-oma) =   "H112"
          or  hold-oma-cd(ss-clmdtl-oma) =   "H113"
    then
        move "Y"                                to ws-h112-h113.
*   endif

* 2014/06/05 - user decided to remove this edit check
*   if        hold-oma-cd(ss-clmdtl-oma) <>  "H112"
*         and hold-oma-cd(ss-clmdtl-oma) <>  "H113"
*         and hold-oma-cd-alpha(ss-clmdtl-oma) =   "H"
* 2011/07/27 - except if the code is H100
*         and hold-oma-cd(ss-clmdtl-oma) <> "H100"
* 2011/07/27 - end
*   then
*       move "Y"                                to ws-hnnn.
*   endif
* 2014/06/05 - end

* edit 24 & 28 ---------------------------------------------------------------

    if    hold-oma-cd(ss-clmdtl-oma) =   "G489"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S323"
    then
        move "Y"                                to ws-g489-s323.
*   endif

* edit 25 ---------------------------------------------------------------

    if    hold-oma-cd(ss-clmdtl-oma) =   "G222"
      or  hold-oma-cd(ss-clmdtl-oma) =   "Z804"
      or  hold-oma-cd(ss-clmdtl-oma) =   "Z805"
    then
        move "Y"                                to ws-g222-z805.
*   endif

    if   (    hold-oma-cd(ss-clmdtl-oma) =   "P014"
          or  hold-oma-cd(ss-clmdtl-oma) =   "P016"
         )
      and  hold-oma-suff(ss-clmdtl-oma) = "C"
    then
        move "Y"                                to ws-p014-p016.
*   endif

* edit 27 ---------------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "G221"
    then
        move "Y"                                to ws-g221.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "G220"
    then
        move "Y"                                to ws-g220.
*   endif

* edit 29 ---------------------------------------------------------------

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 236
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
    if    hold-oma-cd(ss-clmdtl-oma) =   "S322"
      or  hold-oma-cd(ss-clmdtl-oma) =   "S326"
* 2011/11/23 - MC19+MC22 - edit 29 to exclude the check of A197 and A198
*     or  hold-oma-cd(ss-clmdtl-oma) =   "A197"
*     or  hold-oma-cd(ss-clmdtl-oma) =   "A198"
* 2011/11/23 - end
* MC46+MC43+MC48 - edit 29 to include the check of E423
      or  hold-oma-cd(ss-clmdtl-oma) =   "E423"
* MC46+MC43+MC48 - end
    then
        move "Y"                                to ws-s322-a198.
*   endif

* edit 31 -------------------------------------------------------------

    if    hold-oma-cd(ss-clmdtl-oma) =   "G521"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G395"
    then
        move "Y"                                to ws-g521-g395.
*   endif

    if    hold-oma-cd(ss-clmdtl-oma) =   "H104"
      or  hold-oma-cd(ss-clmdtl-oma) =   "H134"
      or  hold-oma-cd(ss-clmdtl-oma) =   "H154"
      or  hold-oma-cd(ss-clmdtl-oma) =   "H124"
    then
        move "Y"                                to ws-h104-h124.
*   endif

* edit 32 ------------------------------------------------------------

    if    hold-oma-cd(ss-clmdtl-oma) =   "G345"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G359"
* 2011/11/23 - edit 32 to exlcude the check of G339 but include the check of G38
*     or  hold-oma-cd(ss-clmdtl-oma) =   "G339"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G381"
* 2011/11/23 - end
    then
        move "Y"                                to ws-g345-g339.
*   endif

    if      hold-oma-cd-alpha(ss-clmdtl-oma) =   "A"
    then
        move "Y"                                to ws-annn.
*   endif

* edit 33 --------------------------------------------------------------

    if    hold-oma-cd(ss-clmdtl-oma) =   "A765"
      or  hold-oma-cd(ss-clmdtl-oma) =   "C765"
    then
        move "Y"                                to ws-a765-c765.
*   endif

* edit 35 ------------------------------------------------------------

    if   (    hold-oma-cd(ss-clmdtl-oma) =   "G431"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G478"
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 237
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
          or  hold-oma-cd(ss-clmdtl-oma) =   "G479"
         )
       and  hold-oma-suff    (ss-clmdtl-oma) =   "C"
    then
        move "Y"                                to ws-g431-g479.
*   endif

* 2010/03/31 - end

* 2011/03/31 - MC13
    if hold-oma-cd(ss-clmdtl-oma) =   "C983"
    then
        move "Y"                                to ws-c983.
*   endif

* edit 37 ------------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "J025"
    then
        move "Y"                                to ws-j025.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "J021"
    then
        move "Y"                                to ws-j021.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "J022"
    then
        move "Y"                                to ws-j022.
*   endif

* edit 41 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "Z608"
    then
        move "Y"                                to ws-z608.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "Z611"
    or hold-oma-cd(ss-clmdtl-oma) =   "Z602"
    then
        move "Y"                                to ws-z611-z602.
*   endif

* edit 44 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "Z403"
    then
        move "Y"                                to ws-z403.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "Z408"
    then
        move "Y"                                to ws-z408.
*   endif

* edit 44 - end ------------------------------------------------
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 238
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)

    if hold-oma-cd(ss-clmdtl-oma) =   "A195"
    then
        move "Y"                                to ws-a195.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "K002"
    then
        move "Y"                                to ws-k002.
*   endif

* edit 46 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "C122"
    or hold-oma-cd(ss-clmdtl-oma) =   "C123"
    or hold-oma-cd(ss-clmdtl-oma) =   "C124"
    or hold-oma-cd(ss-clmdtl-oma) =   "C142"
    or hold-oma-cd(ss-clmdtl-oma) =   "C143"
    then
        move "Y"                                to ws-c122-c143.
*   endif

   if hold-oma-cd(ss-clmdtl-oma) =   "E083"
    then
        move "Y"                                to ws-e083.
*   endif

* edit 47 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "C122"
    or hold-oma-cd(ss-clmdtl-oma) =   "C123"
    or hold-oma-cd(ss-clmdtl-oma) =   "C124"
    or hold-oma-cd(ss-clmdtl-oma) =   "C142"
    or hold-oma-cd(ss-clmdtl-oma) =   "C143"
    or hold-oma-cd(ss-clmdtl-oma) =   "C882"
    or hold-oma-cd(ss-clmdtl-oma) =   "C982"
* 2011/05/02 - MC14 - add more variable check
    or (      hold-oma-cd-alpha(ss-clmdtl-oma) = 'C'
        and  (hold-oma-cd-num-3(ss-clmdtl-oma) = 2 or 7 or 9)
       )
* 2011/05/02 - end
    then
        move "Y"                                to ws-c122-c982.
*   endif

* edit 49 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "G489"
    or hold-oma-cd(ss-clmdtl-oma) =   "G482"
* 2011/11/23 - MC19+MC22 - edit 49 to exclude the check of G379 and G376
*    or hold-oma-cd(ss-clmdtl-oma) =   "G379"
*    or hold-oma-cd(ss-clmdtl-oma) =   "G376"
* 2011/11/23 - end
* MC46+MC43+MC48 - edit 49 to include the check of G571, G581 and G580
     or hold-oma-cd(ss-clmdtl-oma) =   "G571"
     or hold-oma-cd(ss-clmdtl-oma) =   "G581"
     or hold-oma-cd(ss-clmdtl-oma) =   "G580"
* add  edit 71 to include the check of P007
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 239
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
     or hold-oma-cd(ss-clmdtl-oma) =   "P007"
* MC46+MC43+MC48 - end
    then
        move "Y"                                to ws-g489-g376.
*   endif

* 2011/03/31 - end


* 2011/11/23 - MC19+MC22 - add new edits 52 to 63

* edit 52 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "A197"
    or hold-oma-cd(ss-clmdtl-oma) =   "A198"
    then
        move "Y"                                to ws-a197-a198.
*   endif

* edit 53 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "K189"
    then
        move "Y"                                to ws-k189.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "A190"
    or hold-oma-cd(ss-clmdtl-oma) =   "A195"
    or hold-oma-cd(ss-clmdtl-oma) =   "A695"
    or hold-oma-cd(ss-clmdtl-oma) =   "A795"
    then
        move "Y"                                to ws-a190-a795.
*   endif

* edit 54 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "K960"
    then
        move "Y"                                to ws-k960.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "K990"
    then
        move "Y"                                to ws-k990.
*   endif

* edit 55 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "K961"
    then
        move "Y"                                to ws-k961.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "K992"
    then
        move "Y"                                to ws-k992.
*   endif

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 240
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
* edit 56 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "K962"
    then
        move "Y"                                to ws-k962.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "K994"
    then
        move "Y"                                to ws-k994.
*   endif

* edit 57 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "K963"
    then
        move "Y"                                to ws-k963.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "K998"
    then
        move "Y"                                to ws-k998.
*   endif

* edit 58 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "K964"
    then
        move "Y"                                to ws-k964.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "K996"
    then
        move "Y"                                to ws-k996.
*   endif

* edit 59 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "C960"
    then
        move "Y"                                to ws-c960.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "C990"
    then
        move "Y"                                to ws-c990.
*   endif

* edit 60 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "C961"
    then
        move "Y"                                to ws-c961.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "C992"
    then
        move "Y"                                to ws-c992.
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 241
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
*   endif

* edit 61 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "C962"
    then
        move "Y"                                to ws-c962.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "C994"
    then
        move "Y"                                to ws-c994.
*   endif

* edit 62 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "C963"
    then
        move "Y"                                to ws-c963.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "C986"
    then
        move "Y"                                to ws-c986.
*   endif

* edit 63 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "C964"
    then
        move "Y"                                to ws-c964.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "C996"
    then
        move "Y"                                to ws-c996.
*   endif


* 2011/11/23  - end

* 2012/10/22 - MC26/23 - comment out the below if condition since the pricing of
* 2011/12/05 - MC22/19 - add new edit 64

* edit 64 ------------------------------------------------------

*    if     hold-oma-cd(ss-clmdtl-oma)   = "E676"
*      and  hold-oma-suff(ss-clmdtl-oma) = "B"
*    then
*       * move "Y"                                to ws-e676.
*   endif
* 2011/12/05 - end
* 2012/10/22 - end

* 2013/04/11 - MC28

* edit 67 ------------------------------------------------------

* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 242
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
    if hold-oma-cd(ss-clmdtl-oma) =   "G556"
    then
        move "Y"                                to ws-g556.
*   endif

    if        hold-oma-cd(ss-clmdtl-oma) =   "G400"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G405"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G557"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G600"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G603"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G604"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G610"
          or  hold-oma-cd(ss-clmdtl-oma) =   "G620"
    then
        move "Y"                                to ws-g400-g620.
*   endif

* 2013/04/11 - end

* MC46+MC43+MC48 - add for edit 69 to 79

* edit 69 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "E402"
    or hold-oma-cd(ss-clmdtl-oma) =   "E403"
    then
        move "Y"                                to ws-e402-e403.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "G247"
    then
        move "Y"                                to ws-g247.
*   endif

* edit 72 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "E797"
    then
        move "Y"                                to ws-e797.
*   endif

    if    hold-oma-cd(ss-clmdtl-oma) =   "Z580"
      or  hold-oma-cd(ss-clmdtl-oma) =   "Z555"
      or  hold-oma-cd(ss-clmdtl-oma) =   "Z499"
      or  hold-oma-cd(ss-clmdtl-oma) =   "Z498"
      or (     hold-oma-cd(ss-clmdtl-oma) >=  "Z491"
          and  hold-oma-cd(ss-clmdtl-oma) <=  "Z495"
         )
    then
        move "Y"                                to ws-z491-z580.
*   endif

* edit 73 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "E414"
    then
        move "Y"                                to ws-e414.
*   endif
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 243
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)

* edit 76 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "P030"
    then
        move "Y"                                to ws-p030.
*   endif

    if      hold-oma-cd-alpha(ss-clmdtl-oma) =   "C"
    then
        move "Y"                                to ws-cnnn.
*   endif

* edit 77 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "A895"
    then
        move "Y"                                to ws-a895.
*   endif

    if      hold-oma-cd-alpha(ss-clmdtl-oma) =   "W"
    then
        move "Y"                                to ws-wnnn.
*   endif

    if      hold-oma-cd-alpha(ss-clmdtl-oma) =   "K"
    then
        move "Y"                                to ws-knnn.
*   endif

* edit 78 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "Z512"
    then
        move "Y"                                to ws-z512.
*   endif

    if hold-oma-cd(ss-clmdtl-oma) =   "Z514"
    then
        move "Y"                                to ws-z514.
*   endif

* edit 79 ------------------------------------------------------

    if hold-oma-cd(ss-clmdtl-oma) =   "Z580"
    then
        move "Y"                                to ws-z580.
*   endif

* edit 80 ------------------------------------------------------

    if    hold-oma-cd(ss-clmdtl-oma) =   "G264"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G265"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G227"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G238"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G214"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G228"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G123"
* Micro Focus COBOL for UNIX         V4.0 revision 005 26-Apr-17 12:50 Page 244
*                      newu701.cbl (/alpha/rmabill/rmabill101/use/d00)
      or  hold-oma-cd(ss-clmdtl-oma) =   "G230"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G226"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G229"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G240"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G241"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G242"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G250"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G225"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G235"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G219"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G220"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G221"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G231"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G223"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G218"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G243"
      or  hold-oma-cd(ss-clmdtl-oma) =   "G244"
    then
        add hold-sv-nbr-serv (ss-clmdtl-oma)    to ws-total-nbr-svc
        move "Y"                                to ws-edit-80.
*   endif

*  for below 4 codes, if svc is 1 , count as 2, so add 1 more svc
*  since it has considered the original svc from above

    if   (   hold-oma-cd(ss-clmdtl-oma) =   "G226"
          or hold-oma-cd(ss-clmdtl-oma) =   "G240"
          or hold-oma-cd(ss-clmdtl-oma) =   "G242"
          or hold-oma-cd(ss-clmdtl-oma) =   "G244"
         )
      and hold-sv-nbr-serv (ss-clmdtl-oma) = 1
    then
         add 1                                  to ws-total-nbr-svc.

* edit 81

    if hold-oma-cd(ss-clmdtl-oma) =   "A075"
    then
        move "Y"                                to ws-a075.
*   endif


la4-99-exit.
   exit.
* Micro Focus COBOL for UNIX         V4.0 revision 005 Compiler
* Copyright (C) 1984-1995 Micro Focus Ltd.     URN 2XUPG/GB0/00000F
*                                              REF GNB-030056000AA
*
* Total Messages:     0
* Data:       50020     Code:       57326
