* Micro Focus COBOL for UNIX         V4.0 revision 005 13-Mar-02 12:03 Page   1
*                      account.cbl
* Directives File: /usr/opt/mfcobol4.0/cobol.dir
* Accepted - SHOW-DIR
* Accepted - SOURCEFORMAT"FREE"
* Accepted - SPZERO
* Accepted - TIME
* Accepted - TRUNC
* Accepted - RESEQ
* Accepted - SEQCHK
* Accepted - OSVS
* End Of Directives File: /usr/opt/mfcobol4.0/cobol.dir
* Options: int(account.int) anim verbose nolist + ref endp list(account.lst)
program-id.                                                                             0
account.                                                                              160
                                                                                      160
data division.                                                                        160
working-storage section.                                                              160
78 account-name-len     value 80.                                                     160
01 account-name pic x(account-name-len).                                              160
01 total        pic 9(9) value zero.                                                  1B0
01 result       pic $$$,$$$,$$9.                                                      1BC
                                                                                      1BC
linkage section.                                                                      1C8
01 strlen               pic x(4) comp-5.                                                0
01 newname              pic x(80).                                                      0
01 next-item            pic x(4) comp-5.                                                0
                                                                                        4
procedure division.                                                                     0
display spaces upon crt.                                                               60
exit program.                                                                          67
                                                                                       6C
                                                                                       6C
entry "validate" using strlen newname.                                                 6C
if strlen > account-name-len                                                           75
display "account name exceeds ", account-name-len,                                     7E
"characters."                                                                          7F
move 1 to return-code                                                                  AA
else                                                                                   B1
move newname(1:strlen) to account-name.                                                B3
exit program.                                                                          C4
                                                                                       C9
entry "tally" using next-item.                                                         C9
            add next-item to total                                                     D2
                on size error                                                          E3
                    display "numeric overflow"                                         E3
                    move 2 to return-code.                                             F7
            exit program.                                                              FF
                                                                                      104
entry "showaccount".                                                                  104
            display spaces upon crt.                                                  10D
            display account-name.                                                     114
            move total to result.                                                     11A
            display result.                                                           126
            exit program.                                                             12B
* Micro Focus COBOL for UNIX         V4.0 revision 005 Compiler
* Copyright (C) 1984-1995 Micro Focus Ltd.     URN 2XUPG/GB0/00000F
*                                              REF GNB-030056000AA
*
* Total Messages:     0
* Micro Focus COBOL for UNIX         V4.0 revision 005 13-Mar-02 12:03 Page   2
*                      account.cbl
* Data:         632     Code:         327
