;#> PROGRAM-ID.     U110.QTS
;
;       ((C)) Dyad Technologies
;
;    PURPOSE: SUB-PROCESS WITHIN "EARNINGS GENERATION" PROCESS.
;             Create EARNINGS transactions in F110-COMPENSATION for
;             the current EP-NBR using MTD values taken from F050-REVENUE-MSTR
;
;             STAGE 1 - create subfile of values from F050-REVENUE-MSTR
;
;    MODIFICATION HISTORY
;        DATE    SAF #  WHO      DESCRIPTION
;     93/JUN/01  ____   B.E.     - original
;     93/AUG/02  ____   B.E.     - criteria for output of a transaction
;				   changed from > 0 to <> 0 to allow
;				   negative only transactions
;     93/OCT/07  ____   B.E.     - change summing from YTD to MTD amounts
;     93/OCT/11  ____   B.E.     - criteria for output of transactions changed
;				   to force creation if any record found in
;				   in F050
;     94/FEB/17  ____   M.C.     - MODIFY PGM TO INCLUDE HSC LOCATION
;     95/OCT/19  ----   M.C.     - PDR 631 - INCLUDE OMA CD 'MICV',
;				   'MICM', 'MISJ', 'MISP', 'MOHR'
;     99/feb/24  ----   B.E.     - add new miscellaneous payment codes of
;				   'MICB', MIBR' and 'MINH'
;     99/dec/20  ----   B.E.	 - added MHSC (also allow DHSC which was
;				   mistakenly entered - s/b MHSC
;     06/jul/11  ----   B.E.	 - added DHSC and then changed to DHSC
;     06/sep/07  ----   b.e. 	 - added AGEP	
;     07/jul/03  ----   b.e.     - added MICA - MICL
;
; -------------------------------------------------------
;       IF UPDATING THIS FILE ALSO UPDATE THE FOLLOWING FILES:
;       costing_billing_codes_?.q?s 
;
;       This program has an include:
;	either - u110_rma.qts or u110_hsc.qts
; -------------------------------------------------------

cancel clear
set stacksize 10000
run u110

set default
set process nolimit

global temp   bill-seq    zoned*2
global temp   bill-type   char*1
global temp   bill-factor zoned*6
global temp  afpin-seq    zoned*2
global temp  afpin-type   char*1
global temp  afpin-factor zoned*6
global temp  afpout-seq    zoned*2
global temp  afpout-type   char*1
global temp  afpout-factor zoned*6
global temp  misc0-seq    zoned*2
global temp  misc0-type   char*1
global temp  misc0-factor zoned*6
global temp  misc1-seq    zoned*2
global temp  misc1-type   char*1
global temp  misc1-factor zoned*6
global temp  misc2-seq    zoned*2
global temp  misc2-type   char*1
global temp  misc2-factor zoned*6
global temp  misc3-seq    zoned*2
global temp  misc3-type   char*1
global temp  misc3-factor zoned*6
global temp  misc4-seq    zoned*2
global temp  misc4-type   char*1
global temp  misc4-factor zoned*6
global temp  misc5-seq    zoned*2
global temp  misc5-type   char*1
global temp  misc5-factor zoned*6
global temp  misc6-seq    zoned*2
global temp  misc6-type   char*1
global temp  misc6-factor zoned*6
global temp  misc7-seq    zoned*2
global temp  misc7-type   char*1
global temp  misc7-factor zoned*6
global temp  misc8-seq    zoned*2
global temp  misc8-type   char*1
global temp  misc8-factor zoned*6
global temp  misc9-seq    zoned*2
global temp  misc9-type   char*1
global temp  misc9-factor zoned*6

global temp  micv-seq     zoned*2
global temp  micv-type    char*1
global temp  micv-factor  zoned*6
global temp  micm-seq     zoned*2
global temp  micm-type    char*1
global temp  micm-factor  zoned*6
global temp  misj-seq     zoned*2
global temp  misj-type    char*1
global temp  misj-factor  zoned*6
global temp  misp-seq     zoned*2
global temp  misp-type    char*1
global temp  misp-factor  zoned*6
global temp  mohr-seq     zoned*2
global temp  mohr-type    char*1
global temp  mohr-factor  zoned*6
global temp  micb-seq     zoned*2
global temp  micb-type    char*1
global temp  micb-factor  zoned*6
global temp  mibr-seq     zoned*2
global temp  mibr-type    char*1
global temp  mibr-factor  zoned*6
global temp  minh-seq     zoned*2
global temp  minh-type    char*1
global temp  minh-factor  zoned*6

global temp  mhsc-seq     zoned*2
global temp  mhsc-type    char*1
global temp  mhsc-factor  zoned*6

global temp  dhsc-seq     zoned*2
global temp  dhsc-type    char*1
global temp  dhsc-factor  zoned*6

global temp  agep-seq     zoned*2
global temp  agep-type    char*1
global temp  agep-factor  zoned*6

global temp  mica-seq     zoned*2
global temp  mica-type    char*1
global temp  mica-factor  zoned*6
global temp  micc-seq     zoned*2
global temp  micc-type    char*1
global temp  micc-factor  zoned*6
global temp  micd-seq     zoned*2
global temp  micd-type    char*1
global temp  micd-factor  zoned*6
global temp  mice-seq     zoned*2
global temp  mice-type    char*1
global temp  mice-factor  zoned*6
global temp  micf-seq     zoned*2
global temp  micf-type    char*1
global temp  micf-factor  zoned*6
global temp  micg-seq     zoned*2
global temp  micg-type    char*1
global temp  micg-factor  zoned*6
global temp  mich-seq     zoned*2
global temp  mich-type    char*1
global temp  mich-factor  zoned*6
global temp  micj-seq     zoned*2
global temp  micj-type    char*1
global temp  micj-factor  zoned*6
global temp  mick-seq     zoned*2
global temp  mick-type    char*1
global temp  mick-factor  zoned*6
global temp  micl-seq     zoned*2
global temp  micl-type    char*1
global temp  micl-factor  zoned*6

request u111_a_get_bill                      &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "BILL"
item   bill-seq   final  process-seq
item   bill-type  final  comp-type
item   bill-factor final  factor

request u111_a_get_afpin                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "AFPIN"
item   afpin-seq    final  process-seq
item   afpin-type   final  comp-type
item   afpin-factor final  factor

request u111_a_get_afpout                    &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "AFPOUT"
item   afpout-seq    final  process-seq
item   afpout-type   final  comp-type
item   afpout-factor final  factor

request u111_a_get_misc0                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MISC0"
item  misc0-seq   final  process-seq
item  misc0-type  final  comp-type
item  misc0-factor final  factor

request u111_a_get_misc1                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MISC1"
item  misc1-seq   final  process-seq
item  misc1-type  final  comp-type
item  misc1-factor final  factor

request u111_a_get_misc2                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MISC2"
item  misc2-seq   final  process-seq
item  misc2-type  final  comp-type
item  misc2-factor final  factor

request u111_a_get_misc3                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MISC3"
item  misc3-seq   final  process-seq
item  misc3-type  final  comp-type
item  misc3-factor final  factor

request u111_a_get_misc4                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MISC4"
item  misc4-seq   final  process-seq
item  misc4-type  final  comp-type
item  misc4-factor final  factor

request u111_a_get_misc5                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MISC5"
item  misc5-seq   final  process-seq
item  misc5-type  final  comp-type
item  misc5-factor final  factor

request u111_a_get_misc6                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MISC6"
item  misc6-seq   final  process-seq
item  misc6-type  final  comp-type
item  misc6-factor final  factor

request u111_a_get_misc7                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MISC7"
item  misc7-seq   final  process-seq
item  misc7-type  final  comp-type
item  misc7-factor final  factor

request u111_a_get_misc8                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MISC8"
item  misc8-seq   final  process-seq
item  misc8-type  final  comp-type
item  misc8-factor final  factor

request u111_a_get_misc9                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MISC9"
item  misc9-seq   final  process-seq
item  misc9-type  final  comp-type
item  misc9-factor final  factor

request u111_a_get_micv                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MICV"
item  micv-seq   final  process-seq
item  micv-type  final  comp-type
item  micv-factor final  factor

request u111_a_get_micm                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MICM"
item  micm-seq   final  process-seq
item  micm-type  final  comp-type
item  micm-factor final  factor

request u111_a_get_misj                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MISJ"
item  misj-seq   final  process-seq
item  misj-type  final  comp-type
item  misj-factor final  factor

request u111_a_get_micb                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MICB"
item  micb-seq   final  process-seq
item  micb-type  final  comp-type
item  micb-factor final  factor

request u111_a_get_mibr                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MIBR"
item  mibr-seq   final  process-seq
item  mibr-type  final  comp-type
item  mibr-factor final  factor

request u111_a_get_minh                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MINH"
item  minh-seq   final  process-seq
item  minh-type  final  comp-type
item  minh-factor final  factor

request u111_a_get_misp                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MISP"
item  misp-seq   final  process-seq
item  misp-type  final  comp-type
item  misp-factor final  factor

request u111_a_get_mohr                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MOHR"
item  mohr-seq   final  process-seq
item  mohr-type  final  comp-type
item  mohr-factor final  factor

request u111_a_get_mhsc                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "MHSC"
item  mhsc-seq   final  process-seq
item  mhsc-type  final  comp-type
item  mhsc-factor final  factor

request u111_a_get_dhsc                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "DHSC"
item  dhsc-seq   final  process-seq
item  dhsc-type  final  comp-type
item  dhsc-factor final  factor

request u111_a_get_agep                     &
                on edit        errors report &
                on calculation errors report
access f190-comp-codes
choose comp-code "AGEP"
item  agep-seq   final  process-seq
item  agep-type  final  comp-type
item  agep-factor final  factor


;-------------------------------------------------------------------------------
;
request u110_process                            &
                on edit        errors report    &
                on calculation errors report

@if dg and hsc
  use $pb_src/u110_hsc
@elseif dg and rma
  use $pb_src/u110_rma
@else
  error - program must be compiled using conditional statements
@endif

temp x-comp-code-misc0 char*6
item x-comp-code-misc0                    = "MISC0"
subfile u110 alias u110_misc0   append  at docrev-doc-nbr            &
  if mtd-misc0 <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-misc0, misc0-type, misc0-seq, misc0-factor, mtd-misc0

temp x-comp-code-misc1 char*6
item x-comp-code-misc1                    = "MISC1"
subfile u110 alias u110_misc1   append  at docrev-doc-nbr            &
  if mtd-misc1 <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-misc1, misc1-type, misc1-seq, misc1-factor, mtd-misc1


temp x-comp-code-misc2 char*6
item x-comp-code-misc2                    = "MISC2"
subfile u110 alias u110_misc2   append  at docrev-doc-nbr            &
  if mtd-misc2 <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-misc2,misc2-type,misc2-seq,misc2-factor,mtd-misc2


temp x-comp-code-misc3 char*6
item x-comp-code-misc3                    = "MISC3"
subfile u110 alias u110_misc3   append  at docrev-doc-nbr            &
  if mtd-misc3 <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-misc3,misc3-type, misc3-seq,misc3-factor,mtd-misc3


temp x-comp-code-misc4 char*6
item x-comp-code-misc4                    = "MISC4"
subfile u110 alias u110_misc4   append  at docrev-doc-nbr            &
  if mtd-misc4 <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-misc4,misc4-type,misc4-seq,misc4-factor,mtd-misc4


temp x-comp-code-misc5 char*6
item x-comp-code-misc5                    = "MISC5"
subfile u110 alias u110_misc5   append  at docrev-doc-nbr            &
  if mtd-misc5 <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-misc5,misc5-type,misc5-seq,misc5-factor,mtd-misc5


temp x-comp-code-misc6 char*6
item x-comp-code-misc6                    = "MISC6"
subfile u110 alias u110_misc6   append  at docrev-doc-nbr            &
  if mtd-misc6 <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-misc6,misc6-type,misc6-seq,misc6-factor,mtd-misc6


temp x-comp-code-misc7 char*6
item x-comp-code-misc7                    = "MISC7"
subfile u110 alias u110_misc7   append  at docrev-doc-nbr            &
  if mtd-misc7 <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-misc7,misc7-type,misc7-seq,misc7-factor,mtd-misc7


temp x-comp-code-misc8 char*6
item x-comp-code-misc8                    = "MISC8"
subfile u110 alias u110_misc8   append  at docrev-doc-nbr            &
  if mtd-misc8 <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-misc8,misc8-type,misc8-seq,misc8-factor,mtd-misc8


temp x-comp-code-misc9 char*6
item x-comp-code-misc9                    = "MISC9"
subfile u110 alias u110_misc9   append  at docrev-doc-nbr            &
  if mtd-misc9 <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-misc9,misc9-type,misc9-seq,misc9-factor,mtd-misc9


temp x-comp-code-micv char*6
item x-comp-code-micv                    = "MICV"
subfile u110 alias u110_micv   append  at docrev-doc-nbr            &
  if mtd-micv <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-micv,micv-type,micv-seq,micv-factor,mtd-micv


temp x-comp-code-micm char*6
item x-comp-code-micm                    = "MICM"
subfile u110 alias u110_micm   append  at docrev-doc-nbr            &
  if mtd-micm <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-micm,micm-type,micm-seq,micm-factor,mtd-micm


temp x-comp-code-misj char*6
item x-comp-code-misj                    = "MISJ"
subfile u110 alias u110_misj   append  at docrev-doc-nbr            &
  if mtd-misj <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-misj,misj-type,misj-seq,misj-factor,mtd-misj


temp x-comp-code-misp char*6
item x-comp-code-misp                    = "MISP"
subfile u110 alias u110_misp   append  at docrev-doc-nbr            &
  if mtd-misp <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-misp,misp-type,misp-seq,misp-factor,mtd-misp


temp x-comp-code-mohr char*6
item x-comp-code-mohr                    = "MOHR"
subfile u110 alias u110_mohr   append  at docrev-doc-nbr            &
  if mtd-mohr <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-mohr,mohr-type,mohr-seq,mohr-factor,mtd-mohr


temp x-comp-code-micb char*6
item x-comp-code-micb                    = "MICB"
subfile u110 alias u110_micb   append  at docrev-doc-nbr            &
  if mtd-micb <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-micb,micb-type,micb-seq,micb-factor,mtd-micb


temp x-comp-code-mibr char*6
item x-comp-code-mibr                    = "MIBR"
subfile u110 alias u110_mibr   append  at docrev-doc-nbr            &
  if mtd-mibr <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-mibr,mibr-type,mibr-seq,mibr-factor,mtd-mibr


temp x-comp-code-minh char*6
item x-comp-code-minh                    = "MINH"
subfile u110 alias u110_minh   append  at docrev-doc-nbr            &
  if mtd-minh <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-minh,minh-type,minh-seq,minh-factor,mtd-minh


temp x-comp-code-mhsc char*6
item x-comp-code-mhsc                    = "MHSC"
subfile u110 alias u110_mhsc   append  at docrev-doc-nbr            &
  if mtd-mhsc <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-mhsc,mhsc-type,mhsc-seq,mhsc-factor,mtd-mhsc

temp x-comp-code-dhsc char*6
item x-comp-code-dhsc                    = "DHSC"
subfile u110 alias u110_dhsc   append  at docrev-doc-nbr            &
  if mtd-dhsc <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-dhsc,dhsc-type,dhsc-seq,dhsc-factor,mtd-dhsc

temp x-comp-code-agep char*6
item x-comp-code-agep                    = "AGEP"
subfile u110 alias u110_agep   append  at docrev-doc-nbr            &
  if mtd-agep <> 0                                                   &
     include docrev-doc-nbr of f050-doc-revenue-mstr,x-comp-code-agep,agep-type,agep-seq,agep-factor,mtd-agep


build $pb_obj/u110
  
