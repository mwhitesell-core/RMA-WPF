;PURPOSE: REPORT AGENT 6 or 9 suspend claims  
;	  first pass of 2 programs

;DATE:		WHO:		MODIFICATION
;2011/apr/07    M.C		ORIGINAL

can clear
set process nolimit
set lock record update

request extract_suspend_detail

access f002-suspend-hdr                            &
  link clmhdr-pat-ohip-id-or-chart		   &
   to  key-pat-mstr of f010-pat-mstr opt	   &
  link clmhdr-doc-ohip-nbr, clmhdr-accounting-nbr  &
   to  clmdtl-doc-ohip-nbr, clmdtl-accounting-nbr  &
                             of f002-suspend-dtl   

sel if clmhdr-agent-cd = 6 or clmhdr-agent-cd = 9

sorted on clmhdr-doc-ohip-nbr on clmhdr-accounting-nbr

def x-type zoned*1 = 1

temp x-seq  zoned*2 
item x-seq = x-seq + 1 reset at clmhdr-accounting-nbr

def x-line char*70 = 				&
	 CLMDTL-OMA-CD +			&
	 CLMDTL-OMA-SUFF + '     ' +		&
	 ascii(CLMDTL-NBR-SERV,2)  + '     ' +  &
	 ascii(CLMDTL-DIAG-CD,3)   + '     ' +	&
	 CLMDTL-SV-DATE[1:4] + '/' +		&
	 CLMDTL-SV-DATE[5:2] + '/' + 		&
	 CLMDTL-SV-DATE[7:2] 

subfile susp_agent_dtl keep		  	  &
include  clmhdr-doc-ohip-nbr 			, &
	 clmhdr-accounting-nbr			, &
	 CLMHDR-CLINIC-NBR-1-2  		, &
	 CLMHDR-DOC-NBR				, &
	 CLMHDR-DOC-SPEC-CD			, &
	 CLMHDR-REFER-DOC-NBR			, &
	 CLMHDR-LOC 				, &
	 CLMHDR-AGENT-CD			, &
	 CLMHDR-I-O-PAT-IND 			, &
	 CLMHDR-DOC-DEPT			, &
	 CLMHDR-DATE-ADMIT 			, &
	 CLMHDR-CONFIDENTIAL-FLAG		, &
	 PAT-SURNAME 				, &
	 PAT-GIVEN-NAME				, &
	 PAT-HEALTH-NBR				, &
	 PAT-VERSION-CD				, &
	 PAT-OHIP-MMYY				, &
	 PAT-BIRTH-DATE				, &
	 PAT-SEX				, &
	 SUBSCR-ADDR1				, &
	 SUBSCR-ADDR2				, &
	 SUBSCR-ADDR3				, &
	 SUBSCR-POSTAL-CD 			, &
	 SUBSCR-PROV-CD				, &
	 PAT-PHONE-NBR				, &
	 x-type					, &
	 x-seq					, &
	 x-line

request extract_suspend_desc
 
access f002-suspend-hdr                            &
  link clmhdr-pat-ohip-id-or-chart		   &
   to  key-pat-mstr of f010-pat-mstr opt	   &
  link clmhdr-doc-ohip-nbr, clmhdr-accounting-nbr  &
   to  clmdtl-doc-ohip-nbr, clmdtl-accounting-nbr  &
                             of f002-suspend-desc 

sel if clmhdr-agent-cd = 6 or clmhdr-agent-cd = 9

sorted on clmhdr-doc-ohip-nbr on clmhdr-accounting-nbr

def x-type zoned*1 = 2

def x-seq  zoned*2 = clmdtl-line-no

def x-line char*70 = CLMDTL-SUSPEND-DESC

subfile susp_agent_dtl alias susp_agent_desc  append	&
include  clmhdr-doc-ohip-nbr 			, &
	 clmhdr-accounting-nbr			, &
	 CLMHDR-CLINIC-NBR-1-2  		, &
	 CLMHDR-DOC-NBR				, &
	 CLMHDR-DOC-SPEC-CD			, &
	 CLMHDR-REFER-DOC-NBR			, &
	 CLMHDR-LOC 				, &
	 CLMHDR-AGENT-CD			, &
	 CLMHDR-I-O-PAT-IND 			, &
	 CLMHDR-DOC-DEPT			, &
	 CLMHDR-DATE-ADMIT 			, &
	 CLMHDR-CONFIDENTIAL-FLAG		, &
	 PAT-SURNAME 				, &
	 PAT-GIVEN-NAME				, &
	 PAT-HEALTH-NBR				, &
	 PAT-VERSION-CD				, &
	 PAT-OHIP-MMYY				, &
	 PAT-BIRTH-DATE				, &
	 PAT-SEX				, &
	 SUBSCR-ADDR1				, &
	 SUBSCR-ADDR2				, &
	 SUBSCR-ADDR3				, &
	 SUBSCR-POSTAL-CD 			, &
	 SUBSCR-PROV-CD				, &
	 PAT-PHONE-NBR				, &
	 x-type					, &
	 x-seq					, &
	 x-line


build $obj/suspend_agent_detail
