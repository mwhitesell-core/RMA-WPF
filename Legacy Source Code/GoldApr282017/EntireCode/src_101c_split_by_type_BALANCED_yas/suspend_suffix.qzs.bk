; Program: suspend_suffix.qzs
; Purpose: dump out if suffix C, B or A if over certain amount


cancel clear
set rep nolimit
set rep dev disc name suspend_suffix
set page length 0 width 132

access f002-suspend-dtl

sorted on clmdtl-doc-ohip-nbr	&
       on clmdtl-accounting-nbr 

select if    (CLMDTL-OMA-SUFF = "C" and CLMDTL-FEE-OHIP > 131076)  &
          or (CLMDTL-OMA-SUFF = "B" and CLMDTL-FEE-OHIP > 112860)  &
          or (CLMDTL-OMA-SUFF = "A" and CLMDTL-FEE-OHIP > 540000)    

page heading                                                       &
	tab 30 "Audit of Suspend Detail Prices"			   &
skip 2								   &
  tab 01 "Doc Ohip"					&
  tab 10 "Accounting"					&
  tab 24 "Code"						&
  tab 37 "Consec"					&	
 skip 1							&
  tab 01 "  Number"					&
  tab 13 "    Nbr   "					&
  tab 24 " /Suff"					&
  tab 31 "Svc"						&
  tab 37 "services" 					&
  tab 51 "TECH"						&
  tab 63 "OMA"						&
  tab 73 "OHIP"						&
 skip 2

rep 					  		&
  tab 01 clmdtl-doc-ohip-nbr pic "^^^^^^" print at clmdtl-doc-ohip-nbr 	 &
  tab 12 clmdtl-accounting-nbr            print at clmdtl-accounting-nbr &
  tab 24 clmdtl-oma-cd					&
  tab 29 clmdtl-oma-suff 				&
  tab 32 clmdtl-nbr-serv				&
  tab 36 clmdtl-consec-dates-r    			&
  tab 45 clmdtl-amt-tech-billed  pic "^^^,^^^.^^"       &
  tab 56 clmdtl-fee-oma  pic "^^^,^^^.^^"        	&
  tab 67 clmdtl-fee-ohip pic "^^^,^^^.^^"

final footing								&
 skip 2									&
  tab 45 clmdtl-amt-tech-billed  subtotal pic "^^^,^^^.^^"        	&
  tab 56 clmdtl-fee-oma          subtotal pic "^^^,^^^.^^"        	&
  tab 67 clmdtl-fee-ohip         subtotal pic "^^^,^^^.^^"

build $obj/suspend_suffix
